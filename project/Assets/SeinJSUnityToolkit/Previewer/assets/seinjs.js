(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[function(t,e,n){(function(n,r){(function(e){"use strict";var i,o,a,u,c,h;function l(t){return t.isSName}(i=e.ESpace||(e.ESpace={}))[i.BONE=0]="BONE",i[i.LOCAL=1]="LOCAL",i[i.WORLD=2]="WORLD",i[i.VIEW=3]="VIEW",i[i.NDC=4]="NDC",i[i.SCREEN=5]="SCREEN",(o=e.EColliderType||(e.EColliderType={}))[o.Null=0]="Null",o[o.Sphere=1]="Sphere",o[o.Box=2]="Box",o[o.Plane=3]="Plane",o[o.Cylinder=4]="Cylinder",(a=e.ERigidBodyType||(e.ERigidBodyType={}))[a.Dynamic=1]="Dynamic",a[a.Static=2]="Static",(u=e.EJointType||(e.EJointType={}))[u.PointToPoint=0]="PointToPoint",u[u.Hinge=1]="Hinge",u[u.Distance=2]="Distance",u[u.Spring=3]="Spring",u[u.Lock=4]="Lock",(c=e.EPickMode||(e.EPickMode={}))[c.CLOSEST=1]="CLOSEST",c[c.Closest=1]="Closest",c[c.Any=2]="Any",c[c.All=4]="All",(h=e.ESeinNodeType||(e.ESeinNodeType={}))[h.Component=1]="Component",h[h.Actor=2]="Actor";var f=function(){function t(e){this.isSName=!0,this._value="",this._index=0,this._value=e,t.TABLE[e]||(t.INDEX+=1,t.TABLE[e]=t.INDEX),this._index=t.TABLE[e]}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),t.prototype.equalsTo=function(e){return l(e)?this._index===e._index:!!t.TABLE[e]&&t.TABLE[e]===this._index},t.prototype.toString=function(){return this._value},t.INDEX=0,t.TABLE={},t}(),d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */function p(t,e){function n(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var m=function(){return(m=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function _(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function g(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function v(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function y(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function E(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var T="production";void 0!==n&&(T="production");var A="production"!==T,S={devMode:A,warn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];A&&console.warn.apply(console,t)},logCanvas:function(t,e){var n=e*t.height/t.width,r=t.toDataURL();console.log("%c+","font-size: 1px; padding: "+n/2+"px "+e/2+"px; line-height: "+n+"px; background: url("+r+"); background-size: "+e+"px "+n+"px; background-repeat: no-repeat; color: transparent;")},env:T},M=function(t){function e(n,r,i){void 0===i&&(i="");var o=t.call(this,i)||this;return o.isBaseException=!0,o.objectStack=[],o.__proto__=e.prototype,o.name=n,o.object=r,o.type=new f(o.name||"Unknown"),S.devMode&&(o.objectStack=o.initObjectStack()),o}return p(e,t),e.FROM_NATIVE_JS_ERROR=function(t,n){var r=new e(t.name,n,t.message);return r.stack=t.stack,r},e.prototype.initObjectStack=function(){for(var t=this.object,e=[];t;)e.push(t.constructor.CLASS_NAME.value+"("+t.name.value+")"),t=t.parent;return e},e}(Error);function O(t,e,n){void 0===n&&(n=null);var r=t;(function(t){return t.isBaseException})(t)||(r=M.FROM_NATIVE_JS_ERROR(t,e)),S.devMode&&(console.error(r),console.log("%cStack: "+r.objectStack.join(" -> "),"color: #ff0000; background: rgba(255, 0, 0, .1); padding: 16px"));for(var i=e;i;){if(i.onError&&i.onError.call&&!0===i.onError(r,n))return;i=i.parent}throw r}function b(t){return t.isSObject}var L=function(){function t(e){void 0===e&&(e=""),this.isSObject=!0,this.editable=!0,t.UUID+=1,this._uuid=t.UUID,this.name=new f(e||this.constructor.CLASS_NAME.value+"-"+this._uuid)}return Object.defineProperty(t.prototype,"uuid",{get:function(){return this._uuid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this.constructor.CLASS_NAME},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classType",{get:function(){return this.constructor.CLASS_TYPE},enumerable:!1,configurable:!0}),t.prototype.rename=function(t){this.name=new f(t)},t.prototype.clone=function(t){throw new Error("Not implement.")},t.prototype.serialize=function(){throw new Error("Not implement.")},t.prototype.deserialize=function(t){throw new Error("Not implement.")},t.prototype.onDestroy=function(){},t.prototype.destroy=function(){try{this.onDestroy()}catch(t){O(t,this)}},t.CLASS_NAME=new f("SObject"),t.CLASS_TYPE=new f("SObject"),t.INSPECTABLE_PROPERTIES={},t.UUID=0,t}(),I={},R={};function C(t){return function(e){var n=e;return n.CLASS_NAME=new f(t.className),t.classType&&(n.CLASS_TYPE=new f(t.classType)),I[t.className]=n}}function x(t){return function(e){return e.CLASS_NAME=new f(t.className),R[t.className]=e,e}}var w=function(t){function e(e,n){var r=t.call(this,n)||this;return r.isObservable=!0,r.onEmpty=function(){},r.parent=null,r._index=0,r._length=0,r._queue=[],r.parent=e,r}return p(e,t),Object.defineProperty(e.prototype,"count",{get:function(){return this._queue.length},enumerable:!1,configurable:!0}),e.prototype.add=function(t,e){return void 0!==e?this._queue.splice(e,0,{callback:t,isOnce:!1}):this._queue.push({callback:t,isOnce:!1}),this},e.prototype.addOnce=function(t,e){return void 0!==e?this._queue.splice(e,0,{callback:t,isOnce:!0}):this._queue.push({callback:t,isOnce:!0}),this},e.prototype.clear=function(){return this._queue=[],this.onEmpty(),this},e.prototype.remove=function(t){for(var e=this._queue.length,n=-1,r=0;r<e;r+=1)this._queue[r].callback===t&&(n=r);if(!(n<0))return this._queue.splice(n,1),this._index-=1,this._length-=1,1===e&&this.onEmpty(),this},e.prototype.notify=function(t){var e=this._queue.length;for(this._index=0,this._length=e;this._index<this._length;){var n=this._queue[this._index],r=n.callback;n.isOnce?(this._queue.splice(this._index,1),this._length-=1):this._index+=1;try{if(!0===r(t))return this}catch(t){O(t,this)}}return e>0&&0===this._length&&this.onEmpty(),this},e=g([C({className:"Observable"})],e)}(L),N=function(t){function e(e,n,r,i,o){void 0===o&&(o="");var s=t.call(this,"MissingMember",i,e.className+' "'+e.name+'" does not have '+n+' "'+r+'". '+o)||this;return s.isMissingMemberException=!0,s}return p(e,t),e}(M),P=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this,e.name.value)||this;return n.isEventManager=!0,n._observables={},n._triggers={},n._caches={},n._objHasGame=null,n._objHasGame=e,n}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._objHasGame},enumerable:!1,configurable:!0}),e.prototype.getGame=function(){return this._objHasGame.getGame()},e.prototype.onError=function(){},e.prototype.register=function(t,e){var n=this;return this._observables[t]?(S.warn("Event "+t+" is already registered, before re-register, please unregister it at first !"),this):(this._observables[t]=new w(this,t),this._observables[t].onEmpty=function(){n._triggers[t]&&!n._triggers[t].paused&&n._triggers[t].pause()},e&&(this._triggers[t]=new e(t,this,this.getGame())),this)},e.prototype.unregister=function(t){return this._observables[t]?(delete this._observables[t],this._triggers[t]&&(this._triggers[t].destroy(),delete this._triggers[t]),this):this},e.prototype.add=function(t,e,n){return this._observables[t]||this.register(t),this._observables[t].add(e,n),this._triggers[t]&&this._triggers[t].paused&&this._triggers[t].begin(),this},e.prototype.addOnce=function(t,e,n){return this._observables[t]||this.register(t),this._observables[t].addOnce(e,n),this._triggers[t]&&this._triggers[t].paused&&this._triggers[t].begin(),this},e.prototype.remove=function(t,e){return this._observables[t]?(this._observables[t].remove(e),this):this},e.prototype.has=function(t){return!!this._observables[t]},e.prototype.getCount=function(t){return this.has(t)?this._observables[t].count:0},e.prototype.clear=function(t){return this._observables[t]||O(new N(this,"Event",t,this),this),this._observables[t].clear(),this},e.prototype.trigger=function(t,e,n){return void 0===n&&(n=!0),this._observables[t]||O(new N(this,"Event",t,this,"Register it before trigger !"),this),n||this.getGame().paused?(this._observables[t].notify(e),this):(this._caches[t]=e,this)},e.prototype.flush=function(t){if(!this._observables[t])throw new N(this,"Event",t,this,"Register it before flush !");var e=this._caches[t];return e&&(delete this._caches[t],this._observables[t].notify(e)),this},e.prototype.flushAll=function(){for(var t in this._caches)this.flush(t);return this},e.prototype.onDestroy=function(){for(var t in this._triggers)this._triggers[t].destroy()},e=g([C({className:"EventManager",classType:"EventManager"})],e)}(L);function D(t){return t.isComponent}var H=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.isComponent=!0,i.isRoot=!1,i.updateOnEverTick=!0,i.needUpdateAndDestroy=!0,i.canBeRemoved=!0,i._owner=null,i._event=null,i._initState=r||{},i._owner=n,i._event=new P(i),i}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),e.prototype.verifyAdding=function(t){},e.prototype.verifyRemoving=function(){},e.prototype.onInit=function(t){},e.prototype.onAdd=function(t){},e.prototype.onUpdate=function(t){},e.prototype.onError=function(t,e){},e.prototype.onUnLink=function(){},e.prototype.onReLink=function(){},e.prototype.onDestroy=function(){},e.prototype.initialized=function(){try{this.onInit(this._initState)}catch(t){O(t,this)}},e.prototype.added=function(){try{this.onAdd(this._initState)}catch(t){O(t,this)}},e.prototype.update=function(t){if(this.updateOnEverTick&&this.parent)try{this.onUpdate(t)}catch(t){O(t,this)}},e.prototype.unLink=function(){try{this.onUnLink()}catch(t){O(t,this)}},e.prototype.reLink=function(){try{this.onReLink()}catch(t){O(t,this)}},e.prototype.destroy=function(){this._owner&&(this._event.destroy(),t.prototype.destroy.call(this),this._owner=null)},e.prototype.getGame=function(){return this._owner.getGame()},e.prototype.getWorld=function(){return this._owner.getWorld()},e.prototype.getLevel=function(){return this._owner.getLevel()},e.prototype.getPhysicWorld=function(){return this._owner.getPhysicWorld()},e.prototype.getOwner=function(){return this._owner},e.prototype.getRoot=function(){return this._owner.root},e.prototype.removeFromParent=function(){this._owner.removeComponent(this)},e=g([C({className:"Component",classType:"Component"})],e)}(L),F=function(){function t(){this._array=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this._array.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this._array.length},enumerable:!1,configurable:!0}),t.prototype.fromArray=function(t){throw new Error("Not implemented")},t.prototype.forEach=function(t){for(var e=this.length,n=0;n<e;n+=1)if(t(this._array[n]))return this;return this},t.prototype.clear=function(){return this._array=[],this},t.prototype.addItem=function(t){this._array.push(t)},t.prototype.removeItem=function(t){var e;if(function(t){return t.isSObject}(t)){if((e=this._array.indexOf(t))<0)return}else if(e=t,!(t=this._array[e]))return;this._array.splice(e,1)},t.prototype.findByClass=function(t){return this.findByFilter((function(e){return e.className.equalsTo(t.CLASS_NAME)}))},t.prototype.findAllByClass=function(t,e){return this.findAllByFilter((function(e){return e.className.equalsTo(t.CLASS_NAME)}),e)},t.prototype.findByClassType=function(t){return this.findByFilter((function(e){return e.classType.equalsTo(t)}))},t.prototype.findAllByClassType=function(t,e){return this.findAllByFilter((function(e){return e.classType.equalsTo(t)}),e)},t.prototype.findByName=function(t){return this.findByFilter((function(e){return e.name.equalsTo(t)}))},t.prototype.findAllByName=function(t,e){return this.findAllByFilter((function(e){return e.name.equalsTo(t)}),e)},t.prototype.findByFilter=function(t){var e=null;return this.forEach((function(n){if(t(n))return e=n,!0})),e},t.prototype.findAllByFilter=function(t,e){var n=[];return this.forEach((function(r){if(t(r)&&(n.push(r),e&&e(r,n)))return!0})),n},t.prototype.serialize=function(){throw new Error("Not implemented")},t.prototype.deserialize=function(t){throw new Error("Not implemented")},t}(),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!1,configurable:!0}),e.prototype.add=function(t){return this.addItem(t),this},e.prototype.remove=function(t){return this.removeItem(t),this},e.prototype.set=function(t,e){return this._array[t]=e,this},e.prototype.insert=function(t,e){return this._array.splice(t,0,e),this},e.prototype.get=function(t){return this._array[t]},e.prototype.pop=function(){var t=this.length,e=this._array[t];return this.removeItem(t),e},e.prototype.indexOf=function(t){return this._array.indexOf(t)},e.prototype.merge=function(t){return Array.prototype.push.apply(this._array,t._array),this},e.prototype.copy=function(t){return this._array=t.array.slice(),this},e.prototype.fromArray=function(t){return this._array=t.slice(),this},e}(F);function B(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r||"undefined"!=typeof self&&self;var G,k=B((function(t,e){
/*!
   * Hilo3d 1.16.2
   * Copyright (c) 2017-present Alibaba Group Holding Ltd.
   * @license MIT
   */
window.Hilo3d=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}({"./node_modules/_amc@1.0.6@amc/build/amd.js":
/*!**************************************************!*\
    !*** ./node_modules/_amc@1.0.6@amc/build/amd.js ***!
    \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var o=n(1),s={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR",COLOR_0:"COLOR",COLOR_1:"COLOR_1",TEXCOORD:"TEXCOORD",TEXCOORD_0:"TEXCOORD",TEXCOORD_1:"TEXCOORD_1",TEXCOORD_2:"TEXCOORD_2",TANGENT:"TANGENT",JOINT:"JOINT",JOINTS_0:"JOINT",WEIGHT:"WEIGHT",WEIGHTS_0:"WEIGHT"},a=["POSITION","NORMAL","COLOR","TEXCOORD","TANGENT","JOINT","WEIGHT","OTHER","TEXCOORD_1","TEXCOORD_2","COLOR_1"],u={POSITION:0,NORMAL:1,COLOR:2,TEXCOORD:3,TANGENT:4,JOINT:5,WEIGHT:6,OTHER:7,TEXCOORD_1:8,TEXCOORD_2:9,COLOR_1:10},c={POSITION:"vertices",NORMAL:"normals",COLOR:"colors",TEXCOORD:"uvs",TEXCOORD_1:"uvs1",TEXCOORD_2:"uvs2",TANGENT:"tangents",JOINT:"skinIndices",WEIGHT:"skinWeights"},h={vertices:"POSITION",_normals:"NORMAL",colors:"COLOR",uvs:"TEXCOORD",uvs1:"TEXCOORD_1",uvs2:"TEXCOORD_2",_tangents:"TANGENT",skinIndices:"JOINT",skinWeights:"WEIGHT"},l={POSITION:3,NORMAL:3,COLOR:3,COLOR_1:3,TEXCOORD:2,TEXCOORD_1:2,TEXCOORD_2:2,TANGENT:4,JOINT:4,WEIGHT:4},f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.indices=e,this.mode=n,this.attrs=[],this.attrIndexMap={}}return i(t,null,[{key:"cp",value:function(t){return t}},{key:"minus",value:function(t,e){return t-e}},{key:"plus",value:function(t,e){return t+e}},{key:"pp",value:function(t,e,n,r){return r-e-n+t}},{key:"depp",value:function(t,e,n,r){return e+n-t+r}},{key:"ATTR",get:function(){return s}},{key:"ATTR_NAME_ID",get:function(){return u}}]),i(t,[{key:"getAttrLength",value:function(){return this.attrs[0].data.length/this.attrs[0].itemCount}},{key:"attrIdToName",value:function(t){return a[t]||"OTHER"}},{key:"addAttr",value:function(t,e,n){s[t]?(this.attrIndexMap[t]=this.attrs.length,n||(n=l[t])):n||(n=1),this.attrs.push({name:t,itemCount:n,data:e})}},{key:"getAttr",value:function(t){if(this.attrIndexMap[t])return this.attrs[this.attrIndexMap[t]];for(var e=this.attrs.length-1;e>=0;e--){var n=this.attrs[e];if(n.name===t)return n}}},{key:"cal",value:function(t,e,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];this.attrs.forEach((function(r,o){for(var s=r.data,a=t.attrs[o].data,u=e*r.itemCount,c=r.itemCount-1;c>=0;c--)a[u+c]=n.apply(null,i.map((function(t){return s[t*r.itemCount+c]})))}))}},{key:"quantize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.attrs.forEach((function(e){if("JOINT"!==e.name&&0!=t[e.name]){var n=o.encode(e.data,t[e.name]||12);e.quantizationBit=n.quantizationBit,e.min=n.min,e.max=n.max,e.data=n.data}}))}},{key:"dequantize",value:function(){this.attrs.forEach((function(t){t.quantizationBit&&(t.data=o.decode(t.data,t.quantizationBit,t.min,t.max))}))}},{key:"convertTypedArray",value:function(){!this.indices||this.indices instanceof Array||(this.indices=Array.from(this.indices)),this.attrs.forEach((function(t){t.data instanceof Array||t.data instanceof Float32Array||(t.data=Array.from(t.data))}))}},{key:"clearEBAttrs",value:function(){delete this.clers,delete this.holes,delete this.handles}},{key:"convertToTypedArray",value:function(){this.indices instanceof Array&&(this.getAttrLength()>65535?this.indices=new Uint32Array(this.indices):this.indices=new Uint16Array(this.indices)),this.attrs.forEach((function(t){t.data instanceof Array&&(t.data=new Float32Array(t.data))}))}},{key:"prepareToWorkerSend",value:function(){return this.clearEBAttrs(),this.convertToTypedArray(),this.getAllBuffers()}},{key:"clone",value:function(){var e=new t(Array.from(this.indices),this.mode);return Object.assign(e.attrIndexMap,this.attrIndexMap),e.attrs=this.attrs.map((function(t){var e=Object.assign({},t);return e.data=Array.from(e.data),e})),e}},{key:"cloneStruct",value:function(){var e=new t;return e.mode=this.mode,this.indices&&(e.indices=[]),Object.assign(e.attrIndexMap,this.attrIndexMap),e.attrs=this.attrs.map((function(t){var e=Object.assign({},t);return e.data=[],e})),e}},{key:"toHilo3dGeometry",value:function(t,e){var n=e||new t.Geometry;return this.indices&&(this.indices.BYTES_PER_ELEMENT?n.indices=new t.GeometryData(this.indices,1):this.getAttrLength()>65535?n.indices=new t.GeometryData(new Uint32Array(this.indices),1):n.indices=new t.GeometryData(new Uint16Array(this.indices),1)),this.attrs.forEach((function(e){var r=c[e.name];r&&(e.data.BYTES_PER_ELEMENT?n[r]=new t.GeometryData(e.data,e.itemCount):n[r]=new t.GeometryData(new Float32Array(e.data),e.itemCount))})),n}},{key:"getAllBuffers",value:function(){var t=[];return this.indices.BYTES_PER_ELEMENT&&t.push(this.indices.buffer),this.attrs.forEach((function(e){e.data&&e.data.BYTES_PER_ELEMENT&&t.push(e.data.buffer)})),t}}],[{key:"fromGLTFPrimitive",value:function(e){var n=new t(e.indices,e.mode),r=e.attributes,i=0;for(var o in r.POSITION&&(i=r.POSITION.length/3),r)if(s[o]){var a=l[s[o]];i&&(a=r[o].length/i),n.addAttr(s[o],r[o],a)}else console.warn("Dont support attribute",o);return n}},{key:"fromHilo3dGeometry",value:function(e){var n=new t(e.indices.data,e.mode);for(var r in h)e[r]&&n.addAttr(h[r],e[r].data,e[r].size);return n}}]),t}();t.exports=f},function(t,e){var n={};function r(t){return n[t]||(n[t]=Math.pow(2,t)-1),n[t]}t.exports={cal:function(t,e,n,i){var o=r(i),s=n-e;return Math.round((t-e)/s*o)},encode:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=t.length,i=r(e),o=1/0,s=-1/0,a=0;a<n;a++)o=Math.min(o,t[a]),s=Math.max(s,t[a]);var u=s-o||1,c=[];for(a=0;a<n;a++)c[a]=Math.round((t[a]-o)/u*i);return{min:o,max:s,quantizationBit:e,data:c}},encodeWithMinAndMax:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,s=t.length,a=r(o),u=i-n||1,c=0;c<s;c++)e[c]=Math.round((t[c]-n)/u*a);return e},decode:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=t.length,s=r(e),a=i-n,u=new Float32Array(o),c=0;c<o;c++)u[c]=n+a*(t[c]/s);return u},normalize:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=t.length,i=0;i<r;i+=n){for(var o=0,s=0;s<n;s++)o+=t[i+s]*t[i+s];for(o=Math.sqrt(o),s=0;s<n;s++)e[i+s]=t[i+s]/o}return e}}},function(t,e,n){t.exports=n(3)},function(t,e,n){var r=n(4);r.Geometry=n(0),t.exports=r},function(t,e,n){var r=n(0),i=n(5),o=n(7),s=n(8),a=n(9),u=[i],c=[o];function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t instanceof Uint8Array&&(e=t.byteOffset,t=t.buffer),function(t){return new u[t.type](t).decompress()}(function(t,e){var n=new Uint8Array(t,e,4);if(65!==n[0]||77!==n[1]||67!==n[2])throw new Error("The file is not AMC format!");var r=c[n[3]].read(t,e+4);return r.geometry.type=n[3],r.geometry}(t,e))}var l,f=null,d=null;function p(t,e){return!f&&a()?(f=new s({wasmURL:t,memPages:e}),d=f.init()):d||Promise.resolve()}function m(t,e,n){if(f||p(e,n),!f||!f.isReady)return h(t);try{return f.decompress(t)}catch(e){return console.warn("wasm decompress error",e),h(t)}}var _=null;function g(t){return t=t||"https://g.alicdn.com/hilo/amc/0.1.27/worker.js",_||(!1===l||"undefined"==typeof Worker?Promise.reject("dont support web worker"):_=/^(?:http|blob|data:|\/\/)/.test(t)?new Promise((function(e,n){var r=new XMLHttpRequest;r.addEventListener("load",(function(){if("undefined"==typeof URL||"undefined"==typeof Blob)l=new Worker("data:application/javascript, ".concat(this.responseText));else{var t=URL.createObjectURL(new Blob([this.responseText]));l=new Worker(t)}l.onerror=function(t){console.log("web worker error",t),l=!1,n(t)},e(l)})),r.addEventListener("error",(function(t){return n(t)})),r.open("get",t,!0),r.send()})):new Promise((function(e,n){(l=new Worker(t)).onerror=function(t){console.log("web worker init error",t),l=!1,n(t)},e(l)})))}var v=0;function y(t,e,n,i){return e=e&&a(),t=new Uint8Array(t),g(i).then((function(i){return new Promise((function(o,s){var a=v++,u=function(e){if(e.data.id===a)if(i.removeEventListener("message",u),u=null,e.data.data){var n=e.data.data;n.constructor=r,n.__proto__=r.prototype,o(n)}else o(h(t))};i.addEventListener("message",u),i.postMessage({id:a,data:t,useWASM:e,wasmURL:n},[t.buffer])}))})).catch((function(r){return e?m(t,n):h(t)}))}t.exports={initWASM:p,initWorker:g,decompress:function(t,e,n){var r=a();return!r||t.byteLength>1048576?y(t,r,e,n):r?Promise.resolve(m(t,e)):Promise.resolve(h(t))},decompressWithJS:h,decompressWithWASM:m,decompressWithWorker:y,destory:function(){l&&(l.terminate(),l=null,_=null),f&&(f=null,d=null)}}},function(t,e,n){function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=n(0),o=(n(1),n(6)),a=o.map,u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.geometry=e,this.faceCount=e.clers.length,this.clers=e.clers,this.holes=e.holes,this.handles=e.handles,this.createHandleMap(this.handles),this.vertexCount=e.getAttrLength(),this.noParallelogramPrediction=!!e.noParallelogramPrediction}var e;return(e=[{key:"nextCorner",value:function(t){return t<0?-1:t+(t%3==2?-2:1)}},{key:"prevCorner",value:function(t){return t<0?-1:t+(t%3?-1:2)}},{key:"createHandleMap",value:function(t){var e=this.handlesMap={};if(t)for(var n=t.length-1;n>=0;n-=2)e[t[n]]=t[n-1]}},{key:"mapBoundary",value:function(t){for(var e=this.indices,n=t.length,r=this.currentVertex,i=this.currentVertex-n+1,o=n-1;o>=0;o--)e[this.nextCorner(t[o])]=r,r=i,e[this.prevCorner(t[o])]=i++;this.currentVertex-=n}},{key:"mapHoleBoundary",value:function(t){for(var e=this.indices,n=t.length,r=this.currentVertex-n+1,i=r,o=n-1;o>=0;o--)e[this.nextCorner(t[o])]=r++,e[this.prevCorner(t[o])]=o?r:i;this.currentVertex-=n}},{key:"fixNegativeIndex",value:function(t){for(var e=t,n=this.indices;n[t]<0;){if(e===-n[-n[t]]||n[t]===n[-n[t]]){console.warn("dead loop bug!!"),n[s]=0;break}n[t]=n[-n[t]]}}},{key:"fixIndicesAndReadVertice",value:function(){for(var t,e=this.indices,n=this.handlesMap,r=this.clers,i=r.length,s=-1,a=[],u=0,c=0;u<i;u++,c+=3)-1===s?(this.fixNegativeIndex(c+1),this.fixNegativeIndex(c+2)):(e[c+1]=e[this.prevCorner(s)],e[c+2]=e[this.nextCorner(s)]),this.fixNegativeIndex(c),-1===s?(this.readVertex(e[c+2]),this.readVertex(e[c+1]),this.readVertex(e[c])):this.readVertex(e[c],s),s=c+1,(t=r[u])!==o.S||n[u]?t===o.E||t===o.F?s=a.pop():t===o.R&&(s=c+2):a.push(c+2),t===o.F&&(s=-1,delete this.lastReadVertexIndex),this._onDecompressFace(u,t)}},{key:"readVertex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!this.readedVertexMap[t]&&(this.readedVertexMap[t]=1,!this.noParallelogramPrediction)){var n=this.indices,r=this.geometry;-1===e?void 0!==this.lastReadVertexIndex&&r.cal(r,t,i.plus,this.lastReadVertexIndex,t):r.cal(r,t,i.depp,n[e],n[this.prevCorner(e)],n[this.nextCorner(e)],t),this.lastReadVertexIndex=t}}},{key:"markCorner",value:function(t,e){var n=this.indices;void 0===n[this.nextCorner(t)]&&(n[this.nextCorner(t)]=-this.prevCorner(e[0])),void 0===n[this.prevCorner(t)]&&(n[this.prevCorner(t)]=-this.nextCorner(e[e.length-1]))}},{key:"onFaceC",value:function(t){var e=this.indices,n=3*this.currentFace,r=this.currentVertex--;e[n]=r;var i=t.pop();return e[this.nextCorner(i)]=r,e[this.prevCorner(i)]=-this.nextCorner(t[t.length-1]),i=t.shift(),e[this.prevCorner(i)]=r,e[this.nextCorner(i)]=-this.prevCorner(t[0]),t.push(n),t}},{key:"onFaceL",value:function(t){var e=3*this.currentFace;return this.markCorner(t.pop(),t),t.unshift(e+2),t.push(e),t}},{key:"onFaceF",value:function(t,e){return t&&this.mapBoundary(t),this.onFaceE(null,e)}},{key:"onFaceE",value:function(t,e){var n=3*this.currentFace;return t&&e.push(t),[n+2,n+1,n]}},{key:"onFaceR",value:function(t){var e=3*this.currentFace;return this.markCorner(t.pop(),t),t.push(e+1,e),t}},{key:"onHandleEnd",value:function(t,e,n){var r=this.indices,i=3*this.currentFace,o=this.handlesMap[this.currentFace],s=e.splice(0,t);return e.shift(),n.push(s),r[this.nextCorner(o)]=-(i+1),r[this.prevCorner(o)]=-this.nextCorner(s[s.length-1]),r[i]=-this.prevCorner(s[0]),e.push(i),e}},{key:"onHandleStart",value:function(t,e){for(var n,i=this.indices,o=3*this.currentFace,s=this.handlesMap[this.currentFace],a=e.length-1;a>=0;a--){var u=e[a].indexOf(s);if(u>=0){var c,h=(n=e.splice(a,1)[0]).splice(0,u);n.shift(),(c=n).push.apply(c,r(h));break}}return i[this.nextCorner(s)]=-(o+1),i[this.prevCorner(s)]=-this.nextCorner(n[n.length-1]),i[o]=-this.prevCorner(t[0]),(t=n.concat(t)).push(o),t}},{key:"onFaceS",value:function(t,e,n){var r=this.handlesMap,i=this.indices,o=3*this.currentFace;if(r[this.currentFace]){this.markCorner(t.pop(),t);var s=t.indexOf(r[this.currentFace]);t=s>=0?this.onHandleEnd(s,t,n):this.onHandleStart(t,n)}else{var a=t.pop();this.markCorner(a,t),i[o]=-this.nextCorner(a);var u=e.pop();this.markCorner(u.pop(),u),(t=u.concat(t)).push(o)}return t}},{key:"onFaceM",value:function(t,e,n){var r=this.indices,i=3*this.currentFace,o=t.splice(0,this.holes[this.currentHole--]);this.mapHoleBoundary(o);var s=r[this.prevCorner(o[0])];r[i]=s;var a=t.pop();return r[this.prevCorner(a)]=-this.nextCorner(t[t.length-1]),r[this.nextCorner(a)]=s,a=t.shift(),r[this.prevCorner(a)]=s,r[this.nextCorner(a)]=-this.prevCorner(t[0]),t.push(i),t}},{key:"decompress",value:function(){this.readedVertexMap=new Uint8Array(this.vertexCount);var t=this.faceCount,e=this.indices=new Array(3*t);this.currentFace=t-1,this.currentVertex=this.vertexCount-1,this.currentHole=this.holes.length-1;for(var n,r=this.clers,i=[],o=[];this.currentFace>=0;){var s="onFace"+a[r[this.currentFace]];this[s]?n=this[s](n,i,o):console.warn("has no ".concat(s)),this.currentFace--}return this.mapBoundary(n),this.fixIndicesAndReadVertice(this.indices),this.geometry.indices=e,this.geometry.dequantize(),this.geometry}},{key:"_onDecompressFace",value:function(t,e){this.onDecompressFace&&this.onDecompressFace(t,e)}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();t.exports=u},function(t,e){var n={C:0,R:1,L:2,S:3,E:4,M:5,F:6},r=[];for(var i in n)r[n[i]]=i;n.map=r,t.exports=n},function(t,e,n){var r=n(0);function i(t,e,n,r){return new t(e.slice(n,n+r*t.BYTES_PER_ELEMENT))}t.exports={read:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new DataView(t),o=new r,s=function(t,e){var n={};return n.version=t.getUint8(e++),n.faceCount=t.getUint32(e,!0),e+=4,n.vertexCount=t.getUint32(e,!0),e+=4,n.attrCount=t.getUint8(e++),n.noParallelogramPrediction=t.getUint8(e++),n.holesCount=t.getUint16(e,!0),e+=2,n.handlesCount=t.getUint16(e,!0),e+=2,n.headerBytes=15,n}(n,e);return e+=s.headerBytes,o.mode="CLERS",e=function(t,e,n,r){for(var o=0;o<r.attrCount;o++){var s={},a=e.getUint16(n,!0);n+=2,s.name=t.attrIdToName(a),s.itemCount=e.getUint8(n++),s.quantizationBit=e.getUint8(n++),s.min=e.getFloat32(n,!0),n+=4,s.max=e.getFloat32(n,!0),n+=4,s.data=i(Int16Array,e.buffer,n,s.itemCount*r.vertexCount),n+=s.itemCount*r.vertexCount*2,t.attrs.push(s)}return n}(o,n,e=function(t,e,n,r){return t.clers=new Uint8Array(e.buffer,n,r.faceCount),n+r.faceCount}(o,n,e=function(t,e,n,r){return r.handlesCount?(t.handles=i(Uint32Array,e.buffer,n,2*r.handlesCount),n+8*r.handlesCount):(t.handles=[],n)}(o,n,e=function(t,e,n,r){return r.holesCount?(t.holes=i(Uint16Array,e.buffer,n,r.holesCount),n+2*r.holesCount):(t.holes=[],n)}(o,n,e,s),s),s),s),{header:s,geometry:o,offset:e}}}},function(t,e,n){var r=n(0),i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wasmURL=e.wasmURL||"https://ossgw.alicdn.com/tmall-c3/tmx/70b8d82ccf33e97a124e54c2d6a3e0c7.wasm",this.memPages=e.memPages||256,this.memPages<256&&(this.memPages=256),this.isReady=!1}var e;return(e=[{key:"initASMJS",value:function(){this.isReady=!0,this.dv=new DataView(HEAP8.buffer),this.heap8=HEAP8,this.ins={exports:{__Z7AMCinitj:Module.__Z7AMCinitj,__Z12AMDecompressv:Module.__Z12AMDecompressv}}}},{key:"init",value:function(){var t=this,e=this.memory=new WebAssembly.Memory({initial:this.memPages});this.dv=new DataView(e.buffer);var n=this.heap8=new Uint8Array(e.buffer),r={global:{NaN:5,Infinity:6},env:{memoryBase:0,memory:e,_malloc:function(){return 2097152},_memset:function(t,e,r){return n.fill(e,t,t+r),t},_printf:function(t,e){for(var r=t;n[r];)r++;var i=String.fromCharCode.apply(String,function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(n.slice(t,r))),o=0;i=i.replace(/%([duf])/g,(function(t,n){return"d"===n||"u"===n?dv.getInt32(e+4*o++,!0):"f"===n?dv.getFloat32(e+4*o++,!0):void 0})),console.log(i)}}};return fetch(this.wasmURL).then((function(t){return t.arrayBuffer()})).then((function(t){return WebAssembly.instantiate(t,r)})).then((function(e){t.module=e,t.ins=e.instance,t.isReady=!0})).catch((function(t){return console.log("wasm load error, use js ver")}))}},{key:"getDataAddr",value:function(t){return this.ins.exports.__Z7AMCinitj(t)}},{key:"decompress",value:function(t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=this.dv,n=this.heap8,i=this.getDataAddr(t.length);n.set(t,i);var o=this.ins.exports.__Z12AMDecompressv();if(o<=0)throw console.error("decompression error code: "+o),new Error("decompression error code: "+o);for(var s=e.getUint32(o,!0),a=e.getUint32(o+4,!0),u=e.getUint32(o+8,!0),c=e.getUint32(o+12,!0),h=[],l=0;l<c;l++){var f=o+16+12*l;h.push([e.getUint32(f,!0),e.getUint32(f+4,!0),e.getUint32(f+8,!0)])}var d=new Uint32Array(e.buffer,a,3*s);d=u>65536?new Uint32Array(d):new Uint16Array(d);var p=new r(d);return h.forEach((function(t){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,3),r=n[0],i=n[1],o=n[2],s=new Float32Array(e.buffer.slice(o,o+u*i*4));p.addAttr(p.attrIdToName(r),s,i)})),p}}])&&function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}();t.exports=i},function(t,e){var n;t.exports=function(){return void 0===n&&(n=function(){if("undefined"==typeof WebAssembly||"undefined"==typeof fetch||function(){if(!/iPad|iPhone|iPod/i.test(navigator.userAgent))return!1;if(/OS (\d+)_(\d+)_?(\d+)?/i.test(navigator.userAgent)){var t=Number(RegExp.$1),e=Number(RegExp.$2);if(11===t&&e>=3||t>11)return!1}return!0}())return!1;try{var t=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),e=new WebAssembly.Module(t);return 0!==new WebAssembly.Instance(e,{}).exports.test(4)}catch(t){return console.log("err while check WebAssembly",t),!1}}()),n}}])},"./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js":
/*!***********************************************************************!*\
    !*** ./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js ***!
    \***********************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){
/*!
  @fileoverview gl-matrix - High performance matrix and vector operations
  @author Brandon Jones
  @author Colin MacKenzie IV
  @version 2.7.0

  Copyright (c) 2015-2018, Brandon Jones, Colin MacKenzie IV.

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to deal
  in the Software without restriction, including without limitation the rights
  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
  THE SOFTWARE.

  */
"undefined"!=typeof self&&self,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t},e.toRadian=function(t){return t*i},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))};var r=e.EPSILON=1e-6;e.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random;var i=Math.PI/180},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=o,e.multiply=s,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.distance=u,e.squaredDistance=c,e.length=h,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t},e.random=function(t,e){var n,i,o,s,a,u;e=e||1;do{a=(n=2*r.RANDOM()-1)*n+(i=2*r.RANDOM()-1)*i}while(a>=1);do{u=(o=2*r.RANDOM()-1)*o+(s=2*r.RANDOM()-1)*s}while(u>=1);var c=Math.sqrt((1-a)/u);return t[0]=e*n,t[1]=e*i,t[2]=e*o*c,t[3]=e*s*c,t},e.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t},e.transformQuat=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2],c=n[3],h=c*r+a*o-u*i,l=c*i+u*r-s*o,f=c*o+s*i-a*r,d=-s*r-a*i-u*o;return t[0]=h*c+d*-s+l*-u-f*-a,t[1]=l*c+d*-a+f*-s-h*-u,t[2]=f*c+d*-u+h*-a-l*-s,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-h)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function s(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function a(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function l(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}e.sub=o,e.mul=s,e.div=a,e.dist=u,e.sqrDist=c,e.len=h,e.sqrLen=l,e.forEach=function(){var t=i();return function(e,n,r,i,o,s){var a,u=void 0;for(n||(n=4),r||(r=0),a=i?Math.min(i*n+r,e.length):e.length,u=r;u<a;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,s),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=o,e.fromValues=s,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=a,e.multiply=u,e.divide=c,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},e.distance=h,e.squaredDistance=l,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=d,e.dot=p,e.cross=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t},e.lerp=function(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t},e.hermite=function(t,e,n,r,i,o){var s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,c=s*(o-1),h=s*(3-2*o);return t[0]=e[0]*a+n[0]*u+r[0]*c+i[0]*h,t[1]=e[1]*a+n[1]*u+r[1]*c+i[1]*h,t[2]=e[2]*a+n[2]*u+r[2]*c+i[2]*h,t},e.bezier=function(t,e,n,r,i,o){var s=1-o,a=s*s,u=o*o,c=a*s,h=3*o*a,l=3*u*s,f=u*o;return t[0]=e[0]*c+n[0]*h+r[0]*l+i[0]*f,t[1]=e[1]*c+n[1]*h+r[1]*l+i[1]*f,t[2]=e[2]*c+n[2]*h+r[2]*l+i[2]*f,t},e.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t},e.transformMat4=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t},e.transformMat3=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t},e.transformQuat=function(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],c=e[2],h=i*c-o*u,l=o*a-r*c,f=r*u-i*a,d=i*f-o*l,p=o*h-r*f,m=r*l-i*h,_=2*s;return h*=_,l*=_,f*=_,d*=2,p*=2,m*=2,t[0]=a+h+d,t[1]=u+l+p,t[2]=c+f+m,t},e.rotateX=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.rotateY=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.rotateZ=function(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t},e.angle=function(t,e){var n=s(t[0],t[1],t[2]),r=s(e[0],e[1],e[2]);d(n,n),d(r,r);var i=p(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=e[0],a=e[1],u=e[2];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(o-u)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(){var t=new r.ARRAY_TYPE(3);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function s(t,e,n){var i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function u(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function c(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function h(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function l(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function f(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function d(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}e.sub=a,e.mul=u,e.div=c,e.dist=h,e.sqrDist=l,e.len=o,e.sqrLen=f,e.forEach=function(){var t=i();return function(e,n,r,i,o,s){var a,u=void 0;for(n||(n=3),r||(r=0),a=i?Math.min(i*n+r,e.length):e.length,u=r;u<a;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,s),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=u,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=c,e.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>r.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n},e.multiply=h,e.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*a,t[1]=i*u+o*a,t[2]=o*u-i*a,t[3]=s*u-r*a,t},e.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*a,t[1]=i*u+s*a,t[2]=o*u+r*a,t[3]=s*u-i*a,t},e.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*a,t[1]=i*u-r*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t},e.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},e.slerp=l,e.random=function(t){var e=r.RANDOM(),n=r.RANDOM(),i=r.RANDOM(),o=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=o*Math.sin(2*Math.PI*n),t[1]=o*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*i),t[3]=s*Math.cos(2*Math.PI*i),t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=f,e.fromEuler=function(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(n),u=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return t[0]=o*u*h-s*a*c,t[1]=s*a*h+o*u*c,t[2]=s*u*c-o*a*h,t[3]=s*u*h+o*a*c,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var r=a(n(0)),i=a(n(5)),o=a(n(2)),s=a(n(1));function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function u(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function c(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function h(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+s*a+i*c-o*u,t[1]=i*h+s*u+o*a-r*c,t[2]=o*h+s*c+r*u-i*a,t[3]=s*h-r*a-i*u-o*c,t}function l(t,e,n,i){var o=e[0],s=e[1],a=e[2],u=e[3],c=n[0],h=n[1],l=n[2],f=n[3],d=void 0,p=void 0,m=void 0,_=void 0,g=void 0;return(p=o*c+s*h+a*l+u*f)<0&&(p=-p,c=-c,h=-h,l=-l,f=-f),1-p>r.EPSILON?(d=Math.acos(p),m=Math.sin(d),_=Math.sin((1-i)*d)/m,g=Math.sin(i*d)/m):(_=1-i,g=i),t[0]=_*o+g*c,t[1]=_*s+g*h,t[2]=_*a+g*l,t[3]=_*u+g*f,t}function f(t,e){var n=e[0]+e[4]+e[8],r=void 0;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*o+s]-e[3*s+o])*r,t[o]=(e[3*o+i]+e[3*i+o])*r,t[s]=(e[3*s+i]+e[3*i+s])*r}return t}e.clone=s.clone,e.fromValues=s.fromValues,e.copy=s.copy,e.set=s.set,e.add=s.add,e.mul=h,e.scale=s.scale,e.dot=s.dot,e.lerp=s.lerp;var d=e.length=s.length,p=(e.len=d,e.squaredLength=s.squaredLength),m=(e.sqrLen=p,e.normalize=s.normalize);e.exactEquals=s.exactEquals,e.equals=s.equals,e.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,s){var a=o.dot(i,s);return a<-.999999?(o.cross(t,e,i),o.len(t)<1e-6&&o.cross(t,n,i),o.normalize(t,t),c(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,m(r,r))}}(),e.sqlerp=function(){var t=u(),e=u();return function(n,r,i,o,s,a){return l(t,r,s,a),l(e,i,o,a),l(n,t,e,2*a*(1-a)),n}}(),e.setAxes=function(){var t=i.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],m(e,f(e,t))}}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,i,o,s,a,u,c,h,l,f,d,p,m,_){var g=new r.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=o,g[5]=s,g[6]=a,g[7]=u,g[8]=c,g[9]=h,g[10]=l,g[11]=f,g[12]=d,g[13]=p,g[14]=m,g[15]=_,g},e.set=function(t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m,_){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=c,t[9]=h,t[10]=l,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=_,t},e.identity=i,e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],_=e[14],g=e[15],v=n*a-r*s,y=n*u-i*s,E=n*c-o*s,T=r*u-i*a,A=r*c-o*a,S=i*c-o*u,M=h*m-l*p,O=h*_-f*p,b=h*g-d*p,L=l*_-f*m,I=l*g-d*m,R=f*g-d*_,C=v*R-y*I+E*L+T*b-A*O+S*M;return C?(C=1/C,t[0]=(a*R-u*I+c*L)*C,t[1]=(i*I-r*R-o*L)*C,t[2]=(m*S-_*A+g*T)*C,t[3]=(f*A-l*S-d*T)*C,t[4]=(u*b-s*R-c*O)*C,t[5]=(n*R-i*b+o*O)*C,t[6]=(_*E-p*S-g*y)*C,t[7]=(h*S-f*E+d*y)*C,t[8]=(s*I-a*b+c*M)*C,t[9]=(r*b-n*I-o*M)*C,t[10]=(p*A-m*E+g*v)*C,t[11]=(l*E-h*A-d*v)*C,t[12]=(a*O-s*L-u*M)*C,t[13]=(n*L-r*O+i*M)*C,t[14]=(m*y-p*T-_*v)*C,t[15]=(h*T-l*y+f*v)*C,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],_=e[14],g=e[15];return t[0]=a*(f*g-d*_)-l*(u*g-c*_)+m*(u*d-c*f),t[1]=-(r*(f*g-d*_)-l*(i*g-o*_)+m*(i*d-o*f)),t[2]=r*(u*g-c*_)-a*(i*g-o*_)+m*(i*c-o*u),t[3]=-(r*(u*d-c*f)-a*(i*d-o*f)+l*(i*c-o*u)),t[4]=-(s*(f*g-d*_)-h*(u*g-c*_)+p*(u*d-c*f)),t[5]=n*(f*g-d*_)-h*(i*g-o*_)+p*(i*d-o*f),t[6]=-(n*(u*g-c*_)-s*(i*g-o*_)+p*(i*c-o*u)),t[7]=n*(u*d-c*f)-s*(i*d-o*f)+h*(i*c-o*u),t[8]=s*(l*g-d*m)-h*(a*g-c*m)+p*(a*d-c*l),t[9]=-(n*(l*g-d*m)-h*(r*g-o*m)+p*(r*d-o*l)),t[10]=n*(a*g-c*m)-s*(r*g-o*m)+p*(r*c-o*a),t[11]=-(n*(a*d-c*l)-s*(r*d-o*l)+h*(r*c-o*a)),t[12]=-(s*(l*_-f*m)-h*(a*_-u*m)+p*(a*f-u*l)),t[13]=n*(l*_-f*m)-h*(r*_-i*m)+p*(r*f-i*l),t[14]=-(n*(a*_-u*m)-s*(r*_-i*m)+p*(r*u-i*a)),t[15]=n*(a*f-u*l)-s*(r*f-i*l)+h*(r*u-i*a),t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],h=t[9],l=t[10],f=t[11],d=t[12],p=t[13],m=t[14],_=t[15];return(e*s-n*o)*(l*_-f*m)-(e*a-r*o)*(h*_-f*p)+(e*u-i*o)*(h*m-l*p)+(n*a-r*s)*(c*_-f*d)-(n*u-i*s)*(c*m-l*d)+(r*u-i*a)*(c*p-h*d)},e.multiply=o,e.translate=function(t,e,n){var r=n[0],i=n[1],o=n[2],s=void 0,a=void 0,u=void 0,c=void 0,h=void 0,l=void 0,f=void 0,d=void 0,p=void 0,m=void 0,_=void 0,g=void 0;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(s=e[0],a=e[1],u=e[2],c=e[3],h=e[4],l=e[5],f=e[6],d=e[7],p=e[8],m=e[9],_=e[10],g=e[11],t[0]=s,t[1]=a,t[2]=u,t[3]=c,t[4]=h,t[5]=l,t[6]=f,t[7]=d,t[8]=p,t[9]=m,t[10]=_,t[11]=g,t[12]=s*r+h*i+p*o+e[12],t[13]=a*r+l*i+m*o+e[13],t[14]=u*r+f*i+_*o+e[14],t[15]=c*r+d*i+g*o+e[15]),t},e.scale=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,i){var o,s,a,u,c,h,l,f,d,p,m,_,g,v,y,E,T,A,S,M,O,b,L,I,R=i[0],C=i[1],x=i[2],w=Math.sqrt(R*R+C*C+x*x);return w<r.EPSILON?null:(R*=w=1/w,C*=w,x*=w,o=Math.sin(n),a=1-(s=Math.cos(n)),u=e[0],c=e[1],h=e[2],l=e[3],f=e[4],d=e[5],p=e[6],m=e[7],_=e[8],g=e[9],v=e[10],y=e[11],E=R*R*a+s,T=C*R*a+x*o,A=x*R*a-C*o,S=R*C*a-x*o,M=C*C*a+s,O=x*C*a+R*o,b=R*x*a+C*o,L=C*x*a-R*o,I=x*x*a+s,t[0]=u*E+f*T+_*A,t[1]=c*E+d*T+g*A,t[2]=h*E+p*T+v*A,t[3]=l*E+m*T+y*A,t[4]=u*S+f*M+_*O,t[5]=c*S+d*M+g*O,t[6]=h*S+p*M+v*O,t[7]=l*S+m*M+y*O,t[8]=u*b+f*L+_*I,t[9]=c*b+d*L+g*I,t[10]=h*b+p*L+v*I,t[11]=l*b+m*L+y*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=s*i+h*r,t[6]=a*i+l*r,t[7]=u*i+f*r,t[8]=c*i-o*r,t[9]=h*i-s*r,t[10]=l*i-a*r,t[11]=f*i-u*r,t},e.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[8],h=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=s*i-h*r,t[2]=a*i-l*r,t[3]=u*i-f*r,t[8]=o*r+c*i,t[9]=s*r+h*i,t[10]=a*r+l*i,t[11]=u*r+f*i,t},e.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],h=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=s*i+h*r,t[2]=a*i+l*r,t[3]=u*i+f*r,t[4]=c*i-o*r,t[5]=h*i-s*r,t[6]=l*i-a*r,t[7]=f*i-u*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){var i,o,s,a=n[0],u=n[1],c=n[2],h=Math.sqrt(a*a+u*u+c*c);return h<r.EPSILON?null:(a*=h=1/h,u*=h,c*=h,i=Math.sin(e),s=1-(o=Math.cos(e)),t[0]=a*a*s+o,t[1]=u*a*s+c*i,t[2]=c*a*s-u*i,t[3]=0,t[4]=a*u*s-c*i,t[5]=u*u*s+o,t[6]=c*u*s+a*i,t[7]=0,t[8]=a*c*s+u*i,t[9]=u*c*s-a*i,t[10]=c*c*s+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=s,e.fromQuat2=function(t,e){var n=new r.ARRAY_TYPE(3),i=-e[0],o=-e[1],a=-e[2],u=e[3],c=e[4],h=e[5],l=e[6],f=e[7],d=i*i+o*o+a*a+u*u;return d>0?(n[0]=2*(c*u+f*i+h*a-l*o)/d,n[1]=2*(h*u+f*o+l*i-c*a)/d,n[2]=2*(l*u+f*a+c*o-h*i)/d):(n[0]=2*(c*u+f*i+h*a-l*o),n[1]=2*(h*u+f*o+l*i-c*a),n[2]=2*(l*u+f*a+c*o-h*i)),s(t,e,n),t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+s*s+a*a),t[2]=Math.sqrt(u*u+c*c+h*h),t},e.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3],u=i+i,c=o+o,h=s+s,l=i*u,f=i*c,d=i*h,p=o*c,m=o*h,_=s*h,g=a*u,v=a*c,y=a*h,E=r[0],T=r[1],A=r[2];return t[0]=(1-(p+_))*E,t[1]=(f+y)*E,t[2]=(d-v)*E,t[3]=0,t[4]=(f-y)*T,t[5]=(1-(l+_))*T,t[6]=(m+g)*T,t[7]=0,t[8]=(d+v)*A,t[9]=(m-g)*A,t[10]=(1-(l+p))*A,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){var o=e[0],s=e[1],a=e[2],u=e[3],c=o+o,h=s+s,l=a+a,f=o*c,d=o*h,p=o*l,m=s*h,_=s*l,g=a*l,v=u*c,y=u*h,E=u*l,T=r[0],A=r[1],S=r[2],M=i[0],O=i[1],b=i[2],L=(1-(m+g))*T,I=(d+E)*T,R=(p-y)*T,C=(d-E)*A,x=(1-(f+g))*A,w=(_+v)*A,N=(p+y)*S,P=(_-v)*S,D=(1-(f+m))*S;return t[0]=L,t[1]=I,t[2]=R,t[3]=0,t[4]=C,t[5]=x,t[6]=w,t[7]=0,t[8]=N,t[9]=P,t[10]=D,t[11]=0,t[12]=n[0]+M-(L*M+C*O+N*b),t[13]=n[1]+O-(I*M+x*O+P*b),t[14]=n[2]+b-(R*M+w*O+D*b),t[15]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,h=r*s,l=r*a,f=i*s,d=i*a,p=i*u,m=o*s,_=o*a,g=o*u;return t[0]=1-l-p,t[1]=h+g,t[2]=f-_,t[3]=0,t[4]=h-g,t[5]=1-c-p,t[6]=d+m,t[7]=0,t[8]=f+_,t[9]=d-m,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,r,i,o,s){var a=1/(n-e),u=1/(i-r),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t},e.perspective=function(t,e,n,r,i){var o=1/Math.tan(e/2),s=void 0;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(r-i),t[10]=(i+r)*s,t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t},e.perspectiveFromFieldOfView=function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+a),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(s-a)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},e.ortho=function(t,e,n,r,i,o,s){var a=1/(e-n),u=1/(r-i),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(s+o)*c,t[15]=1,t},e.lookAt=function(t,e,n,o){var s=void 0,a=void 0,u=void 0,c=void 0,h=void 0,l=void 0,f=void 0,d=void 0,p=void 0,m=void 0,_=e[0],g=e[1],v=e[2],y=o[0],E=o[1],T=o[2],A=n[0],S=n[1],M=n[2];return Math.abs(_-A)<r.EPSILON&&Math.abs(g-S)<r.EPSILON&&Math.abs(v-M)<r.EPSILON?i(t):(f=_-A,d=g-S,p=v-M,s=E*(p*=m=1/Math.sqrt(f*f+d*d+p*p))-T*(d*=m),a=T*(f*=m)-y*p,u=y*d-E*f,(m=Math.sqrt(s*s+a*a+u*u))?(s*=m=1/m,a*=m,u*=m):(s=0,a=0,u=0),c=d*u-p*a,h=p*s-f*u,l=f*a-d*s,(m=Math.sqrt(c*c+h*h+l*l))?(c*=m=1/m,h*=m,l*=m):(c=0,h=0,l=0),t[0]=s,t[1]=c,t[2]=f,t[3]=0,t[4]=a,t[5]=h,t[6]=d,t[7]=0,t[8]=u,t[9]=l,t[10]=p,t[11]=0,t[12]=-(s*_+a*g+u*v),t[13]=-(c*_+h*g+l*v),t[14]=-(f*_+d*g+p*v),t[15]=1,t)},e.targetTo=function(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=r[0],u=r[1],c=r[2],h=i-n[0],l=o-n[1],f=s-n[2],d=h*h+l*l+f*f;d>0&&(h*=d=1/Math.sqrt(d),l*=d,f*=d);var p=u*f-c*l,m=c*h-a*f,_=a*l-u*h;return(d=p*p+m*m+_*_)>0&&(p*=d=1/Math.sqrt(d),m*=d,_*=d),t[0]=p,t[1]=m,t[2]=_,t[3]=0,t[4]=l*_-f*m,t[5]=f*p-h*_,t[6]=h*m-l*p,t[7]=0,t[8]=h,t[9]=l,t[10]=f,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=t[9],d=t[10],p=t[11],m=t[12],_=t[13],g=t[14],v=t[15],y=e[0],E=e[1],T=e[2],A=e[3],S=e[4],M=e[5],O=e[6],b=e[7],L=e[8],I=e[9],R=e[10],C=e[11],x=e[12],w=e[13],N=e[14],P=e[15];return Math.abs(n-y)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-E)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(o-T)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-A)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(a-S)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(u-M)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-O)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(h-b)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))&&Math.abs(l-L)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(f-I)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(d-R)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-C)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-x)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(x))&&Math.abs(_-w)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(w))&&Math.abs(g-N)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(v-P)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(P))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=e[9],d=e[10],p=e[11],m=e[12],_=e[13],g=e[14],v=e[15],y=n[0],E=n[1],T=n[2],A=n[3];return t[0]=y*r+E*a+T*l+A*m,t[1]=y*i+E*u+T*f+A*_,t[2]=y*o+E*c+T*d+A*g,t[3]=y*s+E*h+T*p+A*v,y=n[4],E=n[5],T=n[6],A=n[7],t[4]=y*r+E*a+T*l+A*m,t[5]=y*i+E*u+T*f+A*_,t[6]=y*o+E*c+T*d+A*g,t[7]=y*s+E*h+T*p+A*v,y=n[8],E=n[9],T=n[10],A=n[11],t[8]=y*r+E*a+T*l+A*m,t[9]=y*i+E*u+T*f+A*_,t[10]=y*o+E*c+T*d+A*g,t[11]=y*s+E*h+T*p+A*v,y=n[12],E=n[13],T=n[14],A=n[15],t[12]=y*r+E*a+T*l+A*m,t[13]=y*i+E*u+T*f+A*_,t[14]=y*o+E*c+T*d+A*g,t[15]=y*s+E*h+T*p+A*v,t}function s(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=r+r,u=i+i,c=o+o,h=r*a,l=r*u,f=r*c,d=i*u,p=i*c,m=o*c,_=s*a,g=s*u,v=s*c;return t[0]=1-(d+m),t[1]=l+v,t[2]=f-g,t[3]=0,t[4]=l-v,t[5]=1-(h+m),t[6]=p+_,t[7]=0,t[8]=f+g,t[9]=p-_,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}e.mul=o,e.sub=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,i,o,s,a,u,c){var h=new r.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=n,h[3]=i,h[4]=o,h[5]=s,h[6]=a,h[7]=u,h[8]=c,h},e.set=function(t,e,n,r,i,o,s,a,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=c,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],h=e[8],l=h*s-a*c,f=-h*o+a*u,d=c*o-s*u,p=n*l+r*f+i*d;return p?(p=1/p,t[0]=l*p,t[1]=(-h*r+i*c)*p,t[2]=(a*r-i*s)*p,t[3]=f*p,t[4]=(h*n-i*u)*p,t[5]=(-a*n+i*o)*p,t[6]=d*p,t[7]=(-c*n+r*u)*p,t[8]=(s*n-r*o)*p,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],h=e[8];return t[0]=s*h-a*c,t[1]=i*c-r*h,t[2]=r*a-i*s,t[3]=a*u-o*h,t[4]=n*h-i*u,t[5]=i*o-n*a,t[6]=o*c-s*u,t[7]=r*u-n*c,t[8]=n*s-r*o,t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8];return e*(c*o-s*u)+n*(-c*i+s*a)+r*(u*i-o*a)},e.multiply=i,e.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=f*r+d*s+c,t[7]=f*i+d*a+h,t[8]=f*o+d*u+l,t},e.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=Math.sin(n),d=Math.cos(n);return t[0]=d*r+f*s,t[1]=d*i+f*a,t[2]=d*o+f*u,t[3]=d*s-f*r,t[4]=d*a-f*i,t[5]=d*u-f*o,t[6]=c,t[7]=h,t[8]=l,t},e.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,h=r*s,l=r*a,f=i*s,d=i*a,p=i*u,m=o*s,_=o*a,g=o*u;return t[0]=1-l-p,t[3]=h-g,t[6]=f+_,t[1]=h+g,t[4]=1-c-p,t[7]=d-m,t[2]=f-_,t[5]=d+m,t[8]=1-c-l,t},e.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],h=e[8],l=e[9],f=e[10],d=e[11],p=e[12],m=e[13],_=e[14],g=e[15],v=n*a-r*s,y=n*u-i*s,E=n*c-o*s,T=r*u-i*a,A=r*c-o*a,S=i*c-o*u,M=h*m-l*p,O=h*_-f*p,b=h*g-d*p,L=l*_-f*m,I=l*g-d*m,R=f*g-d*_,C=v*R-y*I+E*L+T*b-A*O+S*M;return C?(C=1/C,t[0]=(a*R-u*I+c*L)*C,t[1]=(u*b-s*R-c*O)*C,t[2]=(s*I-a*b+c*M)*C,t[3]=(i*I-r*R-o*L)*C,t[4]=(n*R-i*b+o*O)*C,t[5]=(r*b-n*I-o*M)*C,t[6]=(m*S-_*A+g*T)*C,t[7]=(_*E-p*S-g*y)*C,t[8]=(p*A-m*E+g*v)*C,t):null},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=o,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],h=t[7],l=t[8],f=e[0],d=e[1],p=e[2],m=e[3],_=e[4],g=e[5],v=e[6],y=e[7],E=e[8];return Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-p)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-m)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(a-_)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-g)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-v)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-y)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))&&Math.abs(l-E)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],h=e[7],l=e[8],f=n[0],d=n[1],p=n[2],m=n[3],_=n[4],g=n[5],v=n[6],y=n[7],E=n[8];return t[0]=f*r+d*s+p*c,t[1]=f*i+d*a+p*h,t[2]=f*o+d*u+p*l,t[3]=m*r+_*s+g*c,t[4]=m*i+_*a+g*h,t[5]=m*o+_*u+g*l,t[6]=v*r+y*s+E*c,t[7]=v*i+y*a+E*h,t[8]=v*o+y*u+E*l,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}e.mul=i,e.sub=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=o,e.multiply=s,e.divide=a,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},e.distance=u,e.squaredDistance=c,e.length=h,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},e.lerp=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t},e.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},e.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},e.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},e.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},e.rotate=function(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],s=Math.sin(r),a=Math.cos(r);return t[0]=i*a-o*s+n[0],t[1]=i*s+o*a+n[1],t},e.angle=function(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=n*n+r*r;s>0&&(s=1/Math.sqrt(s));var a=i*i+o*o;a>0&&(a=1/Math.sqrt(a));var u=(n*i+r*o)*s*a;return u>1?0:u<-1?Math.PI:Math.acos(u)},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var n=t[0],i=t[1],o=e[0],s=e[1];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(){var t=new r.ARRAY_TYPE(2);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function s(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function a(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function h(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function l(t){var e=t[0],n=t[1];return e*e+n*n}e.len=h,e.sub=o,e.mul=s,e.div=a,e.dist=u,e.sqrDist=c,e.sqrLen=l,e.forEach=function(){var t=i();return function(e,n,r,i,o,s){var a,u=void 0;for(n||(n=2),r||(r=0),a=i?Math.min(i*n+r,e.length):e.length,u=r;u<a;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,s),e[u]=t[0],e[u+1]=t[1];return e}}()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sqrLen=e.squaredLength=e.len=e.length=e.dot=e.mul=e.setReal=e.getReal=void 0,e.create=function(){var t=new r.ARRAY_TYPE(8);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},e.fromValues=function(t,e,n,i,o,s,a,u){var c=new r.ARRAY_TYPE(8);return c[0]=t,c[1]=e,c[2]=n,c[3]=i,c[4]=o,c[5]=s,c[6]=a,c[7]=u,c},e.fromRotationTranslationValues=function(t,e,n,i,o,s,a){var u=new r.ARRAY_TYPE(8);u[0]=t,u[1]=e,u[2]=n,u[3]=i;var c=.5*o,h=.5*s,l=.5*a;return u[4]=c*i+h*n-l*e,u[5]=h*i+l*t-c*n,u[6]=l*i+c*e-h*t,u[7]=-c*t-h*e-l*n,u},e.fromRotationTranslation=a,e.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},e.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.fromMat4=function(t,e){var n=i.create();o.getRotation(n,e);var s=new r.ARRAY_TYPE(3);return o.getTranslation(s,e),a(t,n,s),t},e.copy=u,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.set=function(t,e,n,r,i,o,s,a,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t},e.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},e.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},e.getTranslation=function(t,e){var n=e[4],r=e[5],i=e[6],o=e[7],s=-e[0],a=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+o*s+r*u-i*a),t[1]=2*(r*c+o*a+i*s-n*u),t[2]=2*(i*c+o*u+n*a-r*s),t},e.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=.5*n[0],u=.5*n[1],c=.5*n[2],h=e[4],l=e[5],f=e[6],d=e[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=s*a+i*c-o*u+h,t[5]=s*u+o*a-r*c+l,t[6]=s*c+r*u-i*a+f,t[7]=-r*a-i*u-o*c+d,t},e.rotateX=function(t,e,n){var r=-e[0],o=-e[1],s=-e[2],a=e[3],u=e[4],c=e[5],h=e[6],l=e[7],f=u*a+l*r+c*s-h*o,d=c*a+l*o+h*r-u*s,p=h*a+l*s+u*o-c*r,m=l*a-u*r-c*o-h*s;return i.rotateX(t,e,n),r=t[0],o=t[1],s=t[2],a=t[3],t[4]=f*a+m*r+d*s-p*o,t[5]=d*a+m*o+p*r-f*s,t[6]=p*a+m*s+f*o-d*r,t[7]=m*a-f*r-d*o-p*s,t},e.rotateY=function(t,e,n){var r=-e[0],o=-e[1],s=-e[2],a=e[3],u=e[4],c=e[5],h=e[6],l=e[7],f=u*a+l*r+c*s-h*o,d=c*a+l*o+h*r-u*s,p=h*a+l*s+u*o-c*r,m=l*a-u*r-c*o-h*s;return i.rotateY(t,e,n),r=t[0],o=t[1],s=t[2],a=t[3],t[4]=f*a+m*r+d*s-p*o,t[5]=d*a+m*o+p*r-f*s,t[6]=p*a+m*s+f*o-d*r,t[7]=m*a-f*r-d*o-p*s,t},e.rotateZ=function(t,e,n){var r=-e[0],o=-e[1],s=-e[2],a=e[3],u=e[4],c=e[5],h=e[6],l=e[7],f=u*a+l*r+c*s-h*o,d=c*a+l*o+h*r-u*s,p=h*a+l*s+u*o-c*r,m=l*a-u*r-c*o-h*s;return i.rotateZ(t,e,n),r=t[0],o=t[1],s=t[2],a=t[3],t[4]=f*a+m*r+d*s-p*o,t[5]=d*a+m*o+p*r-f*s,t[6]=p*a+m*s+f*o-d*r,t[7]=m*a-f*r-d*o-p*s,t},e.rotateByQuatAppend=function(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],c=e[2],h=e[3];return t[0]=a*s+h*r+u*o-c*i,t[1]=u*s+h*i+c*r-a*o,t[2]=c*s+h*o+a*i-u*r,t[3]=h*s-a*r-u*i-c*o,a=e[4],u=e[5],c=e[6],h=e[7],t[4]=a*s+h*r+u*o-c*i,t[5]=u*s+h*i+c*r-a*o,t[6]=c*s+h*o+a*i-u*r,t[7]=h*s-a*r-u*i-c*o,t},e.rotateByQuatPrepend=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+s*a+i*c-o*u,t[1]=i*h+s*u+o*a-r*c,t[2]=o*h+s*c+r*u-i*a,t[3]=s*h-r*a-i*u-o*c,a=n[4],u=n[5],c=n[6],h=n[7],t[4]=r*h+s*a+i*c-o*u,t[5]=i*h+s*u+o*a-r*c,t[6]=o*h+s*c+r*u-i*a,t[7]=s*h-r*a-i*u-o*c,t},e.rotateAroundAxis=function(t,e,n,i){if(Math.abs(i)<r.EPSILON)return u(t,e);var o=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);i*=.5;var s=Math.sin(i),a=s*n[0]/o,c=s*n[1]/o,h=s*n[2]/o,l=Math.cos(i),f=e[0],d=e[1],p=e[2],m=e[3];t[0]=f*l+m*a+d*h-p*c,t[1]=d*l+m*c+p*a-f*h,t[2]=p*l+m*h+f*c-d*a,t[3]=m*l-f*a-d*c-p*h;var _=e[4],g=e[5],v=e[6],y=e[7];return t[4]=_*l+y*a+g*h-v*c,t[5]=g*l+y*c+v*a-_*h,t[6]=v*l+y*h+_*c-g*a,t[7]=y*l-_*a-g*c-v*h,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},e.multiply=c,e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},e.lerp=function(t,e,n,r){var i=1-r;return h(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t},e.invert=function(t,e){var n=f(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},e.normalize=function(t,e){var n=f(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,o=e[2]/n,s=e[3]/n,a=e[4],u=e[5],c=e[6],h=e[7],l=r*a+i*u+o*c+s*h;t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=(a-r*l)/n,t[5]=(u-i*l)/n,t[6]=(c-o*l)/n,t[7]=(h-s*l)/n}return t},e.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],h=t[7],l=e[0],f=e[1],d=e[2],p=e[3],m=e[4],_=e[5],g=e[6],v=e[7];return Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-f)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-d)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-p)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-m)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(u-_)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-g)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-v)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))};var r=s(n(0)),i=s(n(3)),o=s(n(4));function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t,e,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],s=e[0],a=e[1],u=e[2],c=e[3];return t[0]=s,t[1]=a,t[2]=u,t[3]=c,t[4]=r*c+i*u-o*a,t[5]=i*c+o*s-r*u,t[6]=o*c+r*a-i*s,t[7]=-r*s-i*a-o*u,t}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function c(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[4],u=n[5],c=n[6],h=n[7],l=e[4],f=e[5],d=e[6],p=e[7],m=n[0],_=n[1],g=n[2],v=n[3];return t[0]=r*v+s*m+i*g-o*_,t[1]=i*v+s*_+o*m-r*g,t[2]=o*v+s*g+r*_-i*m,t[3]=s*v-r*m-i*_-o*g,t[4]=r*h+s*a+i*c-o*u+l*v+p*m+f*g-d*_,t[5]=i*h+s*u+o*a-r*c+f*v+p*_+d*m-l*g,t[6]=o*h+s*c+r*u-i*a+d*v+p*g+l*_-f*m,t[7]=s*h-r*a-i*u-o*c+p*v-l*m-f*_-d*g,t}e.getReal=i.copy,e.setReal=i.copy,e.mul=c;var h=e.dot=i.dot,l=e.length=i.length,f=(e.len=l,e.squaredLength=i.squaredLength);e.sqrLen=f},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(6);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,i,o,s){var a=new r.ARRAY_TYPE(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a[4]=o,a[5]=s,a},e.set=function(t,e,n,r,i,o,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=s,t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*a-o*s)*u,t[5]=(r*s-n*a)*u,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=i,e.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+o*c,t[1]=i*h+s*c,t[2]=r*-c+o*h,t[3]=i*-c+s*h,t[4]=a,t[5]=u,t},e.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=n[0],h=n[1];return t[0]=r*c,t[1]=i*c,t[2]=o*h,t[3]=s*h,t[4]=a,t[5]=u,t},e.translate=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=r*c+o*h+a,t[5]=i*c+s*h+u,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=o,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=e[0],h=e[1],l=e[2],f=e[3],d=e[4],p=e[5];return Math.abs(n-c)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-h)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-l)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(s-f)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(a-d)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-p)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=n[0],h=n[1],l=n[2],f=n[3],d=n[4],p=n[5];return t[0]=r*c+o*h,t[1]=i*c+s*h,t[2]=r*l+o*f,t[3]=i*l+s*f,t[4]=r*d+o*p+a,t[5]=i*d+s*p+u,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}e.mul=i,e.sub=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,i){var o=new r.ARRAY_TYPE(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*o-i*r;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-i*s,t[3]=n*s,t):null},e.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=i,e.rotate=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*a,t[1]=i*u+s*a,t[2]=r*-a+o*u,t[3]=i*-a+s*u,t},e.scale=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1];return t[0]=r*a,t[1]=i*a,t[2]=o*u,t[3]=s*u,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=o,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-h)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*a+o*u,t[1]=i*a+s*u,t[2]=r*c+o*h,t[3]=i*c+s*h,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}e.mul=i,e.sub=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var r=d(n(0)),i=d(n(9)),o=d(n(8)),s=d(n(5)),a=d(n(4)),u=d(n(3)),c=d(n(7)),h=d(n(6)),l=d(n(2)),f=d(n(1));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.glMatrix=r,e.mat2=i,e.mat2d=o,e.mat3=s,e.mat4=a,e.quat=u,e.quat2=c,e.vec2=h,e.vec3=l,e.vec4=f}])},"./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js":
/*!****************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js ***!
    \****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js":
/*!*****************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js ***!
    \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/cross.js":
/*!******************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/cross.js ***!
    \******************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js":
/*!****************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js ***!
    \****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js":
/*!******************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js ***!
    \******************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/scaleAndAdd.js":
/*!************************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/scaleAndAdd.js ***!
    \************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/squaredDistance.js":
/*!****************************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/squaredDistance.js ***!
    \****************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}},"./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js":
/*!*********************************************************!*\
    !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js ***!
    \*********************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}},"./node_modules/_object-assign@4.1.1@object-assign/index.js":
/*!******************************************************************!*\
    !*** ./node_modules/_object-assign@4.1.1@object-assign/index.js ***!
    \******************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){
/*
  object-assign
  (c) Sindre Sorhus
  @license MIT
  */
var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,u=s(t),c=1;c<arguments.length;c++){for(var h in n=Object(arguments[c]))i.call(n,h)&&(u[h]=n[h]);if(r){a=r(n);for(var l=0;l<a.length;l++)o.call(n,a[l])&&(u[a[l]]=n[a[l]])}}return u}},"./node_modules/_object-values@2.0.0@object-values/index.js":
/*!******************************************************************!*\
    !*** ./node_modules/_object-values@2.0.0@object-values/index.js ***!
    \******************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports=function(t){return Object.keys(t).map((function(e){return t[e]}))}},"./node_modules/_object.keys@0.1.0@object.keys/index.js":
/*!**************************************************************!*\
    !*** ./node_modules/_object.keys@0.1.0@object.keys/index.js ***!
    \**************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){var r,i,o,s;Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),s=(o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){if("object"!=typeof t&&("function"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");var e,n,a=[];for(e in t)r.call(t,e)&&a.push(e);if(i)for(n=0;n<s;n++)r.call(t,o[n])&&a.push(o[n]);return a}))},"./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js":
/*!**********************************************************!*\
    !*** ./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js ***!
    \**********************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports=function(t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=0,n=t.length;function r(){var r="";do{var i=t[e];if(10==i){++e;break}r+=String.fromCharCode(i)}while(++e<n);return r}for(var i=0,o=0,s=1,a=!1,u=0;u<20;u++){var c,h=r();if(c=h.match("#\\?RADIANCE"));else if(c=h.match("FORMAT=32-bit_rle_rgbe"))a=!0;else if(c=h.match("EXPOSURE=\\s*([0-9]*[.][0-9]*)"))s=Number(c[1]);else if(c=h.match("#.*"));else if(c=h.match("-Y ([0-9]+) \\+X ([0-9]+)")){o=Number(c[1]),i=Number(c[2]);break}}if(!a)throw new Error("File is not run length encoded!");var l=new Uint8Array(i*o*4);!function(t,e,n,r,i,o){var s,a,u,c=new Array(4),h=null,l=new Array(2),f=t.length;function d(e){var n=0;do{e[n++]=t[r]}while(++r<f&&n<e.length);return n}function p(e,n,i){var o=0;do{e[n+o++]=t[r]}while(++r<f&&o<i);return o}function m(t,e,n,r){var i=4*r,o=p(e,n,i);if(o<i)throw new Error("Error reading raw pixels: got "+o+" bytes, expected "+i)}for(;o>0;){if(d(c)<c.length)throw new Error("Error reading bytes: expected "+c.length);if(2!=c[0]||2!=c[1]||0!=(128&c[2]))return e[n++]=c[0],e[n++]=c[1],e[n++]=c[2],e[n++]=c[3],void m(0,e,n,i*o-1);if(((255&c[2])<<8|255&c[3])!=i)throw new Error("Wrong scanline width "+((255&c[2])<<8|255&c[3])+", expected "+i);null==h&&(h=new Array(4*i)),s=0;for(var _=0;_<4;_++)for(a=(_+1)*i;s<a;){if(d(l)<l.length)throw new Error("Error reading 2-byte buffer");if((255&l[0])>128){if(0==(u=(255&l[0])-128)||u>a-s)throw new Error("Bad scanline data");for(;u-- >0;)h[s++]=l[1]}else{if(0==(u=255&l[0])||u>a-s)throw new Error("Bad scanline data");if(h[s++]=l[1],--u>0){if(p(h,s,u)<u)throw new Error("Error reading non-run data");s+=u}}}for(_=0;_<i;_++)e[n+0]=h[_],e[n+1]=h[_+i],e[n+2]=h[_+2*i],e[n+3]=h[_+3*i],n+=4;o--}}(t,l,0,e,i,o);for(var f=new Float32Array(i*o*4),d=0;d<l.length;d+=4){var p=l[d+0]/255,m=l[d+1]/255,_=l[d+2]/255,g=l[d+3],v=Math.pow(2,g-128);p*=v,m*=v,_*=v;var y=d;f[y+0]=p,f[y+1]=m,f[y+2]=_,f[y+3]=1}return{shape:[i,o],exposure:s,gamma:1,data:f}}},"./node_modules/_pinkie-promise@2.0.1@pinkie-promise/index.js":
/*!********************************************************************!*\
    !*** ./node_modules/_pinkie-promise@2.0.1@pinkie-promise/index.js ***!
    \********************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="function"==typeof Promise?Promise:n(/*! pinkie */"./node_modules/_pinkie@2.0.4@pinkie/index.js")},"./node_modules/_pinkie@2.0.4@pinkie/index.js":
/*!****************************************************!*\
    !*** ./node_modules/_pinkie@2.0.4@pinkie/index.js ***!
    \****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){(function(e,n){var r,i=function(){},o=void 0!==e&&void 0!==e.process&&"function"==typeof e.process.emit,s=void 0===n?setTimeout:n,a=[];function u(){for(var t=0;t<a.length;t++)a[t][0](a[t][1]);a=[],r=!1}function c(t,e){a.push([t,e]),r||(r=!0,s(u,0))}function h(t){var e=t.owner,n=e._state,r=e._data,i=t[n],o=t.then;if("function"==typeof i){n="fulfilled";try{r=i(r)}catch(t){p(o,t)}}l(o,r)||("fulfilled"===n&&f(o,r),"rejected"===n&&p(o,r))}function l(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,(function(r){n||(n=!0,e===r?d(t,r):f(t,r))}),(function(e){n||(n=!0,p(t,e))})),!0}}catch(e){return n||p(t,e),!0}return!1}function f(t,e){t!==e&&l(t,e)||d(t,e)}function d(t,e){"pending"===t._state&&(t._state="settled",t._data=e,c(_,t))}function p(t,e){"pending"===t._state&&(t._state="settled",t._data=e,c(g,t))}function m(t){t._then=t._then.forEach(h)}function _(t){t._state="fulfilled",m(t)}function g(t){t._state="rejected",m(t),!t._handled&&o&&e.process.emit("unhandledRejection",t._data,t)}function v(t){e.process.emit("rejectionHandled",t)}function y(t){if("function"!=typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(this instanceof y==0)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(t,e){function n(t){p(e,t)}try{t((function(t){f(e,t)}),n)}catch(t){n(t)}}(t,this)}y.prototype={constructor:y,_state:"pending",_then:null,_data:void 0,_handled:!1,then:function(t,e){var n={owner:this,then:new this.constructor(i),fulfilled:t,rejected:e};return!e&&!t||this._handled||(this._handled=!0,"rejected"===this._state&&o&&c(v,this)),"fulfilled"===this._state||"rejected"===this._state?c(h,n):this._then.push(n),n.then},catch:function(t){return this.then(null,t)}},y.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new y((function(e,n){var r=[],i=0;function o(t){return i++,function(n){r[t]=n,--i||e(r)}}for(var s,a=0;a<t.length;a++)(s=t[a])&&"function"==typeof s.then?s.then(o(a),n):r[a]=s;i||e(r)}))},y.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new y((function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&"function"==typeof r.then?r.then(e,n):e(r)}))},y.resolve=function(t){return t&&"object"==typeof t&&t.constructor===y?t:new y((function(e){e(t)}))},y.reject=function(t){return new y((function(e,n){n(t)}))},t.exports=y}).call(this,n(/*! ./../_webpack@4.44.1@webpack/buildin/global.js */"./node_modules/_webpack@4.44.1@webpack/buildin/global.js"),n(/*! ./../_timers-browserify@2.0.11@timers-browserify/main.js */"./node_modules/_timers-browserify@2.0.11@timers-browserify/main.js").setImmediate)},"./node_modules/_process@0.11.10@process/browser.js":
/*!**********************************************************!*\
    !*** ./node_modules/_process@0.11.10@process/browser.js ***!
    \**********************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],h=!1,l=-1;function f(){h&&u&&(h=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!h){var t=a(f);h=!0;for(var e=c.length;e;){for(u=c,c=[];++l<e;)u&&u[l].run();l=-1,e=c.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||h||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/_ray-3d@1.1.1@ray-3d/index.js":
/*!****************************************************!*\
    !*** ./node_modules/_ray-3d@1.1.1@ray-3d/index.js ***!
    \****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){var r=n(/*! ray-triangle-intersection */"./node_modules/_ray-triangle-intersection@1.0.3@ray-triangle-intersection/index.js"),i=n(/*! ray-plane-intersection */"./node_modules/_ray-plane-intersection@1.0.0@ray-plane-intersection/index.js"),o=n(/*! ray-sphere-intersection */"./node_modules/_ray-sphere-intersection@1.0.0@ray-sphere-intersection/index.js"),s=n(/*! ray-aabb-intersection */"./node_modules/_ray-aabb-intersection@1.0.1@ray-aabb-intersection/index.js"),a=n(/*! gl-vec3/copy */"./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js"),u=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function h(t,e){this.origin=t||[0,0,0],this.direction=e||[0,0,-1]}t.exports=h,h.prototype.set=function(t,e){this.origin=t,this.direction=e},h.prototype.copy=function(t){a(this.origin,t.origin),a(this.direction,t.direction)},h.prototype.clone=function(){var t=new h;return t.copy(this),t},h.prototype.intersectsSphere=function(t,e){return o(c,this.origin,this.direction,t,e)},h.prototype.intersectsPlane=function(t,e){return i(c,this.origin,this.direction,t,e)},h.prototype.intersectsTriangle=function(t){return r(c,this.origin,this.direction,t)},h.prototype.intersectsBox=function(t){return s(c,this.origin,this.direction,t)},h.prototype.intersectsTriangleCell=function(t,e){var n=t[0],r=t[1],i=t[2];return u[0]=e[n],u[1]=e[r],u[2]=e[i],this.intersectsTriangle(u)}},"./node_modules/_ray-aabb-intersection@1.0.1@ray-aabb-intersection/index.js":
/*!**********************************************************************************!*\
    !*** ./node_modules/_ray-aabb-intersection@1.0.1@ray-aabb-intersection/index.js ***!
    \**********************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){function n(t,e,n){for(var r=t.length,i=-1/0,o=1/0,s=0;s<r;s++){var a=(n[0][s]-t[s])/e[s],u=(n[1][s]-t[s])/e[s];if(a>u){var c=a;a=u,u=c}if(u<i||a>o)return 1/0;a>i&&(i=a),u<o&&(o=u)}return i>o?1/0:i}t.exports=function(t,e,r,i){var o=n(e,r,i);if(o===1/0)t=null;else{t=t||[];for(var s=0;s<e.length;s++)t[s]=e[s]+r[s]*o}return t},t.exports.distance=n},"./node_modules/_ray-plane-intersection@1.0.0@ray-plane-intersection/index.js":
/*!************************************************************************************!*\
    !*** ./node_modules/_ray-plane-intersection@1.0.0@ray-plane-intersection/index.js ***!
    \************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){var r=n(/*! gl-vec3/dot */"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js"),i=n(/*! gl-vec3/add */"./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js"),o=n(/*! gl-vec3/scale */"./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js"),s=n(/*! gl-vec3/copy */"./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js");t.exports=function(t,e,n,u,c){var h=r(n,u);if(0!==h){var l=-(r(e,u)+c)/h;return l<0?null:(o(a,n,l),i(t,e,a))}return r(u,e)+c===0?s(t,e):null};var a=[0,0,0]},"./node_modules/_ray-sphere-intersection@1.0.0@ray-sphere-intersection/index.js":
/*!**************************************************************************************!*\
    !*** ./node_modules/_ray-sphere-intersection@1.0.0@ray-sphere-intersection/index.js ***!
    \**************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){var r=n(/*! gl-vec3/squaredDistance */"./node_modules/_gl-vec3@1.1.3@gl-vec3/squaredDistance.js"),i=n(/*! gl-vec3/dot */"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js"),o=n(/*! gl-vec3/subtract */"./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js"),s=n(/*! gl-vec3/scaleAndAdd */"./node_modules/_gl-vec3@1.1.3@gl-vec3/scaleAndAdd.js"),a=n(/*! gl-vec3/scale */"./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js"),u=n(/*! gl-vec3/add */"./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js"),c=[0,0,0];t.exports=function(t,e,n,h,l){o(c,h,e);var f=i(n,c);if(f<0)return null;s(c,e,n,f);var d=r(h,c),p=l*l;return d>p?null:(a(t,n,f-Math.sqrt(p-d)),u(t,t,e))}},"./node_modules/_ray-triangle-intersection@1.0.3@ray-triangle-intersection/index.js":
/*!******************************************************************************************!*\
    !*** ./node_modules/_ray-triangle-intersection@1.0.3@ray-triangle-intersection/index.js ***!
    \******************************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){var r=n(/*! gl-vec3/cross */"./node_modules/_gl-vec3@1.1.3@gl-vec3/cross.js"),i=n(/*! gl-vec3/dot */"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js"),o=n(/*! gl-vec3/subtract */"./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js"),s=[0,0,0],a=[0,0,0],u=[0,0,0],c=[0,0,0],h=[0,0,0];t.exports=function(t,e,n,l){o(s,l[1],l[0]),o(a,l[2],l[0]),r(c,n,a);var f=i(s,c);if(f<1e-6)return null;o(u,e,l[0]);var d=i(u,c);if(d<0||d>f)return null;r(h,u,s);var p=i(n,h);if(p<0||d+p>f)return null;var m=i(a,h)/f;return t[0]=e[0]+m*n[0],t[1]=e[1]+m*n[1],t[2]=e[2]+m*n[2],t}},"./node_modules/_setimmediate@1.0.5@setimmediate/setImmediate.js":
/*!***********************************************************************!*\
    !*** ./node_modules/_setimmediate@1.0.5@setimmediate/setImmediate.js ***!
    \***********************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){(function(t,e){!function(t,n){if(!t.setImmediate){var r,i,o,s,a,u=1,c={},h=!1,l=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){p(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(s="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&p(+e.data.slice(s.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(s+e,"*")}):t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){p(t.data)},r=function(t){o.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(i=l.documentElement,r=function(t){var e=l.createElement("script");e.onreadystatechange=function(){p(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(p,0,t)},f.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},f.clearImmediate=d}function d(t){delete c[t]}function p(t){if(h)setTimeout(p,0,t);else{var e=c[t];if(e){h=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(/*! ./../_webpack@4.44.1@webpack/buildin/global.js */"./node_modules/_webpack@4.44.1@webpack/buildin/global.js"),n(/*! ./../_process@0.11.10@process/browser.js */"./node_modules/_process@0.11.10@process/browser.js"))},"./node_modules/_timers-browserify@2.0.11@timers-browserify/main.js":
/*!**************************************************************************!*\
    !*** ./node_modules/_timers-browserify@2.0.11@timers-browserify/main.js ***!
    \**************************************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(/*! setimmediate */"./node_modules/_setimmediate@1.0.5@setimmediate/setImmediate.js"),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(/*! ./../_webpack@4.44.1@webpack/buildin/global.js */"./node_modules/_webpack@4.44.1@webpack/buildin/global.js"))},"./node_modules/_webpack@4.44.1@webpack/buildin/global.js":
/*!***********************************!*\
    !*** (webpack)/buildin/global.js ***!
    \***********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},"./src/Hilo3d.js":
/*!*************************************!*\
    !*** ./src/Hilo3d.js + 100 modules ***!
    \*************************************/
/*! exports provided: util, GLTFExtensions, Class, EventMixin, Fog, Mesh, Node, SkinedMesh, Skeleton, Stage, Tween, version, BoxGeometry, Geometry, GeometryData, MorphGeometry, PlaneGeometry, SphereGeometry, Camera, PerspectiveCamera, OrthographicCamera, Buffer, capabilities, extensions, Framebuffer, glType, logGLResource, Program, RenderInfo, RenderList, VertexArrayObject, WebGLRenderer, WebGLResourceManager, WebGLState, BasicLoader, CubeTextureLoader, GLTFLoader, GLTFParser, AliAMCExtension, HDRLoader, KTXLoader, LoadCache, LoadQueue, ShaderMaterialLoader, TextureLoader, Loader, Texture, LazyTexture, CubeTexture, DataTexture, Shader, BasicMaterial, GeometryMaterial, Material, PBRMaterial, semantic, ShaderMaterial, AxisHelper, AxisNetHelper, CameraHelper, AmbientLight, AreaLight, DirectionalLight, CubeLightShadow, Light, LightManager, LightShadow, PointLight, SpotLight, Animation, AnimationStates, MeshPicker, Ticker, log, Cache, browser, WebGLSupport, constants, Color, Euler, EulerNotifier, Frustum, math, Matrix3, Matrix4, Matrix4Notifier, Plane, Quaternion, Ray, Sphere, SphericalHarmonics3, Vector2, Vector3, Vector3Notifier, Vector4 */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_amc@1.0.6@amc/build/amd.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_ray-3d@1.1.1@ray-3d/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/basic.frag (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/basic.vert (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/geometry.frag (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/pbr.frag (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/screen.frag (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/screen.vert (<- Module is not an ECMAScript module) */function(t,e,n){n.r(e),n.d(e,"util",(function(){return s})),n.d(e,"GLTFExtensions",(function(){return a})),n.d(e,"Class",(function(){return Ks})),n.d(e,"EventMixin",(function(){return ta})),n.d(e,"Fog",(function(){return bl})),n.d(e,"Mesh",(function(){return Nl})),n.d(e,"Node",(function(){return xa})),n.d(e,"SkinedMesh",(function(){return Fl})),n.d(e,"Skeleton",(function(){return Bl})),n.d(e,"Stage",(function(){return lf})),n.d(e,"Tween",(function(){return Nf})),n.d(e,"version",(function(){return Gl})),n.d(e,"BoxGeometry",(function(){return Df})),n.d(e,"Geometry",(function(){return fu})),n.d(e,"GeometryData",(function(){return Qa})),n.d(e,"MorphGeometry",(function(){return ll})),n.d(e,"PlaneGeometry",(function(){return Gf})),n.d(e,"SphereGeometry",(function(){return jf})),n.d(e,"Camera",(function(){return Va})),n.d(e,"PerspectiveCamera",(function(){return pu})),n.d(e,"OrthographicCamera",(function(){return Lh})),n.d(e,"Buffer",(function(){return zu})),n.d(e,"capabilities",(function(){return vu})),n.d(e,"extensions",(function(){return gu})),n.d(e,"Framebuffer",(function(){return bc})),n.d(e,"glType",(function(){return Fu})),n.d(e,"logGLResource",(function(){return Xf})),n.d(e,"Program",(function(){return Gu})),n.d(e,"RenderInfo",(function(){return kl})),n.d(e,"RenderList",(function(){return Wl})),n.d(e,"VertexArrayObject",(function(){return tc})),n.d(e,"WebGLRenderer",(function(){return uf})),n.d(e,"WebGLResourceManager",(function(){return ql})),n.d(e,"WebGLState",(function(){return zl})),n.d(e,"BasicLoader",(function(){return Jf})),n.d(e,"CubeTextureLoader",(function(){return $f})),n.d(e,"GLTFLoader",(function(){return Pd})),n.d(e,"GLTFParser",(function(){return wd})),n.d(e,"AliAMCExtension",(function(){return ml})),n.d(e,"HDRLoader",(function(){return jd})),n.d(e,"KTXLoader",(function(){return Wd})),n.d(e,"LoadCache",(function(){return zf})),n.d(e,"LoadQueue",(function(){return zd})),n.d(e,"ShaderMaterialLoader",(function(){return Yd})),n.d(e,"TextureLoader",(function(){return Qd})),n.d(e,"Loader",(function(){return Zf})),n.d(e,"Texture",(function(){return pc})),n.d(e,"LazyTexture",(function(){return id})),n.d(e,"CubeTexture",(function(){return Nc})),n.d(e,"DataTexture",(function(){return Gc})),n.d(e,"Shader",(function(){return Cu})),n.d(e,"BasicMaterial",(function(){return vh})),n.d(e,"GeometryMaterial",(function(){return Oh})),n.d(e,"Material",(function(){return _h})),n.d(e,"PBRMaterial",(function(){return ed})),n.d(e,"semantic",(function(){return nh})),n.d(e,"ShaderMaterial",(function(){return al})),n.d(e,"AxisHelper",(function(){return tp})),n.d(e,"AxisNetHelper",(function(){return rp})),n.d(e,"CameraHelper",(function(){return ap})),n.d(e,"AmbientLight",(function(){return cp})),n.d(e,"AreaLight",(function(){return lp})),n.d(e,"DirectionalLight",(function(){return el})),n.d(e,"CubeLightShadow",(function(){return Jh})),n.d(e,"Light",(function(){return Ua})),n.d(e,"LightManager",(function(){return Zl})),n.d(e,"LightShadow",(function(){return Ph})),n.d(e,"PointLight",(function(){return Zh})),n.d(e,"SpotLight",(function(){return ol})),n.d(e,"Animation",(function(){return yd})),n.d(e,"AnimationStates",(function(){return gd})),n.d(e,"MeshPicker",(function(){return mp})),n.d(e,"Ticker",(function(){return _p})),n.d(e,"log",(function(){return h})),n.d(e,"Cache",(function(){return mu})),n.d(e,"browser",(function(){return cf})),n.d(e,"WebGLSupport",(function(){return gp})),n.d(e,"constants",(function(){return Ss})),n.d(e,"Color",(function(){return Da})),n.d(e,"Euler",(function(){return Ma})),n.d(e,"EulerNotifier",(function(){return Ia})),n.d(e,"Frustum",(function(){return Ga})),n.d(e,"math",(function(){return Ea})),n.d(e,"Matrix3",(function(){return oa})),n.d(e,"Matrix4",(function(){return ma})),n.d(e,"Matrix4Notifier",(function(){return va})),n.d(e,"Plane",(function(){return Ba})),n.d(e,"Quaternion",(function(){return ca})),n.d(e,"Ray",(function(){return Rl})),n.d(e,"Sphere",(function(){return qa})),n.d(e,"SphericalHarmonics3",(function(){return Ep})),n.d(e,"Vector2",(function(){return Wa})),n.d(e,"Vector3",(function(){return ra})),n.d(e,"Vector3Notifier",(function(){return ya})),n.d(e,"Vector4",(function(){return Na}));var r={};n.r(r),n.d(r,"ACTIVE_ATTRIBUTES",(function(){return l})),n.d(r,"ACTIVE_ATTRIBUTE_MAX_LENGTH",(function(){return f})),n.d(r,"ACTIVE_TEXTURE",(function(){return d})),n.d(r,"ACTIVE_UNIFORMS",(function(){return p})),n.d(r,"ACTIVE_UNIFORM_MAX_LENGTH",(function(){return m})),n.d(r,"ALIASED_LINE_WIDTH_RANGE",(function(){return _})),n.d(r,"ALIASED_POINT_SIZE_RANGE",(function(){return g})),n.d(r,"ALPHA",(function(){return v})),n.d(r,"ALPHA_BITS",(function(){return y})),n.d(r,"ALWAYS",(function(){return E})),n.d(r,"ARRAY_BUFFER",(function(){return T})),n.d(r,"ARRAY_BUFFER_BINDING",(function(){return A})),n.d(r,"ATTACHED_SHADERS",(function(){return S})),n.d(r,"BACK",(function(){return M})),n.d(r,"BLEND",(function(){return O})),n.d(r,"BLEND_COLOR",(function(){return b})),n.d(r,"BLEND_DST_ALPHA",(function(){return L})),n.d(r,"BLEND_DST_RGB",(function(){return I})),n.d(r,"BLEND_EQUATION",(function(){return R})),n.d(r,"BLEND_EQUATION_ALPHA",(function(){return C})),n.d(r,"BLEND_EQUATION_RGB",(function(){return x})),n.d(r,"BLEND_SRC_ALPHA",(function(){return w})),n.d(r,"BLEND_SRC_RGB",(function(){return N})),n.d(r,"BLUE_BITS",(function(){return P})),n.d(r,"BOOL",(function(){return D})),n.d(r,"BOOL_VEC2",(function(){return H})),n.d(r,"BOOL_VEC3",(function(){return F})),n.d(r,"BOOL_VEC4",(function(){return U})),n.d(r,"BROWSER_DEFAULT_WEBGL",(function(){return B})),n.d(r,"BUFFER_SIZE",(function(){return G})),n.d(r,"BUFFER_USAGE",(function(){return k})),n.d(r,"BYTE",(function(){return j})),n.d(r,"CCW",(function(){return V})),n.d(r,"CLAMP_TO_EDGE",(function(){return X})),n.d(r,"COLOR_ATTACHMENT0",(function(){return W})),n.d(r,"COLOR_BUFFER_BIT",(function(){return z})),n.d(r,"COLOR_CLEAR_VALUE",(function(){return q})),n.d(r,"COLOR_WRITEMASK",(function(){return Y})),n.d(r,"COMPILE_STATUS",(function(){return J})),n.d(r,"COMPRESSED_TEXTURE_FORMATS",(function(){return Q})),n.d(r,"CONSTANT_ALPHA",(function(){return Z})),n.d(r,"CONSTANT_COLOR",(function(){return K})),n.d(r,"CONTEXT_LOST_WEBGL",(function(){return $})),n.d(r,"CULL_FACE",(function(){return tt})),n.d(r,"CULL_FACE_MODE",(function(){return et})),n.d(r,"CURRENT_PROGRAM",(function(){return nt})),n.d(r,"CURRENT_VERTEX_ATTRIB",(function(){return rt})),n.d(r,"CW",(function(){return it})),n.d(r,"DECR",(function(){return ot})),n.d(r,"DECR_WRAP",(function(){return st})),n.d(r,"DELETE_STATUS",(function(){return at})),n.d(r,"DEPTH_ATTACHMENT",(function(){return ut})),n.d(r,"DEPTH_BITS",(function(){return ct})),n.d(r,"DEPTH_BUFFER_BIT",(function(){return ht})),n.d(r,"DEPTH_CLEAR_VALUE",(function(){return lt})),n.d(r,"DEPTH_COMPONENT",(function(){return ft})),n.d(r,"DEPTH_COMPONENT16",(function(){return dt})),n.d(r,"DEPTH_FUNC",(function(){return pt})),n.d(r,"DEPTH_RANGE",(function(){return mt})),n.d(r,"DEPTH_STENCIL",(function(){return _t})),n.d(r,"DEPTH_STENCIL_ATTACHMENT",(function(){return gt})),n.d(r,"DEPTH_TEST",(function(){return vt})),n.d(r,"DEPTH_WRITEMASK",(function(){return yt})),n.d(r,"DITHER",(function(){return Et})),n.d(r,"DONT_CARE",(function(){return Tt})),n.d(r,"DST_ALPHA",(function(){return At})),n.d(r,"DST_COLOR",(function(){return St})),n.d(r,"DYNAMIC_DRAW",(function(){return Mt})),n.d(r,"ELEMENT_ARRAY_BUFFER",(function(){return Ot})),n.d(r,"ELEMENT_ARRAY_BUFFER_BINDING",(function(){return bt})),n.d(r,"EQUAL",(function(){return Lt})),n.d(r,"FASTEST",(function(){return It})),n.d(r,"FLOAT",(function(){return Rt})),n.d(r,"FLOAT_MAT2",(function(){return Ct})),n.d(r,"FLOAT_MAT3",(function(){return xt})),n.d(r,"FLOAT_MAT4",(function(){return wt})),n.d(r,"FLOAT_VEC2",(function(){return Nt})),n.d(r,"FLOAT_VEC3",(function(){return Pt})),n.d(r,"FLOAT_VEC4",(function(){return Dt})),n.d(r,"FRAGMENT_SHADER",(function(){return Ht})),n.d(r,"FRAMEBUFFER",(function(){return Ft})),n.d(r,"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",(function(){return Ut})),n.d(r,"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",(function(){return Bt})),n.d(r,"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",(function(){return Gt})),n.d(r,"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",(function(){return kt})),n.d(r,"FRAMEBUFFER_BINDING",(function(){return jt})),n.d(r,"FRAMEBUFFER_COMPLETE",(function(){return Vt})),n.d(r,"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",(function(){return Xt})),n.d(r,"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",(function(){return Wt})),n.d(r,"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",(function(){return zt})),n.d(r,"FRAMEBUFFER_UNSUPPORTED",(function(){return qt})),n.d(r,"FRONT",(function(){return Yt})),n.d(r,"FRONT_AND_BACK",(function(){return Jt})),n.d(r,"FRONT_FACE",(function(){return Qt})),n.d(r,"FUNC_ADD",(function(){return Zt})),n.d(r,"FUNC_REVERSE_SUBTRACT",(function(){return Kt})),n.d(r,"FUNC_SUBTRACT",(function(){return $t})),n.d(r,"GENERATE_MIPMAP_HINT",(function(){return te})),n.d(r,"GEQUAL",(function(){return ee})),n.d(r,"GREATER",(function(){return ne})),n.d(r,"GREEN_BITS",(function(){return re})),n.d(r,"HIGH_FLOAT",(function(){return ie})),n.d(r,"HIGH_INT",(function(){return oe})),n.d(r,"INCR",(function(){return se})),n.d(r,"INCR_WRAP",(function(){return ae})),n.d(r,"INFO_LOG_LENGTH",(function(){return ue})),n.d(r,"INT",(function(){return ce})),n.d(r,"INT_VEC2",(function(){return he})),n.d(r,"INT_VEC3",(function(){return le})),n.d(r,"INT_VEC4",(function(){return fe})),n.d(r,"INVALID_ENUM",(function(){return de})),n.d(r,"INVALID_FRAMEBUFFER_OPERATION",(function(){return pe})),n.d(r,"INVALID_OPERATION",(function(){return me})),n.d(r,"INVALID_VALUE",(function(){return _e})),n.d(r,"INVERT",(function(){return ge})),n.d(r,"KEEP",(function(){return ve})),n.d(r,"LEQUAL",(function(){return ye})),n.d(r,"LESS",(function(){return Ee})),n.d(r,"LINEAR",(function(){return Te})),n.d(r,"LINEAR_MIPMAP_LINEAR",(function(){return Ae})),n.d(r,"LINEAR_MIPMAP_NEAREST",(function(){return Se})),n.d(r,"LINES",(function(){return Me})),n.d(r,"LINE_LOOP",(function(){return Oe})),n.d(r,"LINE_STRIP",(function(){return be})),n.d(r,"LINE_WIDTH",(function(){return Le})),n.d(r,"LINK_STATUS",(function(){return Ie})),n.d(r,"LOW_FLOAT",(function(){return Re})),n.d(r,"LOW_INT",(function(){return Ce})),n.d(r,"LUMINANCE",(function(){return xe})),n.d(r,"LUMINANCE_ALPHA",(function(){return we})),n.d(r,"MAX_COMBINED_TEXTURE_IMAGE_UNITS",(function(){return Ne})),n.d(r,"MAX_CUBE_MAP_TEXTURE_SIZE",(function(){return Pe})),n.d(r,"MAX_FRAGMENT_UNIFORM_VECTORS",(function(){return De})),n.d(r,"MAX_RENDERBUFFER_SIZE",(function(){return He})),n.d(r,"MAX_TEXTURE_IMAGE_UNITS",(function(){return Fe})),n.d(r,"MAX_TEXTURE_SIZE",(function(){return Ue})),n.d(r,"MAX_VARYING_VECTORS",(function(){return Be})),n.d(r,"MAX_VERTEX_ATTRIBS",(function(){return Ge})),n.d(r,"MAX_VERTEX_TEXTURE_IMAGE_UNITS",(function(){return ke})),n.d(r,"MAX_VERTEX_UNIFORM_VECTORS",(function(){return je})),n.d(r,"MAX_VIEWPORT_DIMS",(function(){return Ve})),n.d(r,"MEDIUM_FLOAT",(function(){return Xe})),n.d(r,"MEDIUM_INT",(function(){return We})),n.d(r,"MIRRORED_REPEAT",(function(){return ze})),n.d(r,"NEAREST",(function(){return qe})),n.d(r,"NEAREST_MIPMAP_LINEAR",(function(){return Ye})),n.d(r,"NEAREST_MIPMAP_NEAREST",(function(){return Je})),n.d(r,"NEVER",(function(){return Qe})),n.d(r,"NICEST",(function(){return Ze})),n.d(r,"NONE",(function(){return Ke})),n.d(r,"NOTEQUAL",(function(){return $e})),n.d(r,"NO_ERROR",(function(){return tn})),n.d(r,"NUM_COMPRESSED_TEXTURE_FORMATS",(function(){return en})),n.d(r,"ONE",(function(){return nn})),n.d(r,"ONE_MINUS_CONSTANT_ALPHA",(function(){return rn})),n.d(r,"ONE_MINUS_CONSTANT_COLOR",(function(){return on})),n.d(r,"ONE_MINUS_DST_ALPHA",(function(){return sn})),n.d(r,"ONE_MINUS_DST_COLOR",(function(){return an})),n.d(r,"ONE_MINUS_SRC_ALPHA",(function(){return un})),n.d(r,"ONE_MINUS_SRC_COLOR",(function(){return cn})),n.d(r,"OUT_OF_MEMORY",(function(){return hn})),n.d(r,"PACK_ALIGNMENT",(function(){return ln})),n.d(r,"POINTS",(function(){return fn})),n.d(r,"POLYGON_OFFSET_FACTOR",(function(){return dn})),n.d(r,"POLYGON_OFFSET_FILL",(function(){return pn})),n.d(r,"POLYGON_OFFSET_UNITS",(function(){return mn})),n.d(r,"RED_BITS",(function(){return _n})),n.d(r,"RENDERBUFFER",(function(){return gn})),n.d(r,"RENDERBUFFER_ALPHA_SIZE",(function(){return vn})),n.d(r,"RENDERBUFFER_BINDING",(function(){return yn})),n.d(r,"RENDERBUFFER_BLUE_SIZE",(function(){return En})),n.d(r,"RENDERBUFFER_DEPTH_SIZE",(function(){return Tn})),n.d(r,"RENDERBUFFER_GREEN_SIZE",(function(){return An})),n.d(r,"RENDERBUFFER_HEIGHT",(function(){return Sn})),n.d(r,"RENDERBUFFER_INTERNAL_FORMAT",(function(){return Mn})),n.d(r,"RENDERBUFFER_RED_SIZE",(function(){return On})),n.d(r,"RENDERBUFFER_STENCIL_SIZE",(function(){return bn})),n.d(r,"RENDERBUFFER_WIDTH",(function(){return Ln})),n.d(r,"RENDERER",(function(){return In})),n.d(r,"REPEAT",(function(){return Rn})),n.d(r,"REPLACE",(function(){return Cn})),n.d(r,"RGB",(function(){return xn})),n.d(r,"RGB5_A1",(function(){return wn})),n.d(r,"RGB565",(function(){return Nn})),n.d(r,"RGBA",(function(){return Pn})),n.d(r,"RGBA4",(function(){return Dn})),n.d(r,"SAMPLER_2D",(function(){return Hn})),n.d(r,"SAMPLER_CUBE",(function(){return Fn})),n.d(r,"SAMPLES",(function(){return Un})),n.d(r,"SAMPLE_ALPHA_TO_COVERAGE",(function(){return Bn})),n.d(r,"SAMPLE_BUFFERS",(function(){return Gn})),n.d(r,"SAMPLE_COVERAGE",(function(){return kn})),n.d(r,"SAMPLE_COVERAGE_INVERT",(function(){return jn})),n.d(r,"SAMPLE_COVERAGE_VALUE",(function(){return Vn})),n.d(r,"SCISSOR_BOX",(function(){return Xn})),n.d(r,"SCISSOR_TEST",(function(){return Wn})),n.d(r,"SHADER_COMPILER",(function(){return zn})),n.d(r,"SHADER_SOURCE_LENGTH",(function(){return qn})),n.d(r,"SHADER_TYPE",(function(){return Yn})),n.d(r,"SHADING_LANGUAGE_VERSION",(function(){return Jn})),n.d(r,"SHORT",(function(){return Qn})),n.d(r,"SRC_ALPHA",(function(){return Zn})),n.d(r,"SRC_ALPHA_SATURATE",(function(){return Kn})),n.d(r,"SRC_COLOR",(function(){return $n})),n.d(r,"STATIC_DRAW",(function(){return tr})),n.d(r,"STENCIL_ATTACHMENT",(function(){return er})),n.d(r,"STENCIL_BACK_FAIL",(function(){return nr})),n.d(r,"STENCIL_BACK_FUNC",(function(){return rr})),n.d(r,"STENCIL_BACK_PASS_DEPTH_FAIL",(function(){return ir})),n.d(r,"STENCIL_BACK_PASS_DEPTH_PASS",(function(){return or})),n.d(r,"STENCIL_BACK_REF",(function(){return sr})),n.d(r,"STENCIL_BACK_VALUE_MASK",(function(){return ar})),n.d(r,"STENCIL_BACK_WRITEMASK",(function(){return ur})),n.d(r,"STENCIL_BITS",(function(){return cr})),n.d(r,"STENCIL_BUFFER_BIT",(function(){return hr})),n.d(r,"STENCIL_CLEAR_VALUE",(function(){return lr})),n.d(r,"STENCIL_FAIL",(function(){return fr})),n.d(r,"STENCIL_FUNC",(function(){return dr})),n.d(r,"STENCIL_INDEX",(function(){return pr})),n.d(r,"STENCIL_INDEX8",(function(){return mr})),n.d(r,"STENCIL_PASS_DEPTH_FAIL",(function(){return _r})),n.d(r,"STENCIL_PASS_DEPTH_PASS",(function(){return gr})),n.d(r,"STENCIL_REF",(function(){return vr})),n.d(r,"STENCIL_TEST",(function(){return yr})),n.d(r,"STENCIL_VALUE_MASK",(function(){return Er})),n.d(r,"STENCIL_WRITEMASK",(function(){return Tr})),n.d(r,"STREAM_DRAW",(function(){return Ar})),n.d(r,"SUBPIXEL_BITS",(function(){return Sr})),n.d(r,"TEXTURE",(function(){return Mr})),n.d(r,"TEXTURE0",(function(){return Or})),n.d(r,"TEXTURE1",(function(){return br})),n.d(r,"TEXTURE2",(function(){return Lr})),n.d(r,"TEXTURE3",(function(){return Ir})),n.d(r,"TEXTURE4",(function(){return Rr})),n.d(r,"TEXTURE5",(function(){return Cr})),n.d(r,"TEXTURE6",(function(){return xr})),n.d(r,"TEXTURE7",(function(){return wr})),n.d(r,"TEXTURE8",(function(){return Nr})),n.d(r,"TEXTURE9",(function(){return Pr})),n.d(r,"TEXTURE10",(function(){return Dr})),n.d(r,"TEXTURE11",(function(){return Hr})),n.d(r,"TEXTURE12",(function(){return Fr})),n.d(r,"TEXTURE13",(function(){return Ur})),n.d(r,"TEXTURE14",(function(){return Br})),n.d(r,"TEXTURE15",(function(){return Gr})),n.d(r,"TEXTURE16",(function(){return kr})),n.d(r,"TEXTURE17",(function(){return jr})),n.d(r,"TEXTURE18",(function(){return Vr})),n.d(r,"TEXTURE19",(function(){return Xr})),n.d(r,"TEXTURE20",(function(){return Wr})),n.d(r,"TEXTURE21",(function(){return zr})),n.d(r,"TEXTURE22",(function(){return qr})),n.d(r,"TEXTURE23",(function(){return Yr})),n.d(r,"TEXTURE24",(function(){return Jr})),n.d(r,"TEXTURE25",(function(){return Qr})),n.d(r,"TEXTURE26",(function(){return Zr})),n.d(r,"TEXTURE27",(function(){return Kr})),n.d(r,"TEXTURE28",(function(){return $r})),n.d(r,"TEXTURE29",(function(){return ti})),n.d(r,"TEXTURE30",(function(){return ei})),n.d(r,"TEXTURE31",(function(){return ni})),n.d(r,"TEXTURE_2D",(function(){return ri})),n.d(r,"TEXTURE_BINDING_2D",(function(){return ii})),n.d(r,"TEXTURE_BINDING_CUBE_MAP",(function(){return oi})),n.d(r,"TEXTURE_CUBE_MAP",(function(){return si})),n.d(r,"TEXTURE_CUBE_MAP_NEGATIVE_X",(function(){return ai})),n.d(r,"TEXTURE_CUBE_MAP_NEGATIVE_Y",(function(){return ui})),n.d(r,"TEXTURE_CUBE_MAP_NEGATIVE_Z",(function(){return ci})),n.d(r,"TEXTURE_CUBE_MAP_POSITIVE_X",(function(){return hi})),n.d(r,"TEXTURE_CUBE_MAP_POSITIVE_Y",(function(){return li})),n.d(r,"TEXTURE_CUBE_MAP_POSITIVE_Z",(function(){return fi})),n.d(r,"TEXTURE_MAG_FILTER",(function(){return di})),n.d(r,"TEXTURE_MIN_FILTER",(function(){return pi})),n.d(r,"TEXTURE_WRAP_S",(function(){return mi})),n.d(r,"TEXTURE_WRAP_T",(function(){return _i})),n.d(r,"TRIANGLES",(function(){return gi})),n.d(r,"TRIANGLE_FAN",(function(){return vi})),n.d(r,"TRIANGLE_STRIP",(function(){return yi})),n.d(r,"UNPACK_ALIGNMENT",(function(){return Ei})),n.d(r,"UNPACK_COLORSPACE_CONVERSION_WEBGL",(function(){return Ti})),n.d(r,"UNPACK_FLIP_Y_WEBGL",(function(){return Ai})),n.d(r,"UNPACK_PREMULTIPLY_ALPHA_WEBGL",(function(){return Si})),n.d(r,"UNSIGNED_BYTE",(function(){return Mi})),n.d(r,"UNSIGNED_INT",(function(){return Oi})),n.d(r,"UNSIGNED_SHORT",(function(){return bi})),n.d(r,"UNSIGNED_SHORT_4_4_4_4",(function(){return Li})),n.d(r,"UNSIGNED_SHORT_5_5_5_1",(function(){return Ii})),n.d(r,"UNSIGNED_SHORT_5_6_5",(function(){return Ri})),n.d(r,"VALIDATE_STATUS",(function(){return Ci})),n.d(r,"VENDOR",(function(){return xi})),n.d(r,"VERSION",(function(){return wi})),n.d(r,"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",(function(){return Ni})),n.d(r,"VERTEX_ATTRIB_ARRAY_ENABLED",(function(){return Pi})),n.d(r,"VERTEX_ATTRIB_ARRAY_NORMALIZED",(function(){return Di})),n.d(r,"VERTEX_ATTRIB_ARRAY_POINTER",(function(){return Hi})),n.d(r,"VERTEX_ATTRIB_ARRAY_SIZE",(function(){return Fi})),n.d(r,"VERTEX_ATTRIB_ARRAY_STRIDE",(function(){return Ui})),n.d(r,"VERTEX_ATTRIB_ARRAY_TYPE",(function(){return Bi})),n.d(r,"VERTEX_SHADER",(function(){return Gi})),n.d(r,"VIEWPORT",(function(){return ki})),n.d(r,"ZERO",(function(){return ji}));var i={};n.r(i),n.d(i,"VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",(function(){return Vi})),n.d(i,"UNMASKED_VENDOR_WEBGL",(function(){return Xi})),n.d(i,"UNMASKED_RENDERER_WEBGL",(function(){return Wi})),n.d(i,"MAX_TEXTURE_MAX_ANISOTROPY_EXT",(function(){return zi})),n.d(i,"TEXTURE_MAX_ANISOTROPY_EXT",(function(){return qi})),n.d(i,"COMPRESSED_RGB_S3TC_DXT1_EXT",(function(){return Yi})),n.d(i,"COMPRESSED_RGBA_S3TC_DXT1_EXT",(function(){return Ji})),n.d(i,"COMPRESSED_RGBA_S3TC_DXT3_EXT",(function(){return Qi})),n.d(i,"COMPRESSED_RGBA_S3TC_DXT5_EXT",(function(){return Zi})),n.d(i,"COMPRESSED_R11_EAC",(function(){return Ki})),n.d(i,"COMPRESSED_SIGNED_R11_EAC",(function(){return $i})),n.d(i,"COMPRESSED_RG11_EAC",(function(){return to})),n.d(i,"COMPRESSED_SIGNED_RG11_EAC",(function(){return eo})),n.d(i,"COMPRESSED_RGB8_ETC2",(function(){return no})),n.d(i,"COMPRESSED_RGBA8_ETC2_EAC",(function(){return ro})),n.d(i,"COMPRESSED_SRGB8_ETC2",(function(){return io})),n.d(i,"COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",(function(){return oo})),n.d(i,"COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",(function(){return so})),n.d(i,"COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",(function(){return ao})),n.d(i,"COMPRESSED_RGB_PVRTC_4BPPV1_IMG",(function(){return uo})),n.d(i,"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",(function(){return co})),n.d(i,"COMPRESSED_RGB_PVRTC_2BPPV1_IMG",(function(){return ho})),n.d(i,"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",(function(){return lo})),n.d(i,"COMPRESSED_RGB_ETC1_WEBGL",(function(){return fo})),n.d(i,"COMPRESSED_RGB_ATC_WEBGL",(function(){return po})),n.d(i,"COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",(function(){return mo})),n.d(i,"COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",(function(){return _o})),n.d(i,"UNSIGNED_INT_24_8_WEBGL",(function(){return go})),n.d(i,"HALF_FLOAT_OES",(function(){return vo})),n.d(i,"RGBA32F_EXT",(function(){return yo})),n.d(i,"RGB32F_EXT",(function(){return Eo})),n.d(i,"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",(function(){return To})),n.d(i,"UNSIGNED_NORMALIZED_EXT",(function(){return Ao})),n.d(i,"MIN_EXT",(function(){return So})),n.d(i,"MAX_EXT",(function(){return Mo})),n.d(i,"SRGB_EXT",(function(){return Oo})),n.d(i,"SRGB_ALPHA_EXT",(function(){return bo})),n.d(i,"SRGB8_ALPHA8_EXT",(function(){return Lo})),n.d(i,"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",(function(){return Io})),n.d(i,"FRAGMENT_SHADER_DERIVATIVE_HINT_OES",(function(){return Ro})),n.d(i,"COLOR_ATTACHMENT0_WEBGL",(function(){return Co})),n.d(i,"COLOR_ATTACHMENT1_WEBGL",(function(){return xo})),n.d(i,"COLOR_ATTACHMENT2_WEBGL",(function(){return wo})),n.d(i,"COLOR_ATTACHMENT3_WEBGL",(function(){return No})),n.d(i,"COLOR_ATTACHMENT4_WEBGL",(function(){return Po})),n.d(i,"COLOR_ATTACHMENT5_WEBGL",(function(){return Do})),n.d(i,"COLOR_ATTACHMENT6_WEBGL",(function(){return Ho})),n.d(i,"COLOR_ATTACHMENT7_WEBGL",(function(){return Fo})),n.d(i,"COLOR_ATTACHMENT8_WEBGL",(function(){return Uo})),n.d(i,"COLOR_ATTACHMENT9_WEBGL",(function(){return Bo})),n.d(i,"COLOR_ATTACHMENT10_WEBGL",(function(){return Go})),n.d(i,"COLOR_ATTACHMENT11_WEBGL",(function(){return ko})),n.d(i,"COLOR_ATTACHMENT12_WEBGL",(function(){return jo})),n.d(i,"COLOR_ATTACHMENT13_WEBGL",(function(){return Vo})),n.d(i,"COLOR_ATTACHMENT14_WEBGL",(function(){return Xo})),n.d(i,"COLOR_ATTACHMENT15_WEBGL",(function(){return Wo})),n.d(i,"DRAW_BUFFER0_WEBGL",(function(){return zo})),n.d(i,"DRAW_BUFFER1_WEBGL",(function(){return qo})),n.d(i,"DRAW_BUFFER2_WEBGL",(function(){return Yo})),n.d(i,"DRAW_BUFFER3_WEBGL",(function(){return Jo})),n.d(i,"DRAW_BUFFER4_WEBGL",(function(){return Qo})),n.d(i,"DRAW_BUFFER5_WEBGL",(function(){return Zo})),n.d(i,"DRAW_BUFFER6_WEBGL",(function(){return Ko})),n.d(i,"DRAW_BUFFER7_WEBGL",(function(){return $o})),n.d(i,"DRAW_BUFFER8_WEBGL",(function(){return ts})),n.d(i,"DRAW_BUFFER9_WEBGL",(function(){return es})),n.d(i,"DRAW_BUFFER10_WEBGL",(function(){return ns})),n.d(i,"DRAW_BUFFER11_WEBGL",(function(){return rs})),n.d(i,"DRAW_BUFFER12_WEBGL",(function(){return is})),n.d(i,"DRAW_BUFFER13_WEBGL",(function(){return os})),n.d(i,"DRAW_BUFFER14_WEBGL",(function(){return ss})),n.d(i,"DRAW_BUFFER15_WEBGL",(function(){return as})),n.d(i,"MAX_COLOR_ATTACHMENTS_WEBGL",(function(){return us})),n.d(i,"MAX_DRAW_BUFFERS_WEBGL",(function(){return cs})),n.d(i,"VERTEX_ARRAY_BINDING_OES",(function(){return hs})),n.d(i,"QUERY_COUNTER_BITS_EXT",(function(){return ls})),n.d(i,"CURRENT_QUERY_EXT",(function(){return fs})),n.d(i,"QUERY_RESULT_EXT",(function(){return ds})),n.d(i,"QUERY_RESULT_AVAILABLE_EXT",(function(){return ps})),n.d(i,"TIME_ELAPSED_EXT",(function(){return ms})),n.d(i,"TIMESTAMP_EXT",(function(){return _s})),n.d(i,"GPU_DISJOINT_EXT",(function(){return gs}));var o={};n.r(o),n.d(o,"POSITION",(function(){return vs})),n.d(o,"NORMAL",(function(){return ys})),n.d(o,"DEPTH",(function(){return Es})),n.d(o,"DISTANCE",(function(){return Ts}));var s={};n.r(s),n.d(s,"each",(function(){return Ds})),n.d(s,"getRelativePath",(function(){return ws})),n.d(s,"convertUint8ArrayToString",(function(){return Ns})),n.d(s,"getExtension",(function(){return Ps})),n.d(s,"getIndexFromSortedArray",(function(){return Hs})),n.d(s,"insertToSortedArray",(function(){return Fs})),n.d(s,"padLeft",(function(){return Us})),n.d(s,"getTypedArrayClass",(function(){return js})),n.d(s,"copyArrayData",(function(){return Vs})),n.d(s,"isStrOrNumber",(function(){return Xs})),n.d(s,"getTypedArrayGLType",(function(){return Bs})),n.d(s,"getBlobUrl",(function(){return qs})),n.d(s,"isBlobUrl",(function(){return Ws})),n.d(s,"revokeBlobUrl",(function(){return zs})),n.d(s,"isArrayLike",(function(){return Ys})),n.d(s,"getElementRect",(function(){return Js})),n.d(s,"serialRun",(function(){return Qs})),n.d(s,"hasOwnProperty",(function(){return Zs}));var a={};n.r(a),n.d(a,"ALI_amc_mesh_compression",(function(){return ml})),n.d(a,"WEB3D_quantized_attributes",(function(){return gl})),n.d(a,"HILO_animation_clips",(function(){return vl})),n.d(a,"ALI_animation_clips",(function(){return yl})),n.d(a,"ALI_bounding_box",(function(){return El})),n.d(a,"KHR_materials_pbrSpecularGlossiness",(function(){return Tl})),n.d(a,"KHR_materials_clearcoat",(function(){return Al})),n.d(a,"KHR_lights_punctual",(function(){return Sl})),n.d(a,"KHR_techniques_webgl",(function(){return Ml}));var u={},c={_cache:u,level:7,LEVEL_NONE:0,LEVEL_LOG:1,LEVEL_WARN:2,LEVEL_ERROR:4,log:function(){var t=this.console;return 1&this.level&&t.log.apply(t,arguments),this},warn:function(){var t=this.console;return 2&this.level&&t.warn.apply(t,arguments),this},error:function(){var t=this.console;return 4&this.level&&t.error.apply(t,arguments),this},logOnce:function(t){return u["log_"+t]||(u["log_"+t]=!0,this.log.apply(this,Array.prototype.slice.call(arguments,1))),this},warnOnce:function(t){return u["warn_"+t]||(u["warn_"+t]=!0,this.warn.apply(this,Array.prototype.slice.call(arguments,1))),this},errorOnce:function(t){return u["error_"+t]||(u["error_"+t]=!0,this.error.apply(this,Array.prototype.slice.call(arguments,1))),this},_console:console,get console(){return this._console},set console(t){this._console=t}},h=c,l=35721,f=35722,d=34016,p=35718,m=35719,_=33902,g=33901,v=6406,y=3413,E=519,T=34962,A=34964,S=35717,M=1029,O=3042,b=32773,L=32970,I=32968,R=32777,C=34877,x=32777,w=32971,N=32969,P=3412,D=35670,H=35671,F=35672,U=35673,B=37444,G=34660,k=34661,j=5120,V=2305,X=33071,W=36064,z=16384,q=3106,Y=3107,J=35713,Q=34467,Z=32771,K=32769,$=37442,tt=2884,et=2885,nt=35725,rt=34342,it=2304,ot=7683,st=34056,at=35712,ut=36096,ct=3414,ht=256,lt=2931,ft=6402,dt=33189,pt=2932,mt=2928,_t=34041,gt=33306,vt=2929,yt=2930,Et=3024,Tt=4352,At=772,St=774,Mt=35048,Ot=34963,bt=34965,Lt=514,It=4353,Rt=5126,Ct=35674,xt=35675,wt=35676,Nt=35664,Pt=35665,Dt=35666,Ht=35632,Ft=36160,Ut=36049,Bt=36048,Gt=36051,kt=36050,jt=36006,Vt=36053,Xt=36054,Wt=36057,zt=36055,qt=36061,Yt=1028,Jt=1032,Qt=2886,Zt=32774,Kt=32779,$t=32778,te=33170,ee=518,ne=516,re=3411,ie=36338,oe=36341,se=7682,ae=34055,ue=35716,ce=5124,he=35667,le=35668,fe=35669,de=1280,pe=1286,me=1282,_e=1281,ge=5386,ve=7680,ye=515,Ee=513,Te=9729,Ae=9987,Se=9985,Me=1,Oe=2,be=3,Le=2849,Ie=35714,Re=36336,Ce=36339,xe=6409,we=6410,Ne=35661,Pe=34076,De=36349,He=34024,Fe=34930,Ue=3379,Be=36348,Ge=34921,ke=35660,je=36347,Ve=3386,Xe=36337,We=36340,ze=33648,qe=9728,Ye=9986,Je=9984,Qe=512,Ze=4354,Ke=0,$e=517,tn=0,en=34466,nn=1,rn=32772,on=32770,sn=773,an=775,un=771,cn=769,hn=1285,ln=3333,fn=0,dn=32824,pn=32823,mn=10752,_n=3410,gn=36161,vn=36179,yn=36007,En=36178,Tn=36180,An=36177,Sn=36163,Mn=36164,On=36176,bn=36181,Ln=36162,In=7937,Rn=10497,Cn=7681,xn=6407,wn=32855,Nn=36194,Pn=6408,Dn=32854,Hn=35678,Fn=35680,Un=32937,Bn=32926,Gn=32936,kn=32928,jn=32939,Vn=32938,Xn=3088,Wn=3089,zn=36346,qn=35720,Yn=35663,Jn=35724,Qn=5122,Zn=770,Kn=776,$n=768,tr=35044,er=36128,nr=34817,rr=34816,ir=34818,or=34819,sr=36003,ar=36004,ur=36005,cr=3415,hr=1024,lr=2961,fr=2964,dr=2962,pr=6401,mr=36168,_r=2965,gr=2966,vr=2967,yr=2960,Er=2963,Tr=2968,Ar=35040,Sr=3408,Mr=5890,Or=33984,br=33985,Lr=33986,Ir=33987,Rr=33988,Cr=33989,xr=33990,wr=33991,Nr=33992,Pr=33993,Dr=33994,Hr=33995,Fr=33996,Ur=33997,Br=33998,Gr=33999,kr=34e3,jr=34001,Vr=34002,Xr=34003,Wr=34004,zr=34005,qr=34006,Yr=34007,Jr=34008,Qr=34009,Zr=34010,Kr=34011,$r=34012,ti=34013,ei=34014,ni=34015,ri=3553,ii=32873,oi=34068,si=34067,ai=34070,ui=34072,ci=34074,hi=34069,li=34071,fi=34073,di=10240,pi=10241,mi=10242,_i=10243,gi=4,vi=6,yi=5,Ei=3317,Ti=37443,Ai=37440,Si=37441,Mi=5121,Oi=5125,bi=5123,Li=32819,Ii=32820,Ri=33635,Ci=35715,xi=7936,wi=7938,Ni=34975,Pi=34338,Di=34922,Hi=34373,Fi=34339,Ui=34340,Bi=34341,Gi=35633,ki=2978,ji=0,Vi=35070,Xi=37445,Wi=37446,zi=34047,qi=34046,Yi=33776,Ji=33777,Qi=33778,Zi=33779,Ki=37488,$i=37489,to=37490,eo=37491,no=37492,ro=37493,io=37494,oo=37495,so=37496,ao=37497,uo=35840,co=35842,ho=35841,lo=35843,fo=36196,po=35986,mo=35986,_o=34798,go=34042,vo=36193,yo=34836,Eo=34837,To=33297,Ao=35863,So=32775,Mo=32776,Oo=35904,bo=35906,Lo=35907,Io=33296,Ro=35723,Co=36064,xo=36065,wo=36066,No=36067,Po=36068,Do=36069,Ho=36070,Fo=36071,Uo=36072,Bo=36073,Go=36074,ko=36075,jo=36076,Vo=36077,Xo=36078,Wo=36079,zo=34853,qo=34854,Yo=34855,Jo=34856,Qo=34857,Zo=34858,Ko=34859,$o=34860,ts=34861,es=34862,ns=34863,rs=34864,is=34865,os=34866,ss=34867,as=34868,us=36063,cs=34852,hs=34229,ls=34916,fs=34917,ds=34918,ps=34919,ms=35007,_s=36392,gs=36795,vs="POSITION",ys="NORMAL",Es="DEPTH",Ts="DISTANCE",As={webgl:r,webglExtensions:i,Hilo:o};Object.assign(As,r,i,o);var Ss=As;function Ms(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Os,bs=Ss.BYTE,Ls=Ss.UNSIGNED_BYTE,Is=Ss.SHORT,Rs=Ss.UNSIGNED_SHORT,Cs=Ss.UNSIGNED_INT,xs=Ss.FLOAT;function ws(t,e){if(/^(?:http|blob|data:|\/)/.test(e))return e;var n;for(t=t.replace(/\/[^/]*?$/,"").split("/"),e=e.split("/"),n=0;n<e.length;n++){var r=e[n];if(".."===r)t.pop();else if("."!==r)break}return t.join("/")+"/"+e.slice(n).join("/")}function Ns(t,e){if(window.TextDecoder)return Os||(Os=new TextDecoder("utf-8")),t instanceof Uint8Array||(t=new Uint8Array(t)),Os.decode(t);for(var n="",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return e&&(n=decodeURIComponent(escape(n))),n}function Ps(t){var e=String(t).match(/\/?[^/]+\.(\w+)(\?\S+)?$/i);return e&&e[1].toLowerCase()||null}function Ds(t,e){t&&(Array.isArray(t)?t.forEach(e):Object.keys(t).forEach((function(n){e(t[n],n)})))}function Hs(t,e,n){if(!t||!t.length)return[0,0];for(var r=0,i=t.length-1;r<=i;){var o=r+i>>1,s=n(t[o],e);if(0===s)return[o,o];s<0?r=o+1:i=o-1}return r>i?[i,r]:[r,i]}function Fs(t,e,n){var r=Hs(t,e,n);t.splice(r[1],0,e)}function Us(t,e,n){return e<=t.length?t:new Array(e-t.length+1).join(n||"0")+t}function Bs(t){return t instanceof Float32Array?xs:t instanceof Int8Array?bs:t instanceof Uint8Array?Ls:t instanceof Int16Array?Is:t instanceof Uint16Array?Rs:t instanceof Uint32Array?Cs:xs}var Gs,ks,js=(Ms(Gs={},bs,Int8Array),Ms(Gs,Ls,Uint8Array),Ms(Gs,Is,Int16Array),Ms(Gs,Rs,Uint16Array),Ms(Gs,Cs,Uint32Array),Ms(Gs,xs,Float32Array),ks=Gs,function(t){return ks[t]||Float32Array});function Vs(t,e,n,r,i){if(t&&e){e.isGeometryData&&(e=e.data);for(var o=0;o<i;o++)t[n+o]=e[r+o]}}function Xs(t){return"string"==typeof t||"number"==typeof t}function Ws(t){return/^blob:/.test(t)}function zs(t){window.URL&&URL.revokeObjectURL(t)}function qs(t,e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),window.Blob&&window.URL)try{var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}catch(e){h.warn("new Blob error",t)}return"data:".concat(t,";base64,").concat(btoa(Ns(e)))}function Ys(t){return Array.isArray(t)||t.BYTES_PER_ELEMENT||t.length}function Js(t){var e,n=document.documentElement;try{e=t.getBoundingClientRect()}catch(n){e={top:t.offsetTop,left:t.offsetLeft,right:t.offsetLeft+t.offsetWidth,bottom:t.offsetTop+t.offsetHeight}}var r=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0)||0,i=(window.pageYOffset||n.scrollTop)-(n.clientTop||0)||0,o=window.getComputedStyle?getComputedStyle(t):t.currentStyle,s=parseInt,a=s(o.paddingLeft)+s(o.borderLeftWidth)||0,u=s(o.paddingTop)+s(o.borderTopWidth)||0,c=s(o.paddingRight)+s(o.borderRightWidth)||0,h=s(o.paddingBottom)+s(o.borderBottomWidth)||0,l=e.top||0,f=e.left||0;return{left:f+r+a,top:l+i+u,width:(e.right||0)-c-f-a,height:(e.bottom||0)-h-l-u}}function Qs(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return Array.isArray(t)||(t=Object.values(t)),t.reduce((function(t,n,r){return t.then((function(){return e(n,r)}))}),Promise.resolve())}function Zs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ks=function(){var t,e;try{t=Object.defineProperty,e=Object.defineProperties,t({},"$",{value:0})}catch(n){"__defineGetter__"in Object&&(t=function(t,e,n){return"value"in n&&(t[e]=n.value),"get"in n&&t.__defineGetter__(e,n.get),"set"in n&&t.__defineSetter__(e,n.set),t},e=function(e,n){for(var r in n)n.hasOwnProperty(r)&&t(e,r,n[r]);return e})}var n=function(t){for(var n=1,r=arguments.length;n<r;n++){var i=arguments[n],o=void 0;for(var s in i){var a=i[s];!a||"object"!=typeof a||void 0===a.value&&"function"!=typeof a.get&&"function"!=typeof a.set?t[s]=a:(o=o||{})[s]=a}o&&e(t,o)}return t},r=function(){if(Object.__proto__)return function(t){return{__proto__:t}};var t=function(){};return function(e){return t.prototype=e,new t}}(),i={Extends:function(t){var e=this.prototype,i=r(t.prototype);n(this,t),n(i,e),i.constructor=this,this.prototype=i,this.superclass=t.prototype},Mixes:function(t){t instanceof Array||(t=[t]);for(var e,r=this.prototype;e=t.shift();)n(r,e.prototype||e)},Statics:function(t){n(this,t)}},o=function(t){var e,r,o={};for(r in t)e=t[r],i.hasOwnProperty(r)?i[r].call(this,e):o[r]=e;n(this.prototype,o)};return{create:function(t){var e=(t=t||{}).hasOwnProperty("constructor")?t.constructor:function(){};return o.call(e,t),e},mix:n}}(),$s=Ks.create({constructor:function(t,e,n){this.type=t,this.target=e,this.detail=n,this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}}),ta={_listeners:null,on:function(t,e,n){for(var r=this._listeners=this._listeners||{},i=r[t]=r[t]||[],o=0,s=i.length;o<s;o++)if(i[o].listener===e)return this;return i.push({listener:e,once:n}),this},off:function(t,e){if(0===arguments.length)return this._listeners=null,this;var n=this._listeners&&this._listeners[t];if(n&&n.length>0){if(1===arguments.length)return delete this._listeners[t],this;for(var r=0,i=n.length;r<i;r++){var o=n[r];if(o.listener===e){n.splice(r,1);break}}}return this},fire:function(t,e){var n,r;"string"==typeof t?r=t:(n=t,r=t.type);var i=this._listeners;if(!i)return!1;var o=i[r];if(o&&o.length>0){var s=o.slice(0);if((n=n||new $s(r,this,e))._stopped)return!1;for(var a=0;a<s.length;a++){var u=s[a];if(u.listener.call(this,n),u.once){var c=o.indexOf(u);c>-1&&o.splice(c,1)}}return!0}return!1}},ea=n("./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js"),na=Ks.create({className:"Vector3",isVector3:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.elements=ea.vec3.fromValues(t,e,n)},copy:function(t){return ea.vec3.copy(this.elements,t.elements),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t[2+e]=n[2],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],n[2]=t[e+2],this},set:function(t,e,n){return ea.vec3.set(this.elements,t,e,n),this},add:function(t,e){return e||(e=t,t=this),ea.vec3.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),ea.vec3.subtract(this.elements,t.elements,e.elements),this},multiply:function(t,e){return e||(e=t,t=this),ea.vec3.multiply(this.elements,t.elements,e.elements),this},divide:function(t,e){return e||(e=t,t=this),ea.vec3.divide(this.elements,t.elements,e.elements),this},ceil:function(){return ea.vec3.ceil(this.elements,this.elements),this},floor:function(){return ea.vec3.floor(this.elements,this.elements),this},min:function(t,e){return e||(e=t,t=this),ea.vec3.min(this.elements,t.elements,e.elements),this},max:function(t,e){return e||(e=t,t=this),ea.vec3.max(this.elements,t.elements,e.elements),this},round:function(){return ea.vec3.round(this.elements,this.elements),this},scale:function(t){return ea.vec3.scale(this.elements,this.elements,t),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),ea.vec3.scaleAndAdd(this.elements,e.elements,n.elements,t),this},distance:function(t,e){return e||(e=t,t=this),ea.vec3.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),ea.vec3.squaredDistance(t.elements,e.elements)},length:function(){return ea.vec3.length(this.elements)},squaredLength:function(){return ea.vec3.squaredLength(this.elements)},negate:function(){return ea.vec3.negate(this.elements,this.elements),this},inverse:function(t){return t||(t=this),ea.vec3.inverse(this.elements,t.elements),this},normalize:function(){return ea.vec3.normalize(this.elements,this.elements),this},dot:function(t,e){return e||(e=t,t=this),ea.vec3.dot(t.elements,e.elements)},cross:function(t,e){return e||(e=t,t=this),ea.vec3.cross(this.elements,t.elements,e.elements),this},lerp:function(t,e){return ea.vec3.lerp(this.elements,this.elements,t.elements,e),this},hermite:function(t,e,n,r,i){return ea.vec3.hermite(this.elements,t.elements,e.elements,n.elements,r.elements,i),this},bezier:function(t,e,n,r,i){return ea.vec3.bezier(this.elements,t.elements,e.elements,n.elements,r.elements,i),this},random:function(t){return ea.vec3.random(this.elements,t),this},transformMat3:function(t){return ea.vec3.transformMat3(this.elements,this.elements,t.elements),this},transformMat4:function(t){return ea.vec3.transformMat4(this.elements,this.elements,t.elements),this},transformDirection:function(t){var e=this.elements,n=t.elements,r=e[0],i=e[1],o=e[2];return e[0]=r*n[0]+i*n[4]+o*n[8],e[1]=r*n[1]+i*n[5]+o*n[9],e[2]=r*n[2]+i*n[6]+o*n[10],this},transformQuat:function(t){return ea.vec3.transformQuat(this.elements,this.elements,t.elements),this},rotateX:function(t,e){return ea.vec3.rotateX(this.elements,this.elements,t.elements,e),this},rotateY:function(t,e){return ea.vec3.rotateY(this.elements,this.elements,t.elements,e),this},rotateZ:function(t,e){return ea.vec3.rotateZ(this.elements,this.elements,t.elements,e),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.vec3.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.vec3.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t}}});na.prototype.sub=na.prototype.subtract,na.prototype.mul=na.prototype.multiply,na.prototype.div=na.prototype.divide,na.prototype.dist=na.prototype.distance,na.prototype.sqrDist=na.prototype.squaredDistance,na.prototype.len=na.prototype.length,na.prototype.sqrLen=na.prototype.squaredLength;var ra=na,ia=Ks.create({className:"Matrix3",isMatrix3:!0,constructor:function(){this.elements=ea.mat3.create()},copy:function(t){return ea.mat3.copy(this.elements,t.elements),this},clone:function(){var t=new this.constructor;return ea.mat3.copy(t.elements,this.elements),t},toArray:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<9;r++)t[e+r]=n[r];return t},fromArray:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<9;r++)n[r]=t[e+r];return this},set:function(t,e,n,r,i,o,s,a,u){return ea.mat3.set(this.elements,t,e,n,r,i,o,s,a,u),this},identity:function(){return ea.mat3.identity(this.elements),this},transpose:function(){return ea.mat3.transpose(this.elements,this.elements),this},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return ea.mat3.invert(this.elements,t.elements),this},adjoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return ea.mat3.adjoint(this.elements,t.elements),this},determinant:function(){return ea.mat3.determinant(this.elements)},multiply:function(t,e){return e||(e=t,t=this),ea.mat3.multiply(this.elements,t.elements,e.elements),this},premultiply:function(t){return this.multiply(t,this),this},translate:function(t){return ea.mat3.translate(this.elements,this.elements,t.elements),this},rotate:function(t){return ea.mat3.rotate(this.elements,this.elements,t),this},scale:function(t){return ea.mat3.scale(this.elements,this.elements,t.elements),this},fromTranslation:function(t){return ea.mat3.fromTranslation(this.elements,t.elements),this},fromRotation:function(t){return ea.mat3.fromRotation(this.elements,t),this},fromScaling:function(t){return ea.mat3.fromScaling(this.elements,t.elements),this},fromQuat:function(t){return ea.mat3.fromQuat(this.elements,t.elements),this},normalFromMat4:function(t){return ea.mat3.normalFromMat4(this.elements,t.elements),this},fromMat4:function(t){return ea.mat3.fromMat4(this.elements,t.elements),this},frob:function(){return ea.mat3.frob(this.elements)},add:function(t,e){return e||(e=t,t=this),ea.mat3.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),ea.mat3.subtract(this.elements,t.elements,e.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.mat3.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.mat3.equals(t.elements,e.elements)},fromRotationTranslationScale:function(t,e,n,r,i){var o=Math.cos(t),s=Math.sin(t);return this.set(r*o,-i*s,0,r*s,i*o,0,e,n,1),this}});ia.prototype.sub=ia.prototype.subtract,ia.prototype.mul=ia.prototype.multiply;var oa=ia,sa=new oa,aa=Ks.create({Mixes:ta,className:"Quaternion",isQuaternion:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.elements=ea.quat.fromValues(t,e,n,r)},copy:function(t,e){return ea.quat.copy(this.elements,t.elements),e||this.fire("update"),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2],t[3])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=this.elements;return r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],n||this.fire("update"),this},set:function(t,e,n,r,i){return ea.quat.set(this.elements,t,e,n,r),i||this.fire("update"),this},identity:function(t){return ea.quat.identity(this.elements),t||this.fire("update"),this},rotationTo:function(t,e,n){return ea.quat.rotationTo(this.elements,t.elements,e.elements),n||this.fire("update"),this},setAxes:function(t,e,n,r){return ea.quat.setAxes(this.elements,t.elements,e.elements,n.elements),r||this.fire("update"),this},setAxisAngle:function(t,e,n){return ea.quat.setAxisAngle(this.elements,t.elements,e),n||this.fire("update"),this},getAxisAngle:function(t){return ea.quat.getAxisAngle(t.elements,this.elements)},add:function(t,e){return ea.quat.add(this.elements,this.elements,t.elements),e||this.fire("update"),this},multiply:function(t,e){return ea.quat.multiply(this.elements,this.elements,t.elements),e||this.fire("update"),this},premultiply:function(t,e){return ea.quat.multiply(this.elements,t.elements,this.elements),e||this.fire("update"),this},scale:function(t,e){return ea.quat.scale(this.elements,this.elements,t),e||this.fire("update"),this},rotateX:function(t,e){return ea.quat.rotateX(this.elements,this.elements,t),e||this.fire("update"),this},rotateY:function(t,e){return ea.quat.rotateY(this.elements,this.elements,t),e||this.fire("update"),this},rotateZ:function(t,e){return ea.quat.rotateZ(this.elements,this.elements,t),e||this.fire("update"),this},calculateW:function(t){return ea.quat.calculateW(this.elements,this.elements),t||this.fire("update"),this},dot:function(t){return ea.quat.dot(this.elements,t.elements)},lerp:function(t,e,n){return ea.quat.lerp(this.elements,this.elements,t.elements,e),n||this.fire("update"),this},slerp:function(t,e,n){return ea.quat.slerp(this.elements,this.elements,t.elements,e),n||this.fire("update"),this},sqlerp:function(t,e,n,r,i,o){return ea.quat.sqlerp(this.elements,t.elements,e.elements,n.elements,r.elements,i),o||this.fire("update"),this},invert:function(t){return ea.quat.invert(this.elements,this.elements),t||this.fire("update"),this},conjugate:function(t){return ea.quat.conjugate(this.elements,this.elements),t||this.fire("update"),this},length:function(){return ea.quat.length(this.elements)},squaredLength:function(){return ea.quat.squaredLength(this.elements)},normalize:function(t){return ea.quat.normalize(this.elements,this.elements),t||this.fire("update"),this},fromMat3:function(t,e){return ea.quat.fromMat3(this.elements,t.elements),e||this.fire("update"),this},fromMat4:function(t,e){return sa.fromMat4(t),this.fromMat3(sa,e),this},exactEquals:function(t){return ea.quat.exactEquals(this.elements,t.elements)},equals:function(t){return ea.quat.equals(this.elements,t.elements)},fromEuler:function(t,e){var n=.5*t.x,r=.5*t.y,i=.5*t.z,o=t.order||"ZYX",s=Math.sin(n),a=Math.cos(n),u=Math.sin(r),c=Math.cos(r),h=Math.sin(i),l=Math.cos(i),f=this.elements;return"XYZ"===o?(f[0]=s*c*l+a*u*h,f[1]=a*u*l-s*c*h,f[2]=a*c*h+s*u*l,f[3]=a*c*l-s*u*h):"YXZ"===o?(f[0]=s*c*l+a*u*h,f[1]=a*u*l-s*c*h,f[2]=a*c*h-s*u*l,f[3]=a*c*l+s*u*h):"ZXY"===o?(f[0]=s*c*l-a*u*h,f[1]=a*u*l+s*c*h,f[2]=a*c*h+s*u*l,f[3]=a*c*l-s*u*h):"ZYX"===o?(f[0]=s*c*l-a*u*h,f[1]=a*u*l+s*c*h,f[2]=a*c*h-s*u*l,f[3]=a*c*l+s*u*h):"YZX"===o?(f[0]=s*c*l+a*u*h,f[1]=a*u*l+s*c*h,f[2]=a*c*h-s*u*l,f[3]=a*c*l-s*u*h):"XZY"===o&&(f[0]=s*c*l-a*u*h,f[1]=a*u*l-s*c*h,f[2]=a*c*h+s*u*l,f[3]=a*c*l+s*u*h),e||this.fire("update"),this},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this.fire("update")}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this.fire("update")}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this.fire("update")}},w:{get:function(){return this.elements[3]},set:function(t){this.elements[3]=t,this.fire("update")}}});aa.prototype.mul=aa.prototype.multiply,aa.prototype.len=aa.prototype.length,aa.prototype.sqrLen=aa.prototype.squaredLength;var ua,ca=aa,ha=new ra,la=new ra,fa=Ks.create({className:"Matrix4",isMatrix4:!0,constructor:function(){this.elements=ea.mat4.create()},copy:function(t){return ea.mat4.copy(this.elements,t.elements),this},clone:function(){var t=new this.constructor;return ea.mat4.copy(t.elements,this.elements),t},toArray:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<16;r++)t[e+r]=n[r];return t},fromArray:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<16;r++)n[r]=t[e+r];return this},set:function(t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m){return ea.mat4.set(this.elements,t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m),this},identity:function(){return ea.mat4.identity(this.elements),this},transpose:function(){return ea.mat4.transpose(this.elements,this.elements),this},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return ea.mat4.invert(this.elements,t.elements),this},adjoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return ea.mat4.adjoint(this.elements,t.elements),this},determinant:function(){return ea.mat4.determinant(this.elements)},multiply:function(t,e){return e||(e=t,t=this),ea.mat4.multiply(this.elements,t.elements,e.elements),this},premultiply:function(t){return this.multiply(t,this),this},translate:function(t){return ea.mat4.translate(this.elements,this.elements,t.elements),this},scale:function(t){return ea.mat4.scale(this.elements,this.elements,t.elements),this},rotate:function(t,e){return ea.mat4.rotate(this.elements,this.elements,t,e.elements),this},rotateX:function(t){return ea.mat4.rotateX(this.elements,this.elements,t),this},rotateY:function(t){return ea.mat4.rotateY(this.elements,this.elements,t),this},rotateZ:function(t){return ea.mat4.rotateZ(this.elements,this.elements,t),this},fromTranslation:function(t){return ea.mat4.fromTranslation(this.elements,t.elements),this},fromScaling:function(t){return ea.mat4.fromScaling(this.elements,t.elements),this},fromRotation:function(t,e){return ea.mat4.fromRotation(this.elements,t,e.elements),this},fromXRotation:function(t){return ea.mat4.fromXRotation(this.elements,t),this},fromYRotation:function(t){return ea.mat4.fromYRotation(this.elements,t),this},fromZRotation:function(t){return ea.mat4.fromZRotation(this.elements,t),this},fromRotationTranslation:function(t,e){return ea.mat4.fromRotationTranslation(this.elements,t.elements,e.elements),this},getTranslation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ra;return ea.mat4.getTranslation(t.elements,this.elements),t},getScaling:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ra;return ea.mat4.getScaling(t.elements,this.elements),t},getRotation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ca;return ea.mat4.getRotation(t.elements,this.elements),t},fromRotationTranslationScale:function(t,e,n){return ea.mat4.fromRotationTranslationScale(this.elements,t.elements,e.elements,n.elements),this},fromRotationTranslationScaleOrigin:function(t,e,n,r){return ea.mat4.fromRotationTranslationScaleOrigin(this.elements,t.elements,e.elements,n.elements,r.elements),this},fromQuat:function(t){return ea.mat4.fromQuat(this.elements,t.elements),this},frustum:function(t,e,n,r,i,o){return ea.mat4.frustum(this.elements,t,e,n,r,i,o),this},perspective:function(t,e,n,r){return ea.mat4.perspective(this.elements,t,e,n,r),this},perspectiveFromFieldOfView:function(t,e,n){return ea.mat4.perspectiveFromFieldOfView(this.elements,t,e,n),this},ortho:function(t,e,n,r,i,o){return ea.mat4.ortho(this.elements,t,e,n,r,i,o),this},lookAt:function(t,e,n){return t.isVector3||(t=ha.set(t.x,t.y,t.z)),e.isVector3||(e=la.set(e.x,e.y,e.z)),ea.mat4.lookAt(this.elements,t.elements,e.elements,n.elements),this},targetTo:function(t,e,n){t.isVector3||(t=ha.set(t.x,t.y,t.z)),e.isVector3||(e=la.set(e.x,e.y,e.z)),t=t.elements,e=e.elements,n=n.elements;var r=this.elements,i=t[0],o=t[1],s=t[2],a=n[0],u=n[1],c=n[2],h=i-e[0],l=o-e[1],f=s-e[2],d=h*h+l*l+f*f;d>0?(h*=d=1/Math.sqrt(d),l*=d,f*=d):f=1;var p=u*f-c*l,m=c*h-a*f,_=a*l-u*h;return(d=p*p+m*m+_*_)>0?(p*=d=1/Math.sqrt(d),m*=d,_*=d):(d=(p=u*f-c*l)*p+(m=c*h-(a+=1e-7)*f)*m+(_=a*l-u*h)*_,p*=d=1/Math.sqrt(d),m*=d,_*=d),r[0]=p,r[1]=m,r[2]=_,r[3]=0,r[4]=l*_-f*m,r[5]=f*p-h*_,r[6]=h*m-l*p,r[7]=0,r[8]=h,r[9]=l,r[10]=f,r[11]=0,r[12]=i,r[13]=o,r[14]=s,r[15]=1,this},frob:function(){return ea.mat4.frob(this.elements)},add:function(t,e){return e||(e=t,t=this),ea.mat4.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),ea.mat4.subtract(this.elements,t.elements,e.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.mat4.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.mat4.equals(t.elements,e.elements)},compose:function(t,e,n,r){return r?this.fromRotationTranslationScaleOrigin(t,e,n,r):this.fromRotationTranslationScale(t,e,n),this},decompose:function(t,e,n,r){return this.getScaling(n),this.getTranslation(e),ua||(ua=new fa),this.determinant()<0&&(n.x*=-1),ua.copy(this),ha.inverse(n),ua.scale(ha),t.fromMat4(ua),r&&r.set(0,0,0),this}});fa.prototype.sub=fa.prototype.subtract,fa.prototype.mul=fa.prototype.multiply;var da,pa,ma=fa,_a=new ra,ga=new ra,va=Ks.create({Mixes:ta,Extends:ma,className:"Matrix4Notifier",isMatrix4Notifier:!0,constructor:function(){this.elements=ea.mat4.create()},copy:function(t){return ea.mat4.copy(this.elements,t.elements),this.fire("update"),this},fromArray:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<16;r++)n[r]=t[e+r];return this.fire("update"),this},set:function(t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m){return ea.mat4.set(this.elements,t,e,n,r,i,o,s,a,u,c,h,l,f,d,p,m),this.fire("update"),this},identity:function(){return ea.mat4.identity(this.elements),this.fire("update"),this},transpose:function(){return ea.mat4.transpose(this.elements,this.elements),this.fire("update"),this},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return ea.mat4.invert(this.elements,t.elements),this.fire("update"),this},adjoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return ea.mat4.adjoint(this.elements,t.elements),this.fire("update"),this},determinant:function(){return ea.mat4.determinant(this.elements)},multiply:function(t,e){return e||(e=t,t=this),ea.mat4.multiply(this.elements,t.elements,e.elements),this.fire("update"),this},premultiply:function(t){return this.multiply(t,this),this.fire("update"),this},translate:function(t){return ea.mat4.translate(this.elements,this.elements,t.elements),this.fire("update"),this},scale:function(t){return ea.mat4.scale(this.elements,this.elements,t.elements),this.fire("update"),this},rotate:function(t,e){return ea.mat4.rotate(this.elements,this.elements,t,e.elements),this.fire("update"),this},rotateX:function(t){return ea.mat4.rotateX(this.elements,this.elements,t),this.fire("update"),this},rotateY:function(t){return ea.mat4.rotateY(this.elements,this.elements,t),this.fire("update"),this},rotateZ:function(t){return ea.mat4.rotateZ(this.elements,this.elements,t),this.fire("update"),this},fromTranslation:function(t){return ea.mat4.fromTranslation(this.elements,t.elements),this.fire("update"),this},fromScaling:function(t){return ea.mat4.fromScaling(this.elements,t.elements),this.fire("update"),this},fromRotation:function(t,e){return ea.mat4.fromRotation(this.elements,t,e.elements),this.fire("update"),this},fromXRotation:function(t){return ea.mat4.fromXRotation(this.elements,t),this.fire("update"),this},fromYRotation:function(t){return ea.mat4.fromYRotation(this.elements,t),this.fire("update"),this},fromZRotation:function(t){return ea.mat4.fromZRotation(this.elements,t),this.fire("update"),this},fromRotationTranslation:function(t,e){return ea.mat4.fromRotationTranslation(this.elements,t.elements,e.elements),this.fire("update"),this},getTranslation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ra;return ea.mat4.getTranslation(t.elements,this.elements),t},getScaling:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ra;return ea.mat4.getScaling(t.elements,this.elements),t},getRotation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ca;return ea.mat4.getRotation(t.elements,this.elements),t},fromRotationTranslationScale:function(t,e,n){return ea.mat4.fromRotationTranslationScale(this.elements,t.elements,e.elements,n.elements),this.fire("update"),this},fromRotationTranslationScaleOrigin:function(t,e,n,r,i){return ea.mat4.fromRotationTranslationScaleOrigin(this.elements,t.elements,e.elements,n.elements,r.elements),i||this.fire("update"),this},fromQuat:function(t){return ea.mat4.fromQuat(this.elements,t.elements),this.fire("update"),this},frustum:function(t,e,n,r,i,o){return ea.mat4.frustum(this.elements,t,e,n,r,i,o),this.fire("update"),this},perspective:function(t,e,n,r){return ea.mat4.perspective(this.elements,t,e,n,r),this.fire("update"),this},perspectiveFromFieldOfView:function(t,e,n){return ea.mat4.perspectiveFromFieldOfView(this.elements,t,e,n),this.fire("update"),this},ortho:function(t,e,n,r,i,o){return ea.mat4.ortho(this.elements,t,e,n,r,i,o),this.fire("update"),this},lookAt:function(t,e,n){return t.isVector3||(t=_a.set(t.x,t.y,t.z)),e.isVector3||(e=ga.set(e.x,e.y,e.z)),ea.mat4.lookAt(this.elements,t.elements,e.elements,n.elements),this.fire("update"),this},targetTo:function(t,e,n){t.isVector3||(t=_a.set(t.x,t.y,t.z)),e.isVector3||(e=ga.set(e.x,e.y,e.z)),t=t.elements,e=e.elements,n=n.elements;var r=this.elements,i=t[0],o=t[1],s=t[2],a=n[0],u=n[1],c=n[2],h=i-e[0],l=o-e[1],f=s-e[2],d=h*h+l*l+f*f;d>0?(h*=d=1/Math.sqrt(d),l*=d,f*=d):f=1;var p=u*f-c*l,m=c*h-a*f,_=a*l-u*h;return(d=p*p+m*m+_*_)>0?(p*=d=1/Math.sqrt(d),m*=d,_*=d):(d=(p=u*f-c*l)*p+(m=c*h-(a+=1e-7)*f)*m+(_=a*l-u*h)*_,p*=d=1/Math.sqrt(d),m*=d,_*=d),r[0]=p,r[1]=m,r[2]=_,r[3]=0,r[4]=l*_-f*m,r[5]=f*p-h*_,r[6]=h*m-l*p,r[7]=0,r[8]=h,r[9]=l,r[10]=f,r[11]=0,r[12]=i,r[13]=o,r[14]=s,r[15]=1,this.fire("update"),this},frob:function(){return ea.mat4.frob(this.elements)},add:function(t,e){return e||(e=t,t=this),ea.mat4.add(this.elements,t.elements,e.elements),this.fire("update"),this},subtract:function(t,e){return e||(e=t,t=this),ea.mat4.subtract(this.elements,t.elements,e.elements),this.fire("update"),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.mat4.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.mat4.equals(t.elements,e.elements)},compose:function(t,e,n,r){return r?this.fromRotationTranslationScaleOrigin(t,e,n,r):this.fromRotationTranslationScale(t,e,n),this},decompose:function(t,e,n,r){return this.getScaling(n),this.getTranslation(e),da||(da=new ma),this.determinant()<0&&(n.x*=-1),da.copy(this),_a.inverse(n),da.scale(_a),t.fromMat4(da),r&&r.set(0,0,0),this}}),ya=Ks.create({Mixes:ta,Extends:ra,className:"Vector3Notifier",isVector3Notifier:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.elements=ea.vec3.fromValues(t,e,n)},copy:function(t){return ea.vec3.copy(this.elements,t.elements),this.fire("update"),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t[2+e]=n[2],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],n[2]=t[e+2],this.fire("update"),this},set:function(t,e,n){return ea.vec3.set(this.elements,t,e,n),this.fire("update"),this},add:function(t,e){return e||(e=t,t=this),ea.vec3.add(this.elements,t.elements,e.elements),this.fire("update"),this},subtract:function(t,e){return e||(e=t,t=this),ea.vec3.subtract(this.elements,t.elements,e.elements),this.fire("update"),this},multiply:function(t,e){return e||(e=t,t=this),ea.vec3.multiply(this.elements,t.elements,e.elements),this.fire("update"),this},divide:function(t,e){return e||(e=t,t=this),ea.vec3.divide(this.elements,t.elements,e.elements),this.fire("update"),this},ceil:function(){return ea.vec3.ceil(this.elements,this.elements),this.fire("update"),this},floor:function(){return ea.vec3.floor(this.elements,this.elements),this.fire("update"),this},min:function(t,e){return e||(e=t,t=this),ea.vec3.min(this.elements,t.elements,e.elements),this.fire("update"),this},max:function(t,e){return e||(e=t,t=this),ea.vec3.max(this.elements,t.elements,e.elements),this.fire("update"),this},round:function(){return ea.vec3.round(this.elements,this.elements),this.fire("update"),this},scale:function(t){return ea.vec3.scale(this.elements,this.elements,t),this.fire("update"),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),ea.vec3.scaleAndAdd(this.elements,e.elements,n.elements,t),this.fire("update"),this},distance:function(t,e){return e||(e=t,t=this),ea.vec3.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),ea.vec3.squaredDistance(t.elements,e.elements)},length:function(){return ea.vec3.length(this.elements)},squaredLength:function(){return ea.vec3.squaredLength(this.elements)},negate:function(){return ea.vec3.negate(this.elements,this.elements),this.fire("update"),this},inverse:function(t){return t||(t=this),ea.vec3.inverse(this.elements,t.elements),this.fire("update"),this},normalize:function(){return ea.vec3.normalize(this.elements,this.elements),this.fire("update"),this},dot:function(t,e){return e||(e=t,t=this),ea.vec3.dot(t.elements,e.elements)},cross:function(t,e){return e||(e=t,t=this),ea.vec3.cross(this.elements,t.elements,e.elements),this.fire("update"),this},lerp:function(t,e){return ea.vec3.lerp(this.elements,this.elements,t.elements,e),this.fire("update"),this},hermite:function(t,e,n,r,i){return ea.vec3.hermite(this.elements,t.elements,e.elements,n.elements,r.elements,i),this.fire("update"),this},bezier:function(t,e,n,r,i){return ea.vec3.bezier(this.elements,t.elements,e.elements,n.elements,r.elements,i),this.fire("update"),this},random:function(t){return ea.vec3.random(this.elements,t),this.fire("update"),this},transformMat3:function(t){return ea.vec3.transformMat3(this.elements,this.elements,t.elements),this.fire("update"),this},transformMat4:function(t){return ea.vec3.transformMat4(this.elements,this.elements,t.elements),this.fire("update"),this},transformDirection:function(t){var e=this.elements,n=t.elements,r=e[0],i=e[1],o=e[2];return e[0]=r*n[0]+i*n[4]+o*n[8],e[1]=r*n[1]+i*n[5]+o*n[9],e[2]=r*n[2]+i*n[6]+o*n[10],this.fire("update"),this},transformQuat:function(t){return ea.vec3.transformQuat(this.elements,this.elements,t.elements),this.fire("update"),this},rotateX:function(t,e){return ea.vec3.rotateX(this.elements,this.elements,t.elements,e),this.fire("update"),this},rotateY:function(t,e){return ea.vec3.rotateY(this.elements,this.elements,t.elements,e),this.fire("update"),this},rotateZ:function(t,e){return ea.vec3.rotateZ(this.elements,this.elements,t.elements,e),this.fire("update"),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.vec3.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.vec3.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this.fire("update")}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this.fire("update")}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this.fire("update")}}}),Ea={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(pa=0,function(t){var e=++pa;return t?e=t+"_"+e:e+="",e}),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},degToRad:function(t){return t*this.DEG2RAD},radToDeg:function(t){return t*this.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}},Ta=new ma,Aa=Ea.DEG2RAD,Sa=Ea.RAD2DEG,Ma=Ks.create({className:"Euler",isEuler:!0,order:"ZYX",constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.elements=new Float32Array([t,e,n]),this.updateDegrees()},clone:function(){var t=new this.constructor;return t.copy(this),t},copy:function(t){return this.elements[0]=t.x,this.elements[1]=t.y,this.elements[2]=t.z,this.order=t.order,this.updateDegrees(),this},set:function(t,e,n){return this.elements[0]=t,this.elements[1]=e,this.elements[2]=n,this.updateDegrees(),this},setDegree:function(t,e,n){return this._degX=t,this._degY=e,this._degZ=n,this.updateRadians(),this},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.elements[0]=t[e],this.elements[1]=t[e+1],this.elements[2]=t[e+2],this.updateDegrees(),this},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.elements[0],t[e+1]=this.elements[1],t[e+2]=this.elements[2],t},fromMat4:function(t,e){var n=t.elements,r=n[0],i=n[1],o=n[2],s=n[4],a=n[5],u=n[6],c=n[8],l=n[9],f=n[10];e=e||this.order,this.order=e;var d=Ea.clamp;return"XYZ"===e?(this.elements[1]=Math.asin(d(c,-1,1)),Math.abs(c)<.99999?(this.elements[0]=Math.atan2(-l,f),this.elements[2]=Math.atan2(-s,r)):(this.elements[0]=Math.atan2(u,a),this.elements[2]=0)):"YXZ"===e?(this.elements[0]=Math.asin(-d(l,-1,1)),Math.abs(l)<.99999?(this.elements[1]=Math.atan2(c,f),this.elements[2]=Math.atan2(i,a)):(this.elements[1]=Math.atan2(-o,r),this.elements[2]=0)):"ZXY"===e?(this.elements[0]=Math.asin(d(u,-1,1)),Math.abs(u)<.99999?(this.elements[1]=Math.atan2(-o,f),this.elements[2]=Math.atan2(-s,a)):(this.elements[1]=0,this.elements[2]=Math.atan2(i,r))):"ZYX"===e?(this.elements[1]=Math.asin(-d(o,-1,1)),Math.abs(o)<.99999?(this.elements[0]=Math.atan2(u,f),this.elements[2]=Math.atan2(i,r)):(this.elements[0]=0,this.elements[2]=Math.atan2(-s,a))):"YZX"===e?(this.elements[2]=Math.asin(d(i,-1,1)),Math.abs(i)<.99999?(this.elements[0]=Math.atan2(-l,a),this.elements[1]=Math.atan2(-o,r)):(this.elements[0]=0,this.elements[1]=Math.atan2(c,f))):"XZY"===e?(this.elements[2]=Math.asin(-d(s,-1,1)),Math.abs(s)<.99999?(this.elements[0]=Math.atan2(u,a),this.elements[1]=Math.atan2(c,r)):(this.elements[0]=Math.atan2(-l,f),this.elements[1]=0)):h.warn("Euler fromMat4() unsupported order: "+e),this.updateDegrees(),this},fromQuat:function(t,e){return Ta.fromQuat(t),this.fromMat4(Ta,e)},updateDegrees:function(){return this._degX=this.elements[0]*Sa,this._degY=this.elements[1]*Sa,this._degZ=this.elements[2]*Sa,this},updateRadians:function(){return this.elements[0]=this._degX*Aa,this.elements[1]=this._degY*Aa,this.elements[2]=this._degZ*Aa,this},degX:{get:function(){return this._degX},set:function(t){this._degX=t,this.elements[0]=t*Aa}},degY:{get:function(){return this._degY},set:function(t){this._degY=t,this.elements[1]=t*Aa}},degZ:{get:function(){return this._degZ},set:function(t){this._degZ=t,this.elements[2]=t*Aa}},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this._degX=t*Sa}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this._degY=t*Sa}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this._degZ=t*Sa}}}),Oa=Ea.DEG2RAD,ba=Ea.RAD2DEG,La=Ks.create({Mixes:ta,Extends:Ma,className:"EulerNotifier",isEulerNotifier:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Ma.call(this,t,e,n)},updateDegrees:function(){return La.superclass.updateDegrees.call(this),this.fire("update"),this},updateRadians:function(){return La.superclass.updateRadians.call(this),this.fire("update"),this},degX:{get:function(){return this._degX},set:function(t){this._degX=t,this.elements[0]=t*Oa,this.fire("update")}},degY:{get:function(){return this._degY},set:function(t){this._degY=t,this.elements[1]=t*Oa,this.fire("update")}},degZ:{get:function(){return this._degZ},set:function(t){this._degZ=t,this.elements[2]=t*Oa,this.fire("update")}},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this._degX=t*ba,this.fire("update")}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this._degY=t*ba,this.fire("update")}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this._degZ=t*ba,this.fire("update")}}}),Ia=La,Ra=new ra(0,1,0),Ca=new ma,xa=Ks.create({Statics:{TRAVERSE_STOP_NONE:!1,TRAVERSE_STOP_CHILDREN:1,TRAVERSE_STOP_ALL:!0},Mixes:ta,isNode:!0,className:"Node",name:"",anim:null,animationId:"",jointName:"",autoUpdateWorldMatrix:!0,autoUpdateChildWorldMatrix:!0,parent:null,_quatDirty:!1,_matrixDirty:!1,needCallChildUpdate:!0,visible:!0,pointerEnabled:!0,pointerChildren:!0,useHandCursor:!1,userData:null,onUpdate:null,__forceUseParentWorldMatrix:!1,constructor:function(t){var e=this;this.id=Ea.generateUUID(this.className),this.up=Ra.clone(),this.children=[],this.worldMatrix=new ma,this._matrix=new va,this._position=new ya(0,0,0),this._scale=new ya(1,1,1),this._pivot=new ya(0,0,0),this._rotation=new Ia,this._quaternion=new ca,this._matrix.on("update",(function(){e._onMatrixUpdate()})),this._position.on("update",(function(){e._onPositionUpdate()})),this._scale.on("update",(function(){e._onScaleUpdate()})),this._pivot.on("update",(function(){e._onPivotUpdate()})),this._rotation.on("update",(function(){e._onRotationUpdate()})),this._quaternion.on("update",(function(){e._onQuaternionUpdate()})),Object.assign(this,t)},clone:function(t){var e=new this.constructor;return e.name=this.name,e.jointName=this.jointName,e.animationId=this.animationId,e.setPosition(this.x,this.y,this.z),e.setScale(this.scaleX,this.scaleY,this.scaleZ),e.setRotation(this.rotationX,this.rotationY,this.rotationZ),this.children.forEach((function(t){e.addChild(t.clone(!0))})),t||(this.anim&&(e.anim=this.anim.clone(e)),e.resetSkinedMeshRootNode()),e},setAnim:function(t){return this.anim=t,t.rootNode=this,this},resetSkinedMeshRootNode:function(){var t=this;this.traverse((function(e){e.isSkinedMesh&&e.skeleton&&(e.skeleton.rootNode=t)}),!0)},getChildrenNameMap:function(){var t={};return this.traverse((function(e){t[e.name]=e;var n=e._originName;void 0===n||t[n]||(t[n]=e)}),!0),t},addChild:function(t){return t.parent&&t.removeFromParent(),t.parent=this,this.children.push(t),this},removeChild:function(t){var e=this.children.indexOf(t);return e>-1&&(this.children.splice(e,1),t.parent=null),this},addTo:function(t){return t.addChild(this),this},removeFromParent:function(){return this.parent&&this.parent.removeChild(this),this},updateMatrix:function(){return this._matrixDirty&&(this._matrixDirty=!1,this.matrixVersion++,this._matrix.fromRotationTranslationScaleOrigin(this.quaternion,this._position,this._scale,this._pivot,!0)),this},updateQuaternion:function(){return this._quatDirty&&(this._quatDirty=!1,this._quaternion.fromEuler(this._rotation,!0)),this},updateTransform:function(){return this._matrix.decompose(this._quaternion,this._position,this._scale,this._pivot),this._onQuaternionUpdate(),this._matrixDirty=!1,this},updateMatrixWorld:function(t){return this.traverse((function(e){return(e.autoUpdateWorldMatrix||t)&&(e.parent?e.__forceUseParentWorldMatrix?e.worldMatrix.copy(e.parent.worldMatrix):e.worldMatrix.multiply(e.parent.worldMatrix,e.matrix):e.worldMatrix.copy(e.matrix)),!e.autoUpdateChildWorldMatrix&&!t&&1})),this},getConcatenatedMatrix:function(t){for(var e=new ma,n=this;n&&n!==t;n=n.parent)e.multiply(n.matrix,e);return e},_traverse:function(t,e){if(!e){var n=t(this);if(n)return n}for(var r=this.children,i=0,o=r.length;i<o;i++){var s=r[i]._traverse(t,!1);if(!0===s)return s}return!1},traverse:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._traverse(t,e),this},traverseBFS:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(n=r?this.children:[this];n.length;){e=n,n=[];for(var i=0,o=e.length;i<o;i++){var s=e[i],a=t(s);if(a){if(!0===a)return this}else n=n.concat(s.children)}}return this},getChildByFnBFS:function(t){var e=null;return this.traverseBFS((function(n){return!!t(n)&&(e=n,!0)}),!0),e},getChildByNamePath:function(t){for(var e=this,n=function(n,r){var i=t[n],o=e.getChildByFnBFS((function(t){return t.name===i}));if(!o)return{v:null};e=o},r=0,i=t.length;r<i;r++){var o=n(r);if("object"==typeof o)return o.v}return e},traverseUpdate:function(t){return this.traverse((function(e){return e.onUpdate&&e.onUpdate(t),!e.needCallChildUpdate&&1})),this},getChildByFn:function(t){var e=null;return this.traverse((function(n){return!!t(n)&&(e=n,!0)}),!0),e},getChildrenByFn:function(t){var e=[];return this.traverse((function(n){t(n)&&e.push(n)}),!0),e},getChildByName:function(t){return this.getChildByFn((function(e){return e.name===t}))},getChildrenByName:function(t){return this.getChildrenByFn((function(e){return e.name===t}))},getChildById:function(t){return this.getChildByFn((function(e){return e.id===t}))},getChildrenByClassName:function(t){return this.getChildrenByFn((function(e){return e.className===t}))},getChildrenByBaseClassName:function(t){return this.getChildrenByFn((function(e){return e["is"+t]}))},setScale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this._scale.set(t,e,n),this},setPosition:function(t,e,n){return this._position.set(t,e,n),this},setRotation:function(t,e,n){return this._rotation.setDegree(t,e,n),this},setPivot:function(t,e,n){return this._pivot.set(t,e,n),this},lookAt:function(t){return this.isCamera?Ca.targetTo(this,t,this.up):Ca.targetTo(t,this,this.up),this._quaternion.fromMat4(Ca),this},raycast:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.visible)return null;var i=[];return this.traverse((function(n){if(r&&!n.pointerEnabled)return 1;if(n.isMesh){var o=n.raycast(t,!1);o&&(i=i.concat(o.map((function(t){return{mesh:n,point:t}}))))}return!(!r||e.pointerChildren)&&1})),i.length?(n&&t.sortPoints(i,"point"),i):null},matrix:{get:function(){return this.updateMatrix(),this._matrix},set:function(t){h.warnOnce("Node.matrix.set","node.matrix is readOnly.Use node.matrix.copy instead."),this._matrix.copy(t)}},position:{get:function(){return this._position},set:function(t){h.warnOnce("Node.position.set","node.position is readOnly.Use node.position.copy instead."),this._position.copy(t)}},x:{get:function(){return this._position.elements[0]},set:function(t){this._position.elements[0]=t,this._matrixDirty=!0}},y:{get:function(){return this._position.elements[1]},set:function(t){this._position.elements[1]=t,this._matrixDirty=!0}},z:{get:function(){return this._position.elements[2]},set:function(t){this._position.elements[2]=t,this._matrixDirty=!0}},scale:{get:function(){return this._scale},set:function(t){h.warnOnce("Node.scale.set","node.scale is readOnly.Use node.scale.copy instead."),this._scale.copy(t)}},scaleX:{get:function(){return this._scale.elements[0]},set:function(t){this._scale.elements[0]=t,this._matrixDirty=!0}},scaleY:{get:function(){return this._scale.elements[1]},set:function(t){this._scale.elements[1]=t,this._matrixDirty=!0}},scaleZ:{get:function(){return this._scale.elements[2]},set:function(t){this._scale.elements[2]=t,this._matrixDirty=!0}},pivot:{get:function(){return this._pivot},set:function(t){h.warnOnce("Node.pivot.set","node.pivot is readOnly.Use node.pivot.copy instead."),this._pivot.copy(t)}},pivotX:{get:function(){return this._pivot.elements[0]},set:function(t){this._pivot.elements[0]=t,this._matrixDirty=!0}},pivotY:{get:function(){return this._pivot.elements[1]},set:function(t){this._pivot.elements[1]=t,this._matrixDirty=!0}},pivotZ:{get:function(){return this._pivot.elements[2]},set:function(t){this._pivot.elements[2]=t,this._matrixDirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){h.warnOnce("Node.rotation.set","node.rotation is readOnly.Use node.rotation.copy instead."),this._rotation.copy(t)}},rotationX:{get:function(){return this._rotation.degX},set:function(t){this._rotation.degX=t}},rotationY:{get:function(){return this._rotation.degY},set:function(t){this._rotation.degY=t}},rotationZ:{get:function(){return this._rotation.degZ},set:function(t){this._rotation.degZ=t}},quaternion:{get:function(){return this.updateQuaternion(),this._quaternion},set:function(t){h.warnOnce("Node.quaternion.set","node.quaternion is readOnly.Use node.quaternion.copy instead."),this._quaternion.copy(t)}},matrixVersion:0,getBounds:function(t,e,n){return e?e.multiply(this.matrix):e=this.getConcatenatedMatrix(t),this.children.forEach((function(t){n=t.getBounds(null,e.clone(),n)})),this.isMesh&&(n=this.geometry.getBounds(e,n)),n},_fireMouseEvent:function(t){if(t.eventCurrentTarget=this,this.fire(t),"mousemove"===t.type){if(!this.__mouseOver){this.__mouseOver=!0;var e=Object.assign({},t);e.type="mouseover",this.fire(e)}}else"mouseout"===t.type&&(this.__mouseOver=!1);var n=this.parent;t._stopped||t._stopPropagationed||!n||n._fireMouseEvent(t)},destroy:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getChildrenByBaseClassName("Node");return this.off(),n.forEach((function(n){n.isMesh?n.destroy(t,e):(n.off(),n.removeFromParent())})),this.removeFromParent(),this},_onMatrixUpdate:function(){this.matrixVersion++,this.updateTransform()},_onPositionUpdate:function(){this._matrixDirty=!0},_onScaleUpdate:function(){this._matrixDirty=!0},_onPivotUpdate:function(){this._matrixDirty=!0},_onRotationUpdate:function(){this._quatDirty=!0,this._matrixDirty=!0},_onQuaternionUpdate:function(){this._rotation.fromQuat(this._quaternion),this._quatDirty=!1}}),wa=Ks.create({className:"Vector4",isVector4:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.elements=ea.vec4.fromValues(t,e,n,r)},copy:function(t){return ea.vec4.copy(this.elements,t.elements),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2],t[3])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t[2+e]=n[2],t[3+e]=n[3],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],n[2]=t[e+2],n[3]=t[e+3],this},set:function(t,e,n,r){return ea.vec4.set(this.elements,t,e,n,r),this},add:function(t,e){return e||(e=t,t=this),ea.vec4.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),ea.vec4.subtract(this.elements,t.elements,e.elements),this},multiply:function(t,e){return e||(e=t,t=this),ea.vec4.multiply(this.elements,t.elements,e.elements),this},divide:function(t,e){return e||(e=t,t=this),ea.vec4.divide(this.elements,t.elements,e.elements),this},ceil:function(){return ea.vec4.ceil(this.elements,this.elements),this},floor:function(){return ea.vec4.floor(this.elements,this.elements),this},min:function(t,e){return e||(e=t,t=this),ea.vec4.min(this.elements,t.elements,e.elements),this},max:function(t,e){return e||(e=t,t=this),ea.vec4.max(this.elements,t.elements,e.elements),this},round:function(){return ea.vec4.round(this.elements,this.elements),this},scale:function(t){return ea.vec4.scale(this.elements,this.elements,t),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),ea.vec4.scaleAndAdd(this.elements,e.elements,n.elements,t),this},distance:function(t,e){return e||(e=t,t=this),ea.vec4.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),ea.vec4.squaredDistance(t.elements,e.elements)},length:function(){return ea.vec4.length(this.elements)},squaredLength:function(){return ea.vec4.squaredLength(this.elements)},negate:function(){return ea.vec4.negate(this.elements,this.elements),this},inverse:function(t){return t||(t=this),ea.vec4.inverse(this.elements,t.elements),this},normalize:function(){return ea.vec4.normalize(this.elements,this.elements),this},dot:function(t,e){return e||(e=t,t=this),ea.vec4.dot(t.elements,e.elements)},lerp:function(t,e){return ea.vec4.lerp(this.elements,this.elements,t.elements,e),this},random:function(t){return t=t||1,this.elements[0]=Math.random(),this.elements[1]=Math.random(),this.elements[2]=Math.random(),this.elements[3]=Math.random(),this.normalize(),this.scale(t),this},transformMat4:function(t){return ea.vec4.transformMat4(this.elements,this.elements,t.elements),this},transformQuat:function(t){return ea.vec4.transformQuat(this.elements,this.elements,t.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.vec4.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.vec4.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t}},w:{get:function(){return this.elements[3]},set:function(t){this.elements[3]=t}}});wa.prototype.sub=wa.prototype.subtract,wa.prototype.mul=wa.prototype.multiply,wa.prototype.div=wa.prototype.divide,wa.prototype.dist=wa.prototype.distance,wa.prototype.sqrDist=wa.prototype.squaredDistance,wa.prototype.len=wa.prototype.length,wa.prototype.sqrLen=wa.prototype.squaredLength;var Na=wa,Pa=Ks.create({Extends:Na,className:"Color",isColor:!0,r:{get:function(){return this.x},set:function(t){this.x=t}},g:{get:function(){return this.y},set:function(t){this.y=t}},b:{get:function(){return this.z},set:function(t){this.z=t}},a:{get:function(){return this.w},set:function(t){this.w=t}},constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Pa.superclass.constructor.call(this,t,e,n,r)},toRGBArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t},fromUintArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.elements[0]=t[e]/255,this.elements[1]=t[e+1]/255,this.elements[2]=t[e+2]/255,this.elements[3]=t[e+3]/255,this},fromHEX:function(t){return"number"==typeof t?t=Us(t.toString(16),6):("#"===t[0]&&(t=t.slice(1)),3===t.length&&(t=t.replace(/(\w)/g,"$1$1"))),this.elements[0]=parseInt(t.slice(0,2),16)/255,this.elements[1]=parseInt(t.slice(2,4),16)/255,this.elements[2]=parseInt(t.slice(4,6),16)/255,this},toHEX:function(){for(var t="",e=0;e<3;e++)t+=Us(Math.floor(255*this.elements[e]).toString(16),2);return t}}),Da=Pa,Ha=new Da,Fa=Ks.create({Extends:xa,isLight:!0,className:"Light",amount:1,enabled:!0,constantAttenuation:1,linearAttenuation:0,quadraticAttenuation:0,_range:0,range:{get:function(){return this._range},set:function(t){this.constantAttenuation=1,t<=0?(this.linearAttenuation=0,this.quadraticAttenuation=0):(this.linearAttenuation=4.5/t,this.quadraticAttenuation=75/(t*t)),this._range=t}},shadow:null,isDirty:!1,constructor:function(t){this.color=new Da(1,1,1),Fa.superclass.constructor.call(this,t)},toInfoArray:function(t,e){return t[e+0]=this.constantAttenuation,t[e+1]=this.linearAttenuation,t[e+2]=this.quadraticAttenuation,this},getRealColor:function(){return Ha.copy(this.color).scale(this.amount)},createShadowMap:function(t,e){}}),Ua=Fa,Ba=Ks.create({className:"Plane",isPlane:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ra,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.normal=t,this.distance=e},copy:function(t){return this.normal.copy(t.normal),this.distance=t.distance,this},clone:function(){return new this.constructor(this.normal.clone(),this.distance)},set:function(t,e,n,r){return this.normal.set(t,e,n),this.distance=r,this},normalize:function(){var t=1/this.normal.length();return this.normal.scale(t),this.distance*=t,this},distanceToPoint:function(t){return this.normal.dot(t)+this.distance},projectPoint:function(t){return(new ra).copy(this.normal).scale(-this.distanceToPoint(t)).add(t)}}),Ga=Ks.create({className:"Frustum",isFrustum:!0,constructor:function(){this.planes=[];for(var t=6;t--;)this.planes.push(new Ba)},copy:function(t){var e=t.planes;return this.planes.forEach((function(t,n){t.copy(e[n])})),this},clone:function(){var t=new this.constructor;return t.copy(this),t},fromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],u=n[5],c=n[6],h=n[7],l=n[8],f=n[9],d=n[10],p=n[11],m=n[12],_=n[13],g=n[14],v=n[15];return e[0].set(s-r,h-a,p-l,v-m).normalize(),e[1].set(s+r,h+a,p+l,v+m).normalize(),e[2].set(s+i,h+u,p+f,v+_).normalize(),e[3].set(s-i,h-u,p-f,v-_).normalize(),e[4].set(s-o,h-c,p-d,v-g).normalize(),e[5].set(s+o,h+c,p+d,v+g).normalize(),this},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++)if(e[i].distanceToPoint(n)<r)return!1;return!0}}),ka=new ma,ja=Ks.create({Extends:xa,isCamera:!0,className:"Camera",_needUpdateProjectionMatrix:!0,_isGeometryDirty:!1,constructor:function(t){this.viewMatrix=new ma,this.projectionMatrix=new ma,this.viewProjectionMatrix=new ma,this._frustum=new Ga,ja.superclass.constructor.call(this,t)},updateViewMatrix:function(){return this.updateMatrixWorld(!0),this.viewMatrix.invert(this.worldMatrix),this},updateProjectionMatrix:function(){},getGeometry:function(t){},updateViewProjectionMatrix:function(){return this._needUpdateProjectionMatrix&&(this.updateProjectionMatrix(),this._needUpdateProjectionMatrix=!1),this.updateViewMatrix(),this.viewProjectionMatrix.multiply(this.projectionMatrix,this.viewMatrix),this.updateFrustum(this.viewProjectionMatrix),this},getModelViewMatrix:function(t,e){return(e=e||new ma).multiply(this.viewMatrix,t.worldMatrix),e},getModelProjectionMatrix:function(t,e){return(e=e||new ma).multiply(this.viewProjectionMatrix,t.worldMatrix),e},projectVector:function(t,e,n){var r=t.clone();return r.transformMat4(this.viewProjectionMatrix),e&&n&&(r.x=(r.x+1)/2*e,r.y=n-(r.y+1)/2*n),r},unprojectVector:function(t,e,n){var r=t.clone();return e&&n&&(r.x=r.x/e*2-1,r.y=1-r.y/n*2),ka.invert(this.viewProjectionMatrix),r.transformMat4(ka),r},isPointVisible:function(t){return!!this._frustum.intersectsSphere({center:t,radius:0})},isMeshVisible:function(t){var e=t.geometry;if(e){var n=e.getSphereBounds(t.worldMatrix);if(this._frustum.intersectsSphere(n))return!0}return!1},updateFrustum:function(t){return this._frustum.fromMatrix(t),this}}),Va=ja,Xa=Ks.create({className:"Vector2",isVector2:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.elements=ea.vec2.fromValues(t,e)},copy:function(t){return ea.vec2.copy(this.elements,t.elements),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],this},set:function(t,e){return ea.vec2.set(this.elements,t,e),this},add:function(t,e){return e||(e=t,t=this),ea.vec2.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),ea.vec2.subtract(this.elements,t.elements,e.elements),this},multiply:function(t,e){return e||(e=t,t=this),ea.vec2.multiply(this.elements,t.elements,e.elements),this},divide:function(t,e){return e||(e=t,t=this),ea.vec2.divide(this.elements,t.elements,e.elements),this},ceil:function(){return ea.vec2.ceil(this.elements,this.elements),this},floor:function(){return ea.vec2.floor(this.elements,this.elements),this},min:function(t,e){return e||(e=t,t=this),ea.vec2.min(this.elements,t.elements,e.elements),this},max:function(t,e){return e||(e=t,t=this),ea.vec2.max(this.elements,t.elements,e.elements),this},round:function(){return ea.vec2.round(this.elements,this.elements),this},scale:function(t){return ea.vec2.scale(this.elements,this.elements,t),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),ea.vec2.scaleAndAdd(this.elements,e.elements,n.elements,t),this},distance:function(t,e){return e||(e=t,t=this),ea.vec2.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),ea.vec2.squaredDistance(t.elements,e.elements)},length:function(){return ea.vec2.length(this.elements)},squaredLength:function(){return ea.vec2.squaredLength(this.elements)},negate:function(){return ea.vec2.negate(this.elements,this.elements),this},inverse:function(t){return t||(t=this),ea.vec2.inverse(this.elements,t.elements),this},normalize:function(){return ea.vec2.normalize(this.elements,this.elements),this},dot:function(t,e){return e||(e=t,t=this),ea.vec2.dot(t.elements,e.elements)},cross:function(t,e){return e||(e=t,t=this),ea.vec2.cross(this.elements,t.elements,e.elements),this},lerp:function(t,e){return ea.vec2.lerp(this.elements,this.elements,t.elements,e),this},random:function(t){return ea.vec2.random(this.elements,t),this},transformMat3:function(t){return ea.vec2.transformMat3(this.elements,this.elements,t.elements),this},transformMat4:function(t){return ea.vec2.transformMat4(this.elements,this.elements,t.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),ea.vec2.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),ea.vec2.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}}});Xa.prototype.sub=Xa.prototype.subtract,Xa.prototype.mul=Xa.prototype.multiply,Xa.prototype.div=Xa.prototype.divide,Xa.prototype.dist=Xa.prototype.distance,Xa.prototype.sqrDist=Xa.prototype.squaredDistance,Xa.prototype.len=Xa.prototype.length,Xa.prototype.sqrLen=Xa.prototype.squaredLength;var Wa=Xa,za=new ra,qa=Ks.create({className:"Sphere",isSphere:!0,radius:0,constructor:function(t){Object.assign(this,t),this.center||(this.center=new ra(0,0,0))},clone:function(){var t=new this.constructor;return t.copy(this),t},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},fromPoints:function(t){for(var e=this.center,n=0,r=0;r<t.length;r+=3){var i=t[r]-e.x,o=t[r+1]-e.y,s=t[r+2]-e.z;n=Math.max(i*i+o*o+s*s,n)}return this.radius=Math.sqrt(n),this},fromGeometryData:function(t){var e=this.center,n=0;return t.traverse((function(t){var r=t.x-e.x,i=t.y-e.y,o=t.z-e.z;n=Math.max(r*r+i*i+o*o,n)})),this.radius=Math.sqrt(n),this},transformMat4:function(t){this.center.transformMat4(t);var e=t.getScaling(za);return this.radius*=Math.max(e.x,e.y,e.z),this}}),Ya={2:new Wa,3:new ra,4:new Na,16:new ma},Ja=Ks.create({className:"GeometryData",isGeometryData:!0,size:void 0,normalized:!1,type:void 0,_isSubDirty:!1,_isAllDirty:!1,isDirty:{get:function(){return this._isSubDirty||this._isAllDirty},set:function(t){this._isAllDirty=t,!1===t&&this.clearSubData()}},bufferViewId:void 0,glBuffer:null,constructor:function(t,e,n){this.id=Ea.generateUUID(this.className),this.data=t,this.size=e,Object.assign(this,n),this.bufferViewId||(this.bufferViewId=this.id),this.size||h.warn("GeometryData.constructor: geometryData must set size!",this)},_stride:0,stride:{get:function(){return this._stride},set:function(t){this._stride=t,this.strideSize=0===t?0:t/this.data.BYTES_PER_ELEMENT}},strideSize:0,_offset:0,offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.offsetSize=t/this.data.BYTES_PER_ELEMENT}},offsetSize:0,data:{set:function(t){t&&(this._data=t,this.type=Bs(t),this.stride=this._stride,this.offset=this._offset,this._isAllDirty=!0)},get:function(){return this._data}},length:{get:function(){return this._data.length}},realLength:{get:function(){return 0===this.strideSize?this._data.length:this._data.length/this.strideSize*this.size}},getByteLength:function(){return this._data.BYTES_PER_ELEMENT*this.realLength},count:{get:function(){return 0===this.strideSize?this._data.length/this.size:this._data.length/this.strideSize}},setSubData:function(t,e){this._isSubDirty=!0,this.data.set(e,t),this.subDataList||(this.subDataList=[]);var n=e.BYTES_PER_ELEMENT*t;this.subDataList.push({byteOffset:n,data:e})},clearSubData:function(){this.subDataList&&(this.subDataList.length=0),this._isSubDirty=!1},clone:function(){var t=new Ja(null,1);return t.copy(this),t},copy:function(t){var e=t.data;this.data=new e.constructor(e),this.size=t.size,this.stride=t.stride,this.normalized=t.normalized,this.type=t.type,this.offset=t.offset},getOffset:function(t){var e=this.strideSize;return 0===e?t*this.size:t*e+this.offsetSize},get:function(t){var e=this.getOffset(t);return this.getByOffset(e)},getCopy:function(t){return this.get(t).clone()},set:function(t,e){var n=this.getOffset(t);return this.setByOffset(n,e),n},getByOffset:function(t){var e=this.size;return e>1?Ya[e].fromArray(this._data,t):this._data[t]},setByOffset:function(t,e){var n=this.size,r=this._data;n>1?e.toArray(r,t):r[t]=e,this._isAllDirty=!0},traverse:function(t){for(var e=this.count,n=0;n<e;n++){var r=this.getOffset(n);if(t(this.getByOffset(r),n,r))return!0}return!1},traverseByComponent:function(t){for(var e=this.count,n=this.size,r=this._data,i=0;i<e;i++)for(var o=this.getOffset(i),s=i*n,a=0;a<n;a++){var u=o+a;if(t(r[u],s+a,u))return!0}return!1},merge:function(t,e){if(t.type!==this.type||t.size!==this.size)return h.warn("geometryData type or size not same, cannot merge!",this,t),this;var n=js(this.type),r=this.realLength,i=t.realLength,o=new n(r+i);return this.traverseByComponent((function(t,e){o[e]=t})),t.traverseByComponent((function(t,n){e&&(t=e(t,n)),o[r+n]=t})),this.stride=0,this.offset=0,this.data=o,this}}),Qa=Ja,Za=Ss.TRIANGLES,Ka=Ss.LINES,$a=Ss.FRONT,tu=Ss.BACK,eu=Ss.FRONT_AND_BACK,nu=new ra,ru=new ra,iu=new ra,ou=new Na,su=new Wa,au=new Wa,uu=new Wa,cu=new oa,hu=new ma,lu=new ca,fu=Ks.create({isGeometry:!0,className:"Geometry",vertices:null,uvs:null,uvs1:null,colors:null,indices:null,skinIndices:null,skinWeights:null,mode:Za,isStatic:!0,isDirty:!0,useAABBRaycast:!1,userData:null,constructor:function(t){this.id=Ea.generateUUID(this.className),Object.assign(this,t),this.currentVerticesCount=0,this.currentIndicesCount=0},_needUpdateNormals:!1,normals:{get:function(){return!this._needUpdateNormals&&this._normals||this.calculateNormals(),this._normals},set:function(t){this._normals=t,this._needUpdateNormals=!1}},calculateNormals:function(){var t=this.vertices;if(t){this._normals||(this._normals=new Qa(new Float32Array(t.realLength),3));var e,n=this._normals;if(this.indices)e=this.indices.data;else{var r=t.length/3;e=new Array(r);for(var i=0;i<r;i++)e[i]=i}for(var o=0,s=new Uint8Array(t.count),a=0;a<e.length;a+=3){o=e[a],nu.copy(t.get(o)),o=e[a+1],ru.copy(t.get(o)),o=e[a+2],iu.copy(t.get(o)),ru.sub(nu),iu.sub(nu),ru.cross(iu);for(var u=0;u<3;u++){if(s[o=e[a+u]]){var c=n.get(o);c.scale(s[o]),c.add(ru),c.scale(1/(s[o]+1)),n.set(o,c)}else n.set(o,ru);s[o]++}}this.isDirty=!0,this._needUpdateNormals=!1}else h.warnOnce("geometry.calculateNormals","geometry.calculateNormals error:no vertices data.")},tangents:{get:function(){return this._tangents||this.calculateTangents(this.uvs,"_tangents"),this._tangents},set:function(t){this._tangents=t}},tangents1:{get:function(){return this._tangents1||this.calculateTangents(this.uvs1,"_tangents1"),this._tangents1},set:function(t){this._tangents1=t}},calculateTangents:function(t,e){var n=this.vertices;if(n){this[e]||(this[e]=new Qa(new Float32Array(4*n.count),4));var r,i=this[e];if(this.indices)r=this.indices.data;else{var o=n.length/3;r=new Array(o);for(var s=0;s<o;s++)r[s]=s}for(var a=0,u=0;u<r.length;u+=3){a=r[u],nu.copy(n.get(a)),su.copy(t.get(a)),a=r[u+1],ru.copy(n.get(a)),au.copy(t.get(a)),a=r[u+2],iu.copy(n.get(a)),uu.copy(t.get(a)),ru.sub(nu),iu.sub(nu),au.sub(su),uu.sub(su);var c=1/(au.x*uu.y-uu.x*au.y);Number.isFinite(c)?(nu.x=c*(uu.y*ru.x-au.y*iu.x),nu.y=c*(uu.y*ru.y-au.y*iu.y),nu.z=c*(uu.y*ru.z-au.y*iu.z)):(nu.x=0,nu.y=0,nu.z=1),ou.set(nu.x,nu.y,nu.z,1),i.set(r[u],ou),i.set(r[u+1],ou),i.set(r[u+2],ou)}this.isDirty=!0}else h.warnOnce("geometry.calculateTangents","geometry.calculateTangents error:no vertices data.")},convertToLinesMode:function(){if(this.mode===Za)if(this.indices){for(var t=new Uint16Array(2*this.indices.length),e=this.indices.data,n=0;n<e.length;n+=3)t[2*n]=e[n],t[2*n+1]=e[n+1],t[2*n+2]=e[n+1],t[2*n+3]=e[n+2],t[2*n+4]=e[n+2],t[2*n+5]=e[n];this.indices.data=t,this.mode=Ka}else h.warn("Has no indices!");else h.warn("Only support convert triangles to lines mode!")},translate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transformMat4(hu.fromTranslation(nu.set(t,e,n))),this},scale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.transformMat4(hu.fromScaling(nu.set(t,e,n))),this},rotate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transformMat4(hu.fromQuat(lu.fromEuler({x:t*Ea.DEG2RAD,y:e*Ea.DEG2RAD,z:n*Ea.DEG2RAD}))),this},transformMat4:function(t){var e=this.vertices;if(e&&e.traverse((function(n,r,i){e.setByOffset(i,n.transformMat4(t))})),cu.normalFromMat4(t),this._normals){var n=this.normals;n.traverse((function(t,e,r){n.setByOffset(r,t.transformMat3(cu).normalize())}))}if(this._tangents){var r=this.tangents;r.traverse((function(t,e,n){r.setByOffset(n,t.transformMat3(cu).normalize())}))}return this.isDirty=!0,this},merge:function(t,e){var n=t.vertices;if(n&&this.vertices){var r=this.vertices.count;e&&(n=t.vertices.clone()).traverse((function(t,r,i){n.setByOffset(i,t.transformMat4(e))})),this.vertices.merge(n),this.indices&&t.indices?this.indices.merge(t.indices,(function(t){return t+r})):this.indices=null}return this.uvs&&t.uvs?this.uvs.merge(t.uvs):this.uvs=null,this.uvs1&&t.uvs1?this.uvs1.merge(t.uvs1):this.uvs1=null,this.colors&&t.colors?this.colors.merge(t.colors):this.colors=null,this._normals&&(this._normals=null),this._tangents&&(this._tangents=null),this._tangents1&&(this._tangents1=null),this.isDirty=!0,this},ensureData:function(t,e,n,r){var i=this[t];if(!i||n>i.length){var o=new r(n);i?(o.set(i.data),i.data=o):this[t]=new Qa(o,e)}},addPoints:function(){var t=this,e=[].slice.call(arguments),n=3*(this.currentVerticesCount+e.length);this.ensureData("vertices",3,n,Float32Array);var r=this.vertices.data;return e.forEach((function(e){var n=3*t.currentVerticesCount++;r[n]=e[0],r[n+1]=e[1],r[n+2]=e[2]})),this.currentVerticesCount-e.length},addIndices:function(){var t=this,e=[].slice.call(arguments),n=this.currentIndicesCount+e.length;this.ensureData("indices",1,n,Uint16Array);var r=this.indices.data;e.forEach((function(e){r[t.currentIndicesCount++]=e})),this._needUpdateNormals=!0},addLine:function(t,e){var n=this.addPoints(t,e);this.addIndices(n,n+1)},addFace:function(t,e,n){var r=this.addPoints(t,e,n);this.addIndices(r,r+1,r+2)},addRect:function(t,e,n,r){var i=this.addPoints(t,e,n,r);this.addIndices(i,i+1,i+2,i,i+2,i+3)},setVertexUV:function(t,e){this.ensureData("uvs",2,this.vertices.length/3*2,Float32Array);for(var n=this.uvs.data,r=0;r<e.length;r++)n[t+2*r]=e[r][0],n[t+2*r+1]=e[r][1]},setFaceUV:function(t,e,n,r){this.setVertexUV(t,[e,n,r])},setRectUV:function(t,e,n,r,i){this.setVertexUV(t,[e,n,r,i])},getBounds:function(t,e){e||(e={xMin:1/0,xMax:-1/0,yMin:1/0,yMax:-1/0,zMin:1/0,zMax:-1/0});var n=this.vertices;return n?(n.traverse((function(n){t&&n.transformMat4(t),e.xMax=Math.max(e.xMax,n.x),e.yMax=Math.max(e.yMax,n.y),e.zMax=Math.max(e.zMax,n.z),e.xMin=Math.min(e.xMin,n.x),e.yMin=Math.min(e.yMin,n.y),e.zMin=Math.min(e.zMin,n.z)})),e.width=e.xMax-e.xMin,e.height=e.yMax-e.yMin,e.depth=e.zMax-e.zMin,e.x=(e.xMin+e.xMax)/2,e.y=(e.yMin+e.yMax)/2,e.z=(e.zMin+e.zMax)/2,e):(h.warnOnce("geometry.getBounds","geometry has no vertices data, geometry.getBounds will return Infinity bounds."),e)},getLocalBounds:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._localBounds&&!t||(this._localBounds=this.getBounds()),this._localBounds},getSphereBounds:function(t){this._sphereBounds||(this._sphereBounds=new qa);var e=this._sphereBounds;return e.copy(this.getLocalSphereBounds()),t&&e.transformMat4(t),e},getLocalSphereBounds:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._localSphereBounds||t){var e=this.getLocalBounds(t),n=new qa({center:new ra(e.x,e.y,e.z)}),r=this.vertices;r?n.fromGeometryData(r):(h.warnOnce("geometry.getLocalSphereBounds","geometry has no vertices data, geometry.getLocalSphereBounds will return Infinity bounds."),n.radius=1/0),this._localSphereBounds=n}return this._localSphereBounds},convertToNoIndices:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;if(this.mode===Za)if(this.indices){for(var e=this.indices.data,n=e.length,r=new Float32Array(n*t),i=this.uvs?new Float32Array(2*n):null,o=new Float32Array(3*n),s=this.colors?new Float32Array(this.colors.size*n):null,a=this.skinIndices?new Float32Array(4*n):null,u=this.skinWeights?new Float32Array(4*n):null,c=0;c<n;c++){var l=e[c];Vs(r,this.vertices,c*t,3*l,3),4===t&&(r[4*c+3]=1),Vs(i,this.uvs,2*c,2*l,2),Vs(o,this.normals,3*c,3*l,3),Vs(a,this.skinIndices,4*c,4*l,4),Vs(u,this.skinWeights,4*c,4*l,4),this.colors&&Vs(s,this.colors,c*this.colors.size,l*this.colors.size,this.colors.size)}delete this.indices,this.vertices.data=r,this.uvs&&(this.uvs.data=i),this.normals&&(this.normals.data=o),this.colors&&(this.colors.data=s),this.skinIndices&&(this.skinIndices.data=a),this.skinWeights&&(this.skinWeights.data=u)}else h.warn("Has no indices!");else h.warn("Only support convert triangles to lines mode!")},clone:function(){var t=new this.constructor({mode:this.mode});return this.vertices&&(t.vertices=this.vertices.clone()),this.uvs&&(t.uvs=this.uvs.clone()),this.uvs1&&(t.uvs1=this.uvs1.clone()),this.colors&&(t.colors=this.colors.clone()),this.indices&&(t.indices=this.indices.clone()),this.skinWeights&&(t.skinWeights=this.skinWeights.clone()),this.skinIndices&&(t.skinIndices=this.skinIndices.clone()),this._normals&&(t._normals=this._normals.clone()),this._tangents&&(t._tangents=this._tangents.clone()),this._tangents1&&(t._tangents1=this._tangents1.clone()),this.positionDecodeMat&&(t.positionDecodeMat=this.positionDecodeMat),this.uvDecodeMat&&(t.uvDecodeMat=this.uvDecodeMat),this.uv1DecodeMat&&(t.uv1DecodeMat=this.uv1DecodeMat),this.normalDecodeMat&&(t.normalDecodeMat=this.normalDecodeMat),t},_aabbRaycast:function(t){var e=this.getLocalBounds(),n=t.intersectsBox([[e.xMin,e.yMin,e.zMin],[e.xMax,e.yMax,e.zMax]]);return n?[n]:null},_raycast:function(t,e){var n=this.vertices;if(!n)return null;var r,i=this.indices,o=[],s=[];r=i?i.realLength:n.realLength/3;for(var a=0;a<r;a+=3){var u=i?i.get(a):a;nu.copy(n.get(u)),u=i?i.get(a+1):a+1,ru.copy(n.get(u)),u=i?i.get(a+2):a+2,iu.copy(n.get(u));var c=void 0;e===$a?(o[0]=nu.elements,o[1]=ru.elements,o[2]=iu.elements,c=t.intersectsTriangle(o)):e===tu?(o[1]=nu.elements,o[0]=ru.elements,o[2]=iu.elements,c=t.intersectsTriangle(o)):e===eu&&(o[0]=nu.elements,o[1]=ru.elements,o[2]=iu.elements,(c=t.intersectsTriangle(o))||(o[1]=nu.elements,o[0]=ru.elements,o[2]=iu.elements,c=t.intersectsTriangle(o))),c&&s.push(c)}return s.length?s:null},raycast:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n=this.useAABBRaycast?this._aabbRaycast(t):this._raycast(t,e))&&r&&t.sortPoints(n),n},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.positionDecodeMat&&(t.QUANTIZED=1,t.POSITION_QUANTIZED=1),this.normalDecodeMat&&(t.QUANTIZED=1,t.NORMAL_QUANTIZED=1),this.uvDecodeMat&&(t.QUANTIZED=1,t.UV_QUANTIZED=1),this.uv1DecodeMat&&(t.QUANTIZED=1,t.UV1_QUANTIZED=1),this.colors&&(t.HAS_COLOR=1,t.COLOR_SIZE=this.colors.size),t},getShaderKey:function(){return void 0===this._shaderKey&&(this._shaderKey="geometry",this.isMorphGeometry?this._shaderKey+="_id_".concat(this.id):(this.colors&&(this._shaderKey+="_colors"),this.positionDecodeMat&&(this._shaderKey+="positionDecodeMat"))),this._shaderKey},getSize:function(){var t=0;for(var e in this)Zs(this,e)&&this[e]&&this[e].isGeometryData&&(t+=this[e].getByteLength());return t},destroy:function(){h.warn("Geometry.destroy has been deprecated, use mesh.destroy(renderer) instead.")}}),du=Ks.create({Extends:Va,isPerspectiveCamera:!0,className:"PerspectiveCamera",_near:.1,near:{get:function(){return this._near},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._near=t}},_far:null,far:{get:function(){return this._far},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._far=t}},_fov:50,fov:{get:function(){return this._fov},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._fov=t}},_aspect:1,aspect:{get:function(){return this._aspect},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._aspect=t}},constructor:function(t){du.superclass.constructor.call(this,t),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.projectionMatrix.elements,e=this.near,n=this.far,r=this.aspect,i=this.fov,o=1/Math.tan(.5*Ea.degToRad(i));if(t[0]=o/r,t[5]=o,t[11]=-1,t[15]=0,n){var s=1/(e-n);t[10]=(e+n)*s,t[14]=2*n*e*s}else t[10]=-1,t[14]=-2*e},getGeometry:function(t){if(t||!this._geometry||this._isGeometryDirty){this._isGeometryDirty=!1;var e=new fu,n=Math.tan(this.fov/2*Math.PI/180),r=this.near,i=this.far,o=r*n,s=i*n,a=this.aspect*o,u=this.aspect*s,c=[-a,-o,-r],h=[a,-o,-r],l=[a,o,-r],f=[-a,o,-r],d=[-u,-s,-i],p=[u,-s,-i],m=[u,s,-i],_=[-u,s,-i];e.addRect(d,p,m,_),e.addRect(p,h,l,m),e.addRect(h,c,f,l),e.addRect(c,d,_,f),e.addRect(_,m,l,f),e.addRect(c,h,p,d),this._geometry=e}return this._geometry}}),pu=du,mu=Ks.create({constructor:function(){this._cache={}},get:function(t){return this._cache[t]},getObject:function(t){return this._cache[t.__cacheId]},add:function(t,e){"object"==typeof e&&(e.__cacheId=t),this._cache[t]=e},remove:function(t){delete this._cache[t]},removeObject:function(t){delete this._cache[t.__cacheId]},removeAll:function(){this._cache={}},each:function(t){var e=this._cache;for(var n in e)t(e[n],n)}}),_u={instanced:void 0,vao:void 0,texFloat:void 0,loseContext:void 0,textureFilterAnisotropic:void 0,_usedExtensions:{},_disabledExtensions:{},init:function(t){this.reset(t)},reset:function(t){this.gl=t;var e=this._usedExtensions;for(var n in e){var r=e[n];this[r]=void 0,this.get(n,r)}},use:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.gl?this.get(t,e):this._usedExtensions[t]=e},get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(this._disabledExtensions[t])return null;var n=this[e];return void 0===n&&(n=this._getExtension(t),this[e]=n),n},disable:function(t){this._disabledExtensions[t]=!0},enable:function(t){this._disabledExtensions[t]=!1},_getExtension:function(t){var e=this.gl;return e&&e.getExtension&&(e.getExtension(t)||e.getExtension("WEBKIT_"+t)||e.getExtension("MOZ_"+t))||null}};_u.use("ANGLE_instanced_arrays","instanced"),_u.use("OES_vertex_array_object","vao"),_u.use("OES_texture_float","texFloat"),_u.use("WEBGL_lose_context","loseContext"),_u.use("OES_element_index_uint","uintIndices"),_u.use("EXT_shader_texture_lod","shaderTextureLod"),_u.use("EXT_texture_filter_anisotropic","textureFilterAnisotropic");var gu=_u,vu={MAX_TEXTURE_INDEX:null,MAX_PRECISION:null,MAX_VERTEX_PRECISION:null,MAX_FRAGMENT_PRECISION:null,VERTEX_TEXTURE_FLOAT:null,FRAGMENT_TEXTURE_FLOAT:null,MAX_TEXTURE_MAX_ANISOTROPY:1,MAX_RENDERBUFFER_SIZE:void 0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:void 0,MAX_CUBE_MAP_TEXTURE_SIZE:void 0,MAX_FRAGMENT_UNIFORM_VECTORS:void 0,MAX_TEXTURE_IMAGE_UNITS:void 0,MAX_TEXTURE_SIZE:void 0,MAX_VARYING_VECTORS:void 0,MAX_VERTEX_ATTRIBS:void 0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:void 0,MAX_VERTEX_UNIFORM_VECTORS:void 0,init:function(t){var e=this;this.gl=t,["MAX_RENDERBUFFER_SIZE","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_SIZE","MAX_VARYING_VECTORS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_VERTEX_UNIFORM_VECTORS"].forEach((function(t){e.get(t)})),this.MAX_TEXTURE_INDEX=this.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,this.MAX_VERTEX_PRECISION=this._getMaxSupportPrecision(t.VERTEX_SHADER),this.MAX_FRAGMENT_PRECISION=this._getMaxSupportPrecision(t.FRAGMENT_SHADER),this.MAX_PRECISION=this.getMaxPrecision(this.MAX_FRAGMENT_PRECISION,this.MAX_VERTEX_PRECISION),this.VERTEX_TEXTURE_FLOAT=!!gu.texFloat&&this.MAX_VERTEX_TEXTURE_IMAGE_UNITS>0,this.FRAGMENT_TEXTURE_FLOAT=!!gu.texFloat,this.EXT_FRAG_DEPTH=gu.get("EXT_frag_depth"),this.SHADER_TEXTURE_LOD=!!gu.shaderTextureLod,gu.textureFilterAnisotropic&&(this.MAX_TEXTURE_MAX_ANISOTROPY=t.getParameter(gu.textureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))},get:function(t){var e=this.gl,n=this[t];return void 0===n&&(n=this[t]=e.getParameter(e[t])),n},_getMaxSupportPrecision:function(t){var e=this.gl,n="lowp";if(e.getShaderPrecisionFormat)for(var r=[{name:"highp",type:e.HIGH_FLOAT},{name:"mediump",type:e.MEDIUM_FLOAT}],i=0;i<r.length;i++){var o=r[i];if((e.getShaderPrecisionFormat(t,o.type)||{}).precision>0){n=o.name;break}}else n="mediump";return n},getMaxPrecision:function(t,e){return"highp"===t||"mediump"===t&&"lowp"===e?e:t}},yu=n("./src/shader/basic.frag"),Eu=n.n(yu),Tu=n("./src/shader/basic.vert"),Au=n.n(Tu),Su=n("./src/shader/geometry.frag"),Mu=n.n(Su),Ou=n("./src/shader/pbr.frag"),bu=n.n(Ou),Lu=new mu,Iu=new mu,Ru=Ks.create({isShader:!0,className:"Shader",vs:"",fs:"",Statics:{commonOptions:{},shaders:{"chunk/baseDefine.glsl":n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl"),"chunk/color.frag":n(/*! ./chunk/color.frag */"./src/shader/chunk/color.frag"),"chunk/color.vert":n(/*! ./chunk/color.vert */"./src/shader/chunk/color.vert"),"chunk/color_main.vert":n(/*! ./chunk/color_main.vert */"./src/shader/chunk/color_main.vert"),"chunk/diffuse.frag":n(/*! ./chunk/diffuse.frag */"./src/shader/chunk/diffuse.frag"),"chunk/diffuse_main.frag":n(/*! ./chunk/diffuse_main.frag */"./src/shader/chunk/diffuse_main.frag"),"chunk/extensions.frag":n(/*! ./chunk/extensions.frag */"./src/shader/chunk/extensions.frag"),"chunk/extensions.vert":n(/*! ./chunk/extensions.vert */"./src/shader/chunk/extensions.vert"),"chunk/fog.frag":n(/*! ./chunk/fog.frag */"./src/shader/chunk/fog.frag"),"chunk/fog_main.frag":n(/*! ./chunk/fog_main.frag */"./src/shader/chunk/fog_main.frag"),"chunk/frag_color.frag":n(/*! ./chunk/frag_color.frag */"./src/shader/chunk/frag_color.frag"),"chunk/joint.vert":n(/*! ./chunk/joint.vert */"./src/shader/chunk/joint.vert"),"chunk/joint_main.vert":n(/*! ./chunk/joint_main.vert */"./src/shader/chunk/joint_main.vert"),"chunk/light.frag":n(/*! ./chunk/light.frag */"./src/shader/chunk/light.frag"),"chunk/lightFog.frag":n(/*! ./chunk/lightFog.frag */"./src/shader/chunk/lightFog.frag"),"chunk/lightFog.vert":n(/*! ./chunk/lightFog.vert */"./src/shader/chunk/lightFog.vert"),"chunk/lightFog_main.frag":n(/*! ./chunk/lightFog_main.frag */"./src/shader/chunk/lightFog_main.frag"),"chunk/lightFog_main.vert":n(/*! ./chunk/lightFog_main.vert */"./src/shader/chunk/lightFog_main.vert"),"chunk/logDepth.frag":n(/*! ./chunk/logDepth.frag */"./src/shader/chunk/logDepth.frag"),"chunk/logDepth_main.frag":n(/*! ./chunk/logDepth_main.frag */"./src/shader/chunk/logDepth_main.frag"),"chunk/logDepth.vert":n(/*! ./chunk/logDepth.vert */"./src/shader/chunk/logDepth.vert"),"chunk/logDepth_main.vert":n(/*! ./chunk/logDepth_main.vert */"./src/shader/chunk/logDepth_main.vert"),"chunk/morph.vert":n(/*! ./chunk/morph.vert */"./src/shader/chunk/morph.vert"),"chunk/morph_main.vert":n(/*! ./chunk/morph_main.vert */"./src/shader/chunk/morph_main.vert"),"chunk/normal.frag":n(/*! ./chunk/normal.frag */"./src/shader/chunk/normal.frag"),"chunk/normal.vert":n(/*! ./chunk/normal.vert */"./src/shader/chunk/normal.vert"),"chunk/normal_main.frag":n(/*! ./chunk/normal_main.frag */"./src/shader/chunk/normal_main.frag"),"chunk/normal_main.vert":n(/*! ./chunk/normal_main.vert */"./src/shader/chunk/normal_main.vert"),"chunk/pbr.frag":n(/*! ./chunk/pbr.frag */"./src/shader/chunk/pbr.frag"),"chunk/pbr_main.frag":n(/*! ./chunk/pbr_main.frag */"./src/shader/chunk/pbr_main.frag"),"chunk/phong.frag":n(/*! ./chunk/phong.frag */"./src/shader/chunk/phong.frag"),"chunk/phong_main.frag":n(/*! ./chunk/phong_main.frag */"./src/shader/chunk/phong_main.frag"),"chunk/precision.frag":n(/*! ./chunk/precision.frag */"./src/shader/chunk/precision.frag"),"chunk/precision.vert":n(/*! ./chunk/precision.vert */"./src/shader/chunk/precision.vert"),"chunk/transparency.frag":n(/*! ./chunk/transparency.frag */"./src/shader/chunk/transparency.frag"),"chunk/transparency_main.frag":n(/*! ./chunk/transparency_main.frag */"./src/shader/chunk/transparency_main.frag"),"chunk/unQuantize.vert":n(/*! ./chunk/unQuantize.vert */"./src/shader/chunk/unQuantize.vert"),"chunk/unQuantize_main.vert":n(/*! ./chunk/unQuantize_main.vert */"./src/shader/chunk/unQuantize_main.vert"),"chunk/uv.frag":n(/*! ./chunk/uv.frag */"./src/shader/chunk/uv.frag"),"chunk/uv.vert":n(/*! ./chunk/uv.vert */"./src/shader/chunk/uv.vert"),"chunk/uv_main.vert":n(/*! ./chunk/uv_main.vert */"./src/shader/chunk/uv_main.vert"),"method/encoding.glsl":n(/*! ./method/encoding.glsl */"./src/shader/method/encoding.glsl"),"method/getDiffuse.glsl":n(/*! ./method/getDiffuse.glsl */"./src/shader/method/getDiffuse.glsl"),"method/getLightAttenuation.glsl":n(/*! ./method/getLightAttenuation.glsl */"./src/shader/method/getLightAttenuation.glsl"),"method/getShadow.glsl":n(/*! ./method/getShadow.glsl */"./src/shader/method/getShadow.glsl"),"method/getSpecular.glsl":n(/*! ./method/getSpecular.glsl */"./src/shader/method/getSpecular.glsl"),"method/packFloat.glsl":n(/*! ./method/packFloat.glsl */"./src/shader/method/packFloat.glsl"),"method/textureEnvMap.glsl":n(/*! ./method/textureEnvMap.glsl */"./src/shader/method/textureEnvMap.glsl"),"method/transpose.glsl":n(/*! ./method/transpose.glsl */"./src/shader/method/transpose.glsl"),"method/unpackFloat.glsl":n(/*! ./method/unpackFloat.glsl */"./src/shader/method/unpackFloat.glsl"),"basic.frag":n(/*! ./basic.frag */"./src/shader/basic.frag"),"basic.vert":n(/*! ./basic.vert */"./src/shader/basic.vert"),"geometry.frag":n(/*! ./geometry.frag */"./src/shader/geometry.frag"),"pbr.frag":n(/*! ./pbr.frag */"./src/shader/pbr.frag"),"screen.frag":n(/*! ./screen.frag */"./src/shader/screen.frag"),"screen.vert":n(/*! ./screen.vert */"./src/shader/screen.vert")},init:function(t){this.renderer=t,this.commonHeader=this._getCommonHeader(this.renderer)},cache:{get:function(){return Lu}},headerCache:{get:function(){return Iu}},reset:function(t){Lu.removeAll()},getHeaderKey:function(t,e,n,r,i){var o="header_"+e.id+"_"+n.lightInfo.uid;return t.isSkinedMesh&&(o+="_joint"+t.skeleton.jointCount),r&&(o+="_fog_"+r.mode),o+="_"+t.geometry.getShaderKey(),i&&(o+="_fogDepth"),o},getHeader:function(t,e,n,r,i){var o=this.getHeaderKey(t,e,n,r),s=Iu.get(o);if(!s||e.isDirty){var a={};Object.assign(a,this.commonOptions);var u=e.lightType;u&&"NONE"!==u&&n.getRenderOption(a),e.getRenderOption(a),t.getRenderOption(a),r&&(a.HAS_FOG=1,r.getRenderOption(a)),i&&(a.USE_LOG_DEPTH=1,vu.EXT_FRAG_DEPTH&&(a.USE_EXT_FRAG_DEPTH=1)),a.HAS_NORMAL&&a.NORMAL_MAP&&(a.HAS_TANGENT=1),a.RECEIVE_SHADOWS||(delete a.DIRECTIONAL_LIGHTS_SMC,delete a.SPOT_LIGHTS_SMC,delete a.POINT_LIGHTS_SMC),s="#define SHADER_NAME ".concat(e.shaderName||e.className,"\n"),s+=Object.keys(a).map((function(t){return t.indexOf("HILO_CUSTUM_OPTION_")>-1?"#define ".concat(t.replace("HILO_CUSTUM_OPTION_","")," ").concat(a[t]):"#define HILO_".concat(t," ").concat(a[t])})).join("\n")+"\n",Iu.add(o,s)}return s},_getCommonHeader:function(t){var e=vu.getMaxPrecision(vu.MAX_VERTEX_PRECISION,t.vertexPrecision),n=vu.getMaxPrecision(vu.MAX_FRAGMENT_PRECISION,t.fragmentPrecision),r=vu.getMaxPrecision(e,n);return"\n#define HILO_MAX_PRECISION ".concat(r,"\n#define HILO_MAX_VERTEX_PRECISION ").concat(e,"\n#define HILO_MAX_FRAGMENT_PRECISION ").concat(n,"\n")},getShader:function(t,e,n,r,i,o){var s=this.getHeader(t,e,r,i,o);return e.isBasicMaterial||e.isPBRMaterial?this.getBasicShader(e,n,s):e.isShaderMaterial?this.getCustomShader(e.vs,e.fs,s,e.shaderCacheId||e.id,e.useHeaderCache):null},getBasicShader:function(t,e,n){var r="";e&&(r=(r=t.getInstancedUniforms().map((function(t){return t.name}))).join("|"));var i=t.className+":"+r;t.onBeforeCompile&&(i+=":"+(t.shaderCacheId||t.id));var o=Lu.get(i);if(!o){var s="",a=Au.a;if(t.isBasicMaterial?t.isGeometryMaterial?s+=Mu.a:s+=Eu.a:t.isPBRMaterial&&(s+=bu.a),t.onBeforeCompile){var u=t.onBeforeCompile(a,s);s=u.fs,a=u.vs}if(r){var c=new RegExp("^\\s*uniform\\s+(\\w+)\\s+(".concat(r,");"),"gm");a=a.replace(c,"attribute $1 $2;")}o=this.getCustomShader(a,s,n,i,!0)}if(o){var h=this._getNumId(o);null!==h&&(t._shaderNumId=h)}return o},_getNumId:function(t){var e=t.id.match(/_(\d+)/);return e&&e[1]?parseInt(e[1],10):null},getCustomShader:function(t,e,n,r,i){var o,s=this.commonHeader;return r&&(i&&(r+=":"+n),o=Lu.get(r)),o||(o=new Ru({vs:s+n+t,fs:s+n+e}),r&&Lu.add(r,o)),o}},alwaysUse:!1,constructor:function(t){this.id=Ea.generateUUID(this.className),Object.assign(this,t)},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){return this._isDestroyed||(Lu.removeObject(this),this._isDestroyed=!0),this}}),Cu=Ru,xu=n("./src/shader/screen.vert"),wu=n.n(xu),Nu=n("./src/shader/screen.frag"),Pu=n.n(Nu),Du=[{name:"FLOAT",byteSize:4,uniformFuncName:"uniform1f",type:"Scalar",size:1},{name:"FLOAT_VEC2",byteSize:8,uniformFuncName:"uniform2f",type:"Vector",size:2},{name:"FLOAT_VEC3",byteSize:12,uniformFuncName:"uniform3f",type:"Vector",size:3},{name:"FLOAT_VEC4",byteSize:16,uniformFuncName:"uniform4f",type:"Vector",size:4},{name:"FLOAT_MAT2",byteSize:16,uniformFuncName:"uniformMatrix2fv",type:"Matrix",size:4},{name:"FLOAT_MAT3",byteSize:36,uniformFuncName:"uniformMatrix3fv",type:"Matrix",size:9},{name:"FLOAT_MAT4",byteSize:64,uniformFuncName:"uniformMatrix4fv",type:"Matrix",size:16},{name:"INT",byteSize:4,uniformFuncName:"uniform1i",type:"Scalar",size:1},{name:"INT_VEC2",byteSize:8,uniformFuncName:"uniform2i",type:"Vector",size:2},{name:"INT_VEC3",byteSize:12,uniformFuncName:"uniform3i",type:"Vector",size:3},{name:"INT_VEC4",byteSize:16,uniformFuncName:"uniform4i",type:"Vector",size:4},{name:"BOOL",byteSize:4,uniformFuncName:"uniform1i",type:"Scalar",size:1},{name:"BOOL_VEC2",byteSize:8,uniformFuncName:"uniform2i",type:"Vector",size:2},{name:"BOOL_VEC3",byteSize:12,uniformFuncName:"uniform3i",type:"Vector",size:3},{name:"BOOL_VEC4",byteSize:16,uniformFuncName:"uniform4i",type:"Vector",size:4},{name:"SAMPLER_2D",byteSize:4,uniformFuncName:"uniform1i",type:"Scalar",size:1},{name:"SAMPLER_CUBE",byteSize:4,uniformFuncName:"uniform1i",type:"Scalar",size:1}],Hu={},Fu={dict:Hu,init:function(t){Du.forEach((function(e){var n,r,i=e.name,o=e.uniformFuncName,s=o+"v";"Matrix"===e.type?n=r=function(e,n){void 0!==n&&t[o](e,!1,n)}:(n=function(e,n){void 0!==n&&t[o](e,n)},r=function(e,n){t[s](e,n)}),Hu[t[i]]=Object.assign(e,{glValue:t[i],uniform:n,uniformArray:r})}))},get:function(t){return Hu[t]}},Uu=new mu,Bu=Ks.create({Statics:{cache:{get:function(){return Uu}},reset:function(t){Uu.each((function(t){t.destroy()}))},getProgram:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.id,i=Uu.get(r);return i||(i=new Bu({state:e,vertexShader:t.vs,fragShader:t.fs,ignoreError:n}),Uu.add(r,i)),i},getBlankProgram:function(t){var e=Cu.getCustomShader("void main(){}","precision HILO_MAX_FRAGMENT_PRECISION float;void main(){gl_FragColor = vec4(0.0);}","","__hiloBlankShader");return this.getProgram(e,t,!0)}},className:"Program",isProgram:!0,fragShader:"",vertexShader:"",attributes:null,uniforms:null,program:null,gl:null,state:null,alwaysUse:!1,constructor:function(t){return this.id=Ea.generateUUID(this.className),Object.assign(this,t),this._dict={},this.attributes={},this.uniforms={},this.gl=this.state.gl,this.program=this.createProgram(),this.program?(this.initAttributes(),this.initUniforms(),this):this.ignoreError?this:Bu.getBlankProgram(t.state)},createProgram:function(){var t=this.gl,e=t.createProgram(),n=this.createShader(t.VERTEX_SHADER,this.vertexShader),r=this.createShader(t.FRAGMENT_SHADER,this.fragShader);if(n&&r){if(t.attachShader(e,n),t.attachShader(e,r),t.linkProgram(e),t.deleteShader(n),t.deleteShader(r),!t.getProgramParameter(e,t.LINK_STATUS)){var i=t.getProgramInfoLog(e);return h.error("compileProgramError: "+i,this),t.deleteProgram(e),null}return e}return null},useProgram:function(){this.state.useProgram(this.program)},createShader:function(t,e){var n=this.gl,r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var i=n.getShaderInfoLog(r);return h.error("compileShaderError: "+i,e.split("\n").map((function(t,e){return"".concat(e+1," ").concat(t)})).join("\n")),null}return r},initAttributes:function(){for(var t=this,e=this.gl,n=this.program,r=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),i=gu.instanced,o=function(r){var o=e.getActiveAttrib(n,r),s=o.name,a=o.type,u=o.size,c=e.getAttribLocation(n,s),h=Fu.get(a),l=function(t){var n=t.type,r=void 0===n?e.FLOAT:n,i=t.normalized,o=void 0!==i&&i,s=t.stride,a=void 0===s?0:s,u=t.offset,l=void 0===u?0:u,f=t.size,d=void 0===f?h.size:f;e.vertexAttribPointer(c,d,r,o,a,l)},f=function(){e.enableVertexAttribArray(c)},d=function(){},p=function(t,e){t[c]=e};if(i&&(d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;i.vertexAttribDivisorANGLE(c,t)}),"Matrix"===h.type){var m=h.byteSize,_=h.size,g=Math.sqrt(_),v=4*g,y=function(t){for(var e=0;e<g;e++)t(c+e,e)};l=function(t){var n,r=t.type,i=void 0===r?e.FLOAT:r,o=t.normalized,s=void 0!==o&&o,a=t.stride,u=void 0===a?0:a,c=t.offset,h=void 0===c?0:c;n=0===u?m:u,y((function(t,r){e.vertexAttribPointer(t,g,i,s,n,h+v*r)}))},f=function(){y((function(t){e.enableVertexAttribArray(t)}))},p=function(t,e){y((function(n){t[n]=e}))},i&&(d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;y((function(e){i.vertexAttribDivisorANGLE(e,t)}))})}t.attributes[s]={name:s,location:c,type:a,size:u,glTypeInfo:h,pointer:l,enable:f,divisor:d,addTo:p}},s=0;s<r;s++)o(s)},initUniforms:function(){for(var t=this,e=this.gl,n=this.program,r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),i=0,o=function(r){var o=e.getActiveUniform(n,r),s=o.name,a=o.size,u=o.type;s=s.replace(/\[0\]$/,"");var c=e.getUniformLocation(n,s),h=Fu.get(u),l=h.uniformArray,f=h.uniform;t.uniforms[s]={name:s,location:c,type:u,size:a,glTypeInfo:h},u!==e.SAMPLER_2D&&u!==e.SAMPLER_CUBE||(t.uniforms[s].textureIndex=i,i+=a),Object.defineProperty(t,s,{set:h.size>1||a>1?function(t){l(c,t)}:function(e){t._dict[s]!==e&&(t._dict[s]=e,f(c,e))}})},s=0;s<r;s++)o(s)},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){return this._isDestroyed||(this.gl.deleteProgram(this.program),this.uniforms=null,this.attributes=null,this.program=null,this.gl=null,this.state=null,this._dict=null,Uu.removeObject(this),this._isDestroyed=!0),this}}),Gu=Bu,ku=Ss.ARRAY_BUFFER,ju=Ss.ELEMENT_ARRAY_BUFFER,Vu=Ss.STATIC_DRAW,Xu=new mu,Wu=Ks.create({Statics:{cache:{get:function(){return Xu}},reset:function(t){Xu.each((function(t){t.destroy()}))},createVertexBuffer:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vu;return this.createBuffer(t,ku,e,n)},createBuffer:function(t,e,n,r){var i=n.bufferViewId,o=Xu.get(i);return o||(n.isDirty=!1,o=new Wu(t,e,n.data,r),Xu.add(i,o),o)},createIndexBuffer:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vu;return this.createBuffer(t,ju,e,n)}},className:"Buffer",isBuffer:!0,constructor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ku,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vu;this.id=Ea.generateUUID(this.className),this.gl=t,this.target=e,this.usage=r,this.buffer=t.createBuffer(),n&&this.bufferData(n)},bind:function(){return this.gl.bindBuffer(this.target,this.buffer),this},bufferData:function(t){var e=this.gl,n=this.target,r=this.usage;return this.bind(),e.bufferData(n,t,r),this.data=t,this},bufferSubData:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.gl,i=this.target;return n||this.bind(),r.bufferSubData(i,t,e),this},uploadGeometryData:function(t){var e=this,n=t.subDataList;return!this.data||this.data.byteLength<t.data.byteLength||!0===t._isAllDirty?this.bufferData(t.data):n&&n.length?(this.bind(),n.forEach((function(t){e.bufferSubData(t.byteOffset,t.data,!0)}))):this.bufferData(t.data),t.isDirty=!1,this},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){return this._isDestroyed||(this.gl.deleteBuffer(this.buffer),this.data=null,Xu.removeObject(this),this._isDestroyed=!0),this}}),zu=Wu,qu=new ArrayBuffer(1),Yu={getTypedArray:function(t,e){return this._updateBuffer(e*t.BYTES_PER_ELEMENT),new t(qu,0,e)},fillArrayData:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=e.length;r<i;r++)t[n+r]=e[r]},_updateBuffer:function(t){qu.byteLength<t&&(qu=new ArrayBuffer(2*t))}},Ju=Ss.TRIANGLES,Qu=[],Zu=null,Ku=new mu,$u=Ks.create({Statics:{cache:{get:function(){return Ku}},getVao:function(t,e,n){var r=Ku.get(e);return r?n.mode&&n.mode!==r.mode&&(r.mode=n.mode):(r=new $u(t,e,n),Ku.add(e,r)),r},reset:function(t){Zu=null,Qu=[],this.bindSystemVao(),Ku.each((function(e){e.destroy(t)}))},bindSystemVao:function(){gu.vao&&gu.vao.bindVertexArrayOES(null),Zu=null}},className:"VertexArrayObject",isVertexArrayObject:!0,vertexCount:null,useVao:!1,useInstanced:!1,mode:Ju,isDirty:!0,constructor:function(t,e,n){this.gl=t,this.id=e,this.vaoExtension=gu.vao,this.instancedExtension=gu.instanced,Object.assign(this,n),this.vaoExtension||(this.useVao=!1),this.instancedExtension||(this.useInstanced=!1),this.useVao&&(this.vao=this.vaoExtension.createVertexArrayOES()),this.attributes=[],this.activeStates=[],this.indexBuffer=null},bind:function(){Zu!==this&&(this.useVao?this.vaoExtension.bindVertexArrayOES(this.vao):this.bindSystemVao(),Zu=this)},bindSystemVao:function(){var t=this.gl;Zu&&Zu.useVao&&Zu.unbind();var e,n=this.activeStates;this.attributes.forEach((function(t){var n=t.buffer,r=t.attribute,i=t.geometryData;e!==n&&(e=n,n.bind()),r.enable(),r.pointer(i),t.useInstanced?r.divisor(1):r.divisor(0)})),Qu.forEach((function(e,r){var i=n[r];e&&!i&&(e.attribute.divisor(0),t.disableVertexAttribArray(r))})),this.indexBuffer&&this.indexBuffer.bind(),Qu=n},unbind:function(){this.useVao&&this.vaoExtension.bindVertexArrayOES(null),Zu=null},draw:function(){this.bind();var t=this.gl,e=this.mode;this.indexBuffer?t.drawElements(e,this.vertexCount,this.indexType,0):t.drawArrays(e,0,this.getVertexCount())},getVertexCount:function(){if(null===this.vertexCount){var t=this.attributes[0];this.vertexCount=t?t.geometryData.count:0}return this.vertexCount},drawInstance:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.bind();var e=this.gl,n=this.mode;this.useInstanced&&(this.indexBuffer?this.instancedExtension.drawElementsInstancedANGLE(n,this.vertexCount,e.UNSIGNED_SHORT,0,t):this.instancedExtension.drawArraysInstancedANGLE(n,0,this.getVertexCount(),t))},addIndexBuffer:function(t,e){this.bind();var n=this.gl,r=this.indexBuffer;return this.indexType=t.type,r?t.isDirty&&(r.uploadGeometryData(t),this.vertexCount=t.length):((r=zu.createIndexBuffer(n,t,e)).bind(),this.indexBuffer=r,this.vertexCount=t.length),r},addAttribute:function(t,e,n,r){this.bind();var i=this.gl,o=e.name,s=this[o];if(!s){var a=zu.createVertexBuffer(i,t,n);a.bind(),e.enable(),e.pointer(t),s={attribute:e,buffer:a,geometryData:t},this.attributes.push(s),this[o]=s,e.addTo(this.activeStates,s),r&&r(s)}if(t.isDirty){var u=s.buffer;u.bind(),e.enable(),e.pointer(t),u.uploadGeometryData(t)}return s},addInstancedAttribute:function(t,e,n){this.bind();var r=this.gl,i=t.name,o=t.glTypeInfo,s=Yu.getTypedArray(Float32Array,e.length*o.size);e.forEach((function(t,e){void 0!==n(t)?Yu.fillArrayData(s,n(t),e*o.size):h.warn("no attributeData:"+i+"-"+t.name)}));var a,u=this[i];return u?(a=u.geometryData).data=s:a=new Qa(s,1),this.addAttribute(a,t,r.DYNAMIC_DRAW,(function(e){t.divisor(1),e.useInstanced=!0}))},getResources:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.attributes&&this.attributes.forEach((function(e){t.push(e.buffer)})),this.indexBuffer&&t.push(this.indexBuffer),t},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){var t=this;return this._isDestroyed||(this.instancedExtension=null,this.useVao&&(this.vaoExtension.deleteVertexArrayOES(this.vao),this.vao=null,this.vaoExtension=null),this.gl=null,this.indexBuffer=null,this.attributes.forEach((function(e){var n=e.attribute||{};t[n.name]=null})),this.attributes=null,this.activeStates=null,Ku.removeObject(this),this._isDestroyed=!0),this}}),tc=$u,ec=Ss.TEXTURE_2D,nc=Ss.RGBA,rc=Ss.LINEAR,ic=Ss.NEAREST,oc=Ss.REPEAT,sc=Ss.CLAMP_TO_EDGE,ac=Ss.UNSIGNED_BYTE,uc=Ss.UNPACK_PREMULTIPLY_ALPHA_WEBGL,cc=Ss.UNPACK_FLIP_Y_WEBGL,hc=Ss.UNPACK_COLORSPACE_CONVERSION_WEBGL,lc=Ss.BROWSER_DEFAULT_WEBGL,fc=Ss.NONE,dc=new mu,pc=Ks.create({Statics:{cache:{get:function(){return dc}},reset:function(t){dc.each((function(e,n){t.deleteTexture(e),dc.remove(n)}))}},isTexture:!0,className:"Texture",isImageCanRelease:!1,_isImageReleased:!1,_image:null,image:{get:function(){return this._isImageReleased&&h.errorOnce("Read Texture.image(".concat(this.id,")"),"Read Texture.image after image released!"),this._image},set:function(t){this._image=t,this._isImageReleased=!1}},_releaseImage:function(){this._canvasImage=null,this._canvasCtx=null,this._originImage=null,this._image=null,this.mipmaps=null,this._isImageReleased=!0},mipmaps:null,target:ec,internalFormat:nc,format:nc,type:ac,width:0,height:0,border:0,magFilter:rc,minFilter:rc,wrapS:oc,wrapT:oc,name:"",premultiplyAlpha:!1,flipY:!1,colorSpaceConversion:!0,compressed:!1,needUpdate:!0,needDestroy:!1,autoUpdate:!1,uv:0,anisotropic:1,origWidth:{get:function(){return this._originImage?this._originImage.width||this.width:this.image&&this.image.width||this.width}},origHeight:{get:function(){return this.originImage?this._originImage.height||this.height:this.image&&this.image.height||this.height}},useMipmap:{get:function(){return this.minFilter!==rc&&this.minFilter!==ic},set:function(){h.warn("texture.useMipmap is readOnly!")}},useRepeat:{get:function(){return this.wrapS!==sc||this.wrapT!==sc},set:function(){h.warn("texture.useRepeat is readOnly!")}},mipmapCount:{get:function(){return Math.floor(Math.log2(Math.max(this.width,this.height))+1)},set:function(){h.warn("texture.mipmapCount is readOnly!")}},constructor:function(t){this.id=Ea.generateUUID(this.className),Object.assign(this,t)},isImgPowerOfTwo:function(t){return Ea.isPowerOfTwo(t.width)&&Ea.isPowerOfTwo(t.height)},getSupportSize:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.width,r=t.height;e&&!this.isImgPowerOfTwo(t)&&(n=Ea.nextPowerOfTwo(n),r=Ea.nextPowerOfTwo(r));var i=vu.MAX_TEXTURE_SIZE;return i&&(n>i&&(n=i),r>i&&(r=i)),{width:n,height:r}},resizeImgToPowerOfTwo:function(t){var e=this.getSupportSize(t,!0);return this.resizeImg(t,e.width,e.height)},resizeImg:function(t,e,n){if(t.width===e&&t.height===n)return t;var r=this._canvasImage;return r?(r.width=e,r.height=n,this._canvasCtx=r.getContext("2d")):((r=document.createElement("canvas")).width=e,r.height=n,this._canvasImage=r,this._canvasCtx=r.getContext("2d")),this._canvasCtx.drawImage(t,0,0,t.width,t.height,0,0,e,n),h.warnOnce("Texture.resizeImg(".concat(this.id,")"),"image size(".concat(t.width,"x").concat(t.height,") is not support. Resized to ").concat(r.width,"x").concat(r.height),t.src),this._originImage=t,r},_glUploadTexture:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.width,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.height,s=t.gl;return this.compressed?s.compressedTexImage2D(e,r,this.internalFormat,i,o,this.border,n):n&&void 0!==n.width?s.texImage2D(e,r,this.internalFormat,this.format,this.type,n):s.texImage2D(e,r,this.internalFormat,i,o,this.border,this.format,this.type,n),this},_uploadTexture:function(t){var e=this;return this.useMipmap&&this.mipmaps?this.mipmaps.forEach((function(n,r){e._glUploadTexture(t,e.target,n.data,r,n.width,n.height)})):this._glUploadTexture(t,this.target,this.image,0),this},_updatePixelStorei:function(){var t=this.state;t.pixelStorei(uc,this.premultiplyAlpha),t.pixelStorei(cc,!!this.flipY),t.pixelStorei(hc,this.colorSpaceConversion?lc:fc)},updateTexture:function(t,e){var n=t.gl;if(this.needUpdate||this.autoUpdate){this._originImage&&this.image===this._canvasImage&&(this.image=this._originImage);var r=this.useMipmap,i=this.useRepeat;if(this.image&&!this.image.length){var o=i||r,s=this.getSupportSize(this.image,o);this.image=this.resizeImg(this.image,s.width,s.height),this.width=this.image.width,this.height=this.image.height}t.activeTexture(n.TEXTURE0+vu.MAX_TEXTURE_INDEX),t.bindTexture(this.target,e),this._updatePixelStorei(),this._uploadTexture(t),r&&(this.compressed?this.mipmaps||(h.warn("Compressed texture has no mipmips, changed the minFilter from ".concat(this.minFilter," to Linear!"),this),this.minFilter=rc):n.generateMipmap(this.target)),n.texParameterf(this.target,n.TEXTURE_MAG_FILTER,this.magFilter),n.texParameterf(this.target,n.TEXTURE_MIN_FILTER,this.minFilter),n.texParameterf(this.target,n.TEXTURE_WRAP_S,this.wrapS),n.texParameterf(this.target,n.TEXTURE_WRAP_T,this.wrapT);var a=gu.textureFilterAnisotropic;a&&this.anisotropic>1&&n.texParameterf(this.target,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(this.anisotropic,vu.MAX_TEXTURE_MAX_ANISOTROPY)),this.needUpdate=!1}return this._needUpdateSubTexture&&(this._uploadSubTextures(t,e),this._needUpdateSubTexture=!1),this},_uploadSubTextures:function(t,e){var n=this;if(this._subTextureList&&this._subTextureList.length>0){var r=t.gl;t.activeTexture(r.TEXTURE0+vu.MAX_TEXTURE_INDEX),t.bindTexture(this.target,e),this._updatePixelStorei(),this._subTextureList.forEach((function(t){var e=t[0],i=t[1],o=t[2];r.texSubImage2D(n.target,0,e,i,n.format,n.type,o)})),this._subTextureList.length=0}},_needUpdateSubTexture:!1,_subTextureList:null,updateSubTexture:function(t,e,n){this._subTextureList||(this._subTextureList=[]),this._subTextureList.push([t,e,n]),this._needUpdateSubTexture=!0},getGLTexture:function(t){this.state=t;var e=this.gl=t.gl,n=this.id;this.needDestroy&&(this.destroy(),this.needDestroy=!1);var r=dc.get(n);return r||(r=e.createTexture(),dc.add(n,r),this.needUpdate=!0),this.updateTexture(t,r),this.isImageCanRelease&&this._releaseImage(),r},setGLTexture:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&this.destroy(),dc.add(this.id,t),this},destroy:function(){var t=this.id,e=dc.get(t);return e&&this.gl&&(this.gl.deleteTexture(e),dc.remove(t)),this},clone:function(){var t=Object.assign({},this);return delete t.id,new this.constructor(t)}}),mc=Ss.TEXTURE_2D,_c=Ss.RGBA,gc=Ss.UNSIGNED_BYTE,vc=Ss.COLOR_ATTACHMENT0,yc=Ss.DEPTH_STENCIL,Ec=Ss.DEPTH_TEST,Tc=Ss.CULL_FACE,Ac=Ss.TRIANGLE_STRIP,Sc=Ss.NEAREST,Mc=Ss.CLAMP_TO_EDGE,Oc=new mu,bc=Ks.create({Statics:{cache:{get:function(){return Oc}},reset:function(t){Oc.each((function(t){t.reset()}))},destroy:function(t){Oc.each((function(t){t.destroy()}))}},className:"Framebuffer",isFramebuffer:!0,bufferInternalFormat:yc,target:mc,format:_c,internalFormat:_c,type:gc,minFilter:Sc,magFilter:Sc,wrapS:Mc,wrapT:Mc,data:null,attachment:vc,needRenderbuffer:!0,useVao:!0,renderer:null,texture:null,renderbuffer:null,framebuffer:null,_isInit:!1,constructor:function(t,e){this.id=Ea.generateUUID(this.className),this.renderer=t,Object.assign(this,e),this.width||(this.width=t.width),this.height||(this.height=t.height),Oc.add(this.id,this)},init:function(){if(!this._isInit&&this.renderer.isInit){this._isInit=!0;var t=this.renderer;this.gl=t.gl,this.state=t.state,this.reset()}},reset:function(){this.destroyResource();var t=this.gl;this.framebuffer=t.createFramebuffer(),this.bind(),this.needRenderbuffer&&(this.renderbuffer=this.createRenderbuffer()),this.texture=this.createTexture(),this.isComplete()||h.warn("Framebuffer is not complete => "+t.checkFramebufferStatus(t.FRAMEBUFFER)),this.unbind()},isComplete:function(){var t=this.gl;return!(!t||t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE)},bind:function(){this.init(),this._isInit&&this.state.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer)},unbind:function(){if(this.init(),this._isInit){var t=this.state;t.bindFramebuffer(this.gl.FRAMEBUFFER,t.preFramebuffer)}},clear:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Da(0,0,0,0);if(this._isInit){var e=this.gl;e.clearColor(t.r,t.g,t.b,t.a),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},render:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0;if(this._isInit){var o=this.gl,s=this.state;s.disable(Ec),s.disable(Tc),i&&this.clear(i);var a=Cu.getCustomShader(wu.a,Pu.a,"","FramebufferTextureShader"),u=Gu.getProgram(a,s);u.useProgram();var c="".concat(t,"_").concat(e,"_").concat(n,"_").concat(r,"_").concat(u.id),h=tc.getVao(o,c,{useVao:this.useVao,useInstanced:!1,mode:Ac});if(h.isDirty){h.isDirty=!1;var l=[t=2*t-1,e=1-2*e,t+(n*=2),e,t,e-(r*=2),t+n,e-r];h.addAttribute(new Qa(new Float32Array(l),2),u.attributes.a_position),h.addAttribute(new Qa(new Float32Array([0,1,1,1,0,0,1,0]),2),u.attributes.a_texcoord0)}s.activeTexture(o.TEXTURE0),s.bindTexture(o.TEXTURE_2D,this.texture.getGLTexture(s)),h.draw()}},createRenderbuffer:function(){var t=this.gl,e=this.width,n=this.height,r=t.createRenderbuffer();return t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e,n),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r),r},createTexture:function(){var t=this.state,e=t.gl,n=new pc({minFilter:this.minFilter,magFilter:this.magFilter,internalFormat:this.internalFormat,format:this.format,type:this.type,width:this.width,height:this.height,image:this.data,wrapS:this.wrapS,wrapT:this.wrapT}),r=n.getGLTexture(t);return e.framebufferTexture2D(e.FRAMEBUFFER,this.attachment,this.target,r,0),n},resize:function(t,e,n){(n||this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this._isInit&&this.reset())},readPixels:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=js(this.type),o=new i(n*r*4);if(this._isInit){var s=this.gl;e=this.height-e-r,this.bind(),s.readPixels(t,e,n,r,this.format,this.type,o),this.unbind()}return o},destroy:function(){return this._isDestroyed||(this.destroyResource(),this.gl=null,Oc.removeObject(this),this._isDestroyed=!0),this},destroyResource:function(){var t=this.gl;t&&(this.framebuffer&&(t.deleteFramebuffer(this.framebuffer),this.framebuffer=null),this.renderbuffer&&(t.deleteRenderbuffer(this.renderbuffer),this.renderbuffer=null),this.texture&&(this.texture.destroy(),this.texture=null))}}),Lc=Ss.TEXTURE_CUBE_MAP,Ic=Ss.RGB,Rc=Ss.LINEAR,Cc=Ss.CLAMP_TO_EDGE,xc=Ss.TEXTURE_CUBE_MAP_POSITIVE_X,wc=Ks.create({Extends:pc,isCubeTexture:!0,className:"CubeTexture",target:Lc,internalFormat:Ic,format:Ic,magFilter:Rc,minFilter:Rc,wrapS:Cc,wrapT:Cc,constructor:function(t){wc.superclass.constructor.call(this,t),this.image=this.image||[]},_uploadTexture:function(t){var e=this,n=this.image;Array.isArray(n)&&6===n.length?(n[0]&&n[0].width&&(this.width=n[0].width,this.height=n[0].height),n.forEach((function(n,r){e._glUploadTexture(t,xc+r,n,0)}))):h.error("CubeTexture image must be an Array of length 6",n)},right:{get:function(){return this.image[0]},set:function(t){this.image[0]=t}},left:{get:function(){return this.image[1]},set:function(t){this.image[1]=t}},top:{get:function(){return this.image[2]},set:function(t){this.image[2]=t}},bottom:{get:function(){return this.image[3]},set:function(t){this.image[3]=t}},front:{get:function(){return this.image[4]},set:function(t){this.image[4]=t}},back:{get:function(){return this.image[5]},set:function(t){this.image[5]=t}}}),Nc=wc,Pc=Ss.TEXTURE_2D,Dc=Ss.RGBA,Hc=Ss.NEAREST,Fc=Ss.CLAMP_TO_EDGE,Uc=Ss.FLOAT,Bc=Ks.create({Extends:pc,isDataTexture:!0,className:"DataTexture",target:Pc,internalFormat:Dc,format:Dc,type:Uc,magFilter:Hc,minFilter:Hc,wrapS:Fc,wrapT:Fc,dataLength:0,resetSize:function(t){if(t!==this.dataLength){this.dataLength=t;var e=Ea.nextPowerOfTwo(t/4),n=Math.max(Math.log2(e),4),r=Math.floor(n/2),i=n-r;this.width=Math.pow(2,r),this.height=Math.pow(2,i),this.DataClass=js(this.type)}},data:{get:function(){return this.image},set:function(t){if(this.image!==t){this.resetSize(t.length);var e=this.width*this.height*4;e===t.length&&t instanceof this.DataClass?this.image=t:(this.image&&this.image.length===e||(this.image=new this.DataClass(e)),this.image.set(t,0)),this.needUpdate=!0}}},constructor:function(t){Bc.superclass.constructor.call(this,t)}}),Gc=Bc;function kc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return jc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jc(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Vc,Xc,Wc,zc,qc,Yc,Jc,Qc=new ra,Zc=new oa,Kc=new ma,$c=new Float32Array([.5,.5,.5,1]),th=new Float32Array([0,0]),eh={state:null,camera:null,lightManager:null,fog:null,gl:null,renderer:null,blankInfo:{get:function(){}},init:function(t,e,n,r,i){Yc=this._renderer=t,zc=this.state=e,Vc=this.camera=n,Wc=this.lightManager=r,qc=this.fog=i,Xc=this.gl=zc.gl},setCamera:function(t){Vc=this.camera=t},handlerColorOrTexture:function(t,e){return t&&t.isTexture?this.handlerTexture(t,e):(t&&t.isColor?t.toArray($c):$c[0]=$c[1]=$c[2]=.5,$c)},handlerTexture:function(t,e){if(t&&t.isTexture)return this.handlerGLTexture(t.target,t.getGLTexture(zc),e)},handlerGLTexture:function(t,e,n){if(e)return zc.activeTexture(Xc.TEXTURE0+n),zc.bindTexture(t,e),n},handlerUV:function(t){return t&&t.isTexture&&t.uv||0},POSITION:{get:function(t,e,n){return t.geometry.vertices}},NORMAL:{get:function(t,e,n){return t.geometry.normals}},TANGENT:{get:function(t,e,n){var r=e.normalMap||e.clearcoatNormalMap;return r&&r.isTexture&&1===Number(r.uv)?t.geometry.tangents1:t.geometry.tangents}},TEXCOORD_0:{get:function(t,e,n){if(t.geometry.uvs)return t.geometry.uvs}},TEXCOORD_1:{get:function(t,e,n){if(t.geometry.uvs1)return t.geometry.uvs1}},UVMATRIX_0:{get:function(t,e,n){if(e.uvMatrix)return e.uvMatrix.elements}},UVMATRIX_1:{get:function(t,e,n){if(e.uvMatrix1)return e.uvMatrix1.elements}},CAMERAFAR:{get:function(t,e,n){if(Vc.isPerspectiveCamera)return Vc.far}},CAMERANEAR:{get:function(t,e,n){if(Vc.isPerspectiveCamera)return Vc.near}},CAMERATYPE:{get:function(t,e,n){return Vc.isPerspectiveCamera?1:0}},CAMERAPOSITION:{get:function(t,e,n){return Vc.worldMatrix.getTranslation(Qc).elements}},COLOR_0:{get:function(t,e,n){if(t.geometry.colors)return t.geometry.colors}},SKININDICES:{get:function(t,e,n){return t.geometry.skinIndices}},JOINT:{get:function(t,e,n){return t.geometry.skinIndices}},WEIGHT:{get:function(t,e,n){return t.geometry.skinWeights}},SKINWEIGHTS:{get:function(t,e,n){return t.geometry.skinWeights}},RENDERERSIZE:{get:function(t,e,n){return th[0]=Yc.width,th[1]=Yc.height,th}},LOCAL:{get:function(t,e,n){return t.matrix.elements},isDependMesh:!0},MODEL:{get:function(t,e,n){return t.worldMatrix.elements},isDependMesh:!0},VIEW:{get:function(t,e,n){return Vc.viewMatrix.elements}},PROJECTION:{get:function(t,e,n){return Vc.projectionMatrix.elements}},VIEWPROJECTION:{get:function(t,e,n){return Vc.viewProjectionMatrix.elements}},MODELVIEW:{get:function(t,e,n){return Vc.getModelViewMatrix(t,Kc).elements},isDependMesh:!0},MODELVIEWPROJECTION:{get:function(t,e,n){return Vc.getModelProjectionMatrix(t,Kc).elements},isDependMesh:!0},MODELINVERSE:{get:function(t,e,n){return Kc.invert(t.worldMatrix).elements},isDependMesh:!0},VIEWINVERSE:{get:function(t,e,n){return Vc.worldMatrix.elements}},VIEWINVERSEINVERSETRANSPOSE:{get:function(t,e,n){return Zc.normalFromMat4(Vc.worldMatrix).elements}},PROJECTIONINVERSE:{get:function(t,e,n){return Kc.invert(Vc.projectionMatrix).elements}},MODELVIEWINVERSE:{get:function(t,e,n){return Kc.invert(Vc.getModelViewMatrix(t,Kc)).elements},isDependMesh:!0},MODELVIEWPROJECTIONINVERSE:{get:function(t,e,n){return Kc.invert(Vc.getModelProjectionMatrix(t,Kc)).elements},isDependMesh:!0},MODELINVERSETRANSPOSE:{get:function(t,e,n){return Zc.normalFromMat4(t.worldMatrix).elements},isDependMesh:!0},MODELVIEWINVERSETRANSPOSE:{get:function(t,e,n){return Zc.normalFromMat4(Vc.getModelViewMatrix(t,Kc)).elements},isDependMesh:!0},VIEWPORT:void 0,JOINTMATRIX:{get:function(t,e,n){if(t.isSkinedMesh)return t.getJointMat();h.warnOnce("semantic.JOINTMATRIX(".concat(t.id,")"),"Current mesh is not SkinedMesh!",t.id)},isDependMesh:!0,notSupportInstanced:!0},JOINTMATRIXTEXTURE:{get:function(t,e,n){if(t.isSkinedMesh)return t.updateJointMatTexture(),eh.handlerTexture(t.jointMatTexture,n.textureIndex);h.warnOnce("semantic.JOINTMATRIXTEXTURE(".concat(t.id,")"),"Current mesh is not SkinedMesh!",t.id)},isDependMesh:!0,notSupportInstanced:!0},JOINTMATRIXTEXTURESIZE:{get:function(t,e,n){if(t.isSkinedMesh)return t.initJointMatTexture(),[t.jointMatTexture.width,t.jointMatTexture.height];h.warnOnce("semantic.JOINTMATRIXTEXTURESIZE(".concat(t.id,")"),"Current mesh is not SkinedMesh!",t.id)},isDependMesh:!0,notSupportInstanced:!0},NORMALMAPSCALE:{get:function(t,e,n){return e.normalMapScale}},OCCLUSIONSTRENGTH:{get:function(t,e,n){return e.occlusionStrength}},SHININESS:{get:function(t,e,n){return e.shininess}},SPECULARENVMATRIX:{get:function(t,e,n){return e.specularEnvMatrix&&e.specularEnvMap?e.specularEnvMatrix.elements:(Kc.identity(),Kc.elements)}},REFLECTIVITY:{get:function(t,e,n){return e.reflectivity}},REFRACTRATIO:{get:function(t,e,n){return e.refractRatio}},REFRACTIVITY:{get:function(t,e,n){return e.refractivity}},LOGDEPTH:{get:function(t,e,n){return 2/(Math.log(Vc.far+1)/Math.LN2)}},AMBIENTLIGHTSCOLOR:{get:function(t,e,n){return Wc.ambientInfo}},DIRECTIONALLIGHTSCOLOR:{get:function(t,e,n){return Wc.directionalInfo.colors}},DIRECTIONALLIGHTSINFO:{get:function(t,e,n){return Wc.directionalInfo.infos}},DIRECTIONALLIGHTSSHADOWMAP:{get:function(t,e,n){return Wc.directionalInfo.shadowMap.map((function(t,e){return eh.handlerTexture(t,n.textureIndex+e)}))}},DIRECTIONALLIGHTSSHADOWMAPSIZE:{get:function(t,e,n){return Wc.directionalInfo.shadowMapSize}},DIRECTIONALLIGHTSSHADOWBIAS:{get:function(t,e,n){return Wc.directionalInfo.shadowBias}},DIRECTIONALLIGHTSPACEMATRIX:{get:function(t,e,n){return Wc.directionalInfo.lightSpaceMatrix}},POINTLIGHTSPOS:{get:function(t,e,n){return Wc.pointInfo.poses}},POINTLIGHTSCOLOR:{get:function(t,e,n){return Wc.pointInfo.colors}},POINTLIGHTSINFO:{get:function(t,e,n){return Wc.pointInfo.infos}},POINTLIGHTSRANGE:{get:function(t,e,n){return Wc.pointInfo.ranges}},POINTLIGHTSSHADOWMAP:{get:function(t,e,n){return Wc.pointInfo.shadowMap.map((function(t,e){return eh.handlerTexture(t,n.textureIndex+e)}))}},POINTLIGHTSSHADOWBIAS:{get:function(t,e,n){return Wc.pointInfo.shadowBias}},POINTLIGHTSPACEMATRIX:{get:function(t,e,n){return Wc.pointInfo.lightSpaceMatrix}},POINTLIGHTCAMERA:{get:function(t,e,n){return Wc.pointInfo.cameras}},SPOTLIGHTSPOS:{get:function(t,e,n){return Wc.spotInfo.poses}},SPOTLIGHTSDIR:{get:function(t,e,n){return Wc.spotInfo.dirs}},SPOTLIGHTSCOLOR:{get:function(t,e,n){return Wc.spotInfo.colors}},SPOTLIGHTSCUTOFFS:{get:function(t,e,n){return Wc.spotInfo.cutoffs}},SPOTLIGHTSINFO:{get:function(t,e,n){return Wc.spotInfo.infos}},SPOTLIGHTSRANGE:{get:function(t,e,n){return Wc.spotInfo.ranges}},SPOTLIGHTSSHADOWMAP:{get:function(t,e,n){return Wc.spotInfo.shadowMap.map((function(t,e){return eh.handlerTexture(t,n.textureIndex+e)}))}},SPOTLIGHTSSHADOWMAPSIZE:{get:function(t,e,n){return Wc.spotInfo.shadowMapSize}},SPOTLIGHTSSHADOWBIAS:{get:function(t,e,n){return Wc.spotInfo.shadowBias}},SPOTLIGHTSPACEMATRIX:{get:function(t,e,n){return Wc.spotInfo.lightSpaceMatrix}},AREALIGHTSCOLOR:{get:function(t,e,n){return Wc.areaInfo.colors}},AREALIGHTSPOS:{get:function(t,e,n){return Wc.areaInfo.poses}},AREALIGHTSWIDTH:{get:function(t,e,n){return Wc.areaInfo.width}},AREALIGHTSHEIGHT:{get:function(t,e,n){return Wc.areaInfo.height}},AREALIGHTSLTCTEXTURE1:{get:function(t,e,n){return eh.handlerTexture(Wc.areaInfo.ltcTexture1,n.textureIndex)}},AREALIGHTSLTCTEXTURE2:{get:function(t,e,n){return eh.handlerTexture(Wc.areaInfo.ltcTexture2,n.textureIndex)}},FOGCOLOR:{get:function(t,e,n){if(qc)return qc.color.elements}},FOGINFO:{get:function(t,e,n){if(qc)return qc.getInfo()}},POSITIONDECODEMAT:{get:function(t,e,n){return t.geometry.positionDecodeMat},isDependMesh:!0},NORMALDECODEMAT:{get:function(t,e,n){return t.geometry.normalDecodeMat},isDependMesh:!0},UVDECODEMAT:{get:function(t,e,n){return t.geometry.uvDecodeMat},isDependMesh:!0},UV1DECODEMAT:{get:function(t,e,n){return t.geometry.uv1DecodeMat},isDependMesh:!0},BASECOLOR:{get:function(t,e,n){return e.baseColor.elements}},EMISSIONFACTOR:{get:function(t,e,n){return e.emissionFactor.elements}},METALLIC:{get:function(t,e,n){return e.metallic}},ROUGHNESS:{get:function(t,e,n){return e.roughness}},DIFFUSEENVMAP:{get:function(t,e,n){return eh.handlerTexture(e.diffuseEnvMap,n.textureIndex)}},DIFFUSEENVINTENSITY:{get:function(t,e,n){return e.diffuseEnvIntensity}},DIFFUSEENVSPHEREHARMONICS3:{get:function(t,e,n){var r=e.diffuseEnvSphereHarmonics3;if(r)return r.toArray()}},BRDFLUT:{get:function(t,e,n){return eh.handlerTexture(e.brdfLUT,n.textureIndex)}},SPECULARENVMAP:{get:function(t,e,n){return eh.handlerTexture(e.specularEnvMap,n.textureIndex)}},SPECULARENVINTENSITY:{get:function(t,e,n){return e.specularEnvIntensity}},SPECULARENVMAPMIPCOUNT:{get:function(t,e,n){var r=e.specularEnvMap;return r?r.mipmapCount:1}},GLOSSINESS:{get:function(t,e,n){return e.glossiness}},ALPHACUTOFF:{get:function(t,e,n){return e.alphaCutoff}},EXPOSURE:{get:function(t,e,n){return e.exposure}},GAMMAFACTOR:{get:function(t,e,n){return e.gammaFactor}},MORPHWEIGHTS:{isDependMesh:!0,notSupportInstanced:!0,get:function(t,e,n){var r=t.geometry;if(r.isMorphGeometry&&r.weights)return r.weights}},CLEARCOATFACTOR:{isDependMesh:!1,notSupportInstanced:!1,get:function(t,e,n){return e.clearcoatFactor}},CLEARCOATROUGHNESSFACTOR:{isDependMesh:!1,notSupportInstanced:!1,get:function(t,e,n){return e.clearcoatRoughnessFactor}}};eh._TIME=(Jc=(new Date).getTime(),{isDependMesh:!1,notSupportInstanced:!1,get:function(t,e,n){return.001*((new Date).getTime()-Jc)}}),[["POSITION","vertices"],["NORMAL","normals"],["TANGENT","tangents"]].forEach((function(t){for(var e=0;e<8;e++)eh["MORPH"+t[0]+e]={get:function(t,e){return function(n,r,i){var o=n.geometry;if(o.isMorphGeometry&&o.targets&&o.targets[t]){var s=o._originalMorphIndices?o._originalMorphIndices[e]:e,a=o.targets[t][s],u="_target_".concat(t,"_").concat(e);return o[u]!==s&&a&&(a.isDirty=!0,o[u]=s),a}}}(t[1],e)}})),[["DIFFUSE","diffuse"],["SPECULAR","specular"],["EMISSION","emission"],["AMBIENT","ambient"]].forEach((function(t){var e=kc(t,2),n=e[0],r=e[1];eh[n]={get:function(t,e,n){return eh.handlerColorOrTexture(e[r],n.textureIndex)}},eh["".concat(n,"UV")]={get:function(t,e,n){return eh.handlerUV(e[r])}}})),[["NORMALMAP","normalMap"],["PARALLAXMAP","parallaxMap"],["BASECOLORMAP","baseColorMap"],["METALLICMAP","metallicMap"],["ROUGHNESSMAP","roughnessMap"],["METALLICROUGHNESSMAP","metallicRoughnessMap"],["OCCLUSIONMAP","occlusionMap"],["SPECULARGLOSSINESSMAP","specularGlossinessMap"],["LIGHTMAP","lightMap"],["CLEARCOATMAP","clearcoatMap"],["CLEARCOATROUGHNESSMAP","clearcoatRoughnessMap"],["CLEARCOATNORMALMAP","clearcoatNormalMap"]].forEach((function(t){var e=kc(t,2),n=e[0],r=e[1];eh[n]={get:function(t,e,n){return eh.handlerTexture(e[r],n.textureIndex)}},eh["".concat(n,"UV")]={get:function(t,e,n){return eh.handlerUV(e[r])}}})),[["TRANSPARENCY","transparency"]].forEach((function(t){var e=kc(t,2),n=e[0],r=e[1];eh[n]={get:function(t,e,n){var i=e[r];return i&&i.isTexture?eh.handlerTexture(i,n.textureIndex):null!=i?i:1}},eh["".concat(n,"UV")]={get:function(t,e,n){return eh.handlerUV(e[r])}}}));var nh=eh,rh=Ss.LEQUAL,ih=Ss.BACK,oh=Ss.FRONT,sh=Ss.FRONT_AND_BACK,ah=Ss.ZERO,uh=Ss.FUNC_ADD,ch=Ss.ONE,hh=Ss.SRC_ALPHA,lh=Ss.ONE_MINUS_SRC_ALPHA,fh=Ss.CCW,dh=Ss.ALWAYS,ph=Ss.KEEP,mh={isBlankInfo:!0,get:function(){}},_h=Ks.create({isMaterial:!0,className:"Material",name:null,shaderCacheId:null,shaderName:null,lightType:"NONE",wireframe:!1,frontFace:fh,depthTest:!0,sampleAlphaToCoverage:!1,depthMask:!0,depthRange:[0,1],depthFunc:rh,_cullFace:!0,normalMap:null,parallaxMap:null,normalMapScale:1,ignoreTranparent:!1,gammaCorrection:!1,usePhysicsLight:!1,isDiffuesEnvAndAmbientLightWorkTogether:!1,userData:null,renderOrder:0,_premultiplyAlpha:!0,premultiplyAlpha:{get:function(){return this._premultiplyAlpha},set:function(t){this._premultiplyAlpha=t,this.transparent&&this.setDefaultTransparentBlend()}},gammaOutput:{get:function(){return h.warnOnce("Matrial.gammaOutput","material.gammaOutput has deprecated. Use material.gammaCorrection instead."),this.gammaCorrection},set:function(t){h.warnOnce("Matrial.gammaOutput","material.gammaOutput has deprecated. Use material.gammaCorrection instead."),this.gammaCorrection=t}},gammaFactor:2.2,castShadows:!0,receiveShadows:!0,uvMatrix:null,uvMatrix1:null,cullFace:{get:function(){return this._cullFace},set:function(t){this._cullFace=t,t?this.cullFaceType=this._cullFaceType:this._side=sh}},_cullFaceType:ih,cullFaceType:{get:function(){return this._cullFaceType},set:function(t){this._cullFaceType=t,this._cullFace&&(t===ih?this._side=oh:t===oh&&(this._side=ih))}},_side:oh,side:{get:function(){return this._side},set:function(t){this._side!==t&&(this._side=t,t===sh?this._cullFace=!1:(this._cullFace=!0,t===oh?this._cullFaceType=ih:t===ih&&(this._cullFaceType=oh)))}},blend:!1,blendEquation:uh,blendEquationAlpha:uh,blendSrc:ch,blendDst:ah,blendSrcAlpha:ch,blendDstAlpha:ah,stencilTest:!1,stencilMask:255,stencilFunc:dh,stencilFuncRef:1,stencilFuncMask:255,stencilOpFail:ph,stencilOpZFail:ph,stencilOpZPass:ph,isDirty:!1,transparency:1,_transparent:!1,transparent:{get:function(){return this._transparent},set:function(t){this._transparent!==t&&(this._transparent=t,t?this.setDefaultTransparentBlend():(this.blend=!1,this.depthMask=!0))}},setDefaultTransparentBlend:function(){this.blend=!0,this.depthMask=!1,this.premultiplyAlpha?(this.blendSrc=ch,this.blendDst=lh,this.blendSrcAlpha=ch,this.blendDstAlpha=lh):(this.blendSrc=hh,this.blendDst=lh,this.blendSrcAlpha=hh,this.blendDstAlpha=lh)},alphaCutoff:0,useHDR:!1,exposure:1,needBasicUnifroms:!0,needBasicAttributes:!0,constructor:function(t){this.id=Ea.generateUUID(this.className),this.uniforms={},this.attributes={},Object.assign(this,t),this.needBasicAttributes&&this.addBasicAttributes(),this.needBasicUnifroms&&this.addBasicUniforms()},addBasicAttributes:function(){var t=this.attributes;this._copyProps(t,{a_position:"POSITION",a_normal:"NORMAL",a_tangent:"TANGENT",a_texcoord0:"TEXCOORD_0",a_texcoord1:"TEXCOORD_1",a_color:"COLOR_0",a_skinIndices:"SKININDICES",a_skinWeights:"SKINWEIGHTS"}),["POSITION","NORMAL","TANGENT"].forEach((function(e){for(var n=e.slice(0,1)+e.slice(1).toLowerCase(),r=0;r<8;r++){var i="a_morph"+n+r;void 0===t[i]&&(t[i]="MORPH"+e+r)}}))},addBasicUniforms:function(){this._copyProps(this.uniforms,{u_modelMatrix:"MODEL",u_viewMatrix:"VIEW",u_projectionMatrix:"PROJECTION",u_modelViewMatrix:"MODELVIEW",u_modelViewProjectionMatrix:"MODELVIEWPROJECTION",u_viewInverseNormalMatrix:"VIEWINVERSEINVERSETRANSPOSE",u_normalMatrix:"MODELVIEWINVERSETRANSPOSE",u_normalWorldMatrix:"MODELINVERSETRANSPOSE",u_cameraPosition:"CAMERAPOSITION",u_rendererSize:"RENDERERSIZE",u_logDepth:"LOGDEPTH",u_ambientLightsColor:"AMBIENTLIGHTSCOLOR",u_directionalLightsColor:"DIRECTIONALLIGHTSCOLOR",u_directionalLightsInfo:"DIRECTIONALLIGHTSINFO",u_directionalLightsShadowMap:"DIRECTIONALLIGHTSSHADOWMAP",u_directionalLightsShadowMapSize:"DIRECTIONALLIGHTSSHADOWMAPSIZE",u_directionalLightsShadowBias:"DIRECTIONALLIGHTSSHADOWBIAS",u_directionalLightSpaceMatrix:"DIRECTIONALLIGHTSPACEMATRIX",u_pointLightsPos:"POINTLIGHTSPOS",u_pointLightsColor:"POINTLIGHTSCOLOR",u_pointLightsInfo:"POINTLIGHTSINFO",u_pointLightsRange:"POINTLIGHTSRANGE",u_pointLightsShadowBias:"POINTLIGHTSSHADOWBIAS",u_pointLightsShadowMap:"POINTLIGHTSSHADOWMAP",u_pointLightSpaceMatrix:"POINTLIGHTSPACEMATRIX",u_pointLightCamera:"POINTLIGHTCAMERA",u_spotLightsPos:"SPOTLIGHTSPOS",u_spotLightsDir:"SPOTLIGHTSDIR",u_spotLightsColor:"SPOTLIGHTSCOLOR",u_spotLightsCutoffs:"SPOTLIGHTSCUTOFFS",u_spotLightsInfo:"SPOTLIGHTSINFO",u_spotLightsRange:"SPOTLIGHTSRANGE",u_spotLightsShadowMap:"SPOTLIGHTSSHADOWMAP",u_spotLightsShadowMapSize:"SPOTLIGHTSSHADOWMAPSIZE",u_spotLightsShadowBias:"SPOTLIGHTSSHADOWBIAS",u_spotLightSpaceMatrix:"SPOTLIGHTSPACEMATRIX",u_areaLightsPos:"AREALIGHTSPOS",u_areaLightsColor:"AREALIGHTSCOLOR",u_areaLightsWidth:"AREALIGHTSWIDTH",u_areaLightsHeight:"AREALIGHTSHEIGHT",u_areaLightsLtcTexture1:"AREALIGHTSLTCTEXTURE1",u_areaLightsLtcTexture2:"AREALIGHTSLTCTEXTURE2",u_jointMat:"JOINTMATRIX",u_jointMatTexture:"JOINTMATRIXTEXTURE",u_jointMatTextureSize:"JOINTMATRIXTEXTURESIZE",u_positionDecodeMat:"POSITIONDECODEMAT",u_normalDecodeMat:"NORMALDECODEMAT",u_uvDecodeMat:"UVDECODEMAT",u_uv1DecodeMat:"UV1DECODEMAT",u_morphWeights:"MORPHWEIGHTS",u_normalMapScale:"NORMALMAPSCALE",u_emission:"EMISSION",u_transparency:"TRANSPARENCY",u_uvMatrix:"UVMATRIX_0",u_uvMatrix1:"UVMATRIX_1",u_fogColor:"FOGCOLOR",u_fogInfo:"FOGINFO",u_alphaCutoff:"ALPHACUTOFF",u_exposure:"EXPOSURE",u_gammaFactor:"GAMMAFACTOR"}),this.addTextureUniforms({u_normalMap:"NORMALMAP",u_parallaxMap:"PARALLAXMAP",u_emission:"EMISSION",u_transparency:"TRANSPARENCY"})},addTextureUniforms:function(t){var e={};for(var n in t){var r=t[n];e[n]=r,e["".concat(n,".texture")]=r,e["".concat(n,".uv")]="".concat(r,"UV")}this._copyProps(this.uniforms,e)},getRenderOption:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.lightType;e["LIGHT_TYPE_".concat(n)]=1,e.SIDE=this.side,"NONE"!==n&&(e.HAS_LIGHT=1),this.premultiplyAlpha&&(e.PREMULTIPLY_ALPHA=1);var r=this._textureOption.reset(e);return e.HAS_LIGHT&&(e.HAS_NORMAL=1,r.add(this.normalMap,"NORMAL_MAP",(function(){1!==t.normalMapScale&&(e.NORMAL_MAP_SCALE=1)}))),r.add(this.parallaxMap,"PARALLAX_MAP"),r.add(this.emission,"EMISSION_MAP"),r.add(this.transparency,"TRANSPARENCY_MAP"),this.ignoreTranparent&&(e.IGNORE_TRANSPARENT=1),this.alphaCutoff>0&&(e.ALPHA_CUTOFF=1),this.useHDR&&(e.USE_HDR=1),this.gammaCorrection&&(e.GAMMA_CORRECTION=1),this.receiveShadows&&(e.RECEIVE_SHADOWS=1),this.castShadows&&(e.CAST_SHADOWS=1),this.uvMatrix&&(e.UV_MATRIX=1),this.uvMatrix1&&(e.UV_MATRIX1=1),this.usePhysicsLight&&(e.USE_PHYSICS_LIGHT=1),this.isDiffuesEnvAndAmbientLightWorkTogether&&(e.IS_DIFFUESENV_AND_AMBIENTLIGHT_WORK_TOGETHER=1),r.update(),e},_textureOption:{uvTypes:null,option:null,reset:function(t){return this.option=t,this.uvTypes={},this},add:function(t,e,n){if(t&&t.isTexture){var r=this.uvTypes,i=this.option,o=t.uv||0;r[o]=1,i[e]=o,t.isCubeTexture&&(i["".concat(e,"_CUBE")]=1),n&&n(t)}return this},update:function(){var t=[0,1],e=this.uvTypes,n=this.option;for(var r in e)-1!==t.indexOf(Number(r))?n["HAS_TEXCOORD".concat(r)]=1:(h.warnOnce("Material._textureOption.update(".concat(r,")"),"uv_".concat(r," not support!")),n.HAS_TEXCOORD0=1);return this}},getInstancedUniforms:function(){var t=this._instancedUniforms;if(!this._instancedUniforms){var e=this.uniforms;for(var n in t=this._instancedUniforms=[],e){var r=this.getUniformInfo(n);r.isDependMesh&&!r.notSupportInstanced&&t.push({name:n,info:r})}}return t},getUniformData:function(t,e,n){return this.getUniformInfo(t).get(e,this,n)},getAttributeData:function(t,e,n){return this.getAttributeInfo(t).get(e,this,n)},getUniformInfo:function(t){return this.getInfo("uniforms",t)},getAttributeInfo:function(t){return this.getInfo("attributes",t)},getInfo:function(t,e){var n=this[t][e];return"string"==typeof n&&(n=nh[n]),n&&n.get||(h.warnOnce("material.getInfo-"+e,"Material.getInfo: no this semantic:"+e),n=mh),n},clone:function(){var t=new this.constructor;for(var e in this)"id"!==e&&(t[e]=this[e]);return t},destroyTextures:function(){this.getTextures().forEach((function(t){t.destroy()}))},getTextures:function(){var t=[];for(var e in this){var n=this[e];n&&n.isTexture&&t.push(n)}return t},_copyProps:function(t,e){for(var n in e)void 0===t[n]&&(t[n]=e[n])}}),gh=Ks.create({Extends:_h,isBasicMaterial:!0,className:"BasicMaterial",lightType:"BLINN-PHONG",diffuse:null,ambient:null,specular:null,emission:null,specularEnvMap:null,specularEnvMatrix:null,reflectivity:0,refractRatio:0,refractivity:0,shininess:32,usedUniformVectors:11,constructor:function(t){this.diffuse=new Da(.5,.5,.5),this.specular=new Da(1,1,1),this.emission=new Da(0,0,0),gh.superclass.constructor.call(this,t),Object.assign(this.uniforms,{u_diffuse:"DIFFUSE",u_specular:"SPECULAR",u_ambient:"AMBIENT",u_shininess:"SHININESS",u_reflectivity:"REFLECTIVITY",u_refractRatio:"REFRACTRATIO",u_refractivity:"REFRACTIVITY",u_specularEnvMap:"SPECULARENVMAP",u_specularEnvMatrix:"SPECULARENVMATRIX"}),this.addTextureUniforms({u_diffuse:"DIFFUSE",u_specular:"SPECULAR",u_ambient:"AMBIENT"})},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};gh.superclass.getRenderOption.call(this,t);var e=this._textureOption.reset(t),n=this.lightType;"PHONG"!==n&&"BLINN-PHONG"!==n||(t.HAS_SPECULAR=1);var r=this.diffuse;return r&&r.isTexture&&(r.isCubeTexture?t.DIFFUSE_CUBE_MAP=1:e.add(this.diffuse,"DIFFUSE_MAP")),t.HAS_LIGHT&&(e.add(this.specular,"SPECULAR_MAP"),e.add(this.ambient,"AMBIENT_MAP"),e.add(this.specularEnvMap,"SPECULAR_ENV_MAP")),e.update(),t}}),vh=gh,yh=Ss.POSITION,Eh=Ss.NORMAL,Th=Ss.DEPTH,Ah=Ss.DISTANCE,Sh=Ss.NONE,Mh=Ks.create({Extends:vh,isGeometryMaterial:!0,className:"GeometryMaterial",vertexType:yh,lightType:Sh,writeOriginData:!1,constructor:function(t){Mh.superclass.constructor.call(this,t),Object.assign(this.uniforms,{u_cameraFar:"CAMERAFAR",u_cameraNear:"CAMERANEAR",u_cameraType:"CAMERATYPE"})},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(Mh.superclass.getRenderOption.call(this,t),t["VERTEX_TYPE_".concat(this.vertexType)]=1,this.vertexType){case yh:t.HAS_FRAG_POS=1;break;case Eh:t.HAS_NORMAL=1;break;case Th:break;case Ah:t.HAS_FRAG_POS=1}return this.writeOriginData&&(t.WRITE_ORIGIN_DATA=1),t}}),Oh=Mh,bh=Ks.create({Extends:Va,isOrthographicCamera:!0,className:"OrthographicCamera",_left:-1,left:{get:function(){return this._left},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._left=t}},_right:1,right:{get:function(){return this._right},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._right=t}},_bottom:-1,bottom:{get:function(){return this._bottom},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._bottom=t}},_top:1,top:{get:function(){return this._top},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._top=t}},_near:.1,near:{get:function(){return this._near},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._near=t}},_far:1,far:{get:function(){return this._far},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._far=t}},constructor:function(t){bh.superclass.constructor.call(this,t),this.updateProjectionMatrix()},updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},getGeometry:function(t){if(t||!this._geometry||this._isGeometryDirty){this._isGeometryDirty=!1;var e=new fu,n=[this.left,this.bottom,-this.near],r=[this.right,this.bottom,-this.near],i=[this.right,this.top,-this.near],o=[this.left,this.top,-this.near],s=[this.left,this.bottom,-this.far],a=[this.right,this.bottom,-this.far],u=[this.right,this.top,-this.far],c=[this.left,this.top,-this.far];e.addRect(s,a,u,c),e.addRect(a,r,i,u),e.addRect(r,n,o,i),e.addRect(n,s,c,o),e.addRect(c,u,i,o),e.addRect(n,r,a,s),this._geometry=e}return this._geometry}}),Lh=bh,Ih=Ss.DEPTH,Rh=Ss.BACK,Ch=null,xh=new Da(1,1,1),wh=new ma,Nh=function(t){return t.material.castShadows},Ph=Ks.create({isLightShadow:!0,className:"LightShadow",light:null,renderer:null,framebuffer:null,camera:null,width:1024,height:1024,maxBias:.05,minBias:.005,cameraInfo:null,debug:!1,constructor:function(t){this.id=Ea.generateUUID(this.className),Object.assign(this,t)},createFramebuffer:function(){this.framebuffer||(this.framebuffer=new bc(this.renderer,{width:this.width,height:this.height}),this.debug&&this.showShadowMap())},updateLightCamera:function(t){this.light.isDirectionalLight?this.updateDirectionalLightCamera(t):this.light.isSpotLight&&this.updateSpotLightCamera(t)},updateDirectionalLightCamera:function(t){var e=this.light;if(this.camera.lookAt(e.direction),this.cameraInfo)this.updateCustumCamera(this.cameraInfo);else{var n=t.getGeometry();if(n){this.camera.updateViewMatrix(),wh.multiply(this.camera.viewMatrix,t.worldMatrix);var r=n.getBounds(wh);this.camera.near=-r.zMax,this.camera.far=-r.zMin,this.camera.left=r.xMin,this.camera.right=r.xMax,this.camera.bottom=r.yMin,this.camera.top=r.yMax}}this.camera.updateViewMatrix()},updateCustumCamera:function(t){for(var e in t)this.camera[e]=t[e]},updateSpotLightCamera:function(t){var e=this.light;this.camera.lookAt(e.direction),this.cameraInfo?this.updateCustumCamera(this.cameraInfo):(this.camera.fov=2*e.outerCutoff,this.camera.near=.01,this.camera.far=t.far,this.camera.aspect=1),this.camera.updateViewMatrix()},createCamera:function(t){this.camera||(this.light.isDirectionalLight?this.camera=new Lh:this.light.isSpotLight&&(this.camera=new pu),this.camera.addTo(this.light)),(this.light.isDirty||this._cameraMatrixVersion!==t.matrixVersion)&&(this.updateLightCamera(t),this._cameraMatrixVersion=t.matrixVersion,this.light.isDirty=!1)},createShadowMap:function(t){this.createFramebuffer(),this.createCamera(t);var e=this.renderer,n=this.framebuffer,r=this.camera;Ch||(Ch=new Oh({vertexType:Ih,side:Rh,writeOriginData:!0})),n.bind(),e.state.viewport(0,0,this.width,this.height),e.clear(xh),r.updateViewProjectionMatrix(),nh.setCamera(r),e.forceMaterial=Ch,this.renderShadowScene(e),delete e.forceMaterial,n.unbind(),nh.setCamera(t),e.viewport()},renderShadowScene:function(t){t.renderList.traverse((function(e){Nh(e)&&t.renderMesh(e)}),(function(e){t.renderInstancedMeshes(e.filter((function(t){return Nh(t)})))}))},showShadowMap:function(){var t=this;this.renderer.on("afterRender",(function(){t.framebuffer.render(0,.7,.3,.3)}))}}),Dh=Ss.DISTANCE,Hh=Ss.BACK,Fh=Ss.TEXTURE_CUBE_MAP,Uh=Ss.TEXTURE0,Bh=Ss.TEXTURE_CUBE_MAP_POSITIVE_X,Gh=Ss.NEAREST,kh=Ss.FRAMEBUFFER,jh=Ss.FRAMEBUFFER_COMPLETE,Vh=null,Xh=new Da(0,0,0,0),Wh=new ra,zh=[[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,-1,0,0,-1,0,0,0,1,0,0,-1,0,-1,0,0,-1,0]],qh=function(t,e){if(t.material.castShadows){if(!t.frustumTest)return!0;if(e.isMeshVisible(t))return!0}return!1},Yh=Ks.create({isLightShadow:!0,className:"CubeLightShadow",Extends:Ph,light:null,renderer:null,framebuffer:null,camera:null,width:1024,height:1024,maxBias:.05,minBias:.005,debug:!1,constructor:function(t){Yh.superclass.constructor.call(this,t)},createFramebuffer:function(){this.framebuffer||(this.framebuffer=new bc(this.renderer,{target:Fh,width:1024,height:1024,createTexture:function(){var t=this.state.gl,e=new Nc({image:[null,null,null,null,null,null],type:this.type,format:this.format,internalFormat:this.internalFormat,magFilter:Gh,minFilter:Gh,width:1024,height:1024});return t.checkFramebufferStatus(kh)!==jh&&h.warn("Framebuffer is not complete",t.checkFramebufferStatus(kh)),e},bindTexture:function(t){t=t||0;var e=this.state,n=e.gl,r=this.texture.getGLTexture(e);e.activeTexture(Uh+vu.MAX_TEXTURE_INDEX),e.bindTexture(this.target,r),n.framebufferTexture2D(kh,this.attachment,Bh+t,r,0)}}))},updateLightCamera:function(t){this.camera.fov=90,this.camera.near=t.near,this.camera.far=t.far,this.camera.aspect=1,this.camera.updateViewMatrix()},createCamera:function(t){this.camera||(this.camera=new pu,this.updateLightCamera(t))},createShadowMap:function(t){this.createFramebuffer(),this.createCamera(t);var e=this.renderer,n=this.framebuffer,r=this.camera;Vh||(Vh=new Oh({vertexType:Dh,side:Hh,writeOriginData:!1})),n.bind(),e.state.viewport(0,0,n.width,n.height),this.light.worldMatrix.getTranslation(r.position);for(var i=0;i<6;i++)n.bindTexture(i),Wh.fromArray(zh[0],3*i).add(r.position),r.up.fromArray(zh[1],3*i),r.lookAt(Wh),r.updateViewProjectionMatrix(),e.clear(Xh),nh.setCamera(r),e.forceMaterial=Vh,this.renderShadowScene(e);r.matrix.identity(),r.updateViewProjectionMatrix(),delete e.forceMaterial,n.unbind(),nh.setCamera(t),e.viewport()},renderShadowScene:function(t){var e=t.renderList,n=this.camera;e.traverse((function(e){qh(e,n)&&t.renderMesh(e)}),(function(e){var r=e.filter((function(t){return qh(t,n)}));t.renderInstancedMeshes(r)}))}}),Jh=Yh,Qh=Ks.create({Extends:Ua,isPointLight:!0,className:"PointLight",constructor:function(t){Qh.superclass.constructor.call(this,t)},createShadowMap:function(t,e){this.shadow&&(this.lightShadow||(this.lightShadow=new Jh({light:this,renderer:t}),"minBias"in this.shadow&&(this.lightShadow.minBias=this.shadow.minBias),"maxBias"in this.shadow&&(this.lightShadow.maxBias=this.shadow.maxBias)),this.lightShadow.createShadowMap(e))}}),Zh=Qh,Kh=new ma,$h=new ra,tl=Ks.create({Extends:Ua,isDirectionalLight:!0,className:"DirectionalLight",constructor:function(t){this.direction=new ra(0,0,1),tl.superclass.constructor.call(this,t)},createShadowMap:function(t,e){this.shadow&&(this.lightShadow||(this.lightShadow=new Ph({light:this,renderer:t,width:this.shadow.width||t.width,height:this.shadow.height||t.height,debug:this.shadow.debug,cameraInfo:this.shadow.cameraInfo}),"minBias"in this.shadow&&(this.lightShadow.minBias=this.shadow.minBias),"maxBias"in this.shadow&&(this.lightShadow.maxBias=this.shadow.maxBias)),this.lightShadow.createShadowMap(e))},getWorldDirection:function(){return $h.copy(this.direction).transformDirection(this.worldMatrix).normalize(),$h},getViewDirection:function(t){var e=t.getModelViewMatrix(this,Kh);return $h.copy(this.direction).transformDirection(e).normalize(),$h}}),el=tl,nl=new ma,rl=new ra,il=Ks.create({Extends:Ua,isSpotLight:!0,className:"SpotLight",_cutoffCos:.9763,_cutoff:12.5,cutoff:{get:function(){return this._cutoff},set:function(t){this._cutoff=t,this._cutoffCos=Math.cos(Ea.degToRad(t))}},_outerCutoffCos:.9537,_outerCutoff:17.5,outerCutoff:{get:function(){return this._outerCutoff},set:function(t){this._outerCutoff=t,this._outerCutoffCos=Math.cos(Ea.degToRad(t))}},constructor:function(t){this.direction=new ra(0,0,1),il.superclass.constructor.call(this,t)},createShadowMap:function(t,e){this.shadow&&(this.lightShadow||(this.lightShadow=new Ph({light:this,renderer:t,width:this.shadow.width||t.width,height:this.shadow.height||t.height,debug:this.shadow.debug,cameraInfo:this.shadow.cameraInfo}),"minBias"in this.shadow&&(this.lightShadow.minBias=this.shadow.minBias),"maxBias"in this.shadow&&(this.lightShadow.maxBias=this.shadow.maxBias)),this.lightShadow.createShadowMap(e))},getWorldDirection:function(){return rl.copy(this.direction).transformDirection(this.worldMatrix).normalize(),rl},getViewDirection:function(t){var e=t.getModelViewMatrix(this,nl);return rl.copy(this.direction).transformDirection(e).normalize(),rl}}),ol=il,sl=Ks.create({Extends:_h,isShaderMaterial:!0,className:"ShaderMaterial",vs:"",fs:"",useHeaderCache:!1,constructor:function(t){sl.superclass.constructor.call(this,t)},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(sl.superclass.getRenderOption.call(this,t),this.getCustomRenderOption){var e=this.getCustomRenderOption({});for(var n in e)t["HILO_CUSTUM_OPTION_".concat(n)]=e[n]}return t},getCustomRenderOption:null}),al=sl,ul=n("./node_modules/_amc@1.0.6@amc/build/amd.js"),cl=n.n(ul),hl=Ks.create({Extends:fu,isMorphGeometry:!0,className:"MorphGeometry",isStatic:!1,weights:[],targets:null,constructor:function(t){hl.superclass.constructor.call(this,t),this.weights=this.weights||[]},update:function(t,e){this.weights=t,this._originalMorphIndices=e},clone:function(){return fu.prototype.clone.call(this,{targets:this.targets,weights:this.weights})},getRenderOption:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return hl.superclass.getRenderOption.call(this,e),this.targets&&(this._maxMorphTargetCount||(this._maxMorphTargetCount=Math.floor(8/Object.keys(this.targets).length)),Ds(this.targets,(function(n,r){e.MORPH_TARGET_COUNT=Math.min(n.length,t._maxMorphTargetCount),"vertices"===r?e.MORPH_HAS_POSITION=1:"normals"===r?e.MORPH_HAS_NORMAL=1:"tangents"===r&&(e.MORPH_HAS_TANGENT=1)}))),e}}),ll=hl,fl={POSITION:{name:"vertices",decodeMatName:"positionDecodeMat"},TEXCOORD_0:{name:"uvs",decodeMatName:"uvDecodeMat"},TEXCOORD_1:{name:"uvs1",decodeMatName:"uv1DecodeMat"},NORMAL:{name:"normals",decodeMatName:"normalDecodeMat"},JOINT:{name:"skinIndices"},JOINTS_0:{name:"skinIndices"},WEIGHT:{name:"skinWeights"},WEIGHTS_0:{name:"skinWeights"},TANGENT:{name:"tangents"},COLOR_0:{name:"colors"}},dl={Geometry:fu,GeometryData:Qa},pl={_decodeTotalTime:0,wasmURL:"",workerURL:"",useWASM:!0,useWebWorker:!0,useAuto:!0,init:function(){return pl.useAuto?cl.a.initWASM(pl.wasmURL,pl.memPages):pl.useWebWorker?cl.a.initWorker(pl.workerURL):pl.useWASM?cl.a.initWASM(pl.wasmURL,pl.memPages):Promise.resolve()},parse:function(t,e,n,r){var i=Date.now(),o=e.bufferViews[t.bufferView],s=pl.wasmURL,a=pl.workerURL,u=pl.useAuto,c=pl.useWASM,h=pl.useWebWorker,l=new Uint8Array(o.buffer,o.byteOffset,o.byteLength);function f(e){pl._decodeTotalTime+=Date.now()-i;var n=e.toHilo3dGeometry(dl,r.primitive._geometry);return t.targets&&(n=function(t,e,n){if(!n.isMorphGeometry){var r=new ll;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&"id"!==i&&(r[i]=n[i]);r.targets={},n=r}for(var o=n.targets,s=0;s<t.targets.length;s++){var a=t.targets[s];for(var u in a)if(u in fl){var c=a[u],h=fl[u].name;o[h]||(o[h]=[]);var l=e.attrs[c];o[h].push(new Qa(l.data,l.itemCount))}}return t.weights?n.weights=t.weights:n.weights=new Float32Array(t.targets.length),n}(t,e,n)),n}return u?cl.a.decompress(l,s,a).then(f):h?cl.a.decompressWithWorker(l,c,s,a).then(f):f(c?cl.a.decompressWithWASM(l,s):cl.a.decompressWithJS(l))},freeMemory:function(){cl.a.destory()}},ml=pl,_l=Ss.SAMPLER_2D,gl={unQuantizeData:function(t,e){if(!e)return t;var n=Math.sqrt(e.length),r=n-1,i=new Float32Array(t.length),o=[];return t.traverse((function(t,s){t.toArray?t.toArray(o):o[0]=t;for(var a=s*r,u=0;u<n;u++){i[a+u]=0;for(var c=0;c<n;c++){var h=c===r?1:o[c];i[a+u]+=e[c*n+u]*h}}})),t.data=i,t.stride=0,t.offset=0,t},parse:function(t,e,n,r){var i=t.decodeMatrix;return r.isDecode?n=gl.unQuantizeData(n,i):n.decodeMat=i,n}},vl={parseOnEnd:function(t,e,n){if(!n.anim||e.isMultiAnim)return n;for(var r in t){var i=t[r];n.anim.addClip(r,i[0],i[1])}return n}},yl=vl,El={parse:function(t,e,n){return t.center=t.max.map((function(e,n){return(e+t.min[n])/2})),t.width=t.max[0]-t.min[0],t.height=t.max[1]-t.min[1],t.depth=t.max[2]-t.min[2],t.size=Math.sqrt(Math.pow(t.width,2)+Math.pow(t.height,2)+Math.pow(t.depth,2)),n.bounds=t,n}},Tl={getUsedTextureNameMap:function(t,e){t.diffuseTexture&&(e[t.diffuseTexture.index]=!0),t.specularGlossinessTexture&&(e[t.specularGlossinessTexture.index]=!0)},parse:function(t,e,n){return t.diffuseFactor&&n.baseColor.fromArray(t.diffuseFactor),t.diffuseTexture&&(n.baseColorMap=e.getTexture(t.diffuseTexture)),t.specularFactor&&(n.specular.fromArray(t.specularFactor),n.specular.a=1),"glossinessFactor"in t&&(n.glossiness=t.glossinessFactor),t.specularGlossinessTexture&&(n.specularGlossinessMap=e.getTexture(t.specularGlossinessTexture)),n.isSpecularGlossiness=!0,n}},Al={getUsedTextureNameMap:function(t,e){t.clearcoatTexture&&(e[t.clearcoatTexture.index]=!0),t.clearcoatRoughnessTexture&&(e[t.clearcoatRoughnessTexture.index]=!0),t.clearcoatNormalTexture&&(e[t.clearcoatNormalTexture.index]=!0)},parse:function(t,e,n){return t.clearcoatFactor&&(n.clearcoatFactor=t.clearcoatFactor),t.clearcoatTexture&&(n.clearcoatMap=e.getTexture(t.clearcoatTexture)),t.clearcoatRoughnessFactor&&(n.clearcoatRoughnessFactor=t.clearcoatRoughnessFactor),t.clearcoatRoughnessTexture&&(n.clearcoatRoughnessMap=e.getTexture(t.clearcoatRoughnessTexture)),t.clearcoatNormalTexture&&(n.clearcoatNormalMap=e.getTexture(t.clearcoatNormalTexture)),n}},Sl={parse:function(t,e,n){if(!e.isUseExtension(e.json,"KHR_lights_punctual")||!e.json.extensions.KHR_lights_punctual.lights)return n;var r,i=e.json.extensions.KHR_lights_punctual.lights[t.light];if(!i)return n;var o=new Da(1,1,1,1);i.color&&(o.r=i.color[0],o.g=i.color[1],o.b=i.color[2]);var s=void 0!==i.intensity?i.intensity:1,a=i.name||"",u=i.spot||{},c=void 0!==u.innerConeAngle?Ea.radToDeg(u.innerConeAngle):0,h=void 0!==u.outerConeAngle?Ea.radToDeg(u.outerConeAngle):45,l=i.range||0;switch(i.type){case"directional":(r=new el({color:o,amount:s,name:a,range:l})).direction.set(0,0,-1);break;case"point":r=new Zh({color:o,amount:s,name:a,range:l});break;case"spot":(r=new ol({color:o,amount:s,name:a,range:l,cutoff:c,outerCutoff:h})).direction.set(0,0,-1);break;default:return n}return r&&(n.addChild(r),e.lights.push(r)),n}},Ml={init:function(t,e){var n=[],r=(e.json.extensions||{}).KHR_techniques_webgl||{},i=r.programs||[],o=r.shaders||[],s=r.techniques||[];return e.shaders={},o.forEach((function(r,i){var o=ws(e.src,r.uri);e.preHandlerShaderURI&&(o=e.preHandlerShaderURI(o,i,r)),n.push(t.loadRes(o).then((function(t){e.shaders[i]=t})))})),e.programs={},i.forEach((function(t,n){e.programs[n]=Object.assign({},t)})),e.techniques={},s.forEach((function(t,n){var r=(e.techniques[n]=Object.assign({},t)).textureInfos={},i=t.uniforms||{};for(var o in i){var s=i[o];s.type===_l&&(r[o]=s.value||{})}})),Promise.all(n)},getUsedTextureNameMap:function(t,e,n){var r=n.techniques[t.technique],i=t.values||{};if(r){var o=r.textureInfos;for(var s in o){var a=void 0;i[s]&&void 0!==i[s].index?a=i[s].index:void 0!==o[s].index&&(a=o[s].index),void 0!==a&&(e[a]=!0)}}},parse:function(t,e,n){var r=e.textures||[],i=e.techniques[t.technique];if(!i)return n;var o=e.programs[i.program];if(!o)return n;var s=e.shaders[o.fragmentShader],a=e.shaders[o.vertexShader],u=i.uniforms||{},c=i.attributes||{},h=t.values||{},l={},f={},d=function(t){var n=u[t]||{},i=h[t];void 0===i&&(i=n.value);var o=void 0;if(void 0!==i)if(n.type===_l){var s=i.index||0;o={get:function(t,e,n){return nh.handlerTexture(r[s],n.textureIndex)}}}else o={get:function(){return i}};else if(n.semantic&&nh[n.semantic]){var a,c=nh[n.semantic],l=n.node;o=void 0!==l?{get:function(t,n,r){return void 0===a&&(a=e.node.getChildByFn((function(t){return t.animationId===l}))||t),c.get(a,n,r)}}:n.semantic}f[t]=o};for(var p in u)d(p);for(var m in c){var _=c[m]||{};_.semantic&&(l[m]=_.semantic)}var g=new al({needBasicUnifroms:!1,needBasicAttributes:!1,useHeaderCache:!0,premultiplyAlpha:!1,vs:a,fs:s,attributes:l,uniforms:f});return void 0!==t.premultiplyAlpha&&(g.premultiplyAlpha=t.premultiplyAlpha),t.defines&&(g.getCustomRenderOption=function(){return t.defines}),void 0!==o.name&&(g.shaderName=o.name,g.shaderCacheId="KHR_techniques_webgl_".concat(o.name)),g}},Ol=new Float32Array(2),bl=Ks.create({isFog:!0,className:"Fog",mode:"LINEAR",start:5,end:10,density:.1,constructor:function(t){this.id=Ea.generateUUID(this.className),this.color=new Da(1,1,1,1),Object.assign(this,t)},getInfo:function(){return"LINEAR"===this.mode?(Ol[0]=this.start,Ol[1]=this.end,Ol):this.density},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t["FOG_".concat(this.mode)]=1,t}}),Ll=n("./node_modules/_ray-3d@1.1.1@ray-3d/index.js"),Il=n.n(Ll),Rl=Ks.create({className:"Ray",isRay:!0,origin:{get:function(){return this._origin},set:function(t){this._origin=t,this._ray.origin=t.elements}},direction:{get:function(){return this._direction},set:function(t){this._direction=t,this._ray.direction=t.elements}},constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._ray=new Il.a,this.origin=t.origin||new ra(0,0,0),this.direction=t.direction||new ra(0,0,-1)},set:function(t,e){return this.origin=t,this.direction=e,this},copy:function(t){this.origin.copy(t.origin),this.direction.copy(t.direction)},clone:function(){return new this.constructor({origin:this.origin.clone(),direction:this.direction.clone()})},fromCamera:function(t,e,n,r,i){t.isPerspectiveCamera?(t.worldMatrix.getTranslation(this.origin),this.direction.set(e,n,0),this.direction.copy(t.unprojectVector(this.direction,r,i)),this.direction.sub(this.origin).normalize()):t.isOrthographicCamera&&(this.origin.set(e,n,(t.near+t.far)/(t.near-t.far)),this.origin.copy(t.unprojectVector(this.origin,r,i)),this.direction.set(0,0,-1).transformDirection(t.worldMatrix).normalize())},transformMat4:function(t){this.origin.transformMat4(t),this.direction.transformDirection(t).normalize()},sortPoints:function(t,e){var n=this;e?t.sort((function(t,r){return n.squaredDistance(t[e])-n.squaredDistance(r[e])})):t.sort((function(t,e){return n.squaredDistance(t)-n.squaredDistance(e)}))},squaredDistance:function(t){return this.origin.squaredDistance(t)},distance:function(t){return this.origin.distance(t)},intersectsSphere:function(t,e){var n=this._ray.intersectsSphere(t,e);return this._getRes(n)},intersectsPlane:function(t,e){var n=this._ray.intersectsPlane(t,e);return this._getRes(n)},intersectsTriangle:function(t){var e=this._ray.intersectsTriangle(t);return this._getRes(e)},intersectsBox:function(t){var e=this._ray.intersectsBox(t);return this._getRes(e)},intersectsTriangleCell:function(t,e){var n=this._ray.intersectsTriangleCell(t,e);return this._getRes(n)},_getRes:function(t){return t?new ra(t[0],t[1],t[2]):null}}),Cl=new Rl,xl=new ma,wl=Ks.create({Extends:xa,isMesh:!0,className:"Mesh",geometry:null,material:null,useInstanced:!1,frustumTest:!0,constructor:function(t){wl.superclass.constructor.call(this,t)},clone:function(t){var e=xa.prototype.clone.call(this,t);return Object.assign(e,{geometry:this.geometry,material:this.material}),e},raycast:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.visible)return null;var n=this.geometry,r=this.material,i=this.worldMatrix;if(n&&r){xl.invert(i),Cl.copy(t),Cl.transformMat4(xl);var o=n.raycast(Cl,r.side,e);if(o)return o.forEach((function(t){t.transformMat4(i)})),o}return null},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.geometry.getRenderOption(t),t},isDestroyed:{get:function(){return this._isDestroyed}},destroy:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._isDestroyed)return this;this.removeFromParent();var n=t.resourceManager;return n.destroyMesh(this),this.material&&e&&this.material.destroyTextures(),this.off(),this.geometry=null,this.material=null,this._isDestroyed=!0,this}}),Nl=wl,Pl=new ma,Dl=new ma,Hl=Ks.create({Extends:Nl,isSkinedMesh:!0,className:"SkinedMesh",useInstanced:!1,jointMatTexture:null,frustumTest:!1,skeleton:null,constructor:function(t){Hl.superclass.constructor.call(this,t)},getJointMat:function(){var t=this;if(this.skeleton&&!(this.skeleton.jointCount<=0)){var e=this.skeleton.jointNodeList,n=this.skeleton.inverseBindMatrices,r=16*this.skeleton.jointCount;return this.jointMat&&this.jointMat.length===r||(this.jointMat=new Float32Array(r)),this.clonedFrom?Dl.invert(this.clonedFrom.worldMatrix):Dl.invert(this.worldMatrix),e.forEach((function(e,r){Pl.copy(Dl),Pl.multiply(e.worldMatrix),Pl.multiply(n[r]),Pl.toArray(t.jointMat,16*r)})),this.jointMat}},resetJointNamesByNodeName:function(t){this.skeleton.resetJointNamesByNodeName(t)},resetSkinIndices:function(t){var e=this.skeleton;if(e){var n=this.geometry,r=n.skinIndices;if(r){this.material.isDirty=!0,n.isDirty=!0,r.isDirty=!0;var i=new Na;r.traverse((function(n,o,s){n.elements.forEach((function(n,r){var o=e.jointNames[n],s=t.jointNames.indexOf(o);s>=0?i.elements[r]=s:h.warnOnce("SkinedMesh.resetSkinIndices","SkinedMesh.resetSkinIndices: no jointName found!",o)})),r.setByOffset(s,i)}))}}},initJointMatTexture:function(){if(!this.jointMatTexture){var t=this.getJointMat();this.jointMatTexture=new Gc({data:t})}return this.jointMatTexture},updateJointMatTexture:function(){if(this.jointMatTexture){var t=this.getJointMat();this.jointMatTexture.data.set(t,0),this.jointMatTexture.needUpdate=!0}else this.initJointMatTexture()},clone:function(t){var e=Nl.prototype.clone.call(this,t);return Object.assign(e,{useInstanced:this.useInstanced,skeleton:this.skeleton.clone()}),e.clonedFrom=this,e},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Hl.superclass.getRenderOption.call(this,t);var e=this.skeleton.jointCount;if(e&&(t.JOINT_COUNT=e,vu.VERTEX_TEXTURE_FLOAT)){var n=(vu.MAX_VERTEX_UNIFORM_VECTORS-22)/4;e>n&&(t.JOINT_MAT_MAP=1)}return t}}),Fl=Hl,Ul=Ks.create({isSkeleton:!0,className:"Skeleton",userData:null,constructor:function(t){this.id=Ea.generateUUID(this.className),this.jointNodeList=[],this.jointNames=[],this.inverseBindMatrices=[],Object.assign(this,t)},jointCount:{get:function(){return this.jointNodeList.length}},_rootNode:null,rootNode:{get:function(){return this._rootNode},set:function(t){this._rootNode=t,t&&this._initJointNodeList()}},_initJointNodeList:function(){var t={};this.rootNode.traverse((function(e){t[e.jointName]=e})),this.jointNodeList=this.jointNames.map((function(e){return t[e]}))},resetJointNamesByNodeName:function(t){var e=this.jointNames;this.jointNodeList.forEach((function(n,r){var i=t.rootNode.getChildByName(n.name);i&&(e[r]=i.jointName)}))},clone:function(t){var e=new Ul;return e.copy(this,t),e},copy:function(t,e){return this.inverseBindMatrices=t.inverseBindMatrices,this.jointNames=t.jointNames.slice(),void 0===e&&(e=t.rootNode),this.rootNode=e,this}}),Bl=Ul,Gl="1.16.2",kl=Ks.create({className:"RenderInfo",isRenderInfo:!0,constructor:function(){this.reset()},addFaceCount:function(t){this._currentFaceCount+=t},addDrawCount:function(t){this._currentDrawCount+=t},reset:function(){this.faceCount=Math.floor(this._currentFaceCount),this.drawCount=Math.floor(this._currentDrawCount),this._currentFaceCount=0,this._currentDrawCount=0}}),jl=new ra,Vl=function(t,e){var n=t.material.renderOrder,r=e.material.renderOrder;if(n!==r)return n-r;var i=t.material._shaderNumId||0,o=e.material._shaderNumId||0;return i!==o?i-o:t._sortRenderZ-e._sortRenderZ},Xl=function(t,e){var n=t.material.renderOrder,r=e.material.renderOrder;return n!==r?n-r:e._sortRenderZ-t._sortRenderZ},Wl=Ks.create({className:"RenderList",isRenderList:!0,useInstanced:!1,constructor:function(){this.opaqueList=[],this.transparentList=[],this.instancedDict={}},reset:function(){this.opaqueList.length=0,this.transparentList.length=0,this.instancedDict={}},traverse:function(t,e){this.opaqueList.forEach((function(e){t(e)}));var n=this.instancedDict;for(var r in n){var i=n[r];i.length>2&&e?e(i):i.forEach((function(e){t(e)}))}this.transparentList.forEach((function(e){t(e)}))},sort:function(){this.transparentList.sort(Xl),this.opaqueList.sort(Vl)},addMesh:function(t,e){var n=t.material,r=t.geometry;if(n&&r){if(t.frustumTest&&!e.isMeshVisible(t))return;if(this.useInstanced&&t.useInstanced){var i=this.instancedDict,o=n.id+"_"+r.id,s=i[o];i[o]||(s=i[o]=[]),s.push(t)}else t.worldMatrix.getTranslation(jl),jl.transformMat4(e.viewProjectionMatrix),t._sortRenderZ=jl.z,n.transparent?this.transparentList.push(t):this.opaqueList.push(t)}else h.warnOnce("RenderList.addMesh(".concat(t.id,")"),"Mesh must have material and geometry",t)}}),zl=Ks.create({className:"WebGLState",isWebGLState:!0,systemFramebuffer:null,constructor:function(t){this.gl=t,this.reset()},reset:function(){this._dict={},this.activeTextureIndex=null,this.textureUnitDict={},this.currentFramebuffer=null,this.preFramebuffer=null,this._pixelStorei={}},enable:function(t){!0!==this._dict[t]&&(this._dict[t]=!0,this.gl.enable(t))},disable:function(t){!1!==this._dict[t]&&(this._dict[t]=!1,this.gl.disable(t))},bindFramebuffer:function(t,e){this.currentFramebuffer!==e&&(this.preFramebuffer=this.currentFramebuffer,this.currentFramebuffer=e,this.gl.bindFramebuffer(t,e))},bindSystemFramebuffer:function(){this.bindFramebuffer(this.gl.FRAMEBUFFER,this.systemFramebuffer)},useProgram:function(t){this.set1("useProgram",t)},depthFunc:function(t){this.set1("depthFunc",t)},depthMask:function(t){this.set1("depthMask",t)},clear:function(t){this.gl.clear(t)},depthRange:function(t,e){this.set2("depthRange",t,e)},stencilFunc:function(t,e,n){this.set3("stencilFunc",t,e,n)},stencilMask:function(t){this.set1("stencilMask",t)},stencilOp:function(t,e,n){this.set3("stencilOp",t,e,n)},colorMask:function(t,e,n,r){this.set4("colorMask",t,e,n,r)},cullFace:function(t){this.set1("cullFace",t)},frontFace:function(t){this.set1("frontFace",t)},blendFuncSeparate:function(t,e,n,r){this.set4("blendFuncSeparate",t,e,n,r)},blendEquationSeparate:function(t,e){this.set2("blendEquationSeparate",t,e)},pixelStorei:function(t,e){this._pixelStorei[t]!==e&&(this._pixelStorei[t]=e,this.gl.pixelStorei(t,e))},viewport:function(t,e,n,r){this.set4("viewport",t,e,n,r)},activeTexture:function(t){this.activeTextureIndex!==t&&(this.activeTextureIndex=t,this.gl.activeTexture(t))},bindTexture:function(t,e){var n=this.getActiveTextureUnit();n[t]!==e&&(n[t]=e,this.gl.bindTexture(t,e))},getActiveTextureUnit:function(){var t=this.textureUnitDict[this.activeTextureIndex];return t||(t=this.textureUnitDict[this.activeTextureIndex]={}),t},set1:function(t,e){this._dict[t]!==e&&(this._dict[t]=e,this.gl[t](e))},set2:function(t,e,n){var r=this._dict[t];r||(r=this._dict[t]=[]),r[0]===e&&r[1]===n||(r[0]=e,r[1]=n,this.gl[t](e,n))},set3:function(t,e,n,r){var i=this._dict[t];i||(i=this._dict[t]=[]),i[0]===e&&i[1]===n&&i[2]===r||(i[0]=e,i[1]=n,i[2]=r,this.gl[t](e,n,r))},set4:function(t,e,n,r,i){var o=this._dict[t];o||(o=this._dict[t]=[]),o[0]===e&&o[1]===n&&o[2]===r&&o[3]===i||(o[0]=e,o[1]=n,o[2]=r,o[3]=i,this.gl[t](e,n,r,i))},get:function(t){return this._dict[t]}}),ql=Ks.create({Mixes:ta,className:"WebGLResourceManager",isWebGLResourceManager:!0,hasNeedDestroyResource:!1,constructor:function(t){this._needDestroyResources=[],Object.assign(this,t)},destroyMesh:function(t){var e=this;this.getMeshResources(t).forEach((function(t){e.destroyIfNoRef(t)})),t._vao=t._program=t._shader=null},getMeshResources:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t._shader&&e.push(t._shader),t._vao&&(e.push(t._vao),t._vao.getResources(e)),t._program&&e.push(t._program),e},destroyIfNoRef:function(t){var e=this._needDestroyResources;return t&&e.indexOf(t)<0&&e.push(t),this},getUsedResources:function(t){var e=this,n=[];return t&&t.traverse((function(t){t.isMesh&&!t.isDestroyed&&e.getMeshResources(t,n)})),n},destroyUnsuedResource:function(t){var e=this,n=this._needDestroyResources;if(0===n.length)return this;var r=this.getUsedResources(t);return n.forEach((function(t){r.indexOf(t)<0&&t&&t.destroy&&!t.alwaysUse&&(e.fire("destroyResource",t.id),t.destroy())})),this.reset(),this},reset:function(){return this._needDestroyResources.length=0,this}}),Yl=new ma,Jl=new ra,Ql=new Float32Array([0,0,0]),Zl=Ks.create({isLightManager:!0,className:"LightManager",constructor:function(t){this.ambientLights=[],this.directionalLights=[],this.pointLights=[],this.spotLights=[],this.areaLights=[],this.lightInfo={AMBIENT_LIGHTS:0,POINT_LIGHTS:0,DIRECTIONAL_LIGHTS:0,SPOT_LIGHTS:0,AREA_LIGHTS:0,uid:0},Object.assign(this,t)},getRenderOption:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ds(this.lightInfo,(function(n,r){if("uid"!==r&&n){e[r]=n;var i=t.getShadowMapCount(r);i&&(e[r+"_SMC"]=i)}})),e},addLight:function(t){var e=null;return t.enabled?(t.isAmbientLight?e=this.ambientLights:t.isDirectionalLight?e=this.directionalLights:t.isPointLight?e=this.pointLights:t.isSpotLight?e=this.spotLights:t.isAreaLight?e=this.areaLights:h.warnOnce("LightManager.addLight(".concat(t.id,")"),"Not support this light:",t),e&&(t.shadow?e.unshift(t):e.push(t)),this):this},getDirectionalInfo:function(t){var e=[],n=[],r=[],i=[],o=[],s=[];this.directionalLights.forEach((function(a,u){var c=3*u;a.getRealColor().toRGBArray(e,c),a.getViewDirection(t).toArray(n,c),a.shadow&&a.lightShadow&&(r.push(a.lightShadow.framebuffer.texture),i.push(a.lightShadow.width),i.push(a.lightShadow.height),s.push(a.lightShadow.minBias,a.lightShadow.maxBias),Yl.copy(t.worldMatrix),Yl.premultiply(a.lightShadow.camera.viewProjectionMatrix),Yl.toArray(o,16*u))}));var a={colors:new Float32Array(e),infos:new Float32Array(n)};return r.length&&(a.shadowMap=r,a.shadowMapSize=new Float32Array(i),a.shadowBias=new Float32Array(s),a.lightSpaceMatrix=new Float32Array(o)),a},getSpotInfo:function(t){var e=[],n=[],r=[],i=[],o=[],s=[],a=[],u=[],c=[],h=[];this.spotLights.forEach((function(l,f){var d=3*f;l.getRealColor().toRGBArray(e,d),l.toInfoArray(n,d),l.getViewDirection(t).toArray(i,d),h.push(l.range),o.push(l._cutoffCos,l._outerCutoffCos),t.getModelViewMatrix(l,Yl),Yl.getTranslation(Jl),Jl.toArray(r,d),l.shadow&&l.lightShadow&&(s.push(l.lightShadow.framebuffer.texture),a.push(l.lightShadow.width),a.push(l.lightShadow.height),c.push(l.lightShadow.minBias,l.lightShadow.maxBias),Yl.multiply(l.lightShadow.camera.viewProjectionMatrix,t.worldMatrix),Yl.toArray(u,16*f))}));var l={colors:new Float32Array(e),infos:new Float32Array(n),poses:new Float32Array(r),dirs:new Float32Array(i),cutoffs:new Float32Array(o),ranges:new Float32Array(h)};return s.length&&(l.shadowMap=s,l.shadowMapSize=new Float32Array(a),l.shadowBias=new Float32Array(c),l.lightSpaceMatrix=new Float32Array(u)),l},getPointInfo:function(t){var e=[],n=[],r=[],i=[],o=[],s=[],a=[],u=[];this.pointLights.forEach((function(c,h){var l=3*h;c.getRealColor().toRGBArray(e,l),c.toInfoArray(n,l),u.push(c.range),t.getModelViewMatrix(c,Yl),Yl.getTranslation(Jl),Jl.toArray(r,l),c.shadow&&c.lightShadow&&(i.push(c.lightShadow.framebuffer.texture),s.push(c.lightShadow.minBias,c.lightShadow.maxBias),t.worldMatrix.toArray(o,16*h),a[2*h]=c.lightShadow.camera.near,a[2*h+1]=c.lightShadow.camera.far)}));var c={colors:new Float32Array(e),infos:new Float32Array(n),poses:new Float32Array(r),ranges:new Float32Array(u)};return i.length&&(c.shadowMap=i,c.shadowBias=new Float32Array(s),c.lightSpaceMatrix=new Float32Array(o),c.cameras=new Float32Array(a)),c},getAreaInfo:function(t){var e,n,r=[],i=[],o=[],s=[];return this.areaLights.forEach((function(a,u){var c=3*u;a.getRealColor().toRGBArray(r,c),t.getModelViewMatrix(a,Yl),Yl.getTranslation(Jl),Jl.toArray(i,c);var h=Yl.getRotation();Yl.fromQuat(h),Jl.set(.5*a.width,0,0),Jl.transformMat4(Yl),Jl.toArray(o,c),Jl.set(0,.5*a.height,0),Jl.transformMat4(Yl),Jl.toArray(s,c),e=a.ltcTexture1,n=a.ltcTexture2})),{colors:new Float32Array(r),poses:new Float32Array(i),width:new Float32Array(o),height:new Float32Array(s),ltcTexture1:e,ltcTexture2:n}},getAmbientInfo:function(){return Ql[0]=Ql[1]=Ql[2]=0,this.ambientLights.forEach((function(t){var e=t.getRealColor();Ql[0]+=e.r,Ql[1]+=e.g,Ql[2]+=e.b})),Ql[0]=Math.min(1,Ql[0]),Ql[1]=Math.min(1,Ql[1]),Ql[2]=Math.min(1,Ql[2]),Ql},updateInfo:function(t){var e=this.lightInfo,n=this.ambientLights,r=this.directionalLights,i=this.pointLights,o=this.spotLights,s=this.areaLights;e.AMBIENT_LIGHTS=n.length,e.POINT_LIGHTS=i.length,e.DIRECTIONAL_LIGHTS=r.length,e.SPOT_LIGHTS=o.length,e.AREA_LIGHTS=s.length;var a=function(t){return!!t.shadow};e.SHADOW_POINT_LIGHTS=i.filter(a).length,e.SHADOW_SPOT_LIGHTS=o.filter(a).length,e.SHADOW_DIRECTIONAL_LIGHTS=r.filter(a).length,e.uid=[e.AMBIENT_LIGHTS,e.POINT_LIGHTS,e.SHADOW_POINT_LIGHTS,e.DIRECTIONAL_LIGHTS,e.SHADOW_DIRECTIONAL_LIGHTS,e.SPOT_LIGHTS,e.SHADOW_SPOT_LIGHTS,e.AREA_LIGHTS].join("_"),this.directionalInfo=this.getDirectionalInfo(t),this.pointInfo=this.getPointInfo(t),this.spotInfo=this.getSpotInfo(t),this.areaInfo=this.getAreaInfo(t),this.ambientInfo=this.getAmbientInfo()},getInfo:function(){return this.lightInfo},reset:function(){this.ambientLights.length=0,this.directionalLights.length=0,this.pointLights.length=0,this.spotLights.length=0,this.areaLights.length=0},getShadowMapCount:function(t){var e=[];"POINT_LIGHTS"===t?e=this.pointLights:"DIRECTIONAL_LIGHTS"===t?e=this.directionalLights:("SPOT_LIGHTS"===t||"AREA_LIGHTS"===t)&&(e=this.spotLights);var n=0;return e.forEach((function(t){n+=t.shadow?1:0})),n},createShadowMap:function(t,e){this.directionalLights.forEach((function(n){n.createShadowMap(t,e)})),this.spotLights.forEach((function(n){n.createShadowMap(t,e)})),this.pointLights.forEach((function(n){n.createShadowMap(t,e)})),this.areaLights.forEach((function(n){n.createShadowMap(t,e)}))}}),Kl=Ss.DEPTH_TEST,$l=Ss.STENCIL_TEST,tf=Ss.SAMPLE_ALPHA_TO_COVERAGE,ef=Ss.CULL_FACE,nf=Ss.FRONT_AND_BACK,rf=Ss.BLEND,of=Ss.LINES,sf=Ss.STATIC_DRAW,af=Ss.DYNAMIC_DRAW,uf=Ks.create({Mixes:ta,className:"WebGLRenderer",isWebGLRenderer:!0,gl:null,width:0,height:0,pixelRatio:1,domElement:null,useInstanced:!1,useVao:!0,alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1,gameMode:!1,useFramebuffer:!1,framebufferOption:{},useLogDepth:!1,vertexPrecision:"highp",fragmentPrecision:"highp",fog:null,offsetX:0,offsetY:0,isInitFailed:!1,_isInit:!1,_isContextLost:!1,constructor:function(t){this.clearColor=new Da(1,1,1),Object.assign(this,t),this.renderInfo=new kl,this.renderList=new Wl,this.lightManager=new Zl,this.resourceManager=new ql},resize:function(t,e,n){if(n||this.width!==t||this.height!==e){var r=this.domElement;this.width=t,this.height=e,r.width=t,r.height=e,this.framebuffer&&this.framebuffer.resize(this.width,this.height,n),this.viewport()}},setOffset:function(t,e){this.offsetX===t&&this.offsetY===e||(this.offsetX=t,this.offsetY=e,this.viewport())},viewport:function(t,e,n,r){var i=this.state,o=this.gl;i&&(void 0===t?t=this.offsetX:this.offsetX=t,void 0===e?e=this.offsetY:this.offsetY=e,void 0===n&&(n=o.drawingBufferWidth),void 0===r&&(r=o.drawingBufferHeight),i.viewport(t,e,n,r))},isInit:{get:function(){return this._isInit&&!this.isInitFailed}},onInit:function(t){var e=this;this._isInit?t(this):this.on("init",(function(){t(e)}),!0)},initContext:function(){if(!this._isInit){this._isInit=!0;try{this._initContext(),this.fire("init")}catch(t){this.isInitFailed=!0,this.fire("initFailed",t)}}},_initContext:function(){var t=this,e={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat};!0===this.preserveDrawingBuffer&&(e.preserveDrawingBuffer=!0),!0===this.gameMode&&(e.gameMode=!0);var n=this.gl=this.domElement.getContext("webgl",e);n.viewport(0,0,this.width,this.height),Fu.init(n),gu.init(n),vu.init(n),Cu.init(this),this.state=new zl(n),gu.instanced||(this.useInstanced=!1),this.renderList.useInstanced=this.useInstanced,gu.vao||(this.useVao=!1),this.useFramebuffer&&(this.framebuffer=new bc(this,Object.assign({useVao:this.useVao,width:this.width,height:this.height},this.framebufferOption))),this.domElement.addEventListener("webglcontextlost",(function(e){t._onContextLost(e)}),!1),this.domElement.addEventListener("webglcontextrestored",(function(e){t._onContextRestore(e)}),!1)},_onContextLost:function(t){var e=this.gl;this._isContextLost=!0,t.preventDefault(),Gu.reset(e),Cu.reset(e),pc.reset(e),zu.reset(e),tc.reset(e),this.state.reset(e),this._lastMaterial=null,this._lastProgram=null,this.fire("webglContextLost")},_onContextRestore:function(t){var e=this.gl;this._isContextLost=!1,gu.reset(e),bc.reset(e),this.fire("webglContextRestored")},setupDepthTest:function(t){var e=this.state;t.depthTest?(e.enable(Kl),e.depthFunc(t.depthFunc),e.depthMask(t.depthMask),e.depthRange(t.depthRange[0],t.depthRange[1])):e.disable(Kl)},setupSampleAlphaToCoverage:function(t){var e=this.state;t.sampleAlphaToCoverage?e.enable(tf):e.disable(tf)},setupCullFace:function(t){var e=this.state;t.cullFace&&t.cullFaceType!==nf?(e.enable(ef),e.cullFace(t.cullFaceType),e.frontFace(t.frontFace)):e.disable(ef)},setupBlend:function(t){var e=this.state;t.blend?(e.enable(rf),e.blendFuncSeparate(t.blendSrc,t.blendDst,t.blendSrcAlpha,t.blendDstAlpha),e.blendEquationSeparate(t.blendEquation,t.blendEquationAlpha)):e.disable(rf)},setupStencil:function(t){if(this.stencil){var e=this.state;t.stencilTest?(e.enable($l),e.stencilMask(t.stencilMask),e.stencilFunc(t.stencilFunc,t.stencilFuncRef,t.stencilFuncMask),e.stencilOp(t.stencilOpFail,t.stencilOpZFail,t.stencilOpZPass)):e.disable($l)}},setupUniforms:function(t,e,n,r){var i=this.forceMaterial||e.material;for(var o in t.uniforms){var s=i.getUniformInfo(o),a=t.uniforms[o];if(!s.isBlankInfo&&(r||s.isDependMesh&&!n)){var u=s.get(e,i,a);null!=u&&(t[o]=u)}}},setupVao:function(t,e,n){var r=n.geometry,i=r.isStatic;if(t.isDirty||!i||r.isDirty){t.isDirty=!1;var o=this.forceMaterial||n.material,s=o.attributes,a=i?sf:af;for(var u in s){var c=e.attributes[u];if(c){var h=o.getAttributeData(u,n,c);null!=h&&t.addAttribute(h,c,a)}}r.indices&&t.addIndexBuffer(r.indices,a),r.isDirty=!1}r.vertexCount&&(t.vertexCount=r.vertexCount)},setupMaterial:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.forceMaterial||e.material;(i.isDirty||this._lastMaterial!==i)&&(this.setupDepthTest(i),this.setupSampleAlphaToCoverage(i),this.setupCullFace(i),this.setupBlend(i),this.setupStencil(i),r=!0),this.setupUniforms(t,e,n,r),i.isDirty=!1,this._lastMaterial=i},setupMesh:function(t,e){var n=this.gl,r=this.state,i=this.lightManager,o=t.geometry,s=this.forceMaterial||t.material,a=Cu.getShader(t,s,e,i,this.fog,this.useLogDepth),u=Gu.getProgram(a,r);u.useProgram(),this.setupMaterial(u,t,e,this._lastProgram!==u),this._lastProgram=u,t.material.wireframe&&o.mode!==of&&o.convertToLinesMode();var c=o.id+u.id,h=tc.getVao(n,c,{useInstanced:e,useVao:this.useVao,mode:o.mode});return this.setupVao(h,u,t),t._vao=h,t._shader=a,t._program=u,{vao:h,program:u,geometry:o}},addRenderInfo:function(t,e){var n=this.renderInfo;n.addFaceCount(t),n.addDrawCount(e)},render:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.initContext(),!this.isInitFailed&&!this._isContextLost){var r=this.renderList,i=this.renderInfo,o=this.lightManager,s=this.resourceManager,a=this.state;this.fog=t.fog,o.reset(),i.reset(),r.reset(),nh.init(this,a,e,o,this.fog),t.updateMatrixWorld(),e.updateViewProjectionMatrix(),t.traverse((function(t){return t.visible?(t.isMesh?r.addMesh(t,e):t.isLight&&o.addLight(t),xa.TRAVERSE_STOP_NONE):xa.TRAVERSE_STOP_CHILDREN})),r.sort(),o.createShadowMap(this,e),o.updateInfo(e),n&&this.fire("beforeRender"),this.useFramebuffer&&this.framebuffer.bind(),this.clear(),n&&this.fire("beforeRenderScene"),this.renderScene(),this.useFramebuffer&&this.renderToScreen(this.framebuffer),n&&this.fire("afterRender"),s.destroyUnsuedResource(t)}},renderScene:function(){var t=this;this.renderList.traverse((function(e){t.renderMesh(e)}),(function(e){t.renderInstancedMeshes(e)})),this._gameModeSumbit()},_gameModeSumbit:function(){var t=this.gl;this.gameMode&&t&&t.submit&&t.submit()},clear:function(t){var e=this.gl,n=this.state;t=t||this.clearColor,this._lastMaterial=null,this._lastProgram=null,e.clearColor(t.r,t.g,t.b,t.a),n.depthMask(!0);var r=e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT;this.stencil&&(n.stencilMask(!0),r|=e.STENCIL_BUFFER_BIT),e.clear(r)},clearDepth:function(){var t=this.gl;this.state.depthMask(!0),t.clear(t.DEPTH_BUFFER_BIT)},clearStencil:function(){var t=this.gl;this.state.stencilMask(!0),t.clear(t.STENCIL_BUFFER_BIT)},renderToScreen:function(t){this.state.bindSystemFramebuffer(),t.render(0,0,1,1,this.clearColor)},renderMesh:function(t){var e=this.setupMesh(t,!1).vao;e.draw(),this.addRenderInfo(e.vertexCount/3,1)},renderInstancedMeshes:function(t){var e=t[0];if(e){var n=this.forceMaterial||e.material,r=this.setupMesh(e,!0),i=r.vao,o=r.program;n.getInstancedUniforms().forEach((function(e){var n=e.name,r=e.info,s=o.attributes[n];s&&i.addInstancedAttribute(s,t,(function(t){return r.get(t)}))})),i.drawInstance(t.length),this.addRenderInfo(i.vertexCount/3*t.length,1)}},renderMultipleMeshes:function(t){var e=this;t.forEach((function(t){e.renderMesh(t)}))},releaseGLResource:function(){var t=this.gl;t&&(Gu.reset(t),Cu.reset(t),zu.reset(t),tc.reset(t),this.state.reset(t),pc.reset(t),bc.destroy(t))}}),cf=function(){var t,e=navigator.userAgent,n=document,r=window,i=n.documentElement,o={iphone:/iphone/i.test(e),ipad:/ipad/i.test(e),ipod:/ipod/i.test(e),ios:/iphone|ipad|ipod/i.test(e),android:/android/i.test(e),webkit:/webkit/i.test(e),chrome:/chrome/i.test(e),safari:/safari/i.test(e),firefox:/firefox/i.test(e),ie:/msie/i.test(e),opera:/opera/i.test(e),supportTouch:"ontouchstart"in r,supportCanvas:!!n.createElement("canvas").getContext,supportStorage:void 0,supportOrientation:"orientation"in r||"orientation"in r.screen,supportDeviceMotion:"ondevicemotion"in r};try{localStorage.setItem("hilo","hilo"),localStorage.removeItem("hilo"),o.supportStorage=!0}catch(t){o.supportStorage=!1,h.warn("LocalStorage disabled")}t=o.webkit||o.firefox?"webkit":o.opera?"o":o.ie?"ms":"",o.jsVendor=t;var s=o.cssVendor="-"+t+"-",a=n.createElement("div"),u=a.style,c=void 0!==u[t+"Transform"],l=void 0!==u[t+"Perspective"];l&&(a.id="test3d",(u=n.createElement("style")).textContent="@media ("+s+"transform-3d){#test3d{height:3px}}",n.head.appendChild(u),i.appendChild(a),l=3===a.offsetHeight,n.head.removeChild(u),i.removeChild(a)),o.supportTransform=c,o.supportTransform3D=l;var f=o.supportTouch,d=f?"touchstart":"mousedown",p=f?"touchmove":"mousemove",m=f?"touchend":"mouseup";return o.POINTER_START=d,o.POINTER_MOVE=p,o.POINTER_END=m,o}(),hf=Ks.create({Extends:xa,isStage:!0,className:"Stage",renderer:null,camera:null,pixelRatio:null,offsetX:0,offsetY:0,width:0,height:0,canvas:null,constructor:function(t){if(t.width||(t.width=window.innerWidth),t.height||(t.height=window.innerHeight),!t.pixelRatio){var e=window.devicePixelRatio||1;e=Math.min(e,1024/Math.max(t.width,t.height),2),e=Math.max(e,1),t.pixelRatio=e}hf.superclass.constructor.call(this,t),this.initRenderer(t),h.log("Hilo3d version: ".concat(Gl))},initRenderer:function(t){var e=this.canvas=this.createCanvas(t);this.renderer=new uf(Object.assign(t,{domElement:e})),this.resize(this.width,this.height,this.pixelRatio,!0)},createCanvas:function(t){var e;return e=t.canvas?t.canvas:document.createElement("canvas"),t.container&&t.container.appendChild(e),e},resize:function(t,e,n,r){if(void 0===n&&(n=this.pixelRatio),r||this.width!==t||this.height!==e||this.pixelRatio!==n){this.width=t,this.height=e,this.pixelRatio=n,this.rendererWidth=t*n,this.rendererHeight=e*n;var i=this.canvas;this.renderer.resize(this.rendererWidth,this.rendererHeight,r),i.style.width=this.width+"px",i.style.height=this.height+"px",this.updateDomViewport()}return this},setOffset:function(t,e){if(this.offsetX!==t||this.offsetY!==e){this.offsetX=t,this.offsetY=e;var n=this.pixelRatio;this.renderer.setOffset(t*n,e*n)}return this},viewport:function(t,e,n,r){return this.resize(n,r,this.pixelRatio,!0),this.setOffset(t,e),this},tick:function(t){return this.traverseUpdate(t),this.camera&&this.renderer.render(this,this.camera,!0),this},enableDOMEvent:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.canvas,i=this._domListener||(this._domListener=function(t){e._onDOMEvent(t)});return(t="string"==typeof t?[t]:t).forEach((function(t){n?r.addEventListener(t,i,!1):r.removeEventListener(t,i)})),this},_onDOMEvent:function(t){var e=this.canvas,n=this._eventTarget,r=t.type,i=0===r.indexOf("touch"),o=t;if(i){var s=t.touches,a=t.changedTouches;s&&s.length?o=s[0]:a&&a.length&&(o=a[0])}var u=this.domViewport||this.updateDomViewport(),c=(o.pageX||o.clientX)-u.left,h=(o.pageY||o.clientY)-u.top;t.stageX=c,t.stageY=h,t.stopPropagation=function(){this._stopPropagationed=!0};var l=this.getMeshResultAtPoint(c,h,!0),f=l.mesh;t.hitPoint=l.point;var d="mouseout"===r;if(n&&(n!==f&&(!n.contains||!n.contains(f))||d)){var p=!1;if("touchmove"===r?p="touchout":"mousemove"!==r&&!d&&f||(p="mouseout"),p){var m=Object.assign({},t);m.type=p,m.eventTarget=n,n._fireMouseEvent(m)}t.lastEventTarget=n,this._eventTarget=null}if(f&&f.pointerEnabled&&"mouseout"!==r&&(t.eventTarget=this._eventTarget=f,f._fireMouseEvent(t)),!i){var _=f&&f.pointerEnabled&&f.useHandCursor?"pointer":"";e.style.cursor=_}cf.android&&"touchmove"===r&&t.preventDefault()},updateDomViewport:function(){var t=this.canvas,e=null;return t.parentNode&&(e=this.domViewport=Js(t)),e},getMeshResultAtPoint:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.camera,i=this._ray;i||(i=this._ray=new Rl),i.fromCamera(r,t,e,this.width,this.height);var o=this.raycast(i,!0,n);if(o)return o[0];this._stageResultAtPoint||(this._stageResultAtPoint={mesh:this,point:new ra});var s=this._stageResultAtPoint.point;return s.copy(r.unprojectVector(s.set(t,e,0),this.width,this.height)),this._stageResultAtPoint},releaseGLResource:function(){return this.renderer.releaseGLResource(),this},destroy:function(){return hf.superclass.destroy.call(this,this.renderer),this.releaseGLResource(),this.traverse((function(t){t.off(),t.parent=null})),this.children.length=0,this.renderer.off(),this}}),lf=hf;function ff(){return+new Date}var df=Ks.create({constructor:function(t,e,n,r){var i=this;for(var o in i.target=t,i._startTime=0,i._seekTime=0,i._pausedTime=0,i._pausedStartTime=0,i._reverseFlag=1,i._repeatCount=0,3===arguments.length&&(r=n,n=e,e=null),r)i[o]=r[o];i._fromProps=e,i._toProps=n,!r.duration&&r.time&&(i.duration=r.time||0,i.time=0)},target:null,duration:1e3,delay:0,paused:!1,loop:!1,reverse:!1,repeat:0,repeatDelay:0,ease:null,time:0,isStart:!1,isComplete:!1,onStart:null,onUpdate:null,onComplete:null,setProps:function(t,e){var n=this.target,r=t||e,i=this._fromProps={},o=this._toProps={};for(var s in t=t||n,e=e||n,r)o[s]=e[s]||0,n[s]=i[s]=t[s]||0;return this},start:function(){var t=this;return t._startTime=ff()+t.delay,t._seekTime=0,t._pausedTime=0,t._reverseFlag=1,t._repeatCount=0,t.paused=!1,t.isStart=!1,t.isComplete=!1,df.add(t),t},stop:function(){return df.remove(this),this},pause:function(){return this.paused=!0,this._pausedStartTime=ff(),this},resume:function(){var t=this;return t.paused=!1,t._pausedStartTime&&(t._pausedTime+=ff()-t._pausedStartTime),t._pausedStartTime=0,t},seek:function(t,e){var n=this,r=ff();return n._startTime=r,n._seekTime=t,n._pausedTime=0,void 0!==e&&(n.paused=e),n._update(r,!0),df.add(n),n},link:function(t){var e,n,r=t.delay,i=this._startTime;return"string"==typeof r&&(e=0===r.indexOf("+"),n=0===r.indexOf("-"),r=e||n?Number(r.substr(1))*(e?1:-1):Number(r)),t.delay=r,t._startTime=e||n?i+this.duration+r:i+r,this._next=t,df.remove(t),t},_render:function(t){var e=this.target,n=this._fromProps;for(var r in n)e[r]=n[r]+(this._toProps[r]-n[r])*t},_update:function(t,e){var n=this;if(n.paused&&!e)return!1;if(n.isComplete)return!0;var r=t-n._startTime-n._pausedTime+n._seekTime;if(r<0)return!1;var i,o=r/n.duration;o<=0?o=0:o>=1&&(o=1);var s=n.ease?n.ease(o):o;n.reverse&&n.isStart&&(n._reverseFlag<0&&(o=1-o,s=1-s),o<1e-7&&(n.repeat>0&&n._repeatCount++>=n.repeat||0===n.repeat&&!n.loop?n.isComplete=!0:(n._startTime=ff(),n._pausedTime=0,n._reverseFlag*=-1))),n.isStart||(n.setProps(n._fromProps,n._toProps),n.isStart=!0,n.onStart&&n.onStart.call(n,n)),n.time=r,n._render(s),(i=n.onUpdate)&&i.call(n,s,n),o>=1&&(n.reverse?(n._startTime=ff(),n._pausedTime=0,n._reverseFlag*=-1):n.loop||n.repeat>0&&n._repeatCount++<n.repeat?(n._startTime=ff()+n.repeatDelay,n._pausedTime=0):n.isComplete=!0);var a=n._next;if(a&&a.time<=0){var u=a._startTime;u>0&&u<=t?(a._render(o),a.time=r,df.add(a)):n.isComplete&&(u<0||u>t)&&a.start()}return!!n.isComplete&&((i=n.onComplete)&&i.call(n,n),!0)},Statics:{_tweens:[],tick:function(){var t,e,n=df._tweens,r=n.length;for(e=0;e<r;e++)(t=n[e])&&t._update(ff())&&(n.splice(e,1),e--);return df},add:function(t){var e=df._tweens;return-1===e.indexOf(t)&&e.push(t),df},remove:function(t){var e,n;if(t instanceof Array){for(e=0,n=t.length;e<n;e++)df.remove(t[e]);return df}var r=df._tweens;if(t instanceof df)(e=r.indexOf(t))>-1&&r.splice(e,1);else for(e=0;e<r.length;e++)r[e].target===t&&(r.splice(e,1),e--);return df},removeAll:function(){return df._tweens.length=0,df},fromTo:function(t,e,n,r){r=r||{};var i,o,s=t instanceof Array;t=s?t:[t];var a=r.stagger,u=[];for(o=0;o<t.length;o++)i=new df(t[o],e,n,r),a&&(i.delay=(r.delay||0)+(o*a||0)),i.start(),u.push(i);return s?u:i},to:function(t,e,n){return df.fromTo(t,null,e,n)},from:function(t,e,n){return df.fromTo(t,e,null,n)}}});function pf(t,e,n,r,i){return t=t||{},e&&(t.EaseIn=e),n&&(t.EaseOut=n),r&&(t.EaseInOut=r),i&&(t.EaseNone=i),t}var mf=pf(null,null,null,null,(function(t){return t})),_f=pf(null,(function(t){return t*t}),(function(t){return-t*(t-2)}),(function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)})),gf=pf(null,(function(t){return t*t*t}),(function(t){return--t*t*t+1}),(function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)})),vf=pf(null,(function(t){return t*t*t*t}),(function(t){return-(--t*t*t*t-1)}),(function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)})),yf=pf(null,(function(t){return t*t*t*t*t}),(function(t){return(t-=1)*t*t*t*t+1}),(function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)})),Ef=Math,Tf=Ef.PI,Af=.5*Tf,Sf=Ef.sin,Mf=Ef.cos,Of=Ef.pow,bf=Ef.sqrt,Lf=pf(null,(function(t){return 1-Mf(t*Af)}),(function(t){return Sf(t*Af)}),(function(t){return-.5*(Mf(Tf*t)-1)})),If=pf(null,(function(t){return 0===t?0:Of(2,10*(t-1))}),(function(t){return 1===t?1:1-Of(2,-10*t)}),(function(t){return 0===t||1===t?t:(t*=2)<1?.5*Of(2,10*(t-1)):.5*(2-Of(2,-10*(t-1)))})),Rf=pf(null,(function(t){return-(bf(1-t*t)-1)}),(function(t){return bf(1- --t*t)}),(function(t){return(t/=.5)<1?-.5*(bf(1-t*t)-1):.5*(bf(1-(t-=2)*t)+1)})),Cf=pf({a:1,p:.4,s:.1,config:function(t,e){Cf.a=t,Cf.p=e,Cf.s=e/(2*Tf)*Math.asin(1/t)||0}},(function(t){return-Cf.a*Of(2,10*(t-=1))*Sf((t-Cf.s)*(2*Tf)/Cf.p)}),(function(t){return Cf.a*Of(2,-10*t)*Sf((t-Cf.s)*(2*Tf)/Cf.p)+1}),(function(t){return(t*=2)<1?Cf.a*Of(2,10*(t-=1))*Sf((t-Cf.s)*(2*Tf)/Cf.p)*-.5:Cf.a*Of(2,-10*(t-=1))*Sf((t-Cf.s)*(2*Tf)/Cf.p)*.5+1})),xf=pf({o:1.70158,s:2.59491,config:function(t){xf.o=t,xf.s=1.525*t}},(function(t){return t*t*((xf.o+1)*t-xf.o)}),(function(t){return(t-=1)*t*((xf.o+1)*t+xf.o)+1}),(function(t){return(t*=2)<1?t*t*((xf.s+1)*t-xf.s)*.5:.5*((t-=2)*t*((xf.s+1)*t+xf.s)+2)})),wf=pf(null,(function(t){return 1-wf.EaseOut(1-t)}),(function(t){return(t/=1)<.36364?7.5625*t*t:t<.72727?7.5625*(t-=.54545)*t+.75:t<.90909?7.5625*(t-=.81818)*t+.9375:7.5625*(t-=.95455)*t+.984375}),(function(t){return t<.5?.5*wf.EaseIn(2*t):.5*wf.EaseOut(2*t-1)+.5}));df.Ease={Linear:mf,Quad:_f,Cubic:gf,Quart:vf,Quint:yf,Sine:Lf,Expo:If,Circ:Rf,Elastic:Cf,Back:xf,Bounce:wf};var Nf=df,Pf=Ks.create({Extends:fu,isBoxGeometry:!0,className:"BoxGeometry",width:1,height:1,depth:1,widthSegments:1,heightSegments:1,depthSegments:1,constructor:function(t){Pf.superclass.constructor.call(this,t),this.isSegments()?this.buildWithSegments():this.build()},buildWithSegments:function(){var t=this.width,e=this.height,n=this.depth,r=this.widthSegments,i=this.heightSegments,o=this.depthSegments,s=i*o*6,a=r*o*6,u=r*i*6,c=2*((i+1)*(o+1)+(r+1)*(o+1)+(r+1)*(i+1)),h=new Float32Array(3*c),l=new Float32Array(3*c),f=new Float32Array(2*c),d=new Uint16Array(2*(s+a+u));this.vertices=new Qa(h,3),this.normals=new Qa(l,3),this.uvs=new Qa(f,2),this.indices=new Qa(d,1);var p=[0,0];this.buildPlane(p,2,1,0,-1,1,n,e,t/2,o,i),this.buildPlane(p,2,1,0,1,1,n,e,-t/2,o,i),this.buildPlane(p,0,2,1,1,-1,t,n,e/2,r,o),this.buildPlane(p,0,2,1,1,1,t,n,-e/2,r,o),this.buildPlane(p,0,1,2,1,1,t,e,n/2,r,i),this.buildPlane(p,0,1,2,-1,1,t,e,-n/2,r,i)},buildPlane:function(t,e,n,r,i,o,s,a,u,c,h){for(var l=s/c,f=a/h,d=s/2,p=a/2,m=t[0],_=t[1],g=this.vertices.data,v=this.normals.data,y=this.uvs.data,E=this.indices.data,T=0;T<=h;T++)for(var A=(T*f-p)*o,S=0;S<=c;S++){if(g[3*m+e]=(S*l-d)*i,g[3*m+n]=A,g[3*m+r]=u,v[3*m+e]=0,v[3*m+n]=0,v[3*m+r]=u<0?-1:1,y[2*m]=S/c,y[2*m+1]=1-T/h,S<c&&T<h){var M=t[0]+(T+1)*(c+1)+S;E[_++]=M,E[_++]=m,E[_++]=M+1,E[_++]=M+1,E[_++]=m,E[_++]=m+1}m++}t[0]=m,t[1]=_},build:function(){var t=new Float32Array(72),e=new Uint16Array(36);this.vertices=new Qa(t,3),this.indices=new Qa(e,1);var n=this.width/2,r=this.height/2,i=this.depth/2,o=[-n,-r,-i],s=[n,-r,-i],a=[n,r,-i],u=[-n,r,-i],c=[-n,-r,i],h=[n,-r,i],l=[n,r,i],f=[-n,r,i];this.addRect(h,s,a,l),this.addRect(o,c,f,u),this.addRect(f,l,a,u),this.addRect(o,s,h,c),this.addRect(c,h,l,f),this.addRect(s,o,u,a)},isSegments:function(){return this.widthSegments>1||this.heightSegments>1||this.depthSegments>1},setFrontUV:function(t){this.isSegments()?h.warn("segmented BoxGeometry dont support setFrontUV!"):this.setVertexUV(32,t)},setRightUV:function(t){this.isSegments()?h.warn("segmented BoxGeometry dont support setRightUV!"):this.setVertexUV(0,t)},setBackUV:function(t){this.isSegments()?h.warn("segmented BoxGeometry dont support setBackUV!"):this.setVertexUV(40,t)},setLeftUV:function(t){this.isSegments()?h.warn("segmented BoxGeometry dont support setLeftUV!"):this.setVertexUV(8,t)},setTopUV:function(t){this.isSegments()?h.warn("segmented BoxGeometry dont support setTopUV!"):this.setVertexUV(16,t)},setBottomUV:function(t){this.isSegments()?h.warn("segmented BoxGeometry dont support setBottomUV!"):this.setVertexUV(24,t)},setAllRectUV:function(t){if(this.isSegments())return h.warn("segmented BoxGeometry dont support setAllRectUV!"),null;for(var e=0;e<6;e++)this.setVertexUV(8*e,t);return this},_raycast:function(t,e){return Pf.superclass._raycast.call(this,t,e)}}),Df=Pf,Hf=Ss.FRONT,Ff=Ss.BACK,Uf=[0,0,1],Bf=Ks.create({Extends:fu,isPlaneGeometry:!0,className:"PlaneGeometry",width:1,height:1,widthSegments:1,heightSegments:1,constructor:function(t){Bf.superclass.constructor.call(this,t),this.build()},build:function(){for(var t=this.widthSegments,e=this.heightSegments,n=(t+1)*(e+1),r=this.width/t,i=this.height/e,o=new Float32Array(3*n),s=new Float32Array(3*n),a=new Float32Array(2*n),u=new Uint16Array(t*e*6),c=0,h=0;h<=e;h++)for(var l=0;l<=t;l++){var f=h*(t+1)+l;if(o[3*f]=l*r-this.width/2,o[3*f+1]=this.height/2-h*i,s[3*f]=0,s[3*f+1]=0,s[3*f+2]=1,a[2*f]=l/t,a[2*f+1]=1-h/e,h<e&&l<t){var d=(h+1)*(t+1)+l;u[c++]=f,u[c++]=d,u[c++]=d+1,u[c++]=f,u[c++]=d+1,u[c++]=f+1}}this.vertices=new Qa(o,3),this.indices=new Qa(u,1),this.normals=new Qa(s,3),this.uvs=new Qa(a,2)},_raycast:function(t,e){var n=t.origin.z,r=t.direction.z;if(e===Hf&&(r>0||n<0))return null;if(e===Ff&&(r<0||n>0))return null;var i=t.intersectsPlane(Uf,0);if(i){var o=i.x,s=i.y,a=.5*this.width,u=.5*this.height;if(o>=-a&&o<=a&&s>=-u&&s<=u)return[i]}return null}}),Gf=Bf,kf=Ks.create({Extends:fu,isSphereGeometry:!0,className:"SphereGeometry",radius:1,heightSegments:16,widthSegments:32,constructor:function(t){kf.superclass.constructor.call(this,t),this.build()},build:function(){for(var t=this.radius,e=this.heightSegments,n=this.widthSegments,r=(n+1)*(e+1),i=n*e,o=new Float32Array(3*r),s=new Float32Array(4*r),a=new Float32Array(2*r),u=new Uint16Array(6*i),c=0,h=0,l=0,f=0,d=0,p=2*Math.PI,m=Math.PI,_=0;_<=e;_++)for(var g=_/e,v=m*g,y=Math.cos(v)*t,E=Math.sin(v)*t,T=0;T<=n;T++){var A=T/n,S=p*A,M=Math.cos(S),O=Math.sin(S),b=M*E,L=O*E,I=O,R=-M;if(s[l++]=I,s[l++]=0,s[l++]=R,s[l++]=1,o[h++]=b,o[h++]=y,o[h++]=L,a[f++]=A,a[f++]=g,_>0&&T>0){var C=d,x=C-1,w=x-n-1,N=C-n-1;u[c++]=w,u[c++]=N,u[c++]=C,u[c++]=w,u[c++]=C,u[c++]=x}d++}this.vertices=new Qa(o,3),this.indices=new Qa(u,1),this.uvs=new Qa(a,2),this.tangents=new Qa(s,4),this.normals=new Qa(new Float32Array(o),3)},_raycast:function(t,e){return kf.superclass._raycast.call(this,t,e)}}),jf=kf,Vf=[Cu,Gu,zu,tc,pc,bc],Xf=function(){var t="";return Vf.forEach((function(e){t+="".concat(e.prototype.className,":").concat(Object.keys(e.cache._cache).length," ")})),h.log(t),t},Wf=Ks.create({Mixes:ta,isLoadCache:!0,className:"LoadCache",Statics:{PENDING:1,LOADED:2,FAILED:3},enabled:!0,constructor:function(){this._files={}},update:function(t,e,n){if(this.enabled){var r={key:t,state:e,data:n};this._files[t]=r,this.fire("update",r),this.fire("update:".concat(r.key),r)}},get:function(t){return this.enabled?this._files[t]:null},getLoaded:function(t){var e=this.get(t);return e&&e.state===Wf.LOADED?e.data:null},remove:function(t){delete this._files[t]},clear:function(){this._files={}},wait:function(t){var e=this;return t?t.state===Wf.LOADED?Promise.resolve(t.data):t.state===Wf.FAILED?Promise.reject():new Promise((function(n,r){e.on("update:".concat(t.key),(function(t){var e=t.detail;e.state===Wf.LOADED?n(e.data):e.state===Wf.FAILED&&r(e.data)}),!0)})):Promise.reject()}}),zf=Wf,qf=new zf,Yf=Ks.create({Mixes:ta,isBasicLoader:!0,className:"BasicLoader",Statics:{_cache:qf,enalbeCache:function(){qf.enabled=!0},disableCache:function(){qf.enabled=!1},deleteCache:function(t){qf.remove(t)},clearCache:function(){qf.clear()},cache:{get:function(){return qf},set:function(){h.warn("BasicLoader.cache is readonly!")}},TYPE_IMAGE:"img",TYPE_JSON:"json",TYPE_BUFFER:"buffer",TYPE_TEXT:"text"},load:function(t){var e=t.src,n=t.type;if(!n){var r=Ps(e);/^(?:png|jpe?g|gif|webp|bmp)$/i.test(r)&&(n="img"),n||(n=t.defaultType)}return n===Yf.TYPE_IMAGE?this.loadImg(e,t.crossOrigin):this.loadRes(e,n)},isCrossOrigin:function(t){var e=window.location,n=document.createElement("a");return n.href=t,n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol},isBase64:function(t){return/^data:(.+?);base64,/.test(t)},Uint8ArrayFrom:function(t,e){if(Uint8Array.from)return Uint8Array.from(t,e);for(var n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e(t[i]);return r},loadImg:function(t,e){var n=this,r=qf.get(t);return r?qf.wait(r):new Promise((function(r,i){var o=new Image;qf.update(t,zf.PENDING),o.onload=function(){o.onerror=null,o.onabort=null,o.onload=null,qf.update(t,zf.LOADED,o),r(o)},o.onerror=function(){o.onerror=null,o.onabort=null,o.onload=null;var e=new Error("Image load failed for ".concat(t.slice(0,100)));qf.update(t,zf.FAILED,e),i(e)},o.onabort=o.onerror,(e||n.isCrossOrigin(t))&&(n.isBase64(t)||(o.crossOrigin="anonymous")),o.src=t}))},loadRes:function(t,e){var n=this;if(this.isBase64(t)){var r=RegExp.$1,i=t.slice(13+r.length),o=atob(i);return e===Yf.TYPE_JSON?o=JSON.parse(o):e===Yf.TYPE_BUFFER&&(o=this.Uint8ArrayFrom(o,(function(t){return t.charCodeAt(0)})).buffer),Promise.resolve(o)}var s=qf.get(t);return s?qf.wait(s):(qf.update(t,zf.PENDING),this.fire("beforeload"),this.request({url:t,type:e}).then((function(e){return n.fire("loaded"),qf.update(t,zf.LOADED,e),e}),(function(e){throw n.fire("failed",e),qf.update(t,zf.FAILED),new Error("Resource load failed for ".concat(t,", ").concat(e))})))},request:function(t){var e=this;return new Promise((function(n,r){var i=new XMLHttpRequest;i.onload=function(){if(i.status<200||i.status>=300)r(new TypeError("Network request failed for ".concat(i.status)));else{var e="response"in i?i.response:i.responseText;if(t.type===Yf.TYPE_JSON)try{e=JSON.parse(e)}catch(t){return void r(new TypeError("JSON.parse error"+t))}n(e)}},i.onprogress=function(n){e.fire("progress",{url:t.url,loaded:n.loaded,total:n.total})},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request timed out"))},i.open(t.method||"GET",t.url,!0),"include"===t.credentials&&(i.withCredentials=!0),t.type===Yf.TYPE_BUFFER&&(i.responseType="arraybuffer"),Ds(t.headers,(function(t,e){i.setRequestHeader(e,t)})),i.send(t.body||null)}))}}),Jf=Yf,Qf=Ks.create({isLoader:!0,className:"Loader",maxConnections:2,Statics:{_loaderClassMap:{},_loaders:{},addLoader:function(t,e){Qf._loaderClassMap[t]=e},getLoader:function(t){if(!Qf._loaders[t]){var e=Qf._loaderClassMap[t]?Qf._loaderClassMap[t]:Jf;Qf._loaders[t]=new e}return Qf._loaders[t]}},preHandlerUrl:null,load:function(t){var e=this;if(t instanceof Array)return Promise.all(t.map((function(t){return e.load(t)})));var n=t.type||Ps(t.src),r=Qf.getLoader(n),i=t;return this.preHandlerUrl&&((i=Object.assign({},t)).src=this.preHandlerUrl(t.src)),r.load(i)}}),Zf=Qf,Kf=Ks.create({Extends:Jf,isCubeTextureLoader:!0,className:"CubeTextureLoader",constructor:function(){Kf.superclass.constructor.call(this)},load:function(t){var e,n=this;return e=t.images&&Array.isArray(t.images)?t.images:[t.right,t.left,t.top,t.bottom,t.front,t.back],Promise.all(e.map((function(e){return n.loadImg(e,t.crossOrigin)}))).then((function(e){var n=Object.assign({},t);return delete n.images,delete n.type,delete n.right,delete n.left,delete n.top,delete n.bottom,delete n.front,delete n.back,n.image=e,new Nc(n)})).catch((function(t){throw h.error("load CubeTexture failed",t.message,t.stack),t}))}});Zf.addLoader("CubeTexture",Kf);var $f=Kf,td=Ks.create({Extends:_h,isPBRMaterial:!0,className:"PBRMaterial",lightType:"PBR",gammaCorrection:!0,usePhysicsLight:!0,baseColor:null,baseColorMap:null,metallic:1,metallicMap:null,roughness:1,roughnessMap:null,metallicRoughnessMap:null,occlusionMap:null,occlusionStrength:1,isOcclusionInMetallicRoughnessMap:!1,diffuseEnvMap:null,diffuseEnvSphereHarmonics3:null,diffuseEnvIntensity:1,brdfLUT:null,specularEnvIntensity:1,specularEnvMap:null,isSpecularEnvMapIncludeMipmaps:!1,emission:null,emissionFactor:null,isSpecularGlossiness:!1,specular:null,glossiness:1,specularGlossinessMap:null,clearcoatFactor:0,clearcoatMap:null,clearcoatRoughnessFactor:0,clearcoatRoughnessMap:null,clearcoatNormalMap:null,usedUniformVectors:11,constructor:function(t){this.baseColor=new Da(1,1,1),this.specular=new Da(1,1,1),this.emissionFactor=new Da(0,0,0),td.superclass.constructor.call(this,t),Object.assign(this.uniforms,{u_baseColor:"BASECOLOR",u_metallic:"METALLIC",u_roughness:"ROUGHNESS",u_specular:"SPECULAR",u_emissionFactor:"EMISSIONFACTOR",u_glossiness:"GLOSSINESS",u_brdfLUT:"BRDFLUT",u_diffuseEnvMap:"DIFFUSEENVMAP",u_diffuseEnvIntensity:"DIFFUSEENVINTENSITY",u_occlusionStrength:"OCCLUSIONSTRENGTH",u_specularEnvMap:"SPECULARENVMAP",u_specularEnvIntensity:"SPECULARENVINTENSITY",u_specularEnvMapMipCount:"SPECULARENVMAPMIPCOUNT",u_diffuseEnvSphereHarmonics3:"DIFFUSEENVSPHEREHARMONICS3",u_clearcoatFactor:"CLEARCOATFACTOR",u_clearcoatRoughnessFactor:"CLEARCOATROUGHNESSFACTOR"}),this.addTextureUniforms({u_baseColorMap:"BASECOLORMAP",u_metallicMap:"METALLICMAP",u_roughnessMap:"ROUGHNESSMAP",u_metallicRoughnessMap:"METALLICROUGHNESSMAP",u_occlusionMap:"OCCLUSIONMAP",u_specularGlossinessMap:"SPECULARGLOSSINESSMAP",u_lightMap:"LIGHTMAP",u_clearcoatMap:"CLEARCOATMAP",u_clearcoatRoughnessMap:"CLEARCOATROUGHNESSMAP",u_clearcoatNormalMap:"CLEARCOATNORMALMAP"})},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};td.superclass.getRenderOption.call(this,t);var e=this._textureOption.reset(t);return e.add(this.baseColorMap,"BASE_COLOR_MAP"),e.add(this.metallicMap,"METALLIC_MAP"),e.add(this.roughnessMap,"ROUGHNESS_MAP"),e.add(this.metallicRoughnessMap,"METALLIC_ROUGHNESS_MAP"),e.add(this.diffuseEnvMap,"DIFFUSE_ENV_MAP"),e.add(this.occlusionMap,"OCCLUSION_MAP"),e.add(this.lightMap,"LIGHT_MAP"),this.brdfLUT&&(e.add(this.specularEnvMap,"SPECULAR_ENV_MAP"),vu.SHADER_TEXTURE_LOD&&this.specularEnvMap&&(t.USE_SHADER_TEXTURE_LOD=1)),this.isSpecularGlossiness&&(t.PBR_SPECULAR_GLOSSINESS=1,e.add(this.specularGlossinessMap,"SPECULAR_GLOSSINESS_MAP")),this.isOcclusionInMetallicRoughnessMap&&(t.IS_OCCLUSION_MAP_IN_METALLIC_ROUGHNESS_MAP=1),1!==this.occlusionStrength&&(t.OCCLUSION_STRENGTH=1),this.diffuseEnvSphereHarmonics3&&(t.HAS_NORMAL=1,t.DIFFUSE_ENV_SPHERE_HARMONICS3=1),(this.specularEnvMap||this.diffuseEnvSphereHarmonics3||this.specularEnvMap)&&(t.NEED_WORLD_NORMAL=1),this.specularEnvMap&&this.isSpecularEnvMapIncludeMipmaps&&(t.IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS=1),this.clearcoatFactor>0&&(t.HAS_CLEARCOAT=1,t.HAS_NORMAL=1,this.clearcoatMap&&e.add(this.clearcoatMap,"CLEARCOAT_MAP"),this.clearcoatNormalMap&&e.add(this.clearcoatNormalMap,"CLEARCOAT_NORMAL_MAP"),this.clearcoatRoughnessMap&&e.add(this.clearcoatRoughnessMap,"CLEARCOAT_ROUGHNESS_MAP")),e.update(),t}}),ed=td,nd=new Image;nd.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";var rd=Ks.create({Extends:pc,Mixes:ta,isLazyTexture:!0,className:"LazyTexture",_src:"",crossOrigin:!1,autoLoad:!0,resType:"",src:{get:function(){return this._src},set:function(t){this._src!==t&&(this._src=t,this.autoLoad&&this.load())}},constructor:function(t){t&&("crossOrigin"in t&&(this.crossOrigin=t.crossOrigin),"autoLoad"in t&&(this.autoLoad=t.autoLoad)),rd.superclass.constructor.call(this,t),this.image=this.placeHolder||nd},load:function(t){var e=this;return rd.loader=rd.loader||new Zf,rd.loader.load({src:this.src,crossOrigin:this.crossOrigin,type:this.resType,defaultType:"img"}).then((function(t){t.isTexture?(Object.assign(e,t),e.needUpdate=!0,e.needDestroy=!0,e.fire("load")):(e.image=t,e.needUpdate=!0,e.fire("load"))}),(function(n){if(e.fire("error"),t)throw new Error("LazyTexture Failed ".concat(n));h.warn("LazyTexture Failed ".concat(n))}))},_releaseImage:function(){this._src&&"string"!=typeof this._src&&(this._src=""),rd.superclass._releaseImage.call(this)}}),id=rd;function od(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return sd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sd(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ad=new ca,ud=new ca,cd=new ca,hd=new ca,ld=new ca,fd=new ca,dd=new Ma,pd=[];function md(t,e){return t-e}var _d=Ks.create({Statics:{interpolation:{LINEAR:function(t,e,n){if(void 0===e)return t;if(t.slerp)return t.slerp(e,n);if(t.lerp)return t.lerp(e,n);if(Ys(t)){pd.length=0;for(var r=t.length-1;r>=0;r--)pd[r]=t[r]+n*(e[r]-t[r]);return pd}return t+n*(e-t)},STEP:function(t,e,n){return t},CUBICSPLINE:function(t,e,n,r){var i=t.length/3;if(void 0===e)return 1===i?t[1]:t.slice(i,-i);var o=t[1],s=t[2],a=e[1],u=e[0];return i>1&&(o=t.slice(i,-i),s=t.slice(-i),a=e.slice(i,-i),u=e.slice(0,i)),o.hermite?o.hermite(o,s.scale(r),a,u.scale(r),n):o.isQuaternion?(o.fromArray(this._cubicSpline(o.elements,s.elements,a.elements,u.elements,r,n),0,!0),o.normalize(!0)):(Ys(o)||(o=[o],s=[s],a=[a],u=[u]),o=this._cubicSpline(o,s,a,u,r,n)),o},_cubicSpline:function(t,e,n,r,i,o){var s=o*o,a=s*o,u=2*a-3*s+1,c=a-2*s+o,h=-2*a+3*s,l=a-s;pd.length=0;for(var f=t.length-1;f>=0;f--)pd[f]=t[f]*u+c*e[f]*i+n[f]*h+l*r[f]*i;return pd}},StateType:{TRANSLATE:"Translation",POSITION:"Translation",TRANSLATION:"Translation",SCALE:"Scale",ROTATE:"Rotation",ROTATION:"Rotation",QUATERNION:"Quaternion",WEIGHTS:"Weights"},getType:function(t){return t=String(t).toUpperCase(),_d.StateType[t]||_d._extraStateHandlers.type[t]},_extraStateHandlers:{type:{},handler:{}},registerStateHandler:function(t,e){_d._extraStateHandlers.type[String(t).toUpperCase()]=t,_d._extraStateHandlers.handler[t]=e}},isAnimationStates:!0,className:"AnimationStates",nodeName:"",type:"",interpolationType:"LINEAR",constructor:function(t){this.id=Ea.generateUUID(this.className),this.keyTime=[],this.states=[],Object.assign(this,t)},findIndexByTime:function(t){return Hs(this.keyTime,t,md)},getStateByIndex:function(t){var e=this.states.length/this.keyTime.length;return 1===e?this.states[t]:this.states.slice(t*e,t*e+e)},getState:function(t){var e=od(this.findIndexByTime(t),2),n=e[0],r=e[1];if(n<0||r>=this.keyTime.length)return null;var i=this.keyTime[n],o=this.keyTime[r],s=this.getStateByIndex(n);if("STEP"===this.interpolationType)return s;if(n===r){var a=this.interpolation(s);return this.type===_d.StateType.ROTATION&&(a=ad.fromEuler(dd.fromArray(a))),a.elements||a}var u=this.getStateByIndex(r),c=o-i,h=(t-i)/c;this.type===_d.StateType.ROTATION?Ys(s[0])?(s[0]=ad.fromEuler(dd.fromArray(s[0])),s[1]=ud.fromEuler(dd.fromArray(s[1])),s[2]=cd.fromEuler(dd.fromArray(s[2])),u[0]=hd.fromEuler(dd.fromArray(u[0])),u[1]=ld.fromEuler(dd.fromArray(u[1])),u[2]=fd.fromEuler(dd.fromArray(u[2]))):(s=ad.fromEuler(dd.fromArray(s)),u=ud.fromEuler(dd.fromArray(u))):this.type===_d.StateType.QUATERNION&&(Ys(s[0])?(s[0]=ad.fromArray(s[0]),s[1]=ud.fromArray(s[1]),s[2]=cd.fromArray(s[2]),u[0]=hd.fromArray(u[0]),u[1]=ld.fromArray(u[1]),u[2]=fd.fromArray(u[2])):(s=ad.fromArray(s),u=ud.fromArray(u)));var l=this.interpolation(s,u,h,c);return l.elements||l},interpolation:function(t,e,n,r){return _d.interpolation[this.interpolationType](t,e,n,r)},updateNodeTranslation:function(t,e){t.x=e[0],t.y=e[1],t.z=e[2]},updateNodeScale:function(t,e){t.scaleX=e[0],t.scaleY=e[1],t.scaleZ=e[2]},updateNodeQuaternion:function(t,e){t.quaternion.fromArray(e)},updateNodeWeights:function(t,e){var n=this._originalWeightIndices=this._originalWeightIndices||[],r=e.length;e=e.slice();for(var i=0;i<r;i++)n[i]=i;for(var o=0;o<r;o++)for(var s=o+1;s<r;s++)if(e[s]>e[o]){var a=e[o];e[o]=e[s],e[s]=a,a=n[o],n[o]=n[s],n[s]=a}t.traverse((function(t){t.isMesh&&t.geometry&&t.geometry.isMorphGeometry&&t.geometry.update(e,n)}))},updateNodeState:function(t,e){if(e){var n=this.type;n===_d.StateType.ROTATION&&(n=_d.StateType.QUATERNION);var r=this.getState(t);if(r){var i="updateNode"+n;this[i]?this[i](e,r):_d._extraStateHandlers.handler[n]?_d._extraStateHandlers.handler[n].call(this,e,r):h.warnOnce(i,"updateNodeState failed unknow type(%s)",n)}}},clone:function(){return new this.constructor({keyTime:this.keyTime,states:this.states,type:this.type,nodeName:this.nodeName})}}),gd=_d,vd=Ks.create({Statics:{_anims:[],tick:function(t){this._anims.forEach((function(e){return e.tick(t)}))}},Mixes:ta,isAnimation:!0,className:"Animation",paused:!1,currentLoopCount:0,loop:1/0,currentTime:0,timeScale:1,startTime:0,endTime:0,clipStartTime:0,clipEndTime:0,nodeNameMap:null,_rootNode:null,rootNode:{get:function(){return this._rootNode},set:function(t){this._rootNode=t,this._initNodeNameMap()}},_animStatesList:null,animStatesList:{get:function(){return this._animStatesList},set:function(t){this._animStatesList=t,this._initClipTime()}},validAnimationIds:null,constructor:function(t){this.id=Ea.generateUUID(this.className),this.clips={},this._animStatesList=[],Object.assign(this,t)},addClip:function(t,e,n,r){this.clips[t]={start:e,end:n,animStatesList:r}},removeClip:function(t){this.clips[t]=null},getAnimStatesListTimeInfo:function(t){var e=0,n=1/0;return t.forEach((function(t){e=Math.max(t.keyTime[t.keyTime.length-1],e),n=Math.min(t.keyTime[0],n)})),{startTime:n,endTime:e}},_initClipTime:function(){var t=this.getAnimStatesListTimeInfo(this.animStatesList);this.clipStartTime=t.startTime,this.clipEndTime=t.endTime},_initNodeNameMap:function(){if(this._rootNode){var t=this.nodeNameMap={};this._rootNode.traverse((function(e){t[e.animationId]=e;var n=e.name;void 0===n||t[n]||(t[n]=e)}),!1)}},tick:function(t){this.paused||(this.currentTime+=t/1e3*this.timeScale,this.currentTime>=this.endTime?(this.currentLoopCount++,this.currentTime=this.endTime,this.updateAnimStates(),this.fire("loopEnd"),!this.loop||this.currentLoopCount>=this.loop?(this.stop(),this.fire("end")):this.currentTime=this.startTime):this.updateAnimStates())},updateAnimStates:function(){var t=this;return this.animStatesList.forEach((function(e){e.updateNodeState(t.currentTime,t.nodeNameMap[e.nodeName])})),this},play:function(t,e){var n;if("string"==typeof t){var r=this.clips[t];r?(n=r.start,e=r.end,r.animStatesList&&(this.animStatesList=r.animStatesList,this._initClipTime())):h.warn("no this animation clip name:"+t)}else n=t;void 0===n&&(n=this.clipStartTime),void 0===e&&(e=this.clipEndTime),this.endTime=Math.min(e,this.clipEndTime),this.startTime=Math.min(n,this.endTime),this.currentTime=this.startTime,this.currentLoopCount=0,this.stop(),this.paused=!1,vd._anims.push(this)},stop:function(){this.paused=!0;var t=vd._anims,e=t.indexOf(this);-1!==e&&t.splice(e,1)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},clone:function(t){var e=new this.constructor({rootNode:t,animStatesList:this.animStatesList,timeScale:this.timeScale,loop:this.loop,paused:this.paused,currentTime:this.currentTime,startTime:this.startTime,endTime:this.endTime,clips:this.clips});return this.paused||e.play(),e}}),yd=vd;function Ed(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Td(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Td(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Td(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ad=Ss.BLEND,Sd=Ss.DEPTH_TEST,Md=Ss.CULL_FACE,Od=Ss.FRONT,bd=Ss.BACK,Ld=Ss.FRONT_AND_BACK,Id={5120:[1,Int8Array],5121:[1,Uint8Array],5122:[2,Int16Array],5123:[2,Uint16Array],5125:[4,Uint32Array],5126:[4,Float32Array]},Rd={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Cd={POSITION:{name:"vertices",decodeMatName:"positionDecodeMat"},TEXCOORD_0:{name:"uvs",decodeMatName:"uvDecodeMat"},TEXCOORD_1:{name:"uvs1",decodeMatName:"uv1DecodeMat"},NORMAL:{name:"normals",decodeMatName:"normalDecodeMat"},JOINT:{name:"skinIndices"},JOINTS_0:{name:"skinIndices"},WEIGHT:{name:"skinWeights"},WEIGHTS_0:{name:"skinWeights"},TANGENT:{name:"tangents"},COLOR_0:{name:"colors"}},xd=Ks.create({isGLTFParser:!0,className:"GLTFParser",Statics:{MAGIC:"glTF",extensionHandlers:a,registerExtensionHandler:function(t,e){this.extensionHandlers[t]=e},unregisterExtensionHandler:function(t){this.extensionHandlers[t]&&delete this.extensionHandlers[t]}},isMultiAnim:!0,isProgressive:!1,isUnQuantizeInShader:!0,isLoadAllTextures:!1,preHandlerImageURI:null,preHandlerBufferURI:null,customMaterialCreator:null,ignoreTextureError:!1,forceCreateNewBuffer:!1,src:"",constructor:function(t,e){Object.assign(this,e),this.content=t},parse:function(t){var e=this;if(this.content instanceof ArrayBuffer){var n=this.content;if(Ns(new Uint8Array(n,0,4))===xd.MAGIC)this.parseBinary(n);else{var r=Ns(new Uint8Array(n),!0);this.json=JSON.parse(r)}}else this.json=JSON.parse(this.content);return this.glTFVersion=parseFloat(this.json.asset.version),this.glTFVersion>=2&&(this.isGLTF2=!0),this.parseExtensionUsed(),this.loadResources(t).then((function(){return e.parseExtensions(e.json.extensions,null,{isGlobal:!0,methodName:"parseOnLoad"}),Promise.resolve()})).then((function(){return e.parseGeometries()})).then((function(){return e.parseScene()}))},parseExtensionUsed:function(){var t=this;this.extensionsUsed={},Ds(this.json.extensionsUsed,(function(e){t.extensionsUsed[e]=!0})),this.extensionsUsed.WEB3D_quantized_attributes||(this.isUnQuantizeInShader=!1)},getExtensionHandler:function(t){return this.extensionHandlers&&this.extensionHandlers[t]||xd.extensionHandlers[t]},parseExtension:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t[e],o=this.getExtensionHandler(e);return o&&o.parse?o.parse(i,this,n,r):n},parseExtensions:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ds(t,(function(t,i){if(!r.ignoreExtensions||!r.ignoreExtensions[i]){var o=n.getExtensionHandler(i),s=r.methodName||"parse";o&&o[s]&&(e=o[s](t,n,e,r))}})),e},isUseExtension:function(t,e){return!!(t&&t.extensions&&t.extensions[e])},parseBinary:function(t){this.isBinary=!0;var e,n=new DataView(t),r=n.getUint32(4,!0),i=n.getUint32(8,!0),o=12;if(r<2){var s=n.getUint32(o,!0);e=Ns(e=new Uint8Array(t,20,s),!0),this.json=JSON.parse(e),this.binaryBody=t.slice(20+s)}else{if(2!==r)throw new Error("Dont support glTF version ".concat(r));for(;o<i;){var a=n.getUint32(o,!0),u=n.getUint32(o+4,!0);1313821514===u?(e=Ns(e=new Uint8Array(t,o+8,a),!0),this.json=JSON.parse(e)):5130562===u&&(this.binaryBody=t.slice(o+8,o+8+a)),o+=8+a}}},loadResources:function(t){var e=this,n=[];for(var r in this.extensionsUsed){var i=this.getExtensionHandler(r);i&&i.init&&n.push(i.init(t,this))}return this.isBinary?n.push(this.loadBuffers(t).then((function(){return e.loadTextures(t)}))):(n.push(this.loadBuffers(t)),n.push(this.loadTextures(t))),Promise.all(n)},getBufferUri:function(t){var e=ws(this.src,this.json.buffers[t].uri);return this.preHandlerBufferURI&&(e=this.preHandlerBufferURI(e,this.json.buffers[t])),e},loadBuffers:function(t){var e=this;return this.buffers={},this.isBinary?(this.isGLTF2?this.buffers[0]=this.binaryBody:this.buffers.binary_glTF=this.binaryBody,this.parseBufferViews(),Promise.resolve()):Promise.all(Object.keys(this.json.buffers||[]).map((function(n){var r=e.getBufferUri(n);return t.loadRes(r,Jf.TYPE_BUFFER).then((function(t){e.buffers[n]=t}))}))).then((function(){e.parseBufferViews()}))},getImageUri:function(t){var e=this.json.images[t],n=e.uri;if(this.isUseExtension(e,"KHR_binary_glTF")){var r=e.extensions.KHR_binary_glTF,i=this.bufferViews[r.bufferView],o=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);n=qs(r.mimeType,o)}else if(n)n=ws(this.src,n);else if("bufferView"in e){var s=this.bufferViews[e.bufferView],a=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);n="image/ktx"===e.mimeType?a:qs(e.mimeType,a)}return this.preHandlerImageURI&&(n=this.preHandlerImageURI(n,e)),n},getImageType:function(t){var e=this.json.images[t],n="";return e&&/^image\/(.*)$/.test(e.mimeType)&&(n=RegExp.$1),["ktx"].indexOf(n)<0&&(n=""),n},getUsedTextureNameMap:function(){var t=this,e={};return Ds(this.json.materials,(function(n){var r=n,i=!1;if(t.isUseExtension(n,"KHR_materials_common")&&(i=!0,r=n.extensions.KHR_materials_common.values),t.isGLTF2&&!i){if(r.normalTexture&&(e[r.normalTexture.index]=!0),r.occlusionTexture&&(e[r.occlusionTexture.index]=!0),r.emissiveTexture&&(e[r.emissiveTexture.index]=!0),r.transparencyTexture&&(e[r.transparencyTexture.index]=!0),r.extensions&&Ds(r.extensions,(function(n,r){var i=t.getExtensionHandler(r);i&&i.getUsedTextureNameMap&&i.getUsedTextureNameMap(n,e,t)})),!t.isUseExtension(r,"KHR_materials_pbrSpecularGlossiness")&&r.pbrMetallicRoughness){var o=r.pbrMetallicRoughness;o.baseColorTexture&&(e[o.baseColorTexture.index]=!0),o.metallicRoughnessTexture&&(e[o.metallicRoughnessTexture.index]=!0)}}else i||(r=n.values),["diffuse","specular","emission","ambient","transparency","normalMap"].forEach((function(n){var i=r[n];i instanceof Object&&"index"in i&&(i=i.index),Xs(i)&&t.json.textures[i]&&(e[i]=!0)}))})),e},loadTextures:function(){var t=this;if(this.textures={},!this.json.textures)return Promise.resolve();var e=Object.keys(this.json.textures);if(!this.isLoadAllTextures){var n=this.getUsedTextureNameMap();e=e.filter((function(t){return n[t]}))}return Promise.all(e.map((function(e){var n=t.json.textures[e],r=t.getImageUri(n.source),i=new id(n);if(i.uv=void 0,i.autoLoad=t.isProgressive,i.crossOrigin=!0,i.resType=t.getImageType(n.source),i.src=r,i.name=n.name||e,i.colorSpaceConversion=!1,Ws(r)){var o=function t(){zs(r),i.off("load",t),i.off("error",t)};i.on("load",o,!0),i.on("error",o,!0)}return t.json.samplers&&Object.assign(i,t.json.samplers[n.sampler]),n.extensions&&(i=t.parseExtensions(n.extensions,i)),t.textures[e]=i,t.isProgressive?Promise.resolve():i.load(!t.ignoreTextureError)})))},parseBufferViews:function(){var t=this;this.bufferViews={},Ds(this.json.bufferViews,(function(e,n){var r=t.buffers[e.buffer],i=e.byteOffset||0,o=e.byteLength;t.bufferViews[n]={id:Ea.generateUUID("bufferView"),byteOffset:i,byteLength:o,buffer:r,byteStride:e.byteStride}})),this.isBinary||delete this.buffers},getTexture:function(t){var e=this.textures[t.index];if(!e)return null;var n=t.texCoord||0,r=t.index+"_"+n;return this.textures[r]?e=this.textures[r]:"number"==typeof e.uv&&e.uv!==n&&(e=e.clone(),this.textures[r]=e),e.uv=n,e.__gltfTextureInfo=t,e},getColorOrTexture:function(t){return Array.isArray(t)?new Da(t[0],t[1],t[2]):(t instanceof Object&&"index"in t&&(t=t.index),this.textures[t])},parseMaterialCommonProps:function(t,e){switch(e.alphaMode){case"BLEND":t.transparent=!0;break;case"MASK":t.alphaCutoff="alphaCutoff"in e?e.alphaCutoff:.5;break;case"OPAQUE":default:t.ignoreTranparent=!0}e.doubleSided?t.side=Ld:t.side=Od,e.transparencyTexture&&(t.transparency=this.getTexture(e.transparencyTexture))},createPBRMaterial:function(t){var e=new ed,n=t,r=!this.isUseExtension(n,"KHR_materials_unlit");if(r){var i=n.normalTexture;i&&(e.normalMap=this.getTexture(i),void 0!==i.scale?e.normalMapScale=i.scale:e.normalMapScale=1);var o=n.occlusionTexture;o&&(e.occlusionMap=this.getTexture(o),void 0!==o.strength?e.occlusionStrength=o.strength:e.occlusionStrength=1);var s=n.emissiveTexture;s&&(e.emission=this.getTexture(s));var a=n.emissiveFactor;a&&(e.emissionFactor.fromArray(a),e.emissionFactor.a=1)}else e.lightType="NONE";if(this.isUseExtension(n,"KHR_materials_pbrSpecularGlossiness"))this.parseExtension(n.extensions,"KHR_materials_pbrSpecularGlossiness",e);else if(n.pbrMetallicRoughness){var u=n.pbrMetallicRoughness;u.baseColorFactor&&e.baseColor.fromArray(u.baseColorFactor),u.baseColorTexture&&(e.baseColorMap=this.getTexture(u.baseColorTexture)),r&&(u.metallicRoughnessTexture&&(e.metallicRoughnessMap=this.getTexture(u.metallicRoughnessTexture),e.occlusionMap===e.metallicRoughnessMap&&(e.occlusionMap=null,e.isOcclusionInMetallicRoughnessMap=!0)),"roughnessFactor"in u&&(e.roughness=u.roughnessFactor),"metallicFactor"in u&&(e.metallic=u.metallicFactor))}return e.baseColorMap&&this._parseTextureTransform(e,e.baseColorMap),e},_parseTextureTransform:function(t,e){var n=e.__gltfTextureInfo;if(this.isUseExtension(n,"KHR_texture_transform")){var r=n.extensions.KHR_texture_transform;if(void 0!==r.texCoord&&(e.uv=r.texCoord),r.offset||r.rotation||r.scale){var i=r.offset||[0,0],o=r.rotation||0,s=r.scale||[1,1],a=(new oa).fromRotationTranslationScale(o,i[0],i[1],s[0],s[1]);0===e.uv?t.uvMatrix=a:1===e.uv&&(t.uvMatrix1=a)}}},createKMCMaterial:function(t,e){var n,r=new vh;return e?(n=e.values,r.lightType=e.technique):n=t.values,r.diffuse=this.getColorOrTexture(n.diffuse)||r.diffuse,r.specular=this.getColorOrTexture(n.specular)||r.specular,r.emission=this.getColorOrTexture(n.emission)||r.emission,r.ambient=this.getColorOrTexture(n.ambient)||r.ambient,n.normalMap&&(r.normalMap=this.getColorOrTexture(n.normalMap)),"number"==typeof n.transparency?(r.transparency=n.transparency,r.transparency<1&&(r.transparent=!0)):"string"==typeof n.transparency&&(r.transparency=this.getColorOrTexture(n.transparency),r.transparent=!0),!0===n.transparent&&(r.transparent=!0),"shininess"in n&&(r.shininess=n.shininess),this._parseTextureTransform(r,r.diffuse),r},parseMaterials:function(){var t=this;this.materials={},Ds(this.json.materials,(function(e,n){if(t.customMaterialCreator){var r=t.customMaterialCreator(n,e,t.json,t);if(r)return void(t.materials[n]=r)}var i,o=null;t.isUseExtension(e,"KHR_materials_common")&&(o=e.extensions.KHR_materials_common),t.isGLTF2&&!o?(i=t.isUseExtension(e,"KHR_techniques_webgl")?t.parseExtension(e.extensions,"KHR_techniques_webgl"):t.createPBRMaterial(e),t.parseMaterialCommonProps(i,e)):i=t.createKMCMaterial(e,o),(i=t.parseExtensions(e.extensions,i,{ignoreExtensions:{KHR_techniques_webgl:1,KHR_materials_common:1,KHR_materials_pbrSpecularGlossiness:1},isMaterial:!0})).name=e.name||n,t.materials[n]=i,t.parseTechnique(e,i)}))},sparseAccessorHandler:function(t,e){if(!e)return t;var n=e.count,r=t.data.constructor,i=new r(t.realLength);i.set(t.data),t.data=i;for(var o=this.bufferViews[e.values.bufferView],s=new r(o.buffer,o.byteOffset+(e.values.byteOffset||0),n*t.size),a=new(r=Id[e.indices.componentType][1])((o=this.bufferViews[e.indices.bufferView]).buffer,o.byteOffset+(e.indices.byteOffset||0),n),u=0;u<n;u++)Vs(i,s,a[u]*t.size,u*t.size,t.size);return t},getAccessorData:function(t,e){var n=this.json.accessors[t];if(n.data)return n.data;var r,i=Ed(Id[n.componentType],2)[1],o=Rd[n.type],s=this.bufferViews[n.bufferView],a=n.count*o;if(s)if(s.byteStride&&s.byteStride>o*i.BYTES_PER_ELEMENT)s.array=new i(s.buffer,s.byteOffset,s.byteLength/i.BYTES_PER_ELEMENT),r=new Qa(s.array,o,{offset:n.byteOffset||0,stride:s.byteStride,bufferViewId:s.id});else{var u,c=(n.byteOffset||0)+s.byteOffset;u=c%i.BYTES_PER_ELEMENT||this.forceCreateNewBuffer?new i(s.buffer.slice(c,c+a*i.BYTES_PER_ELEMENT)):new i(s.buffer,c,a),r=new Qa(u,o)}return n.sparse&&(r||(r=new Qa(new i(a),o)),r=this.sparseAccessorHandler(r,n.sparse)),r=this.parseExtensions(n.extensions,r,{isDecode:e,isAccessor:!0}),n.data=r,n.normalized&&(r.normalized=!0),r},getArrayByAccessor:function(t,e){var n=this.json.accessors[t];if(n.array)return n.array;var r=this.getAccessorData(t,e);if(!r.stride&&!r.offset&&1===r.size)return r.data;var i=[];return r.traverse((function(t){i.push(t.toArray?t.toArray():t)})),n.array=i,i},parseTechnique:function(t,e){var n=null;this.json.techniques&&(n=this.json.techniques[t.technique]),n&&n.states&&(n.states.enable.forEach((function(t){switch(t){case Ad:e.blend=!0;break;case Sd:e.depthTest=!0;break;case Md:e.cullFace=!0}})),Ds(n.states.functions,(function(t,n){switch(n){case"blendEquationSeparate":e.blendEquation=t[0],e.blendEquationAlpha=t[1];break;case"blendFuncSeparate":e.blendSrc=t[0],e.blendDst=t[1],e.blendSrcAlpha=t[2],e.blendDstAlpha=t[3];break;case"depthMask":e.depthMask=t[0];break;case"cullFace":e.cullFaceType=t[0];break;default:e[n]=t}})),e.cullFace?e.side=e.cullFaceType===Od?bd:Od:e.side=Ld)},createMorphGeometry:function(t,e){var n=this,r=new ll,i=r.targets={};return Ds(t.targets,(function(t){Ds(t,(function(t,e){var r=Cd[e].name;i[r]||(i[r]=[]);var o=n.getAccessorData(t,!0);i[r].push(o)}))})),r.weights=e||new Float32Array(t.targets.length),r},handlerGeometry:function(t,e){var n=void 0===e.mode?4:e.mode;if(e.extensions){var r=this.parseExtensions(e.extensions,null,{primitive:e,isPrimitive:!0});if(r)return r.mode=n,r}t||(t=new fu({mode:n})),"indices"in e&&(t.indices=this.getAccessorData(e.indices));var i=e.attributes;for(var o in i){var s=Cd[o];if(s){var a=!(this.isUnQuantizeInShader&&s.decodeMatName);t[s.name]=this.getAccessorData(i[o],a),a||(t[s.decodeMatName]=t[s.name].decodeMat,delete t[s.name].decodeMat)}else h.warn("Unknow attribute named ".concat(o,"!"))}return t},handlerSkinedMesh:function(t,e){e&&(t.skeleton=e,this.useInstanced&&(t.useInstanced=!0))},fixProgressiveGeometry:function(t,e){t._geometry=e,this.isProgressive&&t._meshes&&t._meshes.forEach((function(t){t.visible=!0,t.geometry=e}))},parseGeometries:function(){var t=this,e=Qs(this.json.meshes,(function(e){return Qs(e.primitives,(function(n){var r;n.targets&&n.targets.length&&(r=t.createMorphGeometry(n,e.weights)),n._geometry=r;var i=t.handlerGeometry(r,n);return i&&i.then?i.then((function(e){t.fixProgressiveGeometry(n,e)}),(function(t){h.error("geometry parse error",t)})):(t.fixProgressiveGeometry(n,i),i)}))}));return this.isProgressive?null:e},parseMesh:function(t,e,n){var r=this,i=this.json.meshes[t];i.primitives.forEach((function(o){var s,a=r.skins&&r.skins[n.skin];if(o.meshNode)s=o.meshNode.clone();else{var u=r.materials[o.material]||new vh;s=new(a?Fl:Nl)({geometry:o._geometry,material:u,name:"mesh-"+(i.name||t)}),o.meshNode=s}r.handlerSkinedMesh(s,a),r.isProgressive&&!s.geometry&&(s.visible=!1,o._meshes=o._meshes||[],o._meshes.push(s)),e.addChild(s),r.meshes.push(s)}))},parseCameras:function(){var t=this;this.cameras={};var e=window.innerWidth/window.innerHeight;Ds(this.json.cameras,(function(n,r){var i;"perspective"===n.type&&n.perspective?((i=new pu).fov=Ea.radToDeg(n.perspective.yfov),i.near=n.perspective.znear,i.far=n.perspective.zfar,n.aspectRatio?i.aspect=n.aspectRatio:i.aspect=e):"orthographic"===n.type&&n.orthographic&&((i=new Lh).near=n.orthographic.znear,i.far=n.orthographic.zfar,i.right=n.orthographic.xmag,i.left=-1*i.right,i.top=n.orthographic.ymag,i.bottom=-1*i.top),(i=t.parseExtensions(n.extensions,i,{isCamera:!0}))&&(i.name=n.name||r,t.cameras[r]=i)}))},handlerNodeTransform:function(t,e){e.matrix?t.matrix.fromArray(e.matrix):(e.rotation&&t.quaternion.fromArray(e.rotation),e.scale&&t.setScale(e.scale[0],e.scale[1],e.scale[2]),e.translation&&(t.x=e.translation[0],t.y=e.translation[1],t.z=e.translation[2]))},parseNode:function(t,e){var n,r=this,i=this.json.nodes[t];i||h.warn("GLTFParser.parseNode: nodes[".concat(t,"] has nothing.")),n=new xa({name:i.name,animationId:t}),n=this.parseExtensions(i.extensions,n,{isNode:!0}),"camera"in i&&this.cameras[i.camera]&&n.addChild(this.cameras[i.camera]),this.handlerNodeTransform(n,i),i.jointName?(n.jointName=i.jointName,this.jointMap[n.jointName]=n):this.isGLTF2&&(n.jointName=t,this.jointMap[t]=n),i.meshes?i.meshes.forEach((function(t){return r.parseMesh(t,n,i)})):"mesh"in i&&this.parseMesh(i.mesh,n,i),i.children&&i.children.forEach((function(t){return r.parseNode(t,n)})),e.addChild(n)},parseAnimations:function(){var t=this;if(!this.json.animations)return null;var e=this.isMultiAnim,n={},r=[],i={};return Ds(this.json.animations,(function(o){o.channels.forEach((function(e){var n=e.target.path,s=e.target.id;t.isGLTF2&&(s=e.target.node);var a=o.samplers[e.sampler],u=t.isGLTF2?a.input:o.parameters[a.input],c=t.isGLTF2?a.output:o.parameters[n],h=t.getArrayByAccessor(u,!0),l=t.getArrayByAccessor(c,!0);"rotation"===n&&(n="quaternion");var f=new gd({interpolationType:a.interpolation||"LINEAR",nodeName:s,keyTime:h,states:l,type:gd.getType(n)});r.push(f),i[s]=!0})),e&&r.length&&(n[o.name]={animStatesList:r},r=[])})),e&&Object.keys(n).length>0&&(r=Object.values(n)[0].animStatesList),r.length?new yd({rootNode:this.node,animStatesList:r,validAnimationIds:i,clips:n}):null},parseScene:function(){var t=this;this.parseMaterials(),this.jointMap={},this.meshes=[],this.lights=[],this.node=new xa({needCallChildUpdate:!1}),this.parseCameras();var e=this.json.scenes[this.getDefaultSceneName()];if(!e)return h.warn("GLTFParser:no scene!"),{node:this.node,meshes:[],cameras:[],lights:[],textures:[],materials:[]};var n=e.nodes;this.parseSkins(),n.forEach((function(e){return t.parseNode(e,t.node)})),this.resetSkinInfo(this.node);var r={node:this.node,scene:this.node,meshes:this.meshes,json:this.json,cameras:Object.values(this.cameras),lights:this.lights,textures:Object.values(this.textures),materials:Object.values(this.materials)},i=this.parseAnimations();return i&&(this.node.setAnim(i),i.play(),r.anim=i),this.parseExtensions(e.extensions,null,{isScene:!0}),this.parseExtensions(this.json.extensions,r,{isGlobal:!0,methodName:"parseOnEnd"}),r},getDefaultSceneName:function(){return void 0!==this.defaultScene?this.defaultScene:this.json.scenes?Object.keys(this.json.scenes)[0]:null},parseSkins:function(){var t=this;this.skins=[];var e=this.json.skins;e&&e.length&&(this.skins=e.map((function(e){for(var n=new Bl,r=e.joints.length,i=t.getArrayByAccessor(e.inverseBindMatrices,!0),o=0;o<r;o++){var s=(new ma).fromArray(i[o]);n.inverseBindMatrices.push(s)}return n.jointNames=e.joints,n})))},resetSkinInfo:function(t){var e={};t.traverse((function(t){var n="".concat(t.id,"_").concat(t.name);e[t.jointName]=n,t.jointName=n})),this.skins.forEach((function(t){t.jointNames=t.jointNames.map((function(t){return e[t]}))})),t.resetSkinedMeshRootNode()}}),wd=xd,Nd=Ks.create({Extends:Jf,isGLTFLoader:!0,className:"GLTFLoader",constructor:function(){Nd.superclass.constructor.call(this)},load:function(t){var e=this;return this.loadRes(t.src,"buffer").then((function(n){return new wd(n,t).parse(e)})).catch((function(t){throw h.error("load gltf failed",t.message,t.stack),t}))}});Zf.addLoader("gltf",Nd),Zf.addLoader("glb",Nd);var Pd=Nd,Dd=n("./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js"),Hd=n.n(Dd),Fd=Ss.RGBA,Ud=Ss.NEAREST,Bd=Ss.CLAMP_TO_EDGE,Gd=Ss.FLOAT,kd=Ks.create({Extends:Jf,isHDRLoader:!0,className:"HDRLoader",constructor:function(){kd.superclass.constructor.call(this)},load:function(t){return this.loadRes(t.src,"buffer").then((function(e){try{var n=Hd()(e),r=n.shape,i=n.data,o=new pc({width:r[0],height:r[1],flipY:t.flipY||!1,image:i,type:Gd,magFilter:Ud,minFilter:Ud,wrapS:Bd,wrapT:Bd,internalFormat:Fd,format:Fd});return Object.assign(o,t),o}catch(t){h.error("HDRLoader:parse error => ",t)}return null}))}});Zf.addLoader("hdr",kd);var jd=kd,Vd=Ks.create({Statics:{HEADER_LEN:64,COMPRESSED_2D:0,COMPRESSED_3D:1,TEX_2D:2,TEX_3D:3},isKhronosTextureContainer:!0,className:"KhronosTextureContainer",constructor:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.arrayBuffer=t,this.baseOffset=n;var r=new Uint8Array(this.arrayBuffer,this.baseOffset,12);if(171===r[0]&&75===r[1]&&84===r[2]&&88===r[3]&&32===r[4]&&49===r[5]&&49===r[6]&&187===r[7]&&13===r[8]&&10===r[9]&&26===r[10]&&10===r[11]){var i=Uint32Array.BYTES_PER_ELEMENT,o=new DataView(this.arrayBuffer,this.baseOffset+12,13*i),s=o.getUint32(0,!0),a=67305985===s;this.glType=o.getUint32(1*i,a),this.glTypeSize=o.getUint32(2*i,a),this.glFormat=o.getUint32(3*i,a),this.glInternalFormat=o.getUint32(4*i,a),this.glBaseInternalFormat=o.getUint32(5*i,a),this.pixelWidth=o.getUint32(6*i,a),this.pixelHeight=o.getUint32(7*i,a),this.pixelDepth=o.getUint32(8*i,a),this.numberOfArrayElements=o.getUint32(9*i,a),this.numberOfFaces=o.getUint32(10*i,a),this.numberOfMipmapLevels=o.getUint32(11*i,a),this.bytesOfKeyValueData=o.getUint32(12*i,a),this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===e?0===this.glType?this.loadType=Vd.COMPRESSED_2D:this.loadType=Vd.TEX_2D:h.warn("number of faces expected"+e+", but found "+this.numberOfFaces):h.warn("texture arrays not currently supported"):h.warn("only 2D textures currently supported")}else h.error("texture missing KTX identifier")},mipmaps:function(t){for(var e=[],n=Vd.HEADER_LEN+this.bytesOfKeyValueData,r=this.pixelWidth,i=this.pixelHeight,o=t?this.numberOfMipmapLevels:1,s=0;s<o;s++){for(var a=new Int32Array(this.arrayBuffer,this.baseOffset+n,1)[0],u=0;u<this.numberOfFaces;u++){var c=new Uint8Array(this.arrayBuffer,this.baseOffset+n+4,a);e.push({data:c,width:r,height:i}),n+=a+4,n+=3-(a+3)%4}r=Math.max(1,.5*r),i=Math.max(1,.5*i)}return e}}),Xd=Ks.create({Extends:Jf,Statics:{astc:"WEBGL_compressed_texture_astc",etc:"WEBGL_compressed_texture_etc",etc1:"WEBGL_compressed_texture_etc1",pvrtc:"WEBGL_compressed_texture_pvrtc",s3tc:"WEBGL_compressed_texture_s3tc"},isKTXLoader:!0,className:"KTXLoader",constructor:function(){gu.use(Xd.astc),gu.use(Xd.atc),gu.use(Xd.etc),gu.use(Xd.etc1),gu.use(Xd.pvrtc),gu.use(Xd.s3tc),gu.use(Xd.s3tc_srgb),Xd.superclass.constructor.call(this)},load:function(t){var e=this;return t.src instanceof ArrayBuffer?Promise.resolve(this.createTexture(t,t.src)):ArrayBuffer.isView(t.src)?Promise.resolve(this.createTexture(t,t.src.buffer,t.src.byteOffset)):this.loadRes(t.src,"buffer").then((function(n){return e.createTexture(t,n)}))},createTexture:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new Vd(e,1,n),i={compressed:0===r.glType,type:r.glType,width:r.pixelWidth,height:r.pixelHeight,internalFormat:r.glInternalFormat,format:r.glFormat,isCubemap:6===r.numberOfFaces};return r.numberOfMipmapLevels>=Math.floor(Math.log2(Math.max(i.width,i.height))+1)?(i.mipmaps=r.mipmaps(!0),i.image=i.mipmaps[0].data):(i.mipmaps=null,i.image=r.mipmaps(!1)[0].data),new pc(i)}});Zf.addLoader("ktx",Xd);var Wd=Xd,zd=Ks.create({Mixes:ta,isLoadQueue:!0,className:"LoadQueue",Statics:{addLoader:function(t,e){h.warn("LoadQueue.addLoader is duplicated, please use Loader.addLoader"),Zf.addLoader(t,e)}},constructor:function(t){this._source=[],this.add(t)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(t){return t&&(t=Array.isArray(t)?t:[t],this._source=this._source.concat(t)),this},get:function(t){if(!t)return null;for(var e=this._source,n=0;n<e.length;n++){var r=e[n];if(r.id===t||r.src===t)return r}return null},getContent:function(t){var e=this.get(t);return e&&e.content},start:function(){return this._loader||(this._loader=new Zf),this._loadNext(),this},_loadNext:function(){var t=this,e=this._source,n=e.length;if(this._loaded>=n)this.fire("complete");else if(this._currentIndex<n-1&&this._connections<this.maxConnections){var r=++this._currentIndex,i=e[r];this._connections++,this._loader.load(i).then((function(e){t._onItemLoad(r,e)}),(function(e){t._onItemError(r,e)}))}},_onItemLoad:function(t,e){var n=this._source[t];n.loaded=!0,n.content=e,this._connections--,this._loaded++,this.fire("load",n),this._loadNext()},_onItemError:function(t,e){var n=this._source[t];n.error=e,this._connections--,this._loaded++,this.fire("error",n),this._loadNext()},getSize:function(t){for(var e=0,n=this._source,r=0;r<n.length;r++){var i=n[r];e+=(t?i.loaded&&i.size:i.size)||0}return e},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length},getAllContent:function(){return this._source.map((function(t){return t.content}))}}),qd=Ks.create({Extends:Jf,isShaderMaterialLoader:!0,className:"ShaderMaterialLoader",constructor:function(){qd.superclass.constructor.call(this)},load:function(t){var e=[this.loadRes(t.fs),this.loadRes(t.vs)],n=Object.assign({},t);return Promise.all(e).then((function(t){return n.fs=t[0],n.vs=t[1],new al(n)}),(function(t){h.warn("ShaderMaterial Loader Failed for ".concat(t))}))}}),Yd=qd,Jd=Ks.create({Extends:Jf,isTextureLoader:!0,className:"TextureLoader",constructor:function(){Jd.superclass.constructor.call(this)},load:function(t){return this.loadImg(t.src,t.crossOrigin).then((function(e){var n=Object.assign({},t);return n.image=e,delete n.type,new pc(n)})).catch((function(t){throw h.error("load Texture failed",t.message,t.stack),t}))}});Zf.addLoader("Texture",Jd);var Qd=Jd,Zd=Ss.LINES,Kd={x:[0,0,0,1,0,0],y:[0,0,0,0,1,0],z:[0,0,0,0,0,1]},$d=Ks.create({Extends:xa,isAxisHelper:!0,className:"AxisHelper",size:1,constructor:function(t){$d.superclass.constructor.call(this,t),this.init()},addAxis:function(t){var e=new Nl({name:"AxisHelper_"+t,geometry:new fu({mode:Zd,vertices:new Qa(new Float32Array(Kd[t]),3),indices:new Qa(new Uint16Array([0,1]),1)}),material:new vh({diffuse:new Da(Kd[t][3],Kd[t][4],Kd[t][5]),lightType:"NONE"})});this.addChild(e)},init:function(){this.setScale(this.size),this.addAxis("x"),this.addAxis("y"),this.addAxis("z")}}),tp=$d,ep=Ss.LINES,np=Ks.create({Extends:Nl,isAxisNetHelper:!0,className:"AxisNetHelper",size:5,constructor:function(t){np.superclass.constructor.call(this,t),this.color=this.color||new Da(.5,.5,.5);for(var e=new fu({mode:ep}),n=this.size,r=2*n+1,i=0;i<r;i++){var o=i/n-1;e.addLine([o,0,-1],[o,0,1]),e.addLine([-1,0,o],[1,0,o])}this.geometry=e,this.material=new vh({diffuse:this.color,lightType:"NONE"})}}),rp=np,ip=Ss.LINES,op=new ra,sp=Ks.create({Extends:Nl,isCameraHelper:!0,className:"CameraHelper",camera:null,color:null,constructor:function(t){sp.superclass.constructor.call(this,t),this.color||(this.color=new Da(.3,.9,.6)),this.material=new vh({lightType:"NONE",diffuse:this.color||new Da(.5,.5,.5,1)}),this.geometry=new fu({mode:ip,isStatic:!1,vertices:new Qa(new Float32Array(27),3),indices:new Qa(new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7,8,4,8,5,8,6,8,7]),1)})},onUpdate:function(){this.camera&&(this.camera.updateViewProjectionMatrix(),this._buildGeometry())},_buildGeometry:function(){var t=this.camera,e=this.geometry;e.vertices.set(0,t.unprojectVector(op.set(-1,-1,1))),e.vertices.set(1,t.unprojectVector(op.set(-1,1,1))),e.vertices.set(2,t.unprojectVector(op.set(1,1,1))),e.vertices.set(3,t.unprojectVector(op.set(1,-1,1))),e.vertices.set(4,t.unprojectVector(op.set(-1,-1,-1))),e.vertices.set(5,t.unprojectVector(op.set(-1,1,-1))),e.vertices.set(6,t.unprojectVector(op.set(1,1,-1))),e.vertices.set(7,t.unprojectVector(op.set(1,-1,-1))),e.vertices.set(8,t.worldMatrix.getTranslation(op))}}),ap=sp,up=Ks.create({Extends:Ua,isAmbientLight:!0,className:"AmbientLight",autoUpdateWorldMatrix:!1,constructor:function(t){up.superclass.constructor.call(this,t)}}),cp=up,hp=Ks.create({Statics:{ltcTexture1:null,ltcTexture2:null,ltcTextureReady:!1,ltcTextureUrl:"//g.alicdn.com/tmapp/static/4.0.63/ltcTexture.js",loadLtcTexture:function(){var t=this;this.ltcTextureReady||void 0===this._loader&&(this._loader=new Zf,this._loader.load({type:"json",src:this.ltcTextureUrl}).then((function(e){t._loader=null,t.ltcTexture1=new Gc({data:e.ltcTexture1}),t.ltcTexture2=new Gc({data:e.ltcTexture2}),t.ltcTextureReady=!0})))}},Extends:Ua,isAreaLight:!0,className:"AreaLight",width:10,height:10,_enabled:!0,enabled:{get:function(){return this._enabled&&hp.ltcTextureReady},set:function(t){this._enabled=t}},constructor:function(t){hp.superclass.constructor.call(this,t),hp.loadLtcTexture()},ltcTexture1:{get:function(){return hp.ltcTexture1},set:function(t){hp.ltcTexture1=t}},ltcTexture2:{get:function(){return hp.ltcTexture2},set:function(t){hp.ltcTexture2=t}}}),lp=hp,fp=new vh({lightType:"NONE"}),dp=new Da(1,1,1),pp=new Da,mp=Ks.create({isMeshPicker:!0,className:"MeshPicker",debug:!1,renderer:null,colorMeshMap:null,constructor:function(t){Object.assign(this,t),this.colorMeshMap={},this.init()},createFramebuffer:function(){if(!this.framebuffer){var t=this.renderer;this.framebuffer=new bc(t,{useVao:t.useVao,width:t.width,height:t.height})}},renderDebug:function(){this.framebuffer.render(0,.7,.3,.3)},createMeshNumberId:function(t){"numberId"in t||(t.numberId=10*Number(t.id.replace(/^.*_(\d+)$/,"$1")),t.color=Us(t.numberId.toString(16),6),this.colorMeshMap[t.color]=t)},renderColoredMeshes:function(){var t=this,e=this.renderer,n=this.framebuffer;n.bind(),e.clear(dp);var r=e.forceMaterial;e.forceMaterial=fp,e.renderList.traverse((function(n){t.createMeshNumberId(n),fp.diffuse.fromHEX(n.color),fp.isDirty=!0,e.renderMesh(n)})),e.forceMaterial=r,n.unbind()},getSelection:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this.renderer.pixelRatio,o=[],s=this.framebuffer.readPixels(t*i,e*i,n*i,r*i),a=0;a<s.length;a+=4){var u=pp.fromUintArray(s,a).toHEX();this.colorMeshMap[u]&&o.push(this.colorMeshMap[u])}return o},init:function(){var t=this;this.createFramebuffer(),this.renderer.on("afterRender",(function(){t.renderColoredMeshes(),t.debug&&t.renderDebug()}))}}),_p=Ks.create({constructor:function(t){this.targetFPS=t||60,this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,targetFPS:{set:function(t){this._targetFPS=t,this._interval=1e3/this._targetFPS,this._intervalId&&(this._cancelRunLoop(),this._startRunLoop())},get:function(){return this._targetFPS}},start:function(){this._paused=!1,this._startRunLoop()},stop:function(){this._paused=!0,this._cancelRunLoop(),this._lastTime=0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_startRunLoop:function(){if(!this._intervalId){this._lastTime=+new Date;var t,e=this,n=this._interval,r=window.requestAnimationFrame;r&&n<17?(this._useRAF=!0,t=function(){e._intervalId=r(t),e._tick()}):(this._useRAF=!1,t=function(){e._intervalId=setTimeout(t,n),e._tick()}),t()}},_cancelRunLoop:function(){this._useRAF?(0,window.cancelAnimationFrame)(this._intervalId):clearTimeout(this._intervalId),this._intervalId=null},_tick:function(){if(!this._paused){var t=+new Date,e=t-this._lastTime,n=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1e3/(this._tickTime/this._tickCount)+.5>>0,this._tickCount=0,this._tickTime=0):this._tickTime+=t-this._lastTime,this._lastTime=t;for(var r=n.slice(0),i=0,o=r.length;i<o;i++)r[i].tick(e)}},getMeasuredFPS:function(){return Math.min(this._measuredFPS,this._targetFPS)},addTick:function(t){if(!t||"function"!=typeof t.tick)throw new Error("Ticker: The tick object must implement the tick method.");this._tickers.push(t)},removeTick:function(t){var e=this._tickers,n=e.indexOf(t);n>=0&&e.splice(n,1)},nextTick:function(t){var e=this,n={tick:function(r){e.removeTick(n),t(r)}};return e.addTick(n),n},timeout:function(t,e){var n=this,r=(new Date).getTime()+e,i={tick:function(){(new Date).getTime()-r>=0&&(n.removeTick(i),t())}};return n.addTick(i),i},interval:function(t,e){var n=(new Date).getTime()+e,r={tick:function(){var r=(new Date).getTime(),i=r-n;i>=0&&(i<e&&(r-=i),n=r+e,t())}};return this.addTick(r),r}}),gp={get:function(){if(void 0===this._isWebGLSupport)try{var t=document.createElement("canvas"),e=t.getContext("webgl");e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT);var n=new Uint8Array(4);e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,n),0===n[0]&&255===n[1]&&0===n[2]&&255===n[3]?this._isWebGLSupport=!0:this._isWebGLSupport=!1,t=null,e=null,n=null}catch(t){this._isWebGLSupport=!1}return this._isWebGLSupport}},vp=new Float32Array(27),yp=Ks.create({className:"SphericalHarmonics3",isSphericalHarmonics3:!0,Statics:{SH3_SCALE:[Math.sqrt(1/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(3/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(15/(4*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(5/(16*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(15/(16*Math.PI))]},constructor:function(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new ra)},scale:function(t){return this.coefficients.forEach((function(e){e.scale(t)})),this},fromArray:function(t){return 9===t.length?this.coefficients.forEach((function(e,n){e.fromArray(t[n])})):27===t.length&&this.coefficients.forEach((function(e,n){e.fromArray(t,3*n)})),this},scaleForRender:function(){var t=yp.SH3_SCALE;return this.coefficients.forEach((function(e,n){e.scale(t[n])})),this.scale(1/Math.PI),this},toArray:function(){return this.coefficients.forEach((function(t,e){t.toArray(vp,3*e)})),vp},clone:function(){var t=new this.constructor;return t.copy(this),t},copy:function(t){var e=t.coefficients;return this.coefficients.forEach((function(t,n){t.copy(e[n])})),this}}),Ep=yp},"./src/polyfill.js":
/*!*************************!*\
    !*** ./src/polyfill.js ***!
    \*************************/
/*! no exports provided */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: multi ./src/polyfill.js ./src/Hilo3d.js (referenced with single entry) */function(t,e,n){n.r(e);var r=n(/*! object-assign */"./node_modules/_object-assign@4.1.1@object-assign/index.js"),i=n.n(r),o=n(/*! object.keys */"./node_modules/_object.keys@0.1.0@object.keys/index.js"),s=n.n(o),a=n(/*! object-values */"./node_modules/_object-values@2.0.0@object-values/index.js"),u=n.n(a),c=n(/*! pinkie-promise */"./node_modules/_pinkie-promise@2.0.1@pinkie-promise/index.js"),h=n.n(c);Object.assign||(Object.assign=i.a),Object.keys||(Object.keys=s.a),Object.values||(Object.values=u.a),"undefined"==typeof Promise&&(window.Promise=h.a),[Int8Array,Uint8Array,Int16Array,Uint16Array,Uint32Array,Float32Array].forEach((function(t){t.prototype.slice||Object.defineProperty(t.prototype,"slice",{value:function(e,n){return new t(Array.prototype.slice.call(this,e,n))}})}))},"./src/shader/basic.frag":
/*!*******************************!*\
    !*** ./src/shader/basic.frag ***!
    \*******************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ./chunk/extensions.frag */"./src/shader/chunk/extensions.frag")+"\n"+n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl")+"\n"+n(/*! ./chunk/precision.frag */"./src/shader/chunk/precision.frag")+"\n\n"+n(/*! ./chunk/color.frag */"./src/shader/chunk/color.frag")+"\n"+n(/*! ./chunk/uv.frag */"./src/shader/chunk/uv.frag")+"\n"+n(/*! ./chunk/normal.frag */"./src/shader/chunk/normal.frag")+"\n"+n(/*! ./chunk/lightFog.frag */"./src/shader/chunk/lightFog.frag")+"\n"+n(/*! ./chunk/diffuse.frag */"./src/shader/chunk/diffuse.frag")+"\n"+n(/*! ./chunk/light.frag */"./src/shader/chunk/light.frag")+"\n"+n(/*! ./chunk/phong.frag */"./src/shader/chunk/phong.frag")+"\n"+n(/*! ./chunk/transparency.frag */"./src/shader/chunk/transparency.frag")+"\n"+n(/*! ./chunk/fog.frag */"./src/shader/chunk/fog.frag")+"\n"+n(/*! ./chunk/logDepth.frag */"./src/shader/chunk/logDepth.frag")+"\n\nvoid main(void) {\nvec4 diffuse = vec4(0., 0., 0., 1.);\nvec4 color = vec4(0., 0., 0., 1.);\n\n"+n(/*! ./chunk/normal_main.frag */"./src/shader/chunk/normal_main.frag")+"\n"+n(/*! ./chunk/lightFog_main.frag */"./src/shader/chunk/lightFog_main.frag")+"\n"+n(/*! ./chunk/diffuse_main.frag */"./src/shader/chunk/diffuse_main.frag")+"\n"+n(/*! ./chunk/phong_main.frag */"./src/shader/chunk/phong_main.frag")+"\n"+n(/*! ./chunk/transparency_main.frag */"./src/shader/chunk/transparency_main.frag")+"\n"+n(/*! ./chunk/frag_color.frag */"./src/shader/chunk/frag_color.frag")+"\n"+n(/*! ./chunk/logDepth_main.frag */"./src/shader/chunk/logDepth_main.frag")+"\n}"},"./src/shader/basic.vert":
/*!*******************************!*\
    !*** ./src/shader/basic.vert ***!
    \*******************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ./chunk/extensions.vert */"./src/shader/chunk/extensions.vert")+"\n"+n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl")+"\n"+n(/*! ./chunk/precision.vert */"./src/shader/chunk/precision.vert")+"\n\nattribute vec3 a_position;\nuniform mat4 u_modelViewProjectionMatrix;\n\n"+n(/*! ./chunk/unQuantize.vert */"./src/shader/chunk/unQuantize.vert")+"\n"+n(/*! ./chunk/joint.vert */"./src/shader/chunk/joint.vert")+"\n"+n(/*! ./chunk/uv.vert */"./src/shader/chunk/uv.vert")+"\n"+n(/*! ./chunk/normal.vert */"./src/shader/chunk/normal.vert")+"\n"+n(/*! ./chunk/lightFog.vert */"./src/shader/chunk/lightFog.vert")+"\n"+n(/*! ./chunk/morph.vert */"./src/shader/chunk/morph.vert")+"\n"+n(/*! ./chunk/color.vert */"./src/shader/chunk/color.vert")+"\n"+n(/*! ./chunk/logDepth.vert */"./src/shader/chunk/logDepth.vert")+"\nvoid main(void) {\nvec4 pos = vec4(a_position, 1.0);\n#ifdef HILO_HAS_TEXCOORD0\nvec2 uv = a_texcoord0;\n#endif\n#ifdef HILO_HAS_TEXCOORD1\nvec2 uv1 = a_texcoord1;\n#endif\n#ifdef HILO_HAS_NORMAL\nvec3 normal = a_normal;\n#endif\n\n#if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\nvec4 tangent = a_tangent;\n#endif\n\n"+n(/*! ./chunk/color_main.vert */"./src/shader/chunk/color_main.vert")+"\n"+n(/*! ./chunk/unQuantize_main.vert */"./src/shader/chunk/unQuantize_main.vert")+"\n"+n(/*! ./chunk/morph_main.vert */"./src/shader/chunk/morph_main.vert")+"\n"+n(/*! ./chunk/joint_main.vert */"./src/shader/chunk/joint_main.vert")+"\n"+n(/*! ./chunk/uv_main.vert */"./src/shader/chunk/uv_main.vert")+"\n"+n(/*! ./chunk/normal_main.vert */"./src/shader/chunk/normal_main.vert")+"\n"+n(/*! ./chunk/lightFog_main.vert */"./src/shader/chunk/lightFog_main.vert")+"\n\ngl_Position = u_modelViewProjectionMatrix * pos;\n\n"+n(/*! ./chunk/logDepth_main.vert */"./src/shader/chunk/logDepth_main.vert")+"\n}"},"./src/shader/chunk/baseDefine.glsl":
/*!******************************************!*\
    !*** ./src/shader/chunk/baseDefine.glsl ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#define HILO_FRONT_SIDE 1028\n#define HILO_BACK_SIDE 1029\n#define HILO_FRONT_AND_BACK_SIDE 1032\n#define HILO_PI 3.141592653589793\n#define HILO_INVERSE_PI 0.3183098861837907"},"./src/shader/chunk/color.frag":
/*!*************************************!*\
    !*** ./src/shader/chunk/color.frag ***!
    \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_COLOR\nvarying vec4 v_color;\n#endif\n\n#ifdef HILO_USE_HDR\nuniform float u_exposure;\n#endif\n\n#ifdef HILO_GAMMA_CORRECTION\nuniform float u_gammaFactor;\n#endif"},"./src/shader/chunk/color.vert":
/*!*************************************!*\
    !*** ./src/shader/chunk/color.vert ***!
    \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_COLOR\n#if HILO_COLOR_SIZE == 3\nattribute vec3 a_color;\n#elif HILO_COLOR_SIZE == 4\nattribute vec4 a_color;\n#endif\nvarying vec4 v_color;\n#endif"},"./src/shader/chunk/color_main.vert":
/*!******************************************!*\
    !*** ./src/shader/chunk/color_main.vert ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_COLOR\n#if HILO_COLOR_SIZE == 3\nv_color = vec4(a_color, 1.0);\n#elif HILO_COLOR_SIZE == 4\nv_color = a_color;\n#endif\n#endif"},"./src/shader/chunk/diffuse.frag":
/*!***************************************!*\
    !*** ./src/shader/chunk/diffuse.frag ***!
    \***************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_DIFFUSE_MAP)\nuniform HILO_SAMPLER_2D u_diffuse;\n#elif defined(HILO_DIFFUSE_CUBE_MAP)\nuniform samplerCube u_diffuse;\n#else\nuniform vec4 u_diffuse;\n#endif"},"./src/shader/chunk/diffuse_main.frag":
/*!********************************************!*\
    !*** ./src/shader/chunk/diffuse_main.frag ***!
    \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_DIFFUSE_MAP)\ndiffuse = HILO_TEXTURE_2D(u_diffuse);\n#elif defined(HILO_DIFFUSE_CUBE_MAP)\ndiffuse = textureCube(u_diffuse, v_position);\n#elif defined(HILO_HAS_COLOR)\ndiffuse = v_color;\n#else\ndiffuse = u_diffuse;\n#endif\ncolor.a = diffuse.a;"},"./src/shader/chunk/extensions.frag":
/*!******************************************!*\
    !*** ./src/shader/chunk/extensions.frag ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#ifdef HILO_USE_SHADER_TEXTURE_LOD\n#extension GL_EXT_shader_texture_lod: enable\n#endif\n\n#ifdef HILO_USE_EXT_FRAG_DEPTH\n#extension GL_EXT_frag_depth: enable\n#define GLSLIFY 1\n#endif"},"./src/shader/chunk/extensions.vert":
/*!******************************************!*\
    !*** ./src/shader/chunk/extensions.vert ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n"},"./src/shader/chunk/fixMathCrash.glsl":
/*!********************************************!*\
    !*** ./src/shader/chunk/fixMathCrash.glsl ***!
    \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_FIX_MAX_BUG\nfloat hilo_max(float a, float b){\nif (a > b) {\nreturn a;\n}\nreturn b;\n}\n#define HILO_MAX(a, b) hilo_max(a, b);\n#else\n#define HILO_MAX(a, b) max(a, b);\n#endif"},"./src/shader/chunk/fog.frag":
/*!***********************************!*\
    !*** ./src/shader/chunk/fog.frag ***!
    \***********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_FOG\nvarying float v_dist;\nuniform vec4 u_fogColor;\n\n#ifdef HILO_FOG_LINEAR\nuniform vec2 u_fogInfo;\n#else\nuniform float u_fogInfo;\n#endif\n#endif"},"./src/shader/chunk/fog_main.frag":
/*!****************************************!*\
    !*** ./src/shader/chunk/fog_main.frag ***!
    \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_FOG\nfloat fogFactor = 1.0;\n\n#ifdef HILO_FOG_LINEAR\nfogFactor = (u_fogInfo.y - v_dist)/(u_fogInfo.y - u_fogInfo.x);\n#elif defined(HILO_FOG_EXP)\nfogFactor = exp(-abs(u_fogInfo * v_dist));\n#elif defined(HILO_FOG_EXP2)\nfogFactor = exp(-(u_fogInfo * v_dist) * (u_fogInfo * v_dist)); \n#endif\n\nfogFactor = clamp(fogFactor, 0.0, 1.0);\ncolor = mix(u_fogColor, color, fogFactor);\n#endif"},"./src/shader/chunk/frag_color.frag":
/*!******************************************!*\
    !*** ./src/shader/chunk/frag_color.frag ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n#ifdef HILO_IGNORE_TRANSPARENT\ncolor.a = 1.0;\n#endif\n\n#ifdef HILO_USE_HDR\ncolor.rgb = vec3(1.0) - exp(-color.rgb * u_exposure);\n#endif\n\n#ifdef HILO_GAMMA_CORRECTION\ncolor.rgb = pow(color.rgb, vec3(1.0 / u_gammaFactor));\n#endif\n\n"+n(/*! ./fog_main.frag */"./src/shader/chunk/fog_main.frag")+"\n\n#ifdef HILO_PREMULTIPLY_ALPHA\ncolor.rgb *= color.a;\n#endif\n\ngl_FragColor = color;"},"./src/shader/chunk/joint.vert":
/*!*************************************!*\
    !*** ./src/shader/chunk/joint.vert ***!
    \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_JOINT_COUNT\nattribute vec4 a_skinIndices;\nattribute vec4 a_skinWeights;\n#ifdef HILO_JOINT_MAT_MAP\nuniform sampler2D u_jointMatTexture;\nuniform vec2 u_jointMatTextureSize;\nmat4 getJointMat(float index) {\nindex *= 4.0;\nfloat x = float(mod(index, u_jointMatTextureSize.x));\nfloat y = float(floor(index / u_jointMatTextureSize.x));\nfloat dx = 1.0 / float(u_jointMatTextureSize.x);\nfloat dy = 1.0 / float(u_jointMatTextureSize.y);\ny = dy * (y + 0.5);\nvec4 v1 = texture2D(u_jointMatTexture, vec2(dx * (x + 0.5), y));\nvec4 v2 = texture2D(u_jointMatTexture, vec2(dx * (x + 1.5), y));\nvec4 v3 = texture2D(u_jointMatTexture, vec2(dx * (x + 2.5), y));\nvec4 v4 = texture2D(u_jointMatTexture, vec2(dx * (x + 3.5), y));\nmat4 mat = mat4(v1, v2, v3, v4);\nreturn mat;\n}\n\nmat4 getJointMat(vec4 weights, vec4 indices) {\nmat4 mat = weights.x * getJointMat(indices.x);\nmat += weights.y * getJointMat(indices.y);\nmat += weights.z * getJointMat(indices.z);\nmat += weights.w * getJointMat(indices.w);\nreturn mat;\n}\n#else\nuniform mat4 u_jointMat[HILO_JOINT_COUNT];\n\nmat4 getJointMat(vec4 weights, vec4 indices) {\nmat4 mat = weights.x * u_jointMat[int(indices.x)];\nmat += weights.y * u_jointMat[int(indices.y)];\nmat += weights.z * u_jointMat[int(indices.z)];\nmat += weights.w * u_jointMat[int(indices.w)];\nreturn mat;\n}\n#endif\n#endif"},"./src/shader/chunk/joint_main.vert":
/*!******************************************!*\
    !*** ./src/shader/chunk/joint_main.vert ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_JOINT_COUNT\nmat4 skinMat = getJointMat(a_skinWeights, a_skinIndices);\npos = skinMat * pos;\n\n#ifdef HILO_HAS_NORMAL\nnormal = mat3(skinMat) * normal;\n#endif\n#endif"},"./src/shader/chunk/light.frag":
/*!*************************************!*\
    !*** ./src/shader/chunk/light.frag ***!
    \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n#ifdef HILO_DIRECTIONAL_LIGHTS\nuniform vec3 u_directionalLightsColor[HILO_DIRECTIONAL_LIGHTS];\nuniform vec3 u_directionalLightsInfo[HILO_DIRECTIONAL_LIGHTS];\n#ifdef HILO_DIRECTIONAL_LIGHTS_SMC\nuniform sampler2D u_directionalLightsShadowMap[HILO_DIRECTIONAL_LIGHTS_SMC];\nuniform vec2 u_directionalLightsShadowMapSize[HILO_DIRECTIONAL_LIGHTS_SMC];\nuniform mat4 u_directionalLightSpaceMatrix[HILO_DIRECTIONAL_LIGHTS_SMC];\nuniform vec2 u_directionalLightsShadowBias[HILO_DIRECTIONAL_LIGHTS_SMC];\n#endif\n#endif\n\n#ifdef HILO_SPOT_LIGHTS\nuniform vec3 u_spotLightsPos[HILO_SPOT_LIGHTS];\nuniform vec3 u_spotLightsDir[HILO_SPOT_LIGHTS];\nuniform vec3 u_spotLightsColor[HILO_SPOT_LIGHTS];\nuniform vec2 u_spotLightsCutoffs[HILO_SPOT_LIGHTS];\nuniform vec3 u_spotLightsInfo[HILO_SPOT_LIGHTS];\nuniform float u_spotLightsRange[HILO_SPOT_LIGHTS];\n#ifdef HILO_SPOT_LIGHTS_SMC\nuniform sampler2D u_spotLightsShadowMap[HILO_SPOT_LIGHTS_SMC];\nuniform vec2 u_spotLightsShadowMapSize[HILO_SPOT_LIGHTS_SMC];\nuniform mat4 u_spotLightSpaceMatrix[HILO_SPOT_LIGHTS_SMC];\nuniform vec2 u_spotLightsShadowBias[HILO_SPOT_LIGHTS_SMC];\n#endif\n#endif\n\n#ifdef HILO_POINT_LIGHTS\nuniform vec3 u_pointLightsPos[HILO_POINT_LIGHTS];\nuniform vec3 u_pointLightsColor[HILO_POINT_LIGHTS];\nuniform vec3 u_pointLightsInfo[HILO_POINT_LIGHTS];\nuniform float u_pointLightsRange[HILO_POINT_LIGHTS];\n#ifdef HILO_POINT_LIGHTS_SMC\nuniform samplerCube u_pointLightsShadowMap[HILO_POINT_LIGHTS_SMC];\nuniform mat4 u_pointLightSpaceMatrix[HILO_POINT_LIGHTS_SMC];\nuniform vec2 u_pointLightsShadowBias[HILO_POINT_LIGHTS_SMC];\nuniform vec2 u_pointLightCamera[HILO_POINT_LIGHTS_SMC];\n#endif\n#endif\n\n#ifdef HILO_AREA_LIGHTS\nuniform vec3 u_areaLightsPos[HILO_AREA_LIGHTS];\nuniform vec3 u_areaLightsColor[HILO_AREA_LIGHTS];\nuniform vec3 u_areaLightsWidth[HILO_AREA_LIGHTS];\nuniform vec3 u_areaLightsHeight[HILO_AREA_LIGHTS];\nuniform sampler2D u_areaLightsLtcTexture1;\nuniform sampler2D u_areaLightsLtcTexture2;\n\n"+n(/*! ../method/getAreaLight.glsl */"./src/shader/method/getAreaLight.glsl")+"\n#endif\n\n#ifdef HILO_AMBIENT_LIGHTS\nuniform vec3 u_ambientLightsColor;\n#endif\n\n"+n(/*! ../method/getDiffuse.glsl */"./src/shader/method/getDiffuse.glsl")+"\n"+n(/*! ../method/getSpecular.glsl */"./src/shader/method/getSpecular.glsl")+"\n"+n(/*! ../method/getLightAttenuation.glsl */"./src/shader/method/getLightAttenuation.glsl")+"\n"+n(/*! ../method/unpackFloat.glsl */"./src/shader/method/unpackFloat.glsl")+"\n"+n(/*! ../method/getShadow.glsl */"./src/shader/method/getShadow.glsl")},"./src/shader/chunk/lightFog.frag":
/*!****************************************!*\
    !*** ./src/shader/chunk/lightFog.frag ***!
    \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS)\nvarying vec3 v_fragPos;\n#endif"},"./src/shader/chunk/lightFog.vert":
/*!****************************************!*\
    !*** ./src/shader/chunk/lightFog.vert ***!
    \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FOG) || defined(HILO_HAS_FRAG_POS)\nuniform mat4 u_modelViewMatrix;\n#ifdef HILO_HAS_FOG\nvarying float v_dist;\n#endif\n\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS) \nvarying vec3 v_fragPos;\n#endif\n#endif"},"./src/shader/chunk/lightFog_main.frag":
/*!*********************************************!*\
    !*** ./src/shader/chunk/lightFog_main.frag ***!
    \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_LIGHT\n#if HILO_SIDE == HILO_FRONT_AND_BACK_SIDE\nnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#endif\n#endif"},"./src/shader/chunk/lightFog_main.vert":
/*!*********************************************!*\
    !*** ./src/shader/chunk/lightFog_main.vert ***!
    \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FOG) || defined(HILO_HAS_FRAG_POS)\nvec3 fragPos = (u_modelViewMatrix * pos).xyz;\n\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS)\nv_fragPos = fragPos;\n#endif\n\n#ifdef HILO_HAS_FOG\nv_dist = length(fragPos);\n#endif\n#endif"},"./src/shader/chunk/logDepth.frag":
/*!****************************************!*\
    !*** ./src/shader/chunk/logDepth.frag ***!
    \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_USE_LOG_DEPTH) && defined(HILO_USE_EXT_FRAG_DEPTH)\nuniform float u_logDepth;\nvarying float v_fragDepth;\n#endif"},"./src/shader/chunk/logDepth.vert":
/*!****************************************!*\
    !*** ./src/shader/chunk/logDepth.vert ***!
    \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_USE_LOG_DEPTH\n#ifdef HILO_USE_EXT_FRAG_DEPTH\nvarying float v_fragDepth;\n#else\nuniform float u_logDepth;\n#endif\n#endif"},"./src/shader/chunk/logDepth_main.frag":
/*!*********************************************!*\
    !*** ./src/shader/chunk/logDepth_main.frag ***!
    \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#if defined(HILO_USE_LOG_DEPTH) && defined(HILO_USE_EXT_FRAG_DEPTH)\ngl_FragDepthEXT = log2( v_fragDepth ) * u_logDepth * 0.5;\n#endif"},"./src/shader/chunk/logDepth_main.vert":
/*!*********************************************!*\
    !*** ./src/shader/chunk/logDepth_main.vert ***!
    \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_USE_LOG_DEPTH\n#ifdef HILO_USE_EXT_FRAG_DEPTH\nv_fragDepth = 1.0 + gl_Position.w;\n#else\ngl_Position.z = log2( max( 1e-6, gl_Position.w + 1.0 ) ) * u_logDepth - 1.0;\ngl_Position.z *= gl_Position.w;\n#endif\n#endif"},"./src/shader/chunk/morph.vert":
/*!*************************************!*\
    !*** ./src/shader/chunk/morph.vert ***!
    \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_MORPH_TARGET_COUNT\nuniform float u_morphWeights[HILO_MORPH_TARGET_COUNT];\n\n#if HILO_MORPH_TARGET_COUNT > 0\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition0;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal0;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent0;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 1\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition1;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal1;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent1;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 2\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition2;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal2;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent2;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 3\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition3;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal3;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent3;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 4\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition4;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal4;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent4;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 5\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition5;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal5;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent5;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 6\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition6;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal6;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent6;\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 7\n#ifdef HILO_MORPH_HAS_POSITION\nattribute vec3 a_morphPosition7;\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nattribute vec3 a_morphNormal7;\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\nattribute vec3 a_morphTangent7;\n#endif\n#endif\n#endif"},"./src/shader/chunk/morph_main.vert":
/*!******************************************!*\
    !*** ./src/shader/chunk/morph_main.vert ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_MORPH_TARGET_COUNT\n#if HILO_MORPH_TARGET_COUNT > 0\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition0 * u_morphWeights[0];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal0 * u_morphWeights[0];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent0 * u_morphWeights[0];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 1\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition1 * u_morphWeights[1];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal1 * u_morphWeights[1];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent1 * u_morphWeights[1];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 2\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition2 * u_morphWeights[2];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal2 * u_morphWeights[2];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent2 * u_morphWeights[2];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 3\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition3 * u_morphWeights[3];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal3 * u_morphWeights[3];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent3 * u_morphWeights[3];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 4\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition4 * u_morphWeights[4];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal4 * u_morphWeights[4];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent4 * u_morphWeights[4];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 5\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition5 * u_morphWeights[5];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal5 * u_morphWeights[5];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent5 * u_morphWeights[5];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 6\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition6 * u_morphWeights[6];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal6 * u_morphWeights[6];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent6 * u_morphWeights[6];\n#endif\n#endif\n\n#if HILO_MORPH_TARGET_COUNT > 7\n#ifdef HILO_MORPH_HAS_POSITION\npos.xyz += a_morphPosition7 * u_morphWeights[7];\n#endif\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\nnormal += a_morphNormal7 * u_morphWeights[7];\n#endif\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\ntangent.xyz += a_morphTangent7 * u_morphWeights[7];\n#endif\n#endif\n#endif"},"./src/shader/chunk/normal.frag":
/*!**************************************!*\
    !*** ./src/shader/chunk/normal.frag ***!
    \**************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_NORMAL\nvarying vec3 v_normal;\n#if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\nvarying mat3 v_TBN;\n#ifdef HILO_NORMAL_MAP\nuniform HILO_SAMPLER_2D u_normalMap;\n\n#ifdef HILO_NORMAL_MAP_SCALE\nuniform float u_normalMapScale;\n#endif\n#endif\n\n#ifdef HILO_CLEARCOAT_NORMAL_MAP\nuniform HILO_SAMPLER_2D u_clearcoatNormalMap;\n#endif\n#endif\n#endif"},"./src/shader/chunk/normal.vert":
/*!**************************************!*\
    !*** ./src/shader/chunk/normal.vert ***!
    \**************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_NORMAL\nattribute vec3 a_normal;\nuniform mat3 u_normalMatrix;\nvarying vec3 v_normal;\n\n#if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\nattribute vec4 a_tangent;\nvarying mat3 v_TBN;\n#endif\n#endif"},"./src/shader/chunk/normal_main.frag":
/*!*******************************************!*\
    !*** ./src/shader/chunk/normal_main.frag ***!
    \*******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_NORMAL_MAP\nvec3 normal = HILO_TEXTURE_2D(u_normalMap).rgb * 2.0 - 1.0;\n#ifdef HILO_NORMAL_MAP_SCALE\nnormal.xy *= u_normalMapScale;\n#endif\nnormal = normalize(v_TBN * normal);\n#elif defined(HILO_HAS_NORMAL)\nvec3 normal = normalize(v_normal);\n#else\nvec3 normal = vec3(0, 0, 1);\n#endif\n\n#ifdef HILO_HAS_CLEARCOAT\n#ifdef HILO_CLEARCOAT_NORMAL_MAP\nvec3 clearcoatNormal = HILO_TEXTURE_2D(u_clearcoatNormalMap).rgb * 2.0 - 1.0;\nclearcoatNormal = normalize(v_TBN * clearcoatNormal);\n#elif defined(HILO_HAS_NORMAL)\nvec3 clearcoatNormal = normalize(v_normal);\n#else\nvec3 clearcoatNormal = vec3(0, 0, 1);\n#endif\n#endif\n\n#if HILO_SIDE == HILO_BACK_SIDE\nnormal = -normal;\n#ifdef HILO_HAS_CLEARCOAT\nclearcoatNormal = -clearcoatNormal;\n#endif\n#endif"},"./src/shader/chunk/normal_main.vert":
/*!*******************************************!*\
    !*** ./src/shader/chunk/normal_main.vert ***!
    \*******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_NORMAL\n#if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\nvec3 T = normalize(u_normalMatrix * tangent.xyz);\nvec3 N = normalize(u_normalMatrix * normal);\nT = normalize(T - dot(T, N) * N);\nvec3 B = cross(N, T) * tangent.w;\nv_TBN = mat3(T, B, N);\n#endif\nv_normal = normalize(u_normalMatrix * normal);\n#endif"},"./src/shader/chunk/pbr.frag":
/*!***********************************!*\
    !*** ./src/shader/chunk/pbr.frag ***!
    \***********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ../method/textureEnvMap.glsl */"./src/shader/method/textureEnvMap.glsl")+"\n"+n(/*! ../method/encoding.glsl */"./src/shader/method/encoding.glsl")+"\n"+n(/*! ./fixMathCrash.glsl */"./src/shader/chunk/fixMathCrash.glsl")+'\n\nuniform vec4 u_baseColor;\nuniform vec4 u_emissionFactor;\n\n#ifdef HILO_BASE_COLOR_MAP\nuniform HILO_SAMPLER_2D u_baseColorMap;\n#endif\n\n#ifdef HILO_NEED_WORLD_NORMAL\nuniform mat3 u_viewInverseNormalMatrix;\n#endif\n\n#ifdef HILO_HAS_LIGHT\nuniform float u_metallic;\n#ifdef HILO_METALLIC_MAP\nuniform HILO_SAMPLER_2D u_metallicMap;\n#endif\nuniform float u_roughness;\n#ifdef HILO_ROUGHNESS_MAP\nuniform HILO_SAMPLER_2D u_roughnessMap;\n#endif\n#ifdef HILO_METALLIC_ROUGHNESS_MAP\nuniform HILO_SAMPLER_2D u_metallicRoughnessMap;\n#endif\n#ifdef HILO_OCCLUSION_MAP\nuniform HILO_SAMPLER_2D u_occlusionMap;\n#endif\n\n#ifdef HILO_OCCLUSION_STRENGTH\nuniform float u_occlusionStrength;\n#endif\n\n#ifdef HILO_DIFFUSE_ENV_MAP\n#ifdef HILO_DIFFUSE_ENV_MAP_CUBE\nuniform samplerCube u_diffuseEnvMap;\n#else\nuniform sampler2D u_diffuseEnvMap;\n#endif\nuniform float u_diffuseEnvIntensity;\n#elif defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\nuniform vec3 u_diffuseEnvSphereHarmonics3[9];\nuniform float u_diffuseEnvIntensity;\n#endif\n#ifdef HILO_SPECULAR_ENV_MAP\nuniform sampler2D u_brdfLUT;\n#ifdef HILO_SPECULAR_ENV_MAP_CUBE\nuniform samplerCube u_specularEnvMap;\n#else\nuniform sampler2D u_specularEnvMap;\n#endif\nuniform float u_specularEnvIntensity;\n\nuniform float u_specularEnvMapMipCount;\n#endif\n\n#ifdef HILO_EMISSION_MAP\nuniform HILO_SAMPLER_2D u_emission;\n#endif\n\n#ifdef HILO_PBR_SPECULAR_GLOSSINESS\nuniform vec4 u_specular;\nuniform float u_glossiness;\n#ifdef HILO_SPECULAR_GLOSSINESS_MAP\nuniform HILO_SAMPLER_2D u_specularGlossinessMap;\n#endif\n#endif\n\n#ifdef HILO_LIGHT_MAP\nuniform HILO_SAMPLER_2D u_lightMap;\n#endif\n\n#ifdef HILO_HAS_CLEARCOAT\nuniform float u_clearcoatFactor;\n#ifdef HILO_CLEARCOAT_MAP\nuniform HILO_SAMPLER_2D u_clearcoatMap;\n#endif\n\nuniform float u_clearcoatRoughnessFactor;\n#ifdef HILO_CLEARCOAT_ROUGHNESS_MAP\nuniform HILO_SAMPLER_2D u_clearcoatRoughnessMap;\n#endif\n#endif\n\n\n// PBR Based on https://github.com/KhronosGroup/glTF-WebGL-PBR\n\n// Basic Lambertian diffuse\n// Implementation from Lambert\'s Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(vec3 diffuseColor) {\nreturn diffuseColor * HILO_INVERSE_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(vec3 reflectance0, vec3 reflectance90, float VdotH) {\nreturn reflectance0 + (reflectance90 - reflectance0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(float NdotL, float NdotV, float alphaRoughness) {\nfloat r = alphaRoughness * alphaRoughness;\n\nfloat attenuationL = 2.0 * NdotL / (NdotL + sqrt(r + (1.0 - r) * (NdotL * NdotL)));\nfloat attenuationV = 2.0 * NdotV / (NdotV + sqrt(r + (1.0 - r) * (NdotV * NdotV)));\nreturn attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// Implementation from "Average Irregularity Representation of a Roughened Surface for Ray Reflection" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(float alphaRoughness, float NdotH) {\nfloat roughnessSq = alphaRoughness * alphaRoughness;\nfloat f = (NdotH * roughnessSq - NdotH) * NdotH + 1.0;\nreturn roughnessSq * HILO_INVERSE_PI / (f * f);\n}\n\nvec3 computeDiffuseSHLight(vec3 normal, in vec3 sh[9]) {\nreturn sh[0] +\nsh[1] * (normal.y) +\nsh[2] * (normal.z) +\nsh[3] * (normal.x) +\nsh[4] * (normal.y * normal.x) +\nsh[5] * (normal.y * normal.z) +\nsh[6] * ((3.0 * normal.z * normal.z) - 1.0) +\nsh[7] * (normal.z * normal.x) +\nsh[8] * (normal.x * normal.x - (normal.y * normal.y));\n}\n\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Vendor/EXT_lights_image_based/README.md#rgbd\nvec3 decodeRGBD(in vec4 color){\nreturn color.rgb / color.a;\n}\n\nvec3 getIBLClearCoatContribution(in vec3 N, in vec3 V, vec3 diffuseColor, vec3 specularColor, float ao, float NdotV, float perceptualRoughness) {\nvec3 color = vec3(.0, .0, .0);\n#ifdef HILO_SPECULAR_ENV_MAP\nvec3 R = -normalize(reflect(V, N));\nvec3 brdf = texture2D(u_brdfLUT, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\n#ifdef HILO_IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS\nfloat lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\nvec4 specularEnvMap = textureEnvMapIncludeMipmapsLod(u_specularEnvMap, R, lod);\n#elif defined(HILO_USE_SHADER_TEXTURE_LOD)\nfloat lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\nvec4 specularEnvMap = textureEnvMapLod(u_specularEnvMap, R, lod);\n#else\nvec4 specularEnvMap = textureEnvMap(u_specularEnvMap, R);\n#endif\n\nvec3 specularLight = decodeRGBD(specularEnvMap);\n\n#ifdef HILO_GAMMA_CORRECTION\nspecularLight = sRGBToLinear(specularLight);\n#endif\ncolor.rgb += specularLight * (specularColor * brdf.x + brdf.y) * u_specularEnvIntensity;\n#endif\nreturn color;\n}\n\nvec3 getIBLContribution(in vec3 N, in vec3 V, vec3 diffuseColor, vec3 specularColor, float ao, float NdotV, float perceptualRoughness) {\nvec3 color = vec3(.0, .0, .0);\n#ifdef HILO_NEED_WORLD_NORMAL\nN = u_viewInverseNormalMatrix * N;\nV = u_viewInverseNormalMatrix * V;\n#endif\n#if defined(HILO_DIFFUSE_ENV_MAP) || defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\n#ifdef HILO_DIFFUSE_ENV_MAP\n#ifdef HILO_GAMMA_CORRECTION\nvec3 diffuseLight = sRGBToLinear(textureEnvMap(u_diffuseEnvMap, N)).rgb;\n#else\nvec3 diffuseLight = textureEnvMap(u_diffuseEnvMap, N).rgb;\n#endif\n#elif defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\nvec3 diffuseLight = computeDiffuseSHLight(N, u_diffuseEnvSphereHarmonics3);\n#endif\ncolor.rgb += diffuseLight * diffuseColor * ao * u_diffuseEnvIntensity;\n#endif\n\n#ifdef HILO_SPECULAR_ENV_MAP\nvec3 R = -normalize(reflect(V, N));\nvec3 brdf = texture2D(u_brdfLUT, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\n#ifdef HILO_IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS\nfloat lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\nvec4 specularEnvMap = textureEnvMapIncludeMipmapsLod(u_specularEnvMap, R, lod);\n#elif defined(HILO_USE_SHADER_TEXTURE_LOD)\nfloat lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\nvec4 specularEnvMap = textureEnvMapLod(u_specularEnvMap, R, lod);\n#else\nvec4 specularEnvMap = textureEnvMap(u_specularEnvMap, R);\n#endif\n\nvec3 specularLight = decodeRGBD(specularEnvMap);\n\n#ifdef HILO_GAMMA_CORRECTION\nspecularLight = sRGBToLinear(specularLight);\n#endif\ncolor.rgb += specularLight * (specularColor * brdf.x + brdf.y) * u_specularEnvIntensity;\n#endif\nreturn color;\n}\n\nvec3 calculateLo(vec3 N, vec3 V, vec3 L, vec3 reflectance0, vec3 reflectance90, float alphaRoughness, vec3 diffuseColor, float NdotV) {\nvec3 H = normalize(L + V);\nfloat NdotL = clamp(dot(N, L), 0.001, 1.0);\nfloat NdotH = clamp(dot(N, H), 0.0, 1.0);\nfloat LdotH = clamp(dot(L, H), 0.0, 1.0);\nfloat VdotH = clamp(dot(V, H), 0.0, 1.0);\n// Calculate the shading terms for the microfacet specular shading model\nvec3 F = specularReflection(reflectance0, reflectance90, VdotH);\nfloat G = geometricOcclusion(NdotL, NdotV, alphaRoughness);\nfloat D = microfacetDistribution(alphaRoughness, NdotH);\n\nvec3 diffuseContrib;\n\n#ifdef HILO_LIGHT_MAP\ndiffuseContrib = vec3(0.0);\n#else\ndiffuseContrib = (1.0 - F) * diffuse(diffuseColor);\n#endif\nvec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\n// Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\nreturn NdotL * (diffuseContrib + specContrib);\n}\n\n#ifdef HILO_HAS_CLEARCOAT\nfloat calculateClearcoatBRDF(vec3 N, vec3 V, vec3 L, float clearcoatAlphaRoughness, float NdotV) {\nvec3 H = normalize(L + V);\nfloat NdotL = clamp(dot(N, L), 0.001, 1.0);\nfloat NdotH = clamp(dot(N, H), 0.0, 1.0);\nfloat VdotH = clamp(dot(V, H), 0.0, 1.0);\n\nfloat G = geometricOcclusion(NdotL, NdotV, clearcoatAlphaRoughness);\nfloat D = microfacetDistribution(clearcoatAlphaRoughness, NdotH);\n\nfloat clearcoatLayer = G * D / (4.0 * NdotV);\n\nreturn clearcoatLayer;\n}\n#endif\n#endif'},"./src/shader/chunk/pbr_main.frag":
/*!****************************************!*\
    !*** ./src/shader/chunk/pbr_main.frag ***!
    \****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\nvec4 baseColor = u_baseColor;\nvec3 emissionColor = u_emissionFactor.rgb;\n\n#ifdef HILO_BASE_COLOR_MAP\n#ifdef HILO_GAMMA_CORRECTION\nbaseColor *= sRGBToLinear(HILO_TEXTURE_2D(u_baseColorMap));\n#else\nbaseColor *= HILO_TEXTURE_2D(u_baseColorMap);\n#endif\n#endif\n\n#if defined(HILO_HAS_COLOR)\nbaseColor *= v_color;\n#endif\n\ncolor.a = baseColor.a;\n\n"+n(/*! ./transparency_main.frag */"./src/shader/chunk/transparency_main.frag")+"\n\n#ifdef HILO_HAS_LIGHT\nvec3 viewPos = vec3(0, 0, 0);\nvec3 N = normal;\nvec3 V = normalize(viewPos - v_fragPos);\n\n#ifdef HILO_OCCLUSION_MAP\nfloat ao  = HILO_TEXTURE_2D(u_occlusionMap).r;\n#else\nfloat ao = 1.0;\n#endif\n\n#ifdef HILO_PBR_SPECULAR_GLOSSINESS\nvec3 specular = u_specular.rgb;\nfloat glossiness = u_glossiness;\n#ifdef HILO_SPECULAR_GLOSSINESS_MAP\nvec4 specularGlossiness = sRGBToLinear(HILO_TEXTURE_2D(u_specularGlossinessMap));\nspecular = specularGlossiness.rgb * specular;\nglossiness = specularGlossiness.a * glossiness;\n#endif\nfloat roughness = 1.0 - glossiness;\nfloat metallic = 0.0;\nvec3 diffuseColor = baseColor.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\nvec3 specularColor = specular;\n#else\nfloat metallic = u_metallic;\nfloat roughness = u_roughness;\n#ifdef HILO_METALLIC_MAP\nmetallic = HILO_TEXTURE_2D(u_metallicMap).r * u_metallic;\n#endif\n#ifdef HILO_ROUGHNESS_MAP\nroughness  = HILO_TEXTURE_2D(u_roughnessMap).r * u_roughness;\n#endif\n#ifdef HILO_METALLIC_ROUGHNESS_MAP\nvec4 metallicRoughnessMap = HILO_TEXTURE_2D(u_metallicRoughnessMap);\n#ifdef HILO_IS_OCCLUSION_MAP_IN_METALLIC_ROUGHNESS_MAP\nao = metallicRoughnessMap.r;\n#endif\nroughness = metallicRoughnessMap.g * u_roughness;\nmetallic = metallicRoughnessMap.b * u_metallic;\n#endif\nroughness = clamp(roughness, 0.04, 1.0);\nmetallic = clamp(metallic, 0.0, 1.0);\nvec3 f0 = vec3(0.04);\nvec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\ndiffuseColor *= 1.0 - metallic;\nvec3 specularColor = mix(f0, baseColor.rgb, metallic);\n#endif\n\n#ifdef HILO_OCCLUSION_STRENGTH\nao = mix(1.0, ao, u_occlusionStrength);\n#endif\n\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n// For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\n// For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\nfloat reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\nvec3 specularEnvironmentR0 = specularColor.rgb;\nvec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\nfloat NdotV = clamp(abs(dot(N, V)), 0.001, 1.0);\nfloat alphaRoughness = roughness * roughness;\n\n#ifdef HILO_HAS_CLEARCOAT\nfloat clearcoatFactor = u_clearcoatFactor;\n#ifdef HILO_CLEARCOAT_MAP\nclearcoatFactor *= HILO_TEXTURE_2D(u_clearcoatMap).r;\n#endif\nfloat clearcoatRoughnessFactor = u_clearcoatRoughnessFactor;\n#ifdef HILO_CLEARCOAT_ROUGHNESS_MAP\nclearcoatRoughnessFactor *= HILO_TEXTURE_2D(u_clearcoatRoughnessMap).g;\n#endif\n\nfloat clearcoatAlphaRoughnessFactor = clearcoatRoughnessFactor * clearcoatRoughnessFactor;\nvec3 NC = clearcoatNormal;\nfloat NCdotV = clamp(abs(dot(NC, V)), 0.001, 1.0);\nfloat clearCoatFresnel = 0.04 + (1.0 - 0.04) * pow((1.0 - abs(NCdotV)),5.0);\nvec3 clearCoatLayer = vec3(0.0);\n#endif\n\n#ifdef HILO_DIRECTIONAL_LIGHTS\nfor(int i = 0;i < HILO_DIRECTIONAL_LIGHTS;i++){\nvec3 lightDir = normalize(-u_directionalLightsInfo[i]);\nvec3 radiance = u_directionalLightsColor[i];\nfloat shadow = 1.0;\n#ifdef HILO_DIRECTIONAL_LIGHTS_SMC\nif (i < HILO_DIRECTIONAL_LIGHTS_SMC) {\nfloat bias = HILO_MAX(u_directionalLightsShadowBias[i][1] * (1.0 - dot(N, lightDir)), u_directionalLightsShadowBias[i][0]);\nshadow = getShadow(u_directionalLightsShadowMap[i], u_directionalLightsShadowMapSize[i], bias, v_fragPos, u_directionalLightSpaceMatrix[i]);\n}\n#endif\n#ifdef HILO_HAS_CLEARCOAT\nclearCoatLayer += shadow * radiance * calculateClearcoatBRDF(NC, V, lightDir, clearcoatAlphaRoughnessFactor, NCdotV);\n#endif\ncolor.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\n}\n#endif\n\n#ifdef HILO_SPOT_LIGHTS\nfor(int i = 0; i < HILO_SPOT_LIGHTS; i++){\nvec3 lightDir = normalize(-u_spotLightsDir[i]);\nvec3 distanceVec = u_spotLightsPos[i] - v_fragPos;\n\nfloat theta = dot(normalize(distanceVec), lightDir);\nfloat epsilon = u_spotLightsCutoffs[i][0] - u_spotLightsCutoffs[i][1];\nfloat intensity = clamp((theta - u_spotLightsCutoffs[i][1]) / epsilon, 0.0, 1.0);\nfloat attenuation = getLightAttenuation(distanceVec, u_spotLightsInfo[i], u_spotLightsRange[i]);\nvec3 radiance = intensity * attenuation * u_spotLightsColor[i];\n\nfloat shadow = 1.0;\n#ifdef HILO_SPOT_LIGHTS_SMC\nif (i < HILO_SPOT_LIGHTS_SMC) {\nfloat bias = HILO_MAX(u_spotLightsShadowBias[i][1] * (1.0 - dot(N, lightDir)), u_spotLightsShadowBias[i][0]);\nshadow = getShadow(u_spotLightsShadowMap[i], u_spotLightsShadowMapSize[i], bias, v_fragPos, u_spotLightSpaceMatrix[i]);\n}\n#endif\n#ifdef HILO_HAS_CLEARCOAT\nclearCoatLayer += shadow * radiance * calculateClearcoatBRDF(NC, V, lightDir, clearcoatAlphaRoughnessFactor, NCdotV);\n#endif\ncolor.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\n}\n#endif\n\n#ifdef HILO_POINT_LIGHTS\nfor(int i = 0; i < HILO_POINT_LIGHTS; i++){\nvec3 distanceVec = u_pointLightsPos[i] - v_fragPos;\nvec3 lightDir = normalize(distanceVec);\n\nfloat shadow = 1.0;\n#ifdef HILO_POINT_LIGHTS_SMC\nif (i < HILO_POINT_LIGHTS_SMC) {\nfloat bias = HILO_MAX(u_pointLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_pointLightsShadowBias[i][0]);\nshadow = getShadow(u_pointLightsShadowMap[i], bias, u_pointLightsPos[i], v_fragPos, u_pointLightCamera[i], u_pointLightSpaceMatrix[i]);\n}\n#endif\n\nfloat attenuation = getLightAttenuation(distanceVec, u_pointLightsInfo[i], u_pointLightsRange[i]);\nvec3 radiance = attenuation * u_pointLightsColor[i];\n\n#ifdef HILO_HAS_CLEARCOAT\nclearCoatLayer += shadow * radiance * calculateClearcoatBRDF(NC, V, lightDir, clearcoatAlphaRoughnessFactor, NCdotV);\n#endif\ncolor.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\n}\n#endif\n\n#ifdef HILO_AREA_LIGHTS\nfor(int i = 0; i < HILO_AREA_LIGHTS; i++){\ncolor.rgb += getAreaLight(diffuseColor, specularColor, roughness, N, V, v_fragPos, u_areaLightsPos[i], u_areaLightsColor[i], u_areaLightsWidth[i], u_areaLightsHeight[i], u_areaLightsLtcTexture1, u_areaLightsLtcTexture2);\n}\n#endif\n\n#ifdef HILO_LIGHT_MAP\nvec4 lightMapColor = HILO_TEXTURE_2D(u_lightMap);\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_lights_image_based#rgbd\ncolor.rgb += baseColor.rgb * decodeRGBD(lightMapColor);\n#endif\n\n// IBL\n#ifdef HILO_HAS_CLEARCOAT\nclearCoatLayer += getIBLClearCoatContribution(NC, V, diffuseColor, vec3(.04), ao, NCdotV, clearcoatRoughnessFactor)/clearCoatFresnel;\n#endif\ncolor.rgb += getIBLContribution(N, V, diffuseColor, specularColor, ao, NdotV, roughness);\n\n#if defined(HILO_AMBIENT_LIGHTS) && (defined(HILO_IS_DIFFUESENV_AND_AMBIENTLIGHT_WORK_TOGETHER) || (!defined(HILO_DIFFUSE_ENV_MAP) && !defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)))\ncolor.rgb += u_ambientLightsColor * baseColor.rgb * ao;\n#endif\n\n#ifdef HILO_EMISSION_MAP\n#ifdef HILO_GAMMA_CORRECTION\nemissionColor *= sRGBToLinear(HILO_TEXTURE_2D(u_emission)).rgb;\n#else\nemissionColor *= HILO_TEXTURE_2D(u_emission).rgb;\n#endif\n#endif\n\ncolor.rgb += emissionColor;\n\n#ifdef HILO_HAS_CLEARCOAT\nfloat t = clearcoatFactor * clearCoatFresnel;\ncolor.rgb = color.rgb * (1.0 - t) + clearCoatLayer * t;\n#endif\n#else\ncolor.rgb = baseColor.rgb;\ncolor.rgb += emissionColor;\n#endif"},"./src/shader/chunk/phong.frag":
/*!*************************************!*\
    !*** ./src/shader/chunk/phong.frag ***!
    \*************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ../method/textureEnvMap.glsl */"./src/shader/method/textureEnvMap.glsl")+"\n"+n(/*! ./fixMathCrash.glsl */"./src/shader/chunk/fixMathCrash.glsl")+"\n\n#ifdef HILO_HAS_LIGHT\n#ifdef HILO_HAS_SPECULAR\nuniform float u_shininess;\n#ifdef HILO_SPECULAR_MAP\nuniform HILO_SAMPLER_2D u_specular;\n#else\nuniform vec4 u_specular;\n#endif\n#endif\n#ifdef HILO_EMISSION_MAP\nuniform HILO_SAMPLER_2D u_emission;\n#else\nuniform vec4 u_emission;\n#endif\n#ifdef HILO_AMBIENT_MAP\nuniform HILO_SAMPLER_2D u_ambient;\n#endif\n#ifdef HILO_SPECULAR_ENV_MAP\n#ifdef HILO_SPECULAR_ENV_MAP_CUBE\nuniform samplerCube u_specularEnvMap;\n#else\nuniform sampler2D u_specularEnvMap;\n#endif\nuniform mat4 u_specularEnvMatrix;\nuniform float u_reflectivity;\nuniform float u_refractRatio;\nuniform float u_refractivity;\n#endif\n#endif"},"./src/shader/chunk/phong_main.frag":
/*!******************************************!*\
    !*** ./src/shader/chunk/phong_main.frag ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_LIGHT\nvec3 lightDiffuse = vec3(0, 0, 0);\nvec3 lightAmbient = vec3(0, 0, 0);\nvec3 viewPos = vec3(0, 0, 0);\n\n#ifdef HILO_AMBIENT_MAP\nlightAmbient = HILO_TEXTURE_2D(u_ambient).rgb;\n#else\nlightAmbient = diffuse.rgb;\n#endif\n\n#ifdef HILO_HAS_SPECULAR\nvec3 lightSpecular = vec3(0, 0, 0);\n#ifdef HILO_SPECULAR_MAP\nvec4 specular = HILO_TEXTURE_2D(u_specular);\n#else\nvec4 specular = u_specular;\n#endif\n#endif\n\n#ifdef HILO_EMISSION_MAP\nvec4 emission = HILO_TEXTURE_2D(u_emission);\n#else\nvec4 emission = u_emission;\n#endif\n\n#ifdef HILO_DIRECTIONAL_LIGHTS\nfor(int i = 0;i < HILO_DIRECTIONAL_LIGHTS;i++){\nvec3 lightDir = -u_directionalLightsInfo[i];\n\nfloat shadow = 1.0;\n#ifdef HILO_DIRECTIONAL_LIGHTS_SMC\nif (i < HILO_DIRECTIONAL_LIGHTS_SMC) {\nfloat bias = HILO_MAX(u_directionalLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_directionalLightsShadowBias[i][0]);\nshadow = getShadow(u_directionalLightsShadowMap[i], u_directionalLightsShadowMapSize[i], bias, v_fragPos, u_directionalLightSpaceMatrix[i]);\n}\n#endif\n\nfloat diff = getDiffuse(normal, lightDir);\nlightDiffuse += diff * u_directionalLightsColor[i] * shadow;\n\n#ifdef HILO_HAS_SPECULAR\nfloat spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\nlightSpecular += spec * u_directionalLightsColor[i] * shadow;\n#endif\n}\n#endif\n\n#ifdef HILO_SPOT_LIGHTS\nfor(int i = 0; i < HILO_SPOT_LIGHTS; i++){\nvec3 lightDir = -u_spotLightsDir[i];\nvec3 distanceVec = u_spotLightsPos[i] - v_fragPos;\n\nfloat shadow = 1.0;\n#ifdef HILO_SPOT_LIGHTS_SMC\nif (i < HILO_SPOT_LIGHTS_SMC) {\nfloat bias = HILO_MAX(u_spotLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_spotLightsShadowBias[i][0]);\nshadow = getShadow(u_spotLightsShadowMap[i], u_spotLightsShadowMapSize[i], bias, v_fragPos, u_spotLightSpaceMatrix[i]);\n}\n#endif\n\nfloat diff = getDiffuse(normal, normalize(distanceVec));\nfloat theta = dot(normalize(distanceVec), lightDir);\nfloat epsilon = u_spotLightsCutoffs[i][0] - u_spotLightsCutoffs[i][1];\nfloat intensity = clamp((theta - u_spotLightsCutoffs[i][1]) / epsilon, 0.0, 1.0);\nfloat attenuation = getLightAttenuation(distanceVec, u_spotLightsInfo[i], u_spotLightsRange[i]);\n\nlightDiffuse += intensity * attenuation * shadow * diff * u_spotLightsColor[i];\n\n#ifdef HILO_HAS_SPECULAR\nfloat spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\nlightSpecular += intensity * attenuation * shadow * spec * u_spotLightsColor[i];\n#endif\n}\n#endif\n\n#ifdef HILO_POINT_LIGHTS\nfor(int i = 0;i < HILO_POINT_LIGHTS;i++){\nvec3 distanceVec = u_pointLightsPos[i] - v_fragPos;\nvec3 lightDir = normalize(distanceVec);\n\nfloat shadow = 1.0;\n#ifdef HILO_POINT_LIGHTS_SMC\nif (i < HILO_POINT_LIGHTS_SMC) {\nfloat bias = HILO_MAX(u_pointLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_pointLightsShadowBias[i][0]);\nshadow = getShadow(u_pointLightsShadowMap[i], bias, u_pointLightsPos[i], v_fragPos, u_pointLightCamera[i], u_pointLightSpaceMatrix[i]);\n}\n#endif\n\nfloat diff = getDiffuse(normal, lightDir);\nfloat attenuation = getLightAttenuation(distanceVec, u_pointLightsInfo[i], u_pointLightsRange[i]);\nlightDiffuse += diff * attenuation * u_pointLightsColor[i] * shadow;\n\n#ifdef HILO_HAS_SPECULAR\nfloat spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\nlightSpecular += spec * attenuation * u_pointLightsColor[i] * shadow;\n#endif\n}\n#endif\n\n#ifdef HILO_AREA_LIGHTS\n#ifndef HILO_HAS_SPECULAR\nvec4 specular = vec4(0.0, 0.0, 0.0, 0.0);\n#endif\nvec3 viewDir = normalize(vec3(0, 0, 0) - v_fragPos);\nfor(int i = 0; i < HILO_AREA_LIGHTS; i++){\ncolor.rgb += getAreaLight(diffuse.rgb, specular.rgb, sqrt(2.0/(u_shininess+2.0)), normal, viewDir, v_fragPos, u_areaLightsPos[i], u_areaLightsColor[i], u_areaLightsWidth[i], u_areaLightsHeight[i], u_areaLightsLtcTexture1, u_areaLightsLtcTexture2);\n}\n#endif\n\n#ifdef HILO_AMBIENT_LIGHTS\ncolor.rgb += u_ambientLightsColor * lightAmbient;\n#endif\n\n#if defined(HILO_SPECULAR_ENV_MAP) && defined(HILO_HAS_SPECULAR)\nvec3 I = normalize(v_fragPos - viewPos);\nif (u_reflectivity > 0.0) {\nvec3 R = reflect(I, normal);\nR = normalize(vec3(u_specularEnvMatrix * vec4(R, 1.0)));\nlightSpecular += textureEnvMap(u_specularEnvMap, R).rgb * u_reflectivity;\n}\nif (u_refractivity > 0.0) {\nvec3 R = refract(I, normal, u_refractRatio);\nR = normalize(vec3(u_specularEnvMatrix * vec4(R, 1.0)));\nlightSpecular += textureEnvMap(u_specularEnvMap, R).rgb * u_refractivity;\n}\n#endif\n\ncolor.rgb += lightDiffuse * diffuse.rgb;\n#ifdef HILO_HAS_SPECULAR\ncolor.rgb += lightSpecular * specular.rgb;\n#endif\n\ncolor.rgb += emission.rgb;\n#else\ncolor.rgb = diffuse.rgb;\n#endif"},"./src/shader/chunk/precision.frag":
/*!*****************************************!*\
    !*** ./src/shader/chunk/precision.frag ***!
    \*****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#ifdef GL_ES\nprecision HILO_MAX_FRAGMENT_PRECISION float;\n#define GLSLIFY 1\n#endif"},"./src/shader/chunk/precision.vert":
/*!*****************************************!*\
    !*** ./src/shader/chunk/precision.vert ***!
    \*****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#ifdef GL_ES\nprecision HILO_MAX_VERTEX_PRECISION float;\n#define GLSLIFY 1\n#endif"},"./src/shader/chunk/transparency.frag":
/*!********************************************!*\
    !*** ./src/shader/chunk/transparency.frag ***!
    \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_TRANSPARENCY_MAP\nuniform HILO_SAMPLER_2D u_transparency;\n#else\nuniform float u_transparency;\n#endif\n\n#ifdef HILO_ALPHA_CUTOFF\nuniform float u_alphaCutoff;\n#endif"},"./src/shader/chunk/transparency_main.frag":
/*!*************************************************!*\
    !*** ./src/shader/chunk/transparency_main.frag ***!
    \*************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nfloat transparency = 1.0;\n#ifdef HILO_TRANSPARENCY_MAP\ntransparency = HILO_TEXTURE_2D(u_transparency).r;\n#else\ntransparency = u_transparency;\n#endif\ncolor.a *= transparency;\n#ifdef HILO_ALPHA_CUTOFF\nif (color.a < u_alphaCutoff) {\ndiscard;\n} else {\ncolor.a = 1.0;\n}\n#endif"},"./src/shader/chunk/unQuantize.vert":
/*!******************************************!*\
    !*** ./src/shader/chunk/unQuantize.vert ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_QUANTIZED\n#ifdef HILO_POSITION_QUANTIZED\nuniform mat4 u_positionDecodeMat;\n#endif\n#ifdef HILO_NORMAL_QUANTIZED\nuniform mat4 u_normalDecodeMat;\n#endif\n#ifdef HILO_UV_QUANTIZED\nuniform mat3 u_uvDecodeMat;\n#endif\n#ifdef HILO_UV1_QUANTIZED\nuniform mat3 u_uv1DecodeMat;\n#endif\n\nvec2 unQuantize(vec2 data, mat3 decodeMat) {\nvec3 result = vec3(data, 1.0);\nresult = decodeMat * result;\nreturn result.xy;\n}\n\nvec3 unQuantize(vec3 data, mat4 decodeMat) {\nvec4 result = vec4(data, 1.0);\nresult = decodeMat * result;\nreturn result.xyz;\n}\n#endif"},"./src/shader/chunk/unQuantize_main.vert":
/*!***********************************************!*\
    !*** ./src/shader/chunk/unQuantize_main.vert ***!
    \***********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_QUANTIZED\n#ifdef HILO_POSITION_QUANTIZED\npos.xyz = unQuantize(pos.xyz, u_positionDecodeMat);\n#endif\n#if defined(HILO_HAS_TEXCOORD0) && defined(HILO_UV_QUANTIZED)\nuv = unQuantize(uv, u_uvDecodeMat);\n#endif\n#if defined(HILO_HAS_TEXCOORD1) && defined(HILO_UV1_QUANTIZED)\nuv1 = unQuantize(uv1, u_uv1DecodeMat);\n#endif\n#if defined(HILO_HAS_NORMAL) && defined(HILO_NORMAL_QUANTIZED)\nnormal = unQuantize(normal, u_normalDecodeMat);\n#endif\n#endif"},"./src/shader/chunk/uv.frag":
/*!**********************************!*\
    !*** ./src/shader/chunk/uv.frag ***!
    \**********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_TEXCOORD0\nvarying vec2 v_texcoord0;\n#endif\n\n#ifdef HILO_HAS_TEXCOORD1\nvarying vec2 v_texcoord1;\n#endif\n\n#if defined(HILO_HAS_TEXCOORD0) || defined(HILO_HAS_TEXCOORD1)\n#if defined(HILO_HAS_TEXCOORD0) && defined(HILO_HAS_TEXCOORD1)\n#define HILO_SAMPLER_2D hiloSampler2D\n// https://www.khronos.org/opengl/wiki/Data_Type_(GLSL)#Opaque_types\n#define HILO_TEXTURE_2D(HILO_SAMPLER_2D)  hiloTexture2D(HILO_SAMPLER_2D.texture, HILO_SAMPLER_2D.uv)\nstruct hiloSampler2D{\nsampler2D texture;\nint uv; \n};\n\nvec4 hiloTexture2D(sampler2D texture, int uv){\nif(uv == 0){\nreturn texture2D(texture, v_texcoord0);\n}\nelse{\nreturn texture2D(texture, v_texcoord1);\n}\n}\n#else\n#ifdef HILO_HAS_TEXCOORD1\n#define HILO_V_TEXCOORD v_texcoord1\n#else\n#define HILO_V_TEXCOORD v_texcoord0\n#endif\n#define HILO_SAMPLER_2D sampler2D\n#define HILO_TEXTURE_2D(HILO_SAMPLER_2D)  texture2D(HILO_SAMPLER_2D, HILO_V_TEXCOORD)\n#endif\n#endif\n\n\n#ifdef HILO_DIFFUSE_CUBE_MAP\nvarying vec3 v_position;\n#endif"},"./src/shader/chunk/uv.vert":
/*!**********************************!*\
    !*** ./src/shader/chunk/uv.vert ***!
    \**********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_TEXCOORD0\nattribute vec2 a_texcoord0;\nvarying vec2 v_texcoord0;\n#ifdef HILO_UV_MATRIX\nuniform mat3 u_uvMatrix;\n#endif\n#endif\n\n#ifdef HILO_HAS_TEXCOORD1\nattribute vec2 a_texcoord1;\nvarying vec2 v_texcoord1;\n#ifdef HILO_UV_MATRIX1\nuniform mat3 u_uvMatrix1;\n#endif\n#endif\n\n#ifdef HILO_DIFFUSE_CUBE_MAP\nvarying vec3 v_position;\n#endif"},"./src/shader/chunk/uv_main.vert":
/*!***************************************!*\
    !*** ./src/shader/chunk/uv_main.vert ***!
    \***************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n#ifdef HILO_HAS_TEXCOORD0\n#ifdef HILO_UV_MATRIX\nv_texcoord0 = (u_uvMatrix * vec3(uv, 1.0)).xy;\n#else\nv_texcoord0 = uv;\n#endif\n#endif\n#ifdef HILO_HAS_TEXCOORD1\n#ifdef HILO_UV_MATRIX1\nv_texcoord1 = (u_uvMatrix1 * vec3(uv1, 1.0)).xy;\n#else\nv_texcoord1 = uv1;\n#endif\n#endif\n#ifdef HILO_DIFFUSE_CUBE_MAP\nv_position = pos.xyz;\n#endif"},"./src/shader/geometry.frag":
/*!**********************************!*\
    !*** ./src/shader/geometry.frag ***!
    \**********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ./chunk/extensions.frag */"./src/shader/chunk/extensions.frag")+"\n"+n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl")+"\n"+n(/*! ./chunk/precision.frag */"./src/shader/chunk/precision.frag")+"\n\n#if defined(HILO_VERTEX_TYPE_POSITION)\nvarying vec3 v_fragPos;\n#elif defined(HILO_VERTEX_TYPE_NORMAL)\nvarying vec3 v_normal;\n#elif defined(HILO_VERTEX_TYPE_DEPTH)\nuniform float u_cameraFar;\nuniform float u_cameraNear;\nuniform float u_cameraType;\n#elif defined(HILO_VERTEX_TYPE_DISTANCE)\n"+n(/*! ./method/packFloat.glsl */"./src/shader/method/packFloat.glsl")+"\n\nuniform float u_cameraFar;\nuniform float u_cameraNear;\nvarying vec3 v_fragPos;\n#endif\n\nvec4 transformDataToColor(vec3 data){\n#ifdef HILO_WRITE_ORIGIN_DATA\nreturn vec4(data, 1.0);\n#else\nreturn vec4(data * 0.5 + 0.5, 1.0);\n#endif\n}\n\n"+n(/*! ./chunk/logDepth.frag */"./src/shader/chunk/logDepth.frag")+"\n\nvoid main(void) {\n#if defined(HILO_VERTEX_TYPE_POSITION)\ngl_FragColor = transformDataToColor(v_fragPos);\n#elif defined(HILO_VERTEX_TYPE_NORMAL)\ngl_FragColor = transformDataToColor(v_normal);\n#elif defined(HILO_VERTEX_TYPE_DEPTH)\nfloat z;\n#ifdef HILO_WRITE_ORIGIN_DATA\nz = gl_FragCoord.z;\n#else\n// OrthographicCamera\nif(u_cameraType < 1.0){\nz = gl_FragCoord.z;\n}\n// PerspectiveCamera\nelse{\nz = gl_FragCoord.z * 2.0 - 1.0;\nz = (2.0 * u_cameraNear * u_cameraFar) / (u_cameraFar + u_cameraNear - z * (u_cameraFar - u_cameraNear));\n}\n#endif\ngl_FragColor = vec4(z, z, z, 1.0);\n#elif defined(HILO_VERTEX_TYPE_DISTANCE)\nfloat distance = length(v_fragPos);\n#ifdef HILO_WRITE_ORIGIN_DATA\ngl_FragColor = vec4(distance, distance, distance, 1.0);\n#else\ngl_FragColor = packFloat((distance - u_cameraNear)/(u_cameraFar - u_cameraNear));\n#endif\n#endif\n"+n(/*! ./chunk/logDepth_main.frag */"./src/shader/chunk/logDepth_main.frag")+"\n}"},"./src/shader/method/encoding.glsl":
/*!*****************************************!*\
    !*** ./src/shader/method/encoding.glsl ***!
    \*****************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nvec4 sRGBToLinear( in vec4 value ) {\nreturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\n\nvec3 sRGBToLinear( in vec3 value ) {\nreturn vec3( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ));\n}\n\n"},"./src/shader/method/getAreaLight.glsl":
/*!*********************************************!*\
    !*** ./src/shader/method/getAreaLight.glsl ***!
    \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n// modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl#L26\n\n"+n(/*! ../method/transpose.glsl */"./src/shader/method/transpose.glsl")+"\n\nvec2 LTC_Uv(const in vec3 N, const in vec3 V, const in float roughness) {\nconst float LUT_SIZE = 64.0;\nconst float LUT_SCALE = (LUT_SIZE - 1.0) / LUT_SIZE;\nconst float LUT_BIAS = 0.5 / LUT_SIZE;\nfloat dotNV = clamp(dot(N, V), 0.0, 1.0);\nvec2 uv = vec2(roughness, sqrt(1.0 - dotNV));\nuv = (uv * LUT_SCALE) + LUT_BIAS;\nreturn uv;\n}\n\nfloat LTC_ClippedSphereFormFactor(const in vec3 f) {\nfloat l = length(f);\nreturn max(((l * l) + f.z) / (l + 1.0), 0.0);\n}\n\nvec3 LTC_EdgeVectorFormFactor(const in vec3 v1, const in vec3 v2) {\nfloat x = dot(v1, v2);\nfloat y = abs(x);\nfloat a = 0.8543985 + ((0.4965155 + (0.0145206 * y)) * y);\nfloat b = 3.4175940 + ((4.1616724 + y) * y);\nfloat v = a / b;\nfloat theta_sintheta = x > 0.0 ? v : (0.5 * inversesqrt(max(1.0 - (x * x), 1e-7))) - v;\nreturn cross(v1, v2) * theta_sintheta;\n}\n\nvec3 LTC_Evaluate(const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[4]) {\nvec3 v1 = rectCoords[1] - rectCoords[0];\nvec3 v2 = rectCoords[3] - rectCoords[0];\nvec3 lightNormal = cross(v1, v2);\nif (dot(lightNormal, P - rectCoords[0]) < 0.0)\nreturn vec3(0.0);\nvec3 T1, T2;\nT1 = normalize(V - (N * dot(V, N)));\nT2 = -cross(N, T1);\nmat3 mat = mInv * transpose(mat3(T1, T2, N));\nvec3 coords[4];\ncoords[0] = mat * (rectCoords[0] - P);\ncoords[1] = mat * (rectCoords[1] - P);\ncoords[2] = mat * (rectCoords[2] - P);\ncoords[3] = mat * (rectCoords[3] - P);\ncoords[0] = normalize(coords[0]);\ncoords[1] = normalize(coords[1]);\ncoords[2] = normalize(coords[2]);\ncoords[3] = normalize(coords[3]);\nvec3 vectorFormFactor = vec3(0.0);\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[0], coords[1]);\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[1], coords[2]);\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[2], coords[3]);\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[3], coords[0]);\nfloat result = LTC_ClippedSphereFormFactor(vectorFormFactor);\nreturn vec3(result);\n}\n\nvec3 getAreaLight(const in vec3 diffuseColor, const in vec3 specularColor, const in float roughness, const in vec3 normal, const in vec3 viewDir, const in vec3 position, const in vec3 lightPos, const in vec3 lightColor, const in vec3 halfWidth, const in vec3 halfHeight, const in sampler2D areaLightsLtcTexture1, const in sampler2D areaLightsLtcTexture2){\nvec3 rectCoords[4];\nrectCoords[0] = (lightPos - halfWidth) - halfHeight;\nrectCoords[1] = (lightPos + halfWidth) - halfHeight;\nrectCoords[2] = (lightPos + halfWidth) + halfHeight;\nrectCoords[3] = (lightPos - halfWidth) + halfHeight;\n\nvec2 uv = LTC_Uv(normal, viewDir, roughness);\nvec4 t1 = texture2D(areaLightsLtcTexture1, uv);\nvec4 t2 = texture2D(areaLightsLtcTexture2, uv);\n\nmat3 mInv = mat3(vec3(t1.x, 0, t1.y), vec3(0, 1, 0), vec3(t1.z, 0, t1.w));\nvec3 fresnel = (specularColor * t2.x) + ((vec3(1.0) - specularColor) * t2.y);\n\nvec3 color = vec3(0.0, 0.0, 0.0);\ncolor += ((lightColor * fresnel) * LTC_Evaluate(normal, viewDir, position, mInv, rectCoords));\ncolor += ((lightColor * diffuseColor) * LTC_Evaluate(normal, viewDir, position, mat3(1.0), rectCoords));\nreturn color;\n}\n\n"},"./src/shader/method/getDiffuse.glsl":
/*!*******************************************!*\
    !*** ./src/shader/method/getDiffuse.glsl ***!
    \*******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nfloat getDiffuse(vec3 normal, vec3 lightDir){\nreturn max(dot(normal, lightDir), 0.0);\n}\n\n"},"./src/shader/method/getLightAttenuation.glsl":
/*!****************************************************!*\
    !*** ./src/shader/method/getLightAttenuation.glsl ***!
    \****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nfloat getLightAttenuation(vec3 distanceVec, vec3 info, float range){\nfloat distance = length(distanceVec);\nfloat attenuation = 1.0;\n#ifdef HILO_USE_PHYSICS_LIGHT\nattenuation = max(1.0 / (distance * distance), 0.001);\nif (range > 0.0) {\nattenuation *= max(min(1.0 - pow( distance / range, 4.0 ), 1.0), 0.0);\n}\n#else\nattenuation = 1.0/(info.x + info.y * distance + info.z * distance * distance);\n#endif\n\nreturn attenuation;\n}\n\n"},"./src/shader/method/getShadow.glsl":
/*!******************************************!*\
    !*** ./src/shader/method/getShadow.glsl ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nbool isOutOfRange(vec2 pos) {\nif (pos.x < 0.0 || pos.x > 1.0 || pos.y < 0.0 || pos.y > 1.0) {\nreturn true;\n}\nreturn false;\n}\n\nfloat getShadow(sampler2D shadowMap, vec2 shadowMapSize, float bias, vec3 fragPos, mat4 lightSpaceMatrix) {\nvec4 fragPosLightSpace = lightSpaceMatrix * vec4(fragPos, 1.0);\nvec3 projCoords = fragPosLightSpace.xyz / fragPosLightSpace.w;\nprojCoords = projCoords * 0.5 + 0.5;\nif (isOutOfRange(projCoords.xy)) {\nreturn 1.0;\n}\nfloat currentDepth = projCoords.z;\nfloat shadow = 0.0;\nvec2 texelSize = 1.0 / shadowMapSize;\nfor (int x = -1; x <= 1; ++x) {\nfor (int y = -1; y <= 1; ++y) {\nvec2 pos = projCoords.xy + vec2(x, y) * texelSize;\nif (isOutOfRange(pos)) {\nshadow += 1.0;\n} else {\nfloat pcfDepth = texture2D(shadowMap, pos).r;\nshadow += currentDepth - bias > pcfDepth ? 1.0 : 0.0;\n}\n}\n}\nreturn 1.0 - shadow / 9.0;\n}\n\nfloat getShadow(samplerCube shadowMap, float bias, vec3 lightPos, vec3 position, vec2 camera, mat4 lightSpaceMatrix) {\nvec4 distanceVec = lightSpaceMatrix * vec4(position, 1.0) - lightSpaceMatrix * vec4(lightPos, 1.0);\nfloat currentDistance = length(distanceVec);\nvec3 direction = normalize(distanceVec).xyz;\n\nfloat shadow = 0.0;\nconst float samples = 2.0;\nconst float offset = 0.01;\nconst float step = offset / (samples * 0.5);\nfor(float x = -offset; x < offset; x +=step)\n{\nfor(float y = -offset; y < offset; y +=step)\n{\nfor(float z = -offset; z < offset; z +=step)\n{\nfloat closestDistance = camera[0] + (camera[1] - camera[0]) * unpackFloat(textureCube(shadowMap, direction + vec3(x, y, z)));\nif (closestDistance == camera[0]) {\ncontinue;\n}\nelse if(currentDistance - bias > closestDistance)\nshadow += 1.0;\n}\n}\n}\nshadow /= (samples * samples * samples);\n\nreturn 1.0 - shadow;\n}\n\n"},"./src/shader/method/getSpecular.glsl":
/*!********************************************!*\
    !*** ./src/shader/method/getSpecular.glsl ***!
    \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nfloat getSpecular(vec3 cameraPos, vec3 fragPos, vec3 lightDir, vec3 normal, float shininess){\nvec3 viewDir = normalize(cameraPos - fragPos);\n#ifdef LIGHT_TYPE_PHONG\nreturn pow(max(dot(viewDir, reflect(-lightDir, normal), 0.0), shininess);\n#else\nreturn pow(max(dot(normal, normalize(lightDir + viewDir)), 0.0), shininess);\n#endif\n}\n\n"},"./src/shader/method/packFloat.glsl":
/*!******************************************!*\
    !*** ./src/shader/method/packFloat.glsl ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\n// https://github.com/playcanvas/engine/blob/master/src/graphics/program-lib/chunks/packDepth.frag\n// Packing a float in GLSL with multiplication and mod\n// http://blog.gradientstudios.com/2012/08/23/shadow-map-improvement\nvec4 packFloat(float depth) {\nconst vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\nconst vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\n// combination of mod and multiplication and division works better\nvec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\nres -= res.xxyz * bit_mask;\nreturn res;\n}\n\n\n\n"},"./src/shader/method/textureEnvMap.glsl":
/*!**********************************************!*\
    !*** ./src/shader/method/textureEnvMap.glsl ***!
    \**********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nvec4 textureEnvMap(sampler2D texture, vec3 position){\nreturn texture2D(texture, vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI));\n}\n\nvec4 textureEnvMap(samplerCube texture, vec3 position){\nreturn textureCube(texture, position);\n}\n\nvec4 textureEnvMapIncludeMipmapsLod(sampler2D texture, vec3 position, float lod){\nlod = floor(lod);\nvec2 uv = vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI);\n\nfloat scale = pow(2.0, lod);\n\nreturn texture2D(texture, vec2(uv.x / scale, (uv.y / scale / 2.0) + 1.0 - 1.0/pow(2.0, lod)));\n}\n\n#ifdef HILO_USE_SHADER_TEXTURE_LOD\nvec4 textureEnvMapLod(sampler2D texture, vec3 position, float lod){\nreturn texture2DLodEXT(texture, vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI), lod);\n}\n\nvec4 textureEnvMapLod(samplerCube texture, vec3 position, float lod){\nreturn textureCubeLodEXT(texture, position, lod);\n}\n#endif\n\n"},"./src/shader/method/transpose.glsl":
/*!******************************************!*\
    !*** ./src/shader/method/transpose.glsl ***!
    \******************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nfloat transpose(float m) {\nreturn m;\n}\n\nmat2 transpose(mat2 m) {\nreturn mat2(m[0][0], m[1][0],\nm[0][1], m[1][1]);\n}\n\nmat3 transpose(mat3 m) {\nreturn mat3(m[0][0], m[1][0], m[2][0],\nm[0][1], m[1][1], m[2][1],\nm[0][2], m[1][2], m[2][2]);\n}\n\nmat4 transpose(mat4 m) {\nreturn mat4(m[0][0], m[1][0], m[2][0], m[3][0],\nm[0][1], m[1][1], m[2][1], m[3][1],\nm[0][2], m[1][2], m[2][2], m[3][2],\nm[0][3], m[1][3], m[2][3], m[3][3]);\n}"},"./src/shader/method/unpackFloat.glsl":
/*!********************************************!*\
    !*** ./src/shader/method/unpackFloat.glsl ***!
    \********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e){t.exports="#define GLSLIFY 1\nfloat unpackFloat(vec4 rgbaDepth) {\nconst vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\nfloat depth = dot(rgbaDepth, bitShift);\nreturn depth;\n}\n\n"},"./src/shader/pbr.frag":
/*!*****************************!*\
    !*** ./src/shader/pbr.frag ***!
    \*****************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ./chunk/extensions.frag */"./src/shader/chunk/extensions.frag")+"\n"+n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl")+"\n"+n(/*! ./chunk/precision.frag */"./src/shader/chunk/precision.frag")+"\n\n"+n(/*! ./chunk/color.frag */"./src/shader/chunk/color.frag")+"\n"+n(/*! ./chunk/uv.frag */"./src/shader/chunk/uv.frag")+"\n"+n(/*! ./chunk/normal.frag */"./src/shader/chunk/normal.frag")+"\n"+n(/*! ./chunk/lightFog.frag */"./src/shader/chunk/lightFog.frag")+"\n"+n(/*! ./chunk/pbr.frag */"./src/shader/chunk/pbr.frag")+"\n"+n(/*! ./chunk/light.frag */"./src/shader/chunk/light.frag")+"\n"+n(/*! ./chunk/transparency.frag */"./src/shader/chunk/transparency.frag")+"\n"+n(/*! ./chunk/fog.frag */"./src/shader/chunk/fog.frag")+"\n"+n(/*! ./chunk/logDepth.frag */"./src/shader/chunk/logDepth.frag")+"\n\nvoid main(void) {\nvec4 color = vec4(0., 0., 0., 1.);\n\n"+n(/*! ./chunk/normal_main.frag */"./src/shader/chunk/normal_main.frag")+"\n"+n(/*! ./chunk/lightFog_main.frag */"./src/shader/chunk/lightFog_main.frag")+"\n"+n(/*! ./chunk/pbr_main.frag */"./src/shader/chunk/pbr_main.frag")+"\n"+n(/*! ./chunk/frag_color.frag */"./src/shader/chunk/frag_color.frag")+"\n"+n(/*! ./chunk/logDepth_main.frag */"./src/shader/chunk/logDepth_main.frag")+"\n}"},"./src/shader/screen.frag":
/*!********************************!*\
    !*** ./src/shader/screen.frag ***!
    \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ./chunk/extensions.frag */"./src/shader/chunk/extensions.frag")+"\n"+n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl")+"\n"+n(/*! ./chunk/precision.frag */"./src/shader/chunk/precision.frag")+"\n\nvarying vec2 v_texcoord0;\nuniform sampler2D u_diffuse;\n\nvoid main(void) {  \ngl_FragColor = texture2D(u_diffuse, v_texcoord0);\n}"},"./src/shader/screen.vert":
/*!********************************!*\
    !*** ./src/shader/screen.vert ***!
    \********************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){t.exports="#define GLSLIFY 1\n"+n(/*! ./chunk/extensions.vert */"./src/shader/chunk/extensions.vert")+"\n"+n(/*! ./chunk/baseDefine.glsl */"./src/shader/chunk/baseDefine.glsl")+"\n"+n(/*! ./chunk/precision.vert */"./src/shader/chunk/precision.vert")+"\n\nattribute vec2 a_position;\nattribute vec2 a_texcoord0;\nvarying vec2 v_texcoord0;\n\n\nvoid main(void) {\nvec4 pos = vec4(a_position, 0.0, 1.0);\ngl_Position = pos;\nv_texcoord0 = a_texcoord0;\n}"},0:
/*!***********************************************!*\
    !*** multi ./src/polyfill.js ./src/Hilo3d.js ***!
    \***********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,n){n(/*! ./src/polyfill.js */"./src/polyfill.js"),t.exports=n(/*! ./src/Hilo3d.js */"./src/Hilo3d.js")}}),"undefined"!=typeof window&&window.Hilo3d&&(t.exports=window.Hilo3d)})),j=(G=k)&&G.__esModule&&Object.prototype.hasOwnProperty.call(G,"default")?G.default:G,V=k.util,X=k.GLTFExtensions,W=k.Class,z=k.EventMixin,q=k.Fog,Y=k.Mesh,J=k.Node,Q=k.SkinedMesh,Z=k.Stage,K=k.Tween,$=k.version,tt=k.BoxGeometry,et=k.Geometry,nt=k.GeometryData,rt=k.MorphGeometry,it=k.PlaneGeometry,ot=k.SphereGeometry,st=k.Camera,at=k.PerspectiveCamera,ut=k.OrthographicCamera,ct=k.Buffer,ht=k.capabilities,lt=k.extensions,ft=k.Framebuffer,dt=k.glType,pt=k.Program,mt=k.RenderInfo,_t=k.RenderList,gt=k.VertexArrayObject,vt=k.WebGLRenderer,yt=k.WebGLResourceManager,Et=k.WebGLState,Tt=k.BasicLoader,At=k.CubeTextureLoader,St=k.GLTFLoader,Mt=k.GLTFParser,Ot=k.AliAMCExtension,bt=k.HDRLoader,Lt=k.KTXLoader,It=k.LoadCache,Rt=k.LoadQueue,Ct=k.ShaderMaterialLoader,xt=k.TextureLoader,wt=k.Loader,Nt=k.Texture,Pt=k.LazyTexture,Dt=k.CubeTexture,Ht=k.DataTexture,Ft=k.Shader,Ut=k.BasicMaterial,Bt=k.GeometryMaterial,Gt=k.Material,kt=k.PBRMaterial,jt=k.semantic,Vt=k.ShaderMaterial,Xt=k.AxisHelper,Wt=k.AxisNetHelper,zt=k.CameraHelper,qt=k.AmbientLight,Yt=k.AreaLight,Jt=k.DirectionalLight,Qt=k.CubeLightShadow,Zt=k.Light,Kt=k.LightManager,$t=k.LightShadow,te=k.PointLight,ee=k.SpotLight,ne=k.Animation,re=k.AnimationStates,ie=k.MeshPicker,oe=k.Ticker,se=k.log,ae=k.Cache,ue=k.browser,ce=k.WebGLSupport,he=k.constants,le=k.Color,fe=k.Euler,de=k.EulerNotifier,pe=k.Frustum,me=k.math,_e=k.Matrix3,ge=k.Matrix4,ve=k.Matrix4Notifier,ye=k.Plane,Ee=k.Quaternion,Te=k.Ray,Ae=k.Sphere,Se=k.Vector2,Me=k.Vector3,Oe=k.Vector3Notifier,be=k.Vector4,Le=k.SphericalHarmonics3,Ie=k.Skeleton,Re=Object.freeze({__proto__:null,default:j,__moduleExports:k,util:V,GLTFExtensions:X,Class:W,EventMixin:z,Fog:q,Mesh:Y,Node:J,SkinedMesh:Q,Stage:Z,Tween:K,version:$,BoxGeometry:tt,Geometry:et,GeometryData:nt,MorphGeometry:rt,PlaneGeometry:it,SphereGeometry:ot,Camera:st,PerspectiveCamera:at,OrthographicCamera:ut,Buffer:ct,capabilities:ht,extensions:lt,Framebuffer:ft,glType:dt,Program:pt,RenderInfo:mt,RenderList:_t,VertexArrayObject:gt,WebGLRenderer:vt,WebGLResourceManager:yt,WebGLState:Et,BasicLoader:Tt,CubeTextureLoader:At,GLTFLoader:St,GLTFParser:Mt,AliAMCExtension:Ot,HDRLoader:bt,KTXLoader:Lt,LoadCache:It,LoadQueue:Rt,ShaderMaterialLoader:Ct,TextureLoader:xt,Loader:wt,Texture:Nt,LazyTexture:Pt,CubeTexture:Dt,DataTexture:Ht,Shader:Ft,BasicMaterial:Ut,GeometryMaterial:Bt,Material:Gt,PBRMaterial:kt,semantic:jt,ShaderMaterial:Vt,AxisHelper:Xt,AxisNetHelper:Wt,CameraHelper:zt,AmbientLight:qt,AreaLight:Yt,DirectionalLight:Jt,CubeLightShadow:Qt,Light:Zt,LightManager:Kt,LightShadow:$t,PointLight:te,SpotLight:ee,Animation:ne,AnimationStates:re,MeshPicker:ie,Ticker:oe,log:se,Cache:ae,browser:ue,WebGLSupport:ce,constants:he,Color:le,Euler:fe,EulerNotifier:de,Frustum:pe,math:me,Matrix3:_e,Matrix4:ge,Matrix4Notifier:ve,Plane:ye,Quaternion:Ee,Ray:Te,Sphere:Ae,Vector2:Se,Vector3:Me,Vector3Notifier:Oe,Vector4:be,SphericalHarmonics3:Le,Skeleton:Ie}),Ce=Re.math,xe=Ce.clamp,we=Ce.DEG2RAD,Ne=Ce.degToRad,Pe=Ce.isPowerOfTwo,De=Ce.nearestPowerOfTwo,He=Ce.nextPowerOfTwo,Fe=Ce.RAD2DEG,Ue=Ce.radToDeg;function Be(t){return t.isVector3}var Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Vector2),ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Vector3),je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Vector4),Ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Matrix3),Xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Matrix4),We=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Quaternion),ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Color),qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Euler),Ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.SphericalHarmonics3),Je=function(){function t(t,e,n){this.isSpherical=!0,this.center=new ke,this.radius=t||0,this.phi=e||0,this.theta=n||0}return t.prototype.set=function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},t.prototype.makeSafe=function(){var e=t.EPS;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},t.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},t.prototype.setFromCartesianCoords=function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(xe(e/this.radius,-1,1))),this},t.prototype.toVector3=function(t){t=t||new ke;var e=this.radius,n=this.phi,r=this.theta,i=this.center;return t.x=e*Math.sin(n)*Math.sin(r)+i.x,t.y=e*Math.cos(n)+i.y,t.z=e*Math.sin(n)*Math.cos(r)+i.z,t},t.EPS=1e-6,t}(),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Tween);function Ze(t){return t.isLevel}var Ke=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.isLevel=!0,i.bound={start:new ke(0,0,0),end:null},i._world=null,i._actors=new U,i._actorsForUpdate=new U,i._actorsNeedUpdate=!1,i._script=null,i._updatable=!1,i.handleLoading=function(t){try{i._script.onLoading(t)}catch(t){O(t,i._script)}i.game.event.trigger("LevelIsPreloading",{level:i,state:t})},i.handleLoadError=function(t){var e=t.error,n=t.state;O(e,i._script,n)},i.handleLoadDone=function(){i.game.resource.onLoading.remove(i.handleLoading),i.game.resource.onError.remove(i.handleLoadError),i.game.event.trigger("LevelDidPreload",{level:i});try{i._script.onCreate()}catch(t){O(t,i._script)}i._state.updateOnEverTick=!0,i._script.updateOnEverTick=!0,i.game.event.trigger("LevelDidCreateActors",{level:i})},i._world=r,i._ScriptClass=n,i}return p(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"game",{get:function(){return this._world.game},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"world",{get:function(){return this._world},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._world},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actors",{get:function(){return this._actors},enumerable:!1,configurable:!0}),e.prototype.onError=function(t,e){return this._script.onError(t,e)},e.prototype.inherit=function(t){var e=this;this._actors.merge(t),t.forEach((function(t){Ze(t.parent)&&(t._parent=e)}))},e.prototype.init=function(t){return v(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:this._script=this.game.addActor(this.name+"-level-script",this._ScriptClass),this._script.updateOnEverTick=!1,this._state=this.game.addActor("level-state",this._ScriptClass.LevelStateClass),this._state.copy(t),this._state.updateOnEverTick=!1,this._script._parent=this,this._state.copy(t),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._script.onLogin()];case 2:return e.sent(),[3,4];case 3:return O(e.sent(),this._script),[3,4];case 4:return this._updatable=!0,this.game.event.trigger("LevelDidInit",{level:this}),[2]}}))}))},e.prototype.startLoading=function(){this.game.event.trigger("LevelWillPreload",{level:this});try{this._script.onPreload()}catch(t){O(t,this._script)}this.game.resource.loadDone?this.handleLoadDone():(this.game.resource.onLoading.add(this.handleLoading),this.game.resource.onError.add(this.handleLoadError),this.game.resource.onLoaded.addOnce(this.handleLoadDone))},e.prototype.update=function(t){this._updatable&&(this._actorsNeedUpdate&&(this._actorsForUpdate.copy(this._actors),this._actorsNeedUpdate=!1),this._actorsForUpdate.forEach((function(e){return e.update(t)})))},e.prototype.destroy=function(e){void 0===e&&(e=!1),t.prototype.destroy.call(this),this.game.event.trigger("LevelWillDestroy",{level:this}),this.game.resource.onLoading.remove(this.handleLoading),this.game.resource.onError.remove(this.handleLoadError),this.game.resource.onLoaded.remove(this.handleLoadDone),Qe.removeAll();var n=new U;return e?this._actorsForUpdate.forEach((function(t){t.destroy()})):this._actorsForUpdate.forEach((function(t){t.persistent?n.add(t):t.destroy()})),this.game.removeActor(this._script),this.game.removeActor(this._state),n},e.prototype.addActor=function(t,e,n,r,i){var o=new e(t,this.game,n);if(this.game.devMode)try{o.verifyAdding(n)}catch(t){return void O(t,o)}return o.initialized(),this._actors.add(o),r?r.addChild(o,i):o._parent=this,o.added(),this._actorsNeedUpdate=!0,o},e.prototype.removeActor=function(t){return t.destroy(),t._parent=null,this._actors.remove(t),this._actorsNeedUpdate=!0,this},e=g([C({className:"Level",classType:"Level"})],e)}(L);function $e(t){return t.isSceneActor}var tn=function(){function t(){this.isLayers=!0,this._mask=4294967295}return t.prototype.set=function(t){this._mask=1<<t|0},t.prototype.toggle=function(t){this._mask^=1<<t|0},t.prototype.enable=function(t){this._mask|=1<<t|0},t.prototype.disable=function(t){this._mask&=~(1<<t|0)},t.prototype.reset=function(){this._mask=4294967295},t.prototype.test=function(t){return 0!=(this._mask&t._mask)},t}(),en=new ke;function nn(t){return t.isSceneComponent}var rn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSceneComponent=!0,e.needReleaseGlRes=!0,e.layers=new tn,e._children=new U,e._tmpQuat=new We,e}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent||this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hiloNode",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._node.visible},set:function(t){this._node.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStatic",{get:function(){return!this._node.autoUpdateWorldMatrix},set:function(t){this._node.autoUpdateWorldMatrix=!t,this._node.autoUpdateChildWorldMatrix=!t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._node.position},set:function(t){this._node.position.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._node.rotation},set:function(t){this._node.rotation.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._node.scale},set:function(t){this._node.scale.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this._node.pivot},set:function(t){this._node.pivot.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quaternion",{get:function(){return this._node.quaternion},set:function(t){this._node.quaternion.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this._node.matrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"z",{get:function(){return this.position.z},set:function(t){this.position.z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotationX",{get:function(){return this.rotation.x},set:function(t){this.rotation.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotationY",{get:function(){return this.rotation.y},set:function(t){this.rotation.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotationZ",{get:function(){return this.rotation.z},set:function(t){this.rotation.z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleX",{get:function(){return this.scale.x},set:function(t){this.scale.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleY",{get:function(){return this.scale.y},set:function(t){this.scale.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleZ",{get:function(){return this.scale.z},set:function(t){this.scale.z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivotX",{get:function(){return this.pivot.x},set:function(t){this.pivot.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivotY",{get:function(){return this.pivot.y},set:function(t){this.pivot.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivotZ",{get:function(){return this.pivot.z},set:function(t){this.pivot.z=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldMatrix",{get:function(){return this._node.worldMatrix},set:function(t){this._node.worldMatrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absolutePosition",{get:function(){return this._node.worldMatrix.getTranslation()},set:function(t){var e=this._node.parent;if(e){var n=e.worldMatrix.clone();n.invert(),this.position=t.transformMat4(n)}else this.position=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteRotation",{get:function(){var t=new We;return this._node.worldMatrix.getRotation(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteScale",{get:function(){return this._node.worldMatrix.getScaling()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ndcPosition",{get:function(){var t=this.getWorld().mainCamera;return t?this.absolutePosition.transformMat4(t.viewProjectionMatrix):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forwardVector",{get:function(){return new ke(0,0,1).transformQuat(this.quaternion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upVector",{get:function(){return new ke(0,1,0).transformQuat(this.quaternion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightVector",{get:function(){return new ke(1,0,0).transformQuat(this.quaternion)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldForwardVector",{get:function(){return new ke(0,0,1).transformQuat(this.absoluteRotation)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldUpVector",{get:function(){return new ke(0,1,0).transformQuat(this.absoluteRotation)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldRightVector",{get:function(){return new ke(1,0,0).transformQuat(this.absoluteRotation)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return this._node.up},enumerable:!1,configurable:!0}),e.prototype.getNdcPosition=function(t){return this.absolutePosition.transformMat4(t.viewProjectionMatrix)},e.prototype.onInit=function(t){if(this._node=new Re.Node,t){var e=t;e.position&&(this._node.position.copy(e.position),delete e.position),e.rotation&&(this._node.rotation.copy(e.rotation),delete e.rotation),e.pivot&&(this._node.pivot.copy(e.pivot),delete e.pivot),e.quaternion&&(this._node.quaternion.copy(e.quaternion),delete e.quaternion),e.matrix&&(this._node.matrix.copy(e.matrix),delete e.matrix),void 0!==e.visible&&(this._node.visible=e.visible)}},e.prototype.onDestroy=function(){this.needReleaseGlRes?this._node.destroy(this.getGame().renderer,!0):this._node.removeFromParent()},e.prototype.getBounds=function(t,e){return this._node.getBounds(null,e,t)},e.prototype.addChild=function(t){return this._children.add(t),t._parent=this,t._node.addTo(this._node),this},e.prototype.removeChild=function(t){var e=this._children.indexOf(t);if(!(e<0))return t._parent=null,this._children.remove(e),this},e.prototype.setPosition=function(t,e,n){return this._node.setPosition(t,e,n),this},e.prototype.setRotation=function(t,e,n){return this._node.setRotation(t,e,n),this},e.prototype.setScale=function(t,e,n){return this._node.setScale(t,e,n),this},e.prototype.setPivot=function(t,e,n){return this._node.setPivot(t,e,n),this},e.prototype.setQuaternion=function(t,e,n,r){return this._node.quaternion.x=t,this._node.quaternion.y=e,this._node.quaternion.z=n,this._node.quaternion.w=r,this},e.prototype.setAbsolutePosition=function(t,e,n){return this.absolutePosition=new ke(t,e,n),this},e.prototype.translate=function(t,e){return en.copy(t).scale(e),this.position.add(en),this},e.prototype.rotate=function(t,e){return this._tmpQuat.setAxisAngle(t,e),this.quaternion.multiply(this._tmpQuat),this},e.prototype.updateMatrixWorld=function(t){for(var e=this._node;e;){if(e.parent&&e.parent.isStage){e.updateMatrixWorld(t);break}e=e.parent}return this},e.prototype.removeFromParent=function(){return $e(this._parent)||this._parent.removeChild(this),this._owner.removeComponent(this),this},e.prototype.lookAt=function(t){return Be(t)?(this._node.lookAt(t),this):$e(t)?(this._node.lookAt(t.transform.absolutePosition),this):(this._node.lookAt(t.absolutePosition),this)},e.prototype.cloneFromHiloNode=function(t){this._node.gltfExtensions=t.gltfExtensions,this._node.jointName=t.jointName,this._node.animationId=t.animationId,this._node.name=t.name},e.prototype.preRender=function(){},e=g([C({className:"SceneComponent"})],e)}(H),on=Re.constants;function sn(t){return t.isTexture}var an=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Texture);function un(t){return!!t.toLowerCase}function cn(t){return t.isRawShaderMaterial}var hn=function(t){function e(e){var n=t.call(this,{useHeaderCache:!0})||this;return n.isRawShaderMaterial=!0,n.className="RawShaderMaterial",n.cloneForInst=!1,n._chuckDefines=[],n._chuckVs=[],n._chuckFs=[],n._uniforms={},n.getCustomRenderOption=function(t){},n._initOptions=e,e?(n.className=n.constructor.CLASS_NAME.value,e.shaderCacheId=e.id,e.id||"RawShaderMaterial"===n.className||"ShaderMaterial"===n.className||(e.shaderCacheId=n.className),delete e.id,n.init(e),n):n}return p(e,t),e.prototype.getUniform=function(t){return this._uniforms[t]},e.prototype.setUniform=function(t,e){var n=this._uniforms[t];return n&&null!==n.value&&void 0!==n.value?(n.value=e,this):(this.initUniform(t,{value:e}),this)},e.prototype.changeUniform=function(t,e){var n=e(this._uniforms[t].value);return this.setUniform(t,n)},e.prototype.init=function(t){t.id||delete t.id,this.blendSrc=on.SRC_ALPHA,this.blendDst=on.ONE_MINUS_SRC_ALPHA,this.blendEquationAlpha=on.FUNC_ADD,Object.assign(this,t),this.uniforms={},this.attributes={},this.vs="",this.fs="",this.initChunks(t),this.initAttributes(t),this.initUniforms(t),this.initShaders(t)},e.prototype.initChunks=function(t){if(t.attributes=t.attributes||{},t.uniforms=t.uniforms||{},t.chunks)for(var e=t.chunks.length,n=0;n<e;n+=1){var r=t.chunks[n];S.devMode&&this.checkChuck(r,t),Object.assign(t.attributes,r.attributes),Object.assign(t.uniforms,r.uniforms),r.vs&&(this._chuckVs.push(r.vs),r.isMain&&r.hasVsOut&&(this._mainVsChunkName=r.vsEntryName)),r.fs&&(this._chuckFs.push(r.fs),r.isMain&&r.hasFsOut&&(this._mainFsChunkName=r.fsEntryName)),r.defines&&this._chuckDefines.push(r.defines)}t.vs&&(un(t.vs)?this._chuckVs.push({main:t.vs,header:""}):this._chuckVs.push(t.vs),this._mainVsChunkName=""),t.fs&&(un(t.fs)?this._chuckFs.push({main:t.fs,header:""}):t.fs&&this._chuckFs.push(t.fs),this._mainFsChunkName=""),t.defines&&this._chuckDefines.push(t.defines)},e.prototype.checkChuck=function(t,e){for(var n=t.requiredUniforms,r=t.requiredAttributes,i=t.uniforms,o=t.attributes,s=0,a=r;s<a.length;s++){var u=a[s];if(!e.attributes[u])throw new Error('Shader chuck "'+t.name+'" requires attribute "'+u+'" !')}for(var c=0,h=n;c<h.length;c++)if(u=h[c],!e.uniforms[u])throw new Error('Shader chuck "'+t.name+'" requires uniform "'+u+'" !');for(var u in o)if(e.attributes[u])throw new Error('Attribute "'+u+'" is already existed, re-defined in shader chuck "'+t.name+'" !');for(var u in i)if(e.uniforms[u])throw new Error('Uniform "'+u+'" is already existed, re-defined in shader chuck "'+t.name+'" !')},e.prototype.initAttributes=function(t){var e=t.attributes;this.attributes={};var n=function(t){var n=e[t];void 0===n.name?r.attributes[t]=n:r.attributes[t]={get:function(t){return t.geometry[n.name]}}},r=this;for(var i in e)n(i)},e.prototype.initUniforms=function(t){var e,n=t.uniforms;for(var r in n.u_gammaFactor||(n.u_gammaFactor="GAMMAFACTOR"),n.u_exposure||(n.u_exposure="EXPOSURE"),n){var i=n[r];(e=i)&&!e.substr&&"value"in e?this.initUniform(r,i):this.uniforms[r]=i}},e.prototype.initUniform=function(t,e){var n=this._uniforms;e.isGlobal?n[t]=e:n[t]={value:e.value};var r=n[t].value;this.isDirty=!0,null!=r?sn(r)?this.uniforms[t]={get:function(e,r,i){return Re.semantic.handlerTexture(n[t].value,i.textureIndex)}}:function(t){return!!t.toPrecision}(r)||function(t){return!!t.push}(r)?this.uniforms[t]={get:function(){return n[t].value}}:this.uniforms[t]={get:function(){return n[t].value.elements}}:this.uniforms[t]={get:function(){return null}}},e.prototype.initShaders=function(t){var e=this._chuckDefines.join("\n")+"\n";this.vs+=e,this.fs+=e,this.vs+=this.generateShader(this._chuckVs),this.fs+=this.generateShader(this._chuckFs),this._mainVsChunkName&&(this.vs+="\nvoid main() {\ngl_Position = "+this._mainVsChunkName+"();\n}\n"),this._mainFsChunkName&&(this.fs+="\nvoid main() {\ngl_FragColor = "+this._mainFsChunkName+"();\n}\n"),this.initCommonOptions(t)},e.prototype.initCommonOptions=function(t,e){if(void 0===e&&(e=!1),t.alphaMode&&(!e||!this._initOptions.alphaMode)){switch(t.alphaMode){case"BLEND":this.transparent=!0,this.blend=!0,e||(this.blendSrc=t.blendSrc||on.SRC_ALPHA,this.blendDst=t.blendDst||on.ONE_MINUS_SRC_ALPHA,this.blendEquationAlpha=t.blendEquationAlpha||on.FUNC_ADD);break;case"MASK":this.alphaCutoff="alphaCutoff"in t?t.alphaCutoff:.5;break;case"OPAQUE":default:this.ignoreTranparent=!0}this._initOptions.alphaMode=t.alphaMode}(t.doubleSided&&!e||t.doubleSided&&!this._initOptions.doubleSided)&&(this.side=on.FRONT_AND_BACK,this._initOptions.doubleSided=!0),this.lightType=t.unlit?"NONE":"ENABLE"},e.prototype.generateShader=function(t){for(var e="",n="",r=t.length,i=0;i<r;i+=1){var o=t[i];e+=o.header+"\n",n+=o.main+"\n"}return e+"\n"+n+"\n"},e.prototype.clone=function(){var t=new this.constructor(this._initOptions);return t.initCommonOptions(this._initOptions),t},e.prototype.destroyTextures=function(){for(var e in t.prototype.destroyTextures.call(this),this._uniforms){var n=this._uniforms[e].value;n&&sn(n)&&n.destroy()}return this},e.CLASS_NAME=new f("RawShaderMaterial"),e=g([x({className:"RawShaderMaterial"})],e)}(Re.ShaderMaterial),ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Shader),fn=function(t){function e(e){var n=t.call(this,{depthMask:!0,renderOrder:9999,side:on.BACK,attributes:{a_position:"POSITION",a_uv:"TEXCOORD_0"},uniforms:{u_viewProjectionMatrix:{value:new Xe},u_texture:e.uniforms.u_texture,u_color:e.uniforms.u_color,u_rotation:e.uniforms.u_rotation,u_factor:e.uniforms.u_factor||{value:1},u_exposure:e.uniforms.u_exposure,u_degrees:e.uniforms.u_degrees},vs:"\nprecision highp float;\n\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_viewProjectionMatrix;\n\nvarying vec2 v_uv;\n\n#ifdef SKYBOX_CUBE\nvarying vec3 v_position;\n#endif\n\nvoid main()\n{\n#ifdef SKYBOX_CUBE\nv_position = a_position.xyz;\n#endif\nvec4 pos = u_viewProjectionMatrix * vec4(a_position, 1.0);\ngl_Position = pos.xyww;\nv_uv = a_uv;\n}\n",fs:"\nprecision mediump float;\n\nuniform float u_factor;\nuniform vec4 u_color;\n\n"+ln.shaders["chunk/color.frag"]+"\n"+ln.shaders["method/encoding.glsl"]+"\n\n#ifdef SKYBOX_CUBE\nuniform samplerCube u_texture;\nuniform float u_exposure;\nvarying vec3 v_position;\n#endif\n\n#ifdef SKYBOX_PANORAMIC\nuniform sampler2D u_texture;\nuniform float u_exposure;\n#endif\n\nvarying vec2 v_uv;\n\nvec3 decodeRGBD(vec4 color) {\nreturn color.rgb / color.a;\n}\n\nvoid main()\n{\nvec4 color = vec4(1., 1., 1., 1.);\n\n#ifdef SKYBOX_CUBE\nvec3 tex = decodeRGBD(textureCube(u_texture, v_position));\n#endif\n\n#ifdef SKYBOX_PANORAMIC\nvec3 tex = decodeRGBD(texture2D(u_texture, v_uv));\n#endif\n\n#ifdef HILO_GAMMA_CORRECTION\ntex = sRGBToLinear(tex);\n#endif\ncolor.rgb = tex * u_color.rgb * u_exposure * u_factor;\n\n"+ln.shaders["chunk/frag_color.frag"]+"\n}     \n"})||this;return n.isSkyboxMaterial=!0,n.type="Color",n.getCustomRenderOption=function(t){return"Cube"===n.type?t.SKYBOX_CUBE=1:"Panoramic"===n.type?t.SKYBOX_PANORAMIC=1:t.SKYBOX_COLOR=1,t},n.type=e.type,n}return p(e,t),e=g([x({className:"SkyboxMaterial"})],e)}(hn);function dn(t){return t.isMesh}var pn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.getMaterial=function(){return this.material},e.prototype.clone=function(e){return t.prototype.clone.call(this,e)},e}(Re.Mesh),mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.BoxGeometry),_n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.SphereGeometry),gn=function(t){function e(e,n){void 0===n&&(n="");var r=t.call(this,"BreakGuard",e,n)||this;return r.isBreakGuardException=!0,r}return p(e,t),e}(M);function vn(t){return t.isCameraComponent}var yn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCameraComponent=!0,e._isMainCamera=!1,e._rendererAlive=!1,e}return p(e,t),Object.defineProperty(e.prototype,"isMainCamera",{get:function(){return this._isMainCamera},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewMatrix",{get:function(){return this._camera.viewMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectionMatrix",{get:function(){return this._camera.projectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionMatrix",{get:function(){return this._camera.viewProjectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rendererAlive",{get:function(){return this._rendererAlive},enumerable:!1,configurable:!0}),e.prototype.changeBackgroundMat=function(t){var e=this._backgroundMat.type;t(this._backgroundMat),e!==this._backgroundMat.type&&(this.generateSkybox(this._backgroundMat),this._isMainCamera&&(this.disableSkybox(),this.enableSkybox()))},e.prototype.onInit=function(e){t.prototype.onInit.call(this,e),this._camera=this.onCreateCamera(e),this._camera.__forceUseParentWorldMatrix=!0,this._node.addChild(this._camera),this._node._rotation.order="XYZ",this._node.isCamera=!0,this.generateSkybox(e.backgroundMat)},e.prototype.generateSkybox=function(t){t||(t=new fn({type:"Color",uniforms:{u_color:{value:this.getGame().renderer.clearColor}}})),"Color"!==t.type?(this._backgroundMat=t,"Panoramic"===t.type?this._background=new pn({geometry:new _n({radius:1}),material:this._backgroundMat}):this._background=new pn({geometry:new mn({width:2,height:2,depth:2}),material:this._backgroundMat})):this.getGame().renderer.clearColor.copy(t.getUniform("u_color").value)},e.prototype.onCreateCamera=function(t){return null},e.prototype.onAsMainCamera=function(t){var e=this.getGame();t?(this.enableSkybox(),e.hiloStage.camera=this._camera,this._isMainCamera=!0):this._isMainCamera&&(this.disableSkybox(),e.hiloStage.camera=null,this._isMainCamera=!1)},e.prototype.enableSkybox=function(){this._background&&this.getGame().hiloStage.addChild(this._background)},e.prototype.disableSkybox=function(){this._background&&this.getGame().hiloStage.removeChild(this._background)},e.prototype.onAdd=function(){this.getWorld().mainCamera||this.getWorld().setMainCamera(this)},e.prototype.onUpdate=function(){var t=this;this._rendererAlive=!1,this._isMainCamera&&this._background&&this._backgroundMat.changeUniform("u_viewProjectionMatrix",(function(e){e.copy(t.viewMatrix);var n=t._backgroundMat.getUniform("u_rotation");return n&&0!==n.value&&e.rotateY(-n.value),e.elements[12]=0,e.elements[13]=0,e.elements[14]=0,e.premultiply(t.projectionMatrix),e}))},e.prototype.onDestroy=function(){this.onAsMainCamera(!1),this.getWorld().mainCamera===this&&this.getWorld().removeMainCamera(),t.prototype.onDestroy.call(this)},e.prototype.projectVector=function(t,e,n){return this._camera.projectVector(t,e,n)},e.prototype.unprojectVector=function(t,e,n){return this._camera.unprojectVector(t,e,n)},e.prototype.updateViewProjectionMatrix=function(){this._camera.updateProjectionMatrix()},e.prototype.generateRay=function(t,e,n,r,i,o,s){throw new Error("Not implements")},e.prototype.captureScreen=function(t,e,n){return v(this,void 0,void 0,(function(){var r,i=this;return y(this,(function(o){if(!this._isMainCamera)throw new gn(this,"`captureScreen` can not be called by `mainCamera` now !");return r=this.getGame().canvas,[2,new Promise((function(o,s){i.render();try{"blob"===t?r.toBlob((function(t){return o(t)}),e,n):o(r.toDataURL(e,n))}catch(t){s(t)}}))]}))}))},e.prototype.render=function(t,e){var n=this;void 0===e&&(e=!1);var r=this.getGame(),i=this.getWorld(),o=r.renderer;this._isMainCamera&&e&&r.event.trigger("MainRendererWillStart"),this._isMainCamera||(r.hiloStage.camera=this._camera),i.enableLayers&&i.actors.forEach((function(t){t.visible=n.layers.test(t.layers)}));try{t?(t.bind(),o.render(r.hiloStage,this._camera,!1),t.unbind()):o.render(r.hiloStage,this._camera,e),this._rendererAlive=!0}catch(t){O(t,this),this._rendererAlive=!1}this._isMainCamera||(r.hiloStage.camera=i.mainCamera._camera),this._isMainCamera&&e&&r.event.trigger("MainRendererIsFinished")},e=g([C({className:"CameraComponent"})],e)}(rn),En=function(t){function e(e,n){void 0===n&&(n="");var r=t.call(this,"UnmetRequire",e,n)||this;return r.isUnmetRequireException=!0,r}return p(e,t),e}(M);function Tn(t){return t.isPerspectiveCameraComponent}var An=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPerspectiveCameraComponent=!0,e}return p(e,t),e.prototype.onCreateCamera=function(t){return new Re.PerspectiveCamera(t)},Object.defineProperty(e.prototype,"near",{get:function(){return this._camera.near},set:function(t){this._camera.near=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._camera.far},set:function(t){this._camera.far=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fov",{get:function(){return this._camera.fov},set:function(t){this._camera.fov=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aspect",{get:function(){return this._camera.aspect},set:function(t){this._camera.aspect=t},enumerable:!1,configurable:!0}),e.prototype.generateRay=function(t,e,n,r,i,o,s){return void 0===s&&(s=100),this._node.worldMatrix.getTranslation(i),o.set(t,e,1),o.copy(this._camera.unprojectVector(o,n,r).subtract(i)).normalize().scale(s).add(i),this},e=g([C({className:"PerspectiveCameraComponent"})],e)}(yn);function Sn(t){return t.isOrthographicCameraComponent}var Mn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOrthographicCameraComponent=!0,e}return p(e,t),e.prototype.onCreateCamera=function(t){return new Re.OrthographicCamera(t)},Object.defineProperty(e.prototype,"near",{get:function(){return this._camera.near},set:function(t){this._camera.near=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._camera.far},set:function(t){this._camera.far=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this._camera.left},set:function(t){this._camera.left=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._camera.right},set:function(t){this._camera.right=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._camera.top},set:function(t){this._camera.top=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._camera.bottom},set:function(t){this._camera.bottom=t},enumerable:!1,configurable:!0}),e.prototype.generateRay=function(t,e,n,r,i,o,s){void 0===s&&(s=100);var a=this._camera;i.set(t,e,(a.near+a.far)/(a.near-a.far)),i.copy(this._camera.unprojectVector(i,n,r));var u=this.forwardVector;return o.copy(i).add(u.scale(-s)),this},e=g([C({className:"OrthographicCameraComponent"})],e)}(yn);function On(t){return t.isWorld}var bn=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.isWorld=!0,o.enableLayers=!1,o._game=null,o._script=null,o._level=null,o._levels={},o._mainCamera=null,o._mainCameras=[],o._physicWorld=null,o._updatable=!1,o._game=i,o._levels=r,o._GameModeClass=n,o}return p(e,t),Object.defineProperty(e,"UP",{get:function(){return new ke(0,1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DOWN",{get:function(){return new ke(0,-1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"RIGHT",{get:function(){return new ke(1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LEFT",{get:function(){return new ke(-1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"FORWARD",{get:function(){return new ke(0,0,-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BACK",{get:function(){return new ke(0,0,1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"game",{get:function(){return this._game},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._game},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actors",{get:function(){return this._level.actors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mainCamera",{get:function(){return this._mainCamera},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"physicWorld",{get:function(){return this._physicWorld},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upVector",{get:function(){return new ke(0,1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"downVector",{get:function(){return new ke(0,-1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightVector",{get:function(){return new ke(1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftVector",{get:function(){return new ke(-1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forwardVector",{get:function(){return new ke(0,0,-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backVector",{get:function(){return new ke(0,0,1)},enumerable:!1,configurable:!0}),e.prototype.onError=function(t,e){return this._script.onError(t,e)},e.prototype.init=function(t){return v(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:this._script=this._game.addActor(this.name+"-game-mode",this._GameModeClass),this._script.updateOnEverTick=!1,this._state=this._game.addActor("world-state",this._GameModeClass.WorldStateClass),this._state.copy(t),this._state.updateOnEverTick=!1,this._script._parent=this,this._state.copy(t),this._game.event.trigger("WorldDidInit",{world:this}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._script.onLogin()];case 2:return e.sent(),[3,4];case 3:return O(e.sent(),this._script),[3,4];case 4:try{this._script.onCreatePlayers()}catch(t){O(t,this._script)}if(this._game.event.trigger("WorldDidCreatePlayers",{world:this}),this._game.players.length<1)throw new En(this,"You must give at least one player !");return this._script.updateOnEverTick=!0,this._state.updateOnEverTick=!0,this._updatable=!0,[2]}}))}))},e.prototype.update=function(t){this._updatable&&(this._level&&this._level.update(t),this.mainCamera&&this.mainCamera.render(null,!0))},e.prototype.destroy=function(e){void 0===e&&(e=!0),t.prototype.destroy.call(this),this._game.event.trigger("WorldWillDestroy",{world:this});try{this._script.onDestroyPlayers()}catch(t){O(t,this._script)}var n=this._level.destroy(e);return this.game.removeActor(this._script),this.game.removeActor(this._state),this._physicWorld&&this._physicWorld.destroy(),this._game.players.forEach((function(t){t.releaseController()})),n},e.prototype.switchLevel=function(t,e,n){return void 0===e&&(e=null),v(this,void 0,void 0,(function(){var r,i,o;return y(this,(function(s){switch(s.label){case 0:return this._levels[t]||O(new N(this,"Level",t,this),this),i=this._level,o=this._levels[t].Script,this._level=new Ke(t,o,this),this.addActor=this._level.addActor.bind(this._level),this.removeActor=this._level.removeActor.bind(this._level),i&&(r=i.destroy()),this._level.inherit(r||n||new U),[4,this._level.init(e)];case 1:return s.sent(),this._level.startLoading(),[2,this]}}))}))},e.prototype.enablePhysic=function(t,e){return void 0===e&&(e=!1),this._physicWorld=t,e&&this._physicWorld.initContactEvents(),this},e.prototype.setMainCamera=function(t){return this._mainCamera&&this._mainCamera.onAsMainCamera(!1),b(t)&&vn(t)?this._mainCamera=t:this._mainCamera=t.camera,this._mainCamera.onAsMainCamera(!0),this.resizeMainCamera()},e.prototype.resizeMainCamera=function(){if(!this._mainCamera)return this;var t=this._game.bound,e=t.width/t.height;return Tn(this._mainCamera)?(this._mainCamera.aspect=e,this):(Sn(this._mainCamera)&&(this._mainCamera.top=this._mainCamera.right/e,this._mainCamera.bottom=-this._mainCamera.top),this)},e.prototype.removeMainCamera=function(){this._mainCamera=null,this._mainCameras=[]},e=g([C({className:"World",classType:"World"})],e)}(L);function Ln(t){return t.isSceneComponent}function In(t){return t.isChildActorComponent}var Rn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isChildActorComponent=!0,e.autoDestroyActor=!0,e}return p(e,t),Object.defineProperty(e.prototype,"actor",{get:function(){return this._actor},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t){this._actor=t.actor,this._parent=t.parent||this.getRoot(),$e(this._actor)&&Ln(this._parent)&&(this._actor.root.hiloNode.removeFromParent(),this._actor._parent=this,this._parent.hiloNode.addChild(this._actor.root.hiloNode))},e.prototype.onDestroy=function(){this._actor&&(this._actor._parent=null,$e(this._actor)?(this._actor.root.hiloNode.removeFromParent(),this.autoDestroyActor&&this.getWorld().removeActor(this._actor)):this.autoDestroyActor&&this.getGame().removeActor(this._actor))},e.prototype.removeActor=function(t){this.removeFromParent()},e=g([C({className:"ChildActorComponent"})],e)}(H),Cn=function(t){function e(e,n,r,i,o){void 0===o&&(o="");var s=t.call(this,"MemberConflict",i,n+' "'+r+'" is already in '+e.className+' "'+e.name+'". '+o)||this;return s.isMemberConflictException=!0,s}return p(e,t),e}(M),xn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._table={},e._tableReflect={},e}return p(e,t),Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e){var n=this._table[t];return n&&(this.removeItem(n),delete this._tableReflect[n.uuid]),this.addItem(e),this._table[t]=e,this._tableReflect[e.uuid]=t,this},e.prototype.has=function(t){return!!this._table[t]},e.prototype.remove=function(t){var e=this._table[t];if(e)return this.removeItem(e),delete this._table[t],delete this._tableReflect[e.uuid],e},e.prototype.get=function(t){return this.findByName(t)},e.prototype.getAtIndex=function(t){return this._array[t]},e.prototype.clear=function(){return t.prototype.clear.call(this),this._table={},this._tableReflect={},this},e.prototype.forEachEntities=function(t){for(var e=this.length,n=0;n<e;n+=1){var r=this._array[n];if(t(this._tableReflect[r.uuid],r))return this}return this},e.prototype.fromArray=function(t){this.clear();for(var e=t.length,n=0;n<e;n+=1)this.set(t[n].name.value,t[n]);return this},e.prototype.findByName=function(t){return this._table[t]},e.prototype.findAllByName=function(t){return[this._table[t]]},e}(F);function wn(t){return t.isActor}var Nn=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.isActor=!0,i.updateOnEverTick=!0,i.emitComponentsDestroy=!0,i.tag=new f("UnTagged"),i._game=null,i._root=null,i._components=new xn,i._componentsForUpdate=new U,i._componentsNeedUpdate=!1,i._parent=null,i._inWorld=!1,i._linked=!1,i._game=n,i._initOptions=r,i}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linked",{get:function(){return this._linked},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this._root.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),e.prototype.verifyAdding=function(t){},e.prototype.verifyRemoving=function(){},e.prototype.onCreateRoot=function(t){return this.addComponent("root",H)},e.prototype.onInit=function(t){},e.prototype.onAdd=function(t){},e.prototype.onUpdate=function(t){},e.prototype.onError=function(t,e){},e.prototype.onUnLink=function(){},e.prototype.onReLink=function(t){},e.prototype.onDestroy=function(){},e.prototype.initialized=function(){try{this._root=this.onCreateRoot(this._initOptions),this._componentsForUpdate.add(this._root)}catch(t){O(t,this)}this._root.isRoot=!0;try{this.onInit(this._initOptions)}catch(t){O(t,this)}},e.prototype.added=function(){if(!this._inWorld){this._inWorld=!0,this._linked=!0,this._components.forEach((function(t){t.added()}));try{this.onAdd(this._initOptions)}catch(t){O(t,this)}}},e.prototype.update=function(t){if(this.syncComponentsNeedUpdate(),this.updateOnEverTick&&this._inWorld&&this._parent){try{this.onUpdate(t)}catch(t){O(t,this)}this._componentsForUpdate.forEach((function(e){e.update(t)}))}},e.prototype.unLink=function(){if(!this._linked)return this;try{this.onUnLink()}catch(t){O(t,this)}this.syncComponentsNeedUpdate(),this._componentsForUpdate.forEach((function(t){return t.unLink()}));var t,e=this._parent;return In(e)?(e.autoDestroyActor=!1,e.removeFromParent(),this._parent=e.getOwner(),t=$e(e.getOwner())?e.getWorld():e.getGame()):t=e,t.actors.remove(this),t._actorsNeedUpdate=!0,this._linked=!1,this},e.prototype.reLink=function(t){if(this._linked)return this;var e;if(On(e=wn(t=t||this._parent)?$e(t)?t.getWorld():t.getGame():t)&&this.getGame().world!==e)throw new Error("ReLink error! Current world is different from pre world !");e.actors.add(this),e._actorsNeedUpdate=!0,wn(t)&&t.addChild(this);try{this.onReLink(t)}catch(t){O(t,this)}return this.syncComponentsNeedUpdate(),this._componentsForUpdate.forEach((function(t){return t.reLink()})),this._linked=!0,this},e.prototype.destroy=function(){this.emitComponentsDestroy?(this.syncComponentsNeedUpdate(),this._componentsForUpdate.forEach((function(t){return t.destroy()}))):this._root.destroy(),t.prototype.destroy.call(this),this._parent=null},e.prototype.syncComponentsNeedUpdate=function(){var t=this;this._componentsNeedUpdate&&(this._componentsForUpdate.clear(),this._components.forEach((function(e){(e.isRoot||e.needUpdateAndDestroy)&&t._componentsForUpdate.add(e)})),this._componentsNeedUpdate=!1)},e.prototype.getGame=function(){return this._game},e.prototype.getWorld=function(){return this._game.world},e.prototype.getLevel=function(){return this._game.level},e.prototype.getPhysicWorld=function(){return this._game.world.physicWorld},e.prototype.removeFromParent=function(){this._parent||O(new Error("Actor "+this.name+" has no parent, is it an invalid reference to an actor is already removed from world ?"),this),this._parent.removeActor(this)},e.prototype.addComponent=function(t,e,n,r){if(this._components.has(t))throw new Cn(this,"Component",t,this);if(r&&r.getOwner()!==this)throw new gn(this,"Owner of parent component "+r.name+" must be same to owner of child "+this.name);var i=new e(t,this,n);if(r&&(!Ln(r)||!Ln(i)))throw new gn(this,"Only SceneComponent could have child SceneComponent ! \nCurrent parent: "+r.name+"("+r.className+"), child: "+i.name+"("+i.className+")");if(S.devMode)try{i.verifyAdding(n)}catch(t){return void O(t,i)}return this._components.set(t,i),i.initialized(),Ln(i)?r?r.addChild(i):this._root&&Ln(this._root)?this._root.addChild(i):i._parent=this:i._parent=this,this._inWorld&&i.added(),i.needUpdateAndDestroy&&(this._componentsNeedUpdate=!0),i},e.prototype.removeComponent=function(t){var e;if(!(e=b(t)&&D(t)?t:this._components.get(t)))return this;if(!e.canBeRemoved||e.isRoot)throw new gn(this,"In actor "+this.name+", component "+e.name+" can not be removed.\nIt's one of '!canBeRemoved', 'root'");if(S.devMode)try{e.verifyRemoving()}catch(t){return void O(t,e)}return e.parent&&Ln(e.parent)&&(e.parent.removeChild(e),this.clearSceneComponent(e)),e.destroy(),this._components.remove(e.name.value),e.needUpdateAndDestroy&&(this._componentsNeedUpdate=!0),this},e.prototype.addChild=function(t,e){t.parent&&In(t.parent)&&t.parent.getOwner().removeComponent(t.parent),this.addComponent(t.name.value,Rn,{actor:t,parent:e})},e.prototype.removeChild=function(t){t.parent&&In(t.parent)&&this.removeComponent(t.parent)},e.prototype.clearSceneComponent=function(t){var e=this;t.children.forEach((function(n){t.destroy(),e._components.remove(n.name.value),e.clearSceneComponent(n)}))},e.prototype.findComponentByName=function(t){return this._components.get(t)},e.prototype.findComponentByClass=function(t){return this._components.findByClass(t)},e.prototype.findComponentsByClass=function(t){return this._components.findAllByClass(t)},e.prototype.findComponentByFilter=function(t){return this._components.findByFilter(t)},e.prototype.findComponentsByFilter=function(t){return this._components.findAllByFilter(t)},e=g([C({className:"Actor",classType:"Actor"})],e)}(L),Pn=function(t){function e(e){var n=t.call(this,"SeinTimer")||this;return n.isTicker=!0,n._rafId=0,n._lockFrame=!1,n._fps=0,n._spf=0,n._pre=0,n._delta=0,n._actualPre=0,n._tickers=[],n._tickersQueue=[],n._needUpdate=!1,n._paused=!0,n.update=function(t,e){if(!n._paused&&n._rafId===e){if(n.raf(n.update),0===n._pre)return n._pre=t,void(n._actualPre=Date.now());n._needUpdate&&(n._tickersQueue=n._tickers.slice(),n._needUpdate=!1);var r=t-n._pre;if(n._pre=t,n._lockFrame){if(n._delta>=n._spf){var i=Date.now(),o=i-n._actualPre;n._actualPre=i,n._delta-=n._spf*~~(n._delta/n._spf);var s=n._tickersQueue.length;for(u=0;u<s;u+=1)n._tickersQueue[u](o)}n._delta+=r}else for(var a=n._tickersQueue.length,u=0;u<a;u+=1)n._tickersQueue[u](r)}},null!=e&&(n.fps=e),n}return p(e,t),Object.defineProperty(e.prototype,"fps",{get:function(){return this._fps},set:function(t){60%t!=0&&S.warn(t+"fps is not safe, you can only choice 60, 30, 20(not in low-power mode in safari), 15, 10 or 5 !"),this._fps=t,this._spf=1e3/t,this._lockFrame=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lockFrame",{get:function(){return this._lockFrame},set:function(t){this._lockFrame=t},enumerable:!1,configurable:!0}),e.prototype.add=function(t){return this._tickers.push(t),this._needUpdate=!0,this},e.prototype.remove=function(t){return this._tickers.splice(this._tickers.indexOf(t),1),this._needUpdate=!0,this},e.prototype.start=function(){return this._paused=!1,this._pre=0,this._delta=0,this._actualPre=0,this.raf(this.update),this},e.prototype.pause=function(){return this._paused=!0,this._rafId+=1,this},e.prototype.raf=function(t){this._rafId>=65535?this._rafId=0:this._rafId+=1;var e=this._rafId;requestAnimationFrame((function(n){return t(n,e)}))},e=g([C({className:"Ticker",classType:"Ticker"})],e)}(L),Dn=function(t){function e(e){var r=t.call(this,"SeinEngine")||this;return r.isEngine=!0,r._options=null,r._ticker=null,r._games=[],r._runningGames=[],r.update=function(t){var e=r._runningGames.length;Qe.tick();for(var n=0;n<e;n+=1)r._runningGames[n].update(t)},n.RUNNING_ENGINES.push(r),r._options=e||{},r._ticker=new Pn(r._options.fps),r._ticker.add(r.update),r}var n;return p(e,t),n=e,e.GET_RUNNING_ENGINE=function(t){return void 0===t&&(t=0),n.RUNNING_ENGINES[t]},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ticker",{get:function(){return this._ticker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"env",{get:function(){return S.env},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"devMode",{get:function(){return S.devMode},enumerable:!1,configurable:!0}),e.prototype.onError=function(t,e){S.warn("Error '"+t.message+"' reaches engine, try to catch it in exception chain !")},e.prototype.addGame=function(t){t._engine=this,this._games.push(t);try{t.onAdd()}catch(e){O(e,t)}return this},e.prototype.removeGame=function(t){var e=this._runningGames.indexOf(t);return e>=0&&this.destroyGame(t),(e=this._games.indexOf(t))>=0&&this._games.splice(e,1),t._engine=null,this},e.prototype.getRunningGame=function(t){return void 0===t&&(t=0),this._runningGames[t]},e.prototype.startGame=function(t){if(this._runningGames.indexOf(t)<0){this._runningGames.push(t);try{t.onStart()}catch(e){O(e,t)}}return this._ticker.paused&&this._ticker.start(),this},e.prototype.pauseGame=function(t){try{t.onPause()}catch(e){O(e,t)}return this._runningGames.splice(this._runningGames.indexOf(t),1),0===this._runningGames.length&&this._ticker.pause(),this},e.prototype.resumeGame=function(t){this._runningGames.push(t);try{t.onResume()}catch(e){O(e,t)}return this._ticker.paused&&this._ticker.start(),this},e.prototype.restartGame=function(t){return this.destroyGame(t),this.startGame(t),this},e.prototype.destroyGame=function(t){var e=this._runningGames.indexOf(t);if(e>=0){this._runningGames.splice(e,1);try{t.onDestroy()}catch(e){O(e,t)}}return 0===this._runningGames.length&&this._ticker.pause(),this.removeGame(t),this},e.prototype.start=function(){return this._games.forEach((function(t){return t.start()})),this},e.prototype.pause=function(){return this._runningGames.forEach((function(t){return t.pause()})),this},e.prototype.resume=function(){return this._games.forEach((function(t){return t.resume()})),this},e.prototype.destroy=function(){this._runningGames.forEach((function(t){return t.destroy()})),this._games=[],n.RUNNING_ENGINES.splice(n.RUNNING_ENGINES.indexOf(this),1)},e.RUNNING_ENGINES=[],e=n=g([C({className:"Engine",classType:"Engine"})],e)}(L),Hn=function(t){function e(e,n,r){void 0===r&&(r="");var i=t.call(this,"ResourceLoad",n,'Error occured when load resource "'+e+'". '+r)||this;return i.isResourceLoadException=!0,i.resourceName=e,i}return p(e,t),e}(M),Fn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isResourceLoader=!0,e}return p(e,t),e.prototype.load=function(t,e){setTimeout((function(){return e.onLoaded(t)}),0)},e.prototype.cancel=function(t){t.canceled=!0},e.prototype.instantiate=function(t,e){throw new Error("Not implemented !")},e.prototype.release=function(t){},e.EXTENSIONS=[],e=g([C({className:"ResourceLoader"})],e)}(L),Un=new ke(1,1,1),Bn=new ke(0,0,0),Gn=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.isRigidBodyComponent=!0,e.needUpdateCollider=!1,e._disabled=!1,e._sleeping=!1,e._valid=!1,e._tmpQuat=new We,e._tmpQuat2=new We,e._tmpScale=new ke(1,1,1),e._tmpScale2=new ke(1,1,1),e._tmpScale3=new ke(1,1,1),e.handleCollision=function(t){var n,r,i=t.body,o=t.contact;i.id===o.bi.id?(r=o.bj,n=o.bi):(r=o.bi,n=o.bj),e._valid&&n.component.valid&&e.event.trigger("Collision",{selfBody:r.component,otherBody:n.component,selfActor:r.component.getOwner(),otherActor:n.component.getOwner()})},e.handleBodyEnter=function(t,n){e._valid&&n.valid&&e.event.trigger("BodyEnter",{selfBody:t,otherBody:n,selfActor:t.getOwner(),otherActor:n.getOwner()})},e.handleBodyLeave=function(t,n){e._valid&&n.valid&&e.event.trigger("BodyLeave",{selfBody:t,otherBody:n,selfActor:t.getOwner(),otherActor:n.getOwner()})},e.handleColliderEnter=function(t,n,r,i){e._valid&&n.valid&&e.event.trigger("ColliderEnter",{selfBody:t,otherBody:n,selfCollider:r,otherCollider:i,selfActor:t.getOwner(),otherActor:n.getOwner()})},e.handleColliderLeave=function(t,n,r,i){e._valid&&n.valid&&e.event.trigger("ColliderLeave",{selfBody:t,otherBody:n,selfCollider:r,otherCollider:i,selfActor:t.getOwner(),otherActor:n.getOwner()})},e.handleBeforeStep=function(t,n){void 0===n&&(n=!1),e._valid&&(e._physicStatic&&!e._sleeping&&0!==e.mass&&(e.setAngularVelocity(Bn),e.setLinearVelocity(Bn)),e.syncTransformToRigidBody(n),e.event.trigger("BeforeStep",e))},e.handleAfterStep=function(){if(e.valid&&!e._physicStatic&&!e._sleeping){var t=e._owner.transform;e.event.trigger("AfterStep",e),e.getPhysicWorld().setRootTransform(e),e._owner.parent&&(e.getParentsRotationAndScale(),e._tmpQuat.conjugate(),t.quaternion=e._tmpQuat.multiply(t.quaternion)),t.absolutePosition=t.position}},e.handlePick=function(t){e.event.trigger("Pick",t)},e}var r;return p(n,t),r=n,Object.defineProperty(n.prototype,"rigidBody",{get:function(){return this._rigidBody},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"valid",{get:function(){return this._valid},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mass",{get:function(){return this.getPhysicWorld().getBodyMass(this)},set:function(t){this.getPhysicWorld().setBodyMass(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"filterGroup",{get:function(){return this.getPhysicWorld().getFilterGroup(this)},set:function(t){this.getPhysicWorld().setFilterGroup(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"filterMask",{get:function(){return this.getPhysicWorld().getFilterMask(this)},set:function(t){this.getPhysicWorld().setFilterMask(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"friction",{get:function(){return this.getPhysicWorld().getBodyFriction(this)},set:function(t){this.getPhysicWorld().setBodyFriction(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"restitution",{get:function(){return this.getPhysicWorld().getBodyRestitution(this)},set:function(t){this.getPhysicWorld().setBodyRestitution(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"unControl",{get:function(){return this._unControl},set:function(t){this._unControl=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"physicStatic",{get:function(){return this._physicStatic},set:function(t){this._physicStatic=t,this.getPhysicWorld().setBodyType(this,t?e.ERigidBodyType.Static:e.ERigidBodyType.Dynamic)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{get:function(){return this._disabled},enumerable:!1,configurable:!0}),n.prototype.verifyAdding=function(){if(!this.getPhysicWorld())throw new En(this,"Physic world is required for adding RigidBodyComponent !");if(this._owner.findComponentByClass(r))throw new Cn(this._owner,"RigidBodyComponent",this.name,this)},n.prototype.onInit=function(t){this._unControl=t.unControl||!1,this._physicStatic=t.physicStatic||!1,void 0!==t.filterMask&&(this.filterMask=t.filterMask),void 0!==t.filterGroup&&(this.filterGroup=t.filterGroup),this._event.register("Pick"),this._event.register("Collision"),this._event.register("BodyEnter"),this._event.register("BodyLeave"),this._event.register("ColliderEnter"),this._event.register("ColliderLeave"),this._event.register("BeforeStep"),this._event.register("AfterStep"),this._owner._rigidBody=this},n.prototype.onAdd=function(t){this._rigidBody=this.getPhysicWorld().createRigidBody(this,t),this.getPhysicWorld().initEvents(this),this._valid=!0,!0===t.sleeping&&this.sleep()},n.prototype.onUnLink=function(){this.disable()},n.prototype.onReLink=function(){this.enable()},n.prototype.onDestroy=function(){var t=this;this._valid=!1;var e=this.getPhysicWorld();setTimeout((function(){return e.removeRigidBody(t)}),0),this._owner.rigidBody===this&&(this._owner._rigidBody=null)},n.prototype.disable=function(){this.getPhysicWorld().disableRigidBody(this),this._disabled=!0},n.prototype.enable=function(){this.getPhysicWorld().enableRigidBody(this),this._disabled=!1},n.prototype.getMassCenter=function(){return this._owner.transform.position},n.prototype.setRootTransform=function(){return this.getPhysicWorld().setRootTransform(this),this},n.prototype.setRigidBodyTransform=function(t,e){return this.getPhysicWorld().setRigidBodyTransform(this,t,e),this},n.prototype.setLinearVelocity=function(t){return this.getPhysicWorld().setLinearVelocity(this,t),this},n.prototype.setAngularVelocity=function(t){return this.getPhysicWorld().setAngularVelocity(this,t),this},n.prototype.getLinearVelocity=function(){return this.getPhysicWorld().getLinearVelocity(this)},n.prototype.getAngularVelocity=function(){return this.getPhysicWorld().getAngularVelocity(this)},n.prototype.sleep=function(){return this.getPhysicWorld().sleepBody(this),this._sleeping=!0,this},n.prototype.wakeUp=function(){return this.getPhysicWorld().wakeUpBody(this),this._sleeping=!1,this},n.prototype.forceSync=function(){return this.handleBeforeStep(null,!0),this},n.prototype.getParentsRotationAndScale=function(){var t=this._owner.parent;for(this._tmpQuat.set(0,0,0,1),this._tmpScale.set(1,1,1);t&&!Ze(t);){var e=t.getOwner();this._tmpQuat2.copy(e.transform.quaternion),this._tmpQuat.multiply(this._tmpQuat2),this._tmpScale2.copy(e.transform.scale),this._tmpScale.multiply(this._tmpScale2),t=e.parent}},n.prototype.getCurrentTransform=function(){var t=this._owner.transform;return t.updateMatrixWorld(!0),this._owner.parent&&!Ze(this._owner.parent)?(this.getParentsRotationAndScale(),this._tmpQuat.multiply(t.quaternion),this._tmpScale.multiply(t.scale)):(this._tmpQuat.copy(t.quaternion),this._tmpScale.copy(t.scale)),[t.absolutePosition,this._tmpQuat,this._tmpScale]},n.prototype.syncTransformToRigidBody=function(t){var e=this._owner.transform;if(this.needUpdateCollider&&(this.getPhysicWorld().updateBounding(this),this.needUpdateCollider=!1),t||!this._unControl){t&&e.updateMatrixWorld(!0),this._tmpScale3.copy(this._tmpScale),this._owner.parent&&!Ze(this._owner.parent)?(this.getParentsRotationAndScale(),this._tmpQuat.multiply(e.quaternion),this._tmpScale.multiply(e.scale)):(this._tmpQuat.copy(e.quaternion),this._tmpScale.copy(e.scale));var n=t&&!this._tmpScale.equals(Un)||!this._tmpScale.equals(this._tmpScale3);this.getPhysicWorld().setRigidBodyTransform(this,e.absolutePosition,this._tmpQuat,n?this._tmpScale:null),t&&this.getPhysicWorld().updateBounding(this)}},n=r=g([C({className:"RigidBodyComponent",classType:"RigidBody"})],n)}(H),kn=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isColliderComponent=!0,n._type=e.EColliderType.Null,n}return p(n,t),Object.defineProperty(n.prototype,"collider",{get:function(){return this._collider},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"initState",{get:function(){return this._initState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTrigger",{get:function(){return this.getPhysicWorld().getColliderIsTrigger(this)},set:function(t){this.getPhysicWorld().setColliderIsTrigger(this,t)},enumerable:!1,configurable:!0}),n.prototype.verifyAdding=function(){if(!this._owner.rigidBody)throw new gn(this,"RigidBodyComponent must be added before adding ColliderComponent !")},n.prototype.onAdd=function(t){var e=this._owner.rigidBody,n=this._initState=t||this.getDefaultOptions();n.offset=n.offset||[0,0,0],n.quaternion=n.quaternion||[0,0,0,1],this._collider=this.getPhysicWorld().createCollider(e,this,{type:this._type,options:n})},n.prototype.onDestroy=function(){var t=this,e=this.getPhysicWorld();setTimeout((function(){t._owner&&t._owner.rigidBody&&e.removeCollider(t._owner.rigidBody,t)}),0)},n.prototype.getDefaultOptions=function(){return null},n=g([C({className:"ColliderComponent"})],n)}(H),jn=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isBoxColliderComponent=!0,n._type=e.EColliderType.Box,n}return p(n,t),n.prototype.getDefaultOptions=function(){return null},n=g([C({className:"BoxColliderComponent",classType:"Collider"})],n)}(kn),Vn=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isSphereColliderComponent=!0,n._type=e.EColliderType.Sphere,n}return p(n,t),n.prototype.getDefaultOptions=function(){return null},n=g([C({className:"SphereColliderComponent",classType:"Collider"})],n)}(kn);function Xn(t){return t.isSceneActor}var Wn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSceneActor=!0,e.persistent=!1,e._rigidBody=null,e._animator=null,e._controller=null,e}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){return this._root},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rigidBody",{get:function(){return this._rigidBody},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layers",{get:function(){return this._root.layers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.root.visible},set:function(t){this.root.visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStatic",{get:function(){return this._root.isStatic},set:function(t){this._root.isStatic=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needReleaseGlRes",{get:function(){return this._root.needReleaseGlRes},set:function(t){this._root.needReleaseGlRes=t},enumerable:!1,configurable:!0}),e.prototype.onCreateRoot=function(t){return this.addComponent("root",rn,t)},e.prototype.onInstantiate=function(t){},e.prototype.onUnLink=function(){this._root.hiloNode.removeFromParent()},e.prototype.onReLink=function(t){Xn(t)||this._root.hiloNode.addTo(t.game.hiloStage)},e.prototype.getController=function(){return this._controller},e.prototype.getBounds=function(t,e){return this._root.getBounds(t,e)},e.prototype.added=function(){if(!this._inWorld){this._inWorld=!0,this._linked=!0,Ze(this._parent)&&this._game.hiloStage.addChild(this._root.hiloNode),this._components.forEach((function(t){t.added()}));try{this.onAdd(this._initOptions)}catch(t){O(t,this)}this._initOptions&&this._initOptions.__fromGlTF||this.instantiated()}},e.prototype.instantiated=function(){this._root.updateMatrixWorld(!0);try{this.onInstantiate(this._initOptions)}catch(t){O(t,this)}},e.prototype.destroy=function(){this._controller&&this._controller.dispossessActor(),this._parent&&!Ze(this._parent)&&this._parent.removeActor(this),t.prototype.destroy.call(this)},e.prototype.changeParent=function(t){var e=this._game;return Ze(t)||On(t)?(Ze(this._parent)||(this._parent.autoDestroyActor=!1,this._parent.removeFromParent(),e.hiloStage.addChild(this._root.hiloNode),this._parent=e.level),this):Ze(this._parent)?(t.addChild(this),this):(this._parent.autoDestroyActor=!1,this._parent.removeFromParent(),t.addChild(this),this)},e.prototype.lookAt=function(t){return this._root.lookAt(t),this},e.prototype.preRender=function(){this._components.forEach((function(t){nn(t)&&t.preRender()}))},e=g([C({className:"SceneActor"})],e)}(Nn);function zn(t){return t.isPrimitiveComponent}var qn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPrimitiveComponent=!0,e.needUpdateAndDestroy=!1,e.__multiPrimitive=!1,e}return p(e,t),e.prototype.onInit=function(e){t.prototype.onInit.call(this,e),this.__multiPrimitive=e.__doNotUseMultiPrimitiveYourself&&e.__doNotUseMultiPrimitiveYourself.length>1,e.material&&e.material.cloneForInst&&(e.material=e.material.clone());var n=this._mesh=this.onCreateMesh(e);if(this._mesh.__forceUseParentWorldMatrix=!0,this.__multiPrimitive){this._list=[],this._table={};for(var r=e.__doNotUseMultiPrimitiveYourself.length,i=0;i<r;i+=1){var o=e.__doNotUseMultiPrimitiveYourself[i],s=o.geometry,a=o.material,u=0===i?n:this.onCreateMesh({geometry:s,material:a.cloneForInst?a.clone():a});u.__forceUseParentWorldMatrix=!1,this._list.push(u),this._table[a.name]=u,void 0!==e.frustumTest&&(u.frustumTest=e.frustumTest),this._node.addChild(u)}}else void 0!==e.frustumTest&&(this._mesh.frustumTest=e.frustumTest),this._node.addChild(this._mesh);var c=this.getRoot();c&&c.hiloNode.addChild(this._node)},Object.defineProperty(e.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t},enumerable:!1,configurable:!0}),e.prototype.setMaterial=function(t,e){return this.__multiPrimitive?(e&&this._table[e]&&(this._table[e].material=t),this):(this._mesh.material=t,this)},e.prototype.getMaterial=function(t){return t&&this.__multiPrimitive?this._table[t]?this._table[t].material:null:this._mesh.material},e.prototype.getMaterials=function(){return this.__multiPrimitive?this._list.map((function(t){return t.material})):[this.material]},Object.defineProperty(e.prototype,"geometry",{get:function(){return this._mesh.geometry},set:function(t){this._mesh.geometry=t},enumerable:!1,configurable:!0}),e.prototype.setGeometry=function(t,e){return this.__multiPrimitive?(e&&this._table[e]&&(this._table[e].geometry=t),this):(this._mesh.geometry=t,this)},e.prototype.getGeometry=function(t){return t&&this.__multiPrimitive?this._table[t]?this._table[t].geometry:null:this._mesh.geometry},e.prototype.getSubMesh=function(t){return t&&this.__multiPrimitive?this._table[t]?this._table[t]:null:this._mesh},Object.defineProperty(e.prototype,"frustumTest",{get:function(){return this._mesh.frustumTest},set:function(t){this.setMeshProperty("frustumTest",t)},enumerable:!1,configurable:!0}),e.prototype.preRender=function(){var t=this.getGame().renderer;this.__multiPrimitive?t.renderMesh(this._mesh):this._list.forEach((function(e){t.renderMesh(e)}))},e.prototype.setMeshProperty=function(t,e){if(this.__multiPrimitive)for(var n=this._list.length,r=0;r<n;r+=1)this._list[r][t]=e;else this._mesh[t]=e},e.prototype.onCreateMesh=function(t){return null},e=g([C({className:"PrimitiveComponent"})],e)}(rn);function Yn(t){return t.isStaticMeshComponent}var Jn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStaticMeshComponent=!0,e}return p(e,t),e.prototype.onCreateMesh=function(t){return new pn({geometry:t?t.geometry:null,material:t?t.material:null})},e=g([C({className:"StaticMeshComponent"})],e)}(qn);function Qn(t){return t.isPBRMaterial}var Zn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.PBRMaterial);function Kn(t){return Math.log(t)/Math.log(2)%1==0}var $n=function(t){function e(e,n){void 0===n&&(n=!0);var r=t.call(this)||this;if(r.isAtlasManager=!0,r._AUTO_ID=0,r._area=0,r._needReBuild=!1,r.isImageCanRelease=!1,r._frames=e.frames,r._meta=e.meta,r._canvases={},r._textures={},r._updatable=n,e.texture)r._image=e.texture.image,r._texture=e.texture;else if(e.image instanceof HTMLCanvasElement)r._image=e.image,r._ctx=r._image.getContext("2d");else if(n){if(S.devMode&&(!Kn(r._meta.size.w)||!Kn(r._meta.size.h)))throw new Error("Atlas "+r.name+" is updatable but it size is not power of two !");r._image=document.createElement("canvas"),r._image.width=r._meta.size.w,r._image.height=r._meta.size.h,r._ctx=r._image.getContext("2d"),r._ctx.drawImage(e.image,0,0)}else r._image=e.image;return r}var n;return p(e,t),n=e,e.CREATE_EMPTY=function(t){var e=t.width,r=t.height,i=document.createElement("canvas");i.width=e,i.height=r;var o=i.getContext("2d");return o.fillStyle="rgba(255, 255, 255, 0)",o.fillRect(0,0,e,r),new n({image:i,frames:{},meta:{size:{w:e,h:r}}},!0)},e.CREATE_FROM_GRIDS=function(t,e){var r=t.width,i=t.height,o=t.rows,s=t.cols,a=t.space;a=a||0;var u=document.createElement("canvas");u.width=r,u.height=i;var c=u.getContext("2d");c.fillStyle="rgba(255, 255, 255, 0)",c.fillRect(0,0,r,i);for(var h=~~(r/s)-a,l=~~(i/o)-a,f={},d=0;d<o;d+=1)for(var p=0;p<s;p+=1){var m=p*(h+a),_=d*(l+a);f[v=""+d+p]={frame:{x:m,y:_,w:h,h:l},space:a}}var g=new n({image:u,frames:f,meta:{size:{w:r,h:i}}},!0);if(e)for(d=0;d<o;d+=1)for(p=0;p<s;p+=1){var v=""+d+p,y=g.getFrame(v);e(g,c,{x:m=y.x,y:_=y.y,w:y.w,h:y.h,row:d,col:p},v)}return g},e.CREATE_FROM_TEXTURE=function(t,e){var r=e.cellWidth,i=e.cellHeight,o=t.origWidth,s=t.origHeight,a=e.spacing||0,u=e.framesPerLine,c=e.frameStart,h=e.frameCount;void 0===c&&(c=0),void 0===h&&(h=1/0);for(var l={},f=c;;){var d=(1===u?0:f%u)*(r+a),p=(1===u?f:~~(f/u))*(i+a);if(f>=h||p+i+a>=s)break;l[f]={frame:{x:d,y:p,w:r,h:i}},f+=1}return new n({texture:t,frames:l,meta:{size:{w:o,h:s}}},!1)},Object.defineProperty(e.prototype,"image",{get:function(){return this._image},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"meta",{get:function(){return this._meta},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frames",{get:function(){return this._frames},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this.getWholeTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"usage",{get:function(){var t=this._meta.size,e=t.w,n=t.h;return this._area/(e*n)},enumerable:!1,configurable:!0}),e.prototype.getFrame=function(t){return this._frames[t].frame},e.prototype.getUV=function(t){throw new Error("`getUV` is deprecated, please use `getUVMatrix`!")},e.prototype.getUVMatrix=function(t){var e=this._frames[t];if(!e)throw new Error("Frame "+t+" is not existed!");var n=e.uvMatrix,r=e.frame;return n||(e.uvMatrix=this.buildUVMatrix(r)),e.uvMatrix},e.prototype.buildUVMatrix=function(t){var e=this._meta.size,n=e.w,r=e.h,i=new Ve;return i.set(t.w/n,0,0,0,-t.h/r,0,t.x/n,(t.y+t.h)/r,1),i},e.prototype.getFrameImage=function(t){if(!this._canvases[t]){var e=document.createElement("canvas"),n=e.getContext("2d"),r=this._frames[t].frame,i=r.x,o=r.y,s=r.w,a=r.h;e.width=s,e.height=a,n.drawImage(this._image,i,o,s,a),this._canvases[t]=e}return this._canvases[t]},e.prototype.getTexture=function(t,e){if(!e&&this._textures[t])return this._textures[t];var n,r=this.getFrame(t),i=r.x,o=r.y,s=r.w,a=r.h;if(this._image instanceof HTMLImageElement)this._tmpCanvas||(this._tmpCanvas=document.createElement("canvas"),this._tmpCanvas.width=this._image.width,this._tmpCanvas.height=this._image.height),(u=this._tmpCanvas.getContext("2d")).drawImage(this._image,i,o,s,a,0,0,s,a),n=u.getImageData(0,0,s,a);else if(this._image instanceof HTMLCanvasElement){var u;n=(u=this._image.getContext("2d")).getImageData(i,o,s,a)}else S.warn("Image is 'ArrayBuffer', not support get a frame !");return e?new an(m({image:n,isImageCanRelease:this.isImageCanRelease},e)):(this._textures[t]=new an({image:n,isImageCanRelease:this.isImageCanRelease}),this._textures[t])},e.prototype.getWholeTexture=function(t){return t?(this._texture&&this._texture.destroy(),this._texture=new an(m({image:this._image,isImageCanRelease:this.isImageCanRelease},t))):(this._texture||(this._texture=new an({image:this._image,isImageCanRelease:this.isImageCanRelease})),this._texture)},e.prototype.updateFrame=function(t,e){if(!this._updatable)throw new Error("Atlas "+this.name+" is not updatable !");this._canvases[t]&&delete this._canvases[t],this._textures[t]&&delete this._textures[t];var n=this.getFrame(t),r=n.x,i=n.y,o=n.w,s=n.h;e(this._ctx,{x:r,y:i,w:o,h:s},t),this.updateGlSubBuffer(r,i,o,s)},e.prototype.allocateFrame=function(t,e){if(!this._updatable)throw new Error("Atlas "+this.name+" is not updatable !");var n=t.frameName;if(n&&this._frames[n])throw new Error("Frame named "+n+" is not already existed !");if(this._needReBuild&&this.rebuildFrames(),!(n=this.generateFrame(this._root,t)))return null;if(this._area+=t.w*t.h,e){var r=this.getFrame(n),i=r.x,o=r.y,s=r.w,a=r.h;e(this._ctx,{x:i,y:o,w:s,h:a},n),this.updateGlSubBuffer(i,o,s,a)}return n},e.prototype.generateFrame=function(t,e,n){var r=e.w,i=e.h,o=e.space,s=void 0===o?0:o,a=e.frameName,u=this._meta.size;if(void 0===n&&(n=this._meta.size.h),!this._root)return this._root=this.addFrame(0,0,r,i,a);var c=this._frames[t],h=c.right,l=c.down,f=c.frame,d=f.x+f.w+s,p=f.y+f.h+s,m=u.w-d,_=n-p;return!h&&!l&&r<=m&&i<=f.h||!h&&r<=m&&i<=f.h?c.right=this.addFrame(d,f.y,r,i,a,s):!l&&r<=u.w-f.x&&i<=_?c.down=this.addFrame(f.x,p,r,i,a,s):h&&(a=this.generateFrame(h,e,p))||l&&(a=this.generateFrame(l,e,n))?a:null},e.prototype.rebuildFrames=function(){var t=this,e=this._meta.size;if(!this._tmpCanvas){var n=this._tmpCanvas=document.createElement("canvas");n.width=e.w,n.height=e.h}this._tmpCanvas.getContext("2d").drawImage(this._image,0,0),this._ctx.clearRect(0,0,e.w,e.h),this._ctx.fillStyle="rgba(255, 255, 255, 0)",this._ctx.fillRect(0,0,e.w,e.h);var r=Object.assign({},this._frames);this._frames={},this._root=null,Object.keys(r).sort((function(t,e){return r[e].frame.h-r[t].frame.h})).forEach((function(e){var n=r[e],i=n.frame,o=i.w,s=i.h;t.generateFrame(t._root,{w:o,h:s,frameName:e,space:n.space});var a=t._frames[e].frame,u=a.x,c=a.y,h=r[e].frame;t._ctx.drawImage(t._tmpCanvas,h.x,h.y,o,s,u,c,o,s)})),this.updateGlSubBuffer(0,0,e.w,e.h),this._needReBuild=!1},e.prototype.addFrame=function(t,e,n,r,i,o){return i=i||"AUTO-"+this._AUTO_ID++,this._frames[i]={frame:{x:t,y:e,w:n,h:r},space:o},i},e.prototype.releaseFrame=function(t){if(!this._updatable)throw new Error("Atlas "+this.name+" is not updatable !");var e=this._frames[t];e&&(this._texture[t]&&this._texture.destroy(),this._canvases[t]&&delete this._canvases[t],delete this._frames[t],this._area-=e.frame.h*e.frame.w,this._needReBuild=!0)},e.prototype.updateGlSubBuffer=function(t,e,n,r){this._texture&&this._texture.updateSubTexture(t,this._texture.flipY?this._meta.size.h-e-r:e,this._ctx.getImageData(t,e,n,r))},e.prototype.destroy=function(){for(var t in this._textures)this._textures[t].destroy();this._texture&&this._texture.destroy()},e=n=g([C({className:"AtlasManager"})],e)}(L),tr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.LazyTexture),er=function(t){return function(e,n,r){if(r)return r.gltfExtensions=r.gltfExtensions||{},r.gltfExtensions[t]=e,r}},nr=Re.AliAMCExtension,rr={name:"SEIN_node",optionParsers:{},registerOptionParsers:function(t,e){rr.optionParsers[t]=e},unregisterOptionParsers:function(t){delete rr.optionParsers[t]},parseOption:function(t,e,n){var r=t.type,i=t.value;if(r&&rr.optionParsers[r])return rr.optionParsers[r](i,e,n);throw new Error("You must register parser for type '"+r+"' in SEIN_node.initOptions !")},parse:function(t,e,n,r){if(n.gltfExtensions=n.gltfExtensions||{},n.gltfExtensions[rr.name]=t,!t.initOptions)return n;var i=t.initOptions;return Object.keys(i).forEach((function(n){i[n]=rr.parseOption(i[n],e,t)})),n},instantiate:function(t,e){void 0!==e.updateOnEverTick&&(t.updateOnEverTick=e.updateOnEverTick),void 0!==e.neverTransform&&(t.isStatic=e.neverTransform),$e(t)&&(e.tag&&(t.tag=new f(e.tag)),e.layers&&t.layers.set(e.layers),void 0!==e.persistent&&(t.persistent=e.persistent),void 0!==e.emitComponentsDestroy&&(t.emitComponentsDestroy=e.emitComponentsDestroy))}};["Float","Int","String","Bool"].forEach((function(t){rr.registerOptionParsers(t,(function(t){return t}))})),rr.registerOptionParsers("Vec2",(function(t){return(new Ge).fromArray(t)})),rr.registerOptionParsers("Vec3",(function(t){return(new ke).fromArray(t)})),rr.registerOptionParsers("Vec4",(function(t){return(new je).fromArray(t)})),rr.registerOptionParsers("Mat4",(function(t){return(new Xe).fromArray(t)})),rr.registerOptionParsers("Quat",(function(t){return(new We).fromArray(t)})),rr.registerOptionParsers("Color",(function(t){return(new ze).fromArray(t)})),rr.registerOptionParsers("Tex2D",(function(t,e){return e.textures[t.index]})),rr.registerOptionParsers("TexCube",(function(t,e){return e.cubeTextures[t.index]})),rr.registerOptionParsers("Atlas",(function(t,e){return e.atlases[t.index]})),rr.registerOptionParsers("Mat",(function(t,e){return e.materials[t.index]})),rr.registerOptionParsers("Array",(function(t,e,n){return t.map((function(t){return rr.parseOption(t,e,n)}))})),rr.registerOptionParsers("Object",(function(t,e,n){var r={};return Object.keys(t).forEach((function(i){r[i]=rr.parseOption(t[i],e,n)})),r}));var ir={name:"SEIN_physicBody",instantiate:function(t,e,n){if($e(t)){var r=e;if(n.world.physicWorld){var i=t.addComponent("rigidBody",Gn,{mass:r.mass,friction:r.friction,restitution:r.restitution,unControl:r.unControl,physicStatic:r.physicStatic});e.sleeping&&t.rigidBody.sleep(),r.colliders.forEach((function(e,n){var r="collider-"+(e.name||e.type+n);switch(e.type){case"BOX":t.addComponent(r,jn,e);break;case"SPHERE":t.addComponent(r,Vn,e)}})),r.colliders.length&&i.forceSync()}else S.warn("Model "+t.name+' in gltf file has physicBody, but "PhysicWorld" is not found in current world, ignore...')}else S.warn("You could not add physicBody to a component: "+t.name+", ignore...")}},or={name:"SEIN_animator",instantiate:function(t){$e(t)||S.warn("You could not add animator to a component: "+t.name+", ignore...")}},sr={name:"SEIN_renderer",parseOnLoad:function(t,e){e.renderer=e.json.extensions.SEIN_renderer||{}},parseOnEnd:function(t,e,n){return n.renderer=e.renderer,n},instantiate:function(t,e,n,r,i){var o=$e(t)?t.root:t;(Yn(o)||zn(o))&&o.getMaterials().forEach((function(t){if(Yn(o)&&e.lightMap){var n=t.name;t=t.clone(),o.setMaterial(t,n);var r=e.lightMap,s=r.lightMapIndex,a=r.uvChannel,u=r.uvRotation,c=r.uvScale,h=r.uvOffset,l=i.textures[s];l.uv=a,Qn(t)?t.lightMap=l:cn(t)&&t.setUniform("u_lightMap",l),0===a?t.uvMatrix=(new Ve).fromRotationTranslationScale(u,h[0],h[1],c[0],c[1]):t.uvMatrix1=(new Ve).fromRotationTranslationScale(u,h[0],h[1],c[0],c[1])}t.receiveShadows=e.castShadows||!1,t.castShadows=e.receiveShadows||!1,t.gammaCorrection=e.gammaCorrection||!1;var f=i.renderer;f&&(t.gammaCorrection=f.gammaCorrection||!1,t.useHDR=f.useHDR||!1,t.exposure=f.exposure?t.exposure:f.exposure)}))}},ar={name:"SEIN_ambientLight",parseOnEnd:function(t,e,n){var r=t.color,i=t.intensity,o=new Re.AmbientLight({name:"gltf-ambientLight-extension",color:new ze(r[0],r[1],r[2]),amount:i});return n.ambientLight=o,n}};function ur(t,e){if(/^(?:http|blob|data:|\/)/.test(e))return e;var n=t.replace(/\/[^/]*?$/,"").split("/"),r=e.split("/"),i=0;for(i=0;i<r.length;i+=1){var o=r[i];if(".."===o)n.pop();else if("."!==o)break}return n.join("/")+"/"+r.slice(i).join("/")}var cr={name:"SEIN_cubeTexture",init:function(t,e){var n=e.game,r=[],i=((e.json.extensions||{}).SEIN_cubeTexture||{}).textures||[],o=[];return e.cubeTextures=o,i.forEach((function(t,i){var s=t.images.map((function(t){var n=e.getImageUri(t);return n=ur(e.src,n)}));r.push(Promise.resolve().then((function(){return new Promise((function(r,a){var u=/\.png$/.test(s[0])?on.RGBA:on.RGB;n.resource.getLoader("CubeTexture").load({type:"CubeTexture",url:"",images:{right:s[0],left:s[1],top:s[2],bottom:s[3],front:s[4],back:s[5]},name:"",format:u,internalFormat:u,isImageCanRelease:t.isImageCanRelease},{onLoading:function(t,e){},onLoaded:function(n){var s=n.result,a=e.json.samplers[t.sampler];o[i]=s,s.minFilter=a.minFilter||s.minFilter,s.magFilter=a.magFilter||s.magFilter,s.wrapS=a.wrapS||s.wrapS,s.wrapT=a.wrapT||s.wrapT,r()},onError:function(t,e){return a(e)}})}))})))})),Promise.all(r)},parseOnEnd:function(t,e,n){return n.cubeTextures=e.cubeTextures,n}},hr={name:"SEIN_imageBasedLighting",init:function(t,e){e.game;var n=((e.json.extensions||{}).SEIN_imageBasedLighting||{}).lights||[],r=[];e.imageBasedLights=r,n.forEach((function(t,e){r.push({diffuse:{type:t.diffuse.type,intensity:t.diffuse.intensity,coefficients:(new Ye).fromArray(t.diffuse.coefficients)},specular:t.specular?{type:t.specular.type,intensity:t.specular.intensity,brdfLUTIndex:t.specular.brdfLUT.index,includeMipmaps:t.specular.includeMipmaps,brdfLUT:null,cubeMap:null}:null});var n=r[e].specular;n&&(n.mapIndex=t.specular.map.index)}))},parseOnLoad:function(t,e){e.imageBasedLights.forEach((function(t){t.specular&&(t.specular.brdfLUT=e.textures[t.specular.brdfLUTIndex],"2D"==t.specular.type?t.specular.map=e.textures[t.specular.mapIndex]:t.specular.map=e.cubeTextures[t.specular.mapIndex])}))},parseOnEnd:function(t,e,n){return n.imageBasedLights=e.imageBasedLights,n},parse:function(t,e,n){var r=n,i=t.light,o=t.type,s=e.imageBasedLights[i];return Qn(r)?("ALL"==o&&(r.brdfLUT=s.specular.brdfLUT,r.specularEnvIntensity=s.specular.intensity,r.specularEnvMap=s.specular.map,r.isSpecularEnvMapIncludeMipmaps=s.specular.includeMipmaps),r.diffuseEnvIntensity=s.diffuse.intensity,"SH"==s.diffuse.type&&(r.diffuseEnvSphereHarmonics3=s.diffuse.coefficients)):cn(r)&&("ALL"==o&&(r.setUniform("u_brdfLUT",s.specular.brdfLUT),r.setUniform("u_specularEnvIntensity",s.specular.intensity),r.setUniform("u_specularEnvMap",s.specular.map),r.isSpecularEnvMapIncludeMipmaps=s.specular.includeMipmaps),r.setUniform("u_diffuseEnvIntensity",s.diffuse.intensity),"SH"==s.diffuse.type&&r.setUniform("u_diffuseEnvSphereHarmonics3",s.diffuse.coefficients)),r}},lr={name:"SEIN_atlas",init:function(t,e){e.game;var n=[],r=((e.json.extensions||{}).SEIN_atlas||{}).atlases||[],i=[];return e.atlases=i,r.forEach((function(t,r){i.push(null),n.push(Promise.resolve().then((function(){return new Promise((function(n,o){var s=t.meta.image.index,a=e.getImageUri(s),u=new tr;u.uv=void 0,u.crossOrigin=!0,u.autoLoad=!1,u.resType=e.getImageType(s),u.src=a,u.name=t.name,u.isImageCanRelease=t.isImageCanRelease;var c=function(e){if(u.off("load",c),u.off("error",c),e)return o(e);i[r]=new $n({texture:u,frames:t.frames,meta:t.meta},!1),i[r].name=new f(t.name),i[r].isImageCanRelease=t.isImageCanRelease,n()};u.on("load",(function(){return c()})),u.on("error",(function(t){return c(t)})),u.load(!0)}))})))})),Promise.all(n)},parseOnEnd:function(t,e,n){return n.atlases=e.atlases,n}},fr={name:"SEIN_customMaterial",cache:{},init:function(t,e){var n=[],r=((e.json.extensions||{}).SEIN_customMaterial||{}).scripts||[];return e.scripts=r,r.forEach((function(t,r){var i=t.uri;fr.cache[i]||(fr.cache[i]=!0,i=ur(e.src,i),n.push(new Promise((function(t,e){var n=document.createElement("script");n.onload=function(){return t()},n.onerror=function(t){return e(t)},n.src=i,document.head.append(n)}))))})),Promise.all(n)}},dr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className="FakeHiloSprite",e.isFakeHiloSprite=!0,e}return p(e,t),e}(Re.Node),pr={name:"SEIN_sprite",init:function(t,e){var n=(e.json.extensions||{}).SEIN_sprite||{};e.sprites=(n.sprites||[]).map((function(t){var e=new dr;return e.sprite=t,e}))},parseOnEnd:function(t,e,n){return n.sprites=e.sprites,e.sprites.forEach((function(t){t.sprite.material&&(t.material=e.materials[t.sprite.material.index])})),n},parse:function(t,e,n){var r=n;return r.addChild(e.sprites[t.index]),r}},mr={name:"SEIN_skybox",parse:function(t,e,n){var r=n,i=new fn({type:t.type,uniforms:{u_color:{value:(new ze).fromArray(t.color)},u_factor:{value:t.factor},u_texture:t.texture&&{value:"Panoramic"===t.type?e.textures[t.texture.index]:e.cubeTextures[t.texture.index]},u_rotation:void 0!==t.rotation&&{value:t.rotation},u_exposure:void 0!==t.exposure&&{value:t.exposure},u_degrees:void 0!==t.degrees&&{value:t.degrees}}}),o=e.renderer;return o&&(i.gammaCorrection=o.gammaCorrection||!1,i.useHDR=o.useHDR||!1,i.exposure=o.exposure?i.exposure:o.exposure),r.backgroundMat=i,r}};Re.GLTFExtensions.KHR_techniques_webgl.parse=function(t,e,n,r){if(r.isGlobalExtension)return null;var i=e.textures||[],o=e.techniques[t.technique];if(!o)return null;var s=e.programs[o.program];if(!s)return null;var a=e.shaders[s.fragmentShader],u=e.shaders[s.vertexShader],c=o.uniforms||{},h=o.attributes||{},l=t.values||{},f={},d={};for(var p in c){var m=c[p]||{},_=void 0!==l[p]?l[p]:m.value,g=void 0;g=void 0!==_?m.type===on.SAMPLER_2D?{value:i[_.index||0]}:{value:_}:m.semantic&&Re.semantic[m.semantic]?m.semantic:Re.semantic.blankInfo,d[p]=g}for(var v in h){var y=h[v]||{};y.semantic&&(f[v]=y.semantic)}return new hn({vs:u,fs:a,attributes:f,uniforms:d})};var _r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSkeletalMesh=!0,e}return p(e,t),e.prototype.getMaterial=function(){return this.material},e.prototype.clone=function(e){return t.prototype.clone.call(this,e)},e}(Re.SkinedMesh);function gr(t){return t.isSkeletalMeshComponent}var vr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSkeletalMeshComponent=!0,e}return p(e,t),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this._mesh.skeleton},enumerable:!1,configurable:!0}),e.prototype.onCreateMesh=function(t){return new _r({geometry:t?t.geometry:null,material:t?t.material:null,skeleton:t?t.skeleton:null})},e.prototype.changeSkeleton=function(t){this.__multiPrimitive?this._list.forEach((function(e){e.skeleton=t._mesh.skeleton})):this._mesh.skeleton=t._mesh.skeleton},e.prototype.changeSkin=function(t){var e=this;if(dn(t))return this._list=null,this._table=null,this.__multiPrimitive=!1,this._mesh.geometry=t.geometry,this._mesh.material=t.material,void(this._node.children=[this._mesh]);if(t.length<2)O(new gn(this,"meshes which is array must have more than two elements, if one, please use changeSkin(mesh)"),this);else{var n=this._mesh.skeleton;this._node.children=[],this._table={},this._list=t.map((function(t){var r=t.geometry,i=t.material,o=new _r({geometry:r,material:i.cloneForInst?i.clone():i,skeleton:n});return e._table[i.name]=o,e._node.addChild(o),o})),this._mesh=this._list[0]}},e.prototype.cloneSkinningFromHilo=function(t,e){var n=this._mesh;this.__multiPrimitive&&(n=this._list[e]).material&&delete this._table[n.material.name],n.skeleton=t.skeleton.clone(this.getRoot().hiloNode)},e=g([C({className:"SkeletalMeshComponent"})],e)}(qn),yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",vr,t)},e=g([C({className:"SkeletalMeshActor",classType:"Primitive"})],e)}(Wn),Er=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",Jn,t)},e=g([C({className:"StaticMeshActor"})],e)}(Wn),Tr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),Object.defineProperty(e.prototype,"camera",{get:function(){return this._root},enumerable:!1,configurable:!0}),e.prototype.onCreateRoot=function(t){return this.addComponent("root",Mn,t)},e=g([C({className:"OrthographicCameraActor"})],e)}(Wn),Ar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),Object.defineProperty(e.prototype,"camera",{get:function(){return this._root},enumerable:!1,configurable:!0}),e.prototype.onCreateRoot=function(t){return this.addComponent("root",An,t)},e=g([C({className:"PerspectiveCameraActor"})],e)}(Wn);function Sr(t){return t.isLightComponent}var Mr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLightComponent=!0,e.needUpdateAndDestroy=!1,e}return p(e,t),e.prototype.onCreateLight=function(t){throw new Error("Not Implement !")},e.prototype.onInit=function(e){t.prototype.onInit.call(this,e),this._light=this.onCreateLight(e),this._light.__forceUseParentWorldMatrix=!0,this._node.addChild(this._light)},Object.defineProperty(e.prototype,"amount",{get:function(){return this._light.amount},set:function(t){this._light.amount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._light.color},set:function(t){this._light.color.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this._light.shadow},set:function(t){this._light.shadow=t},enumerable:!1,configurable:!0}),e=g([C({className:"LightComponent"})],e)}(rn);function Or(t){return t.isAmbientLightComponent}var br=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isAmbientLightComponent=!0,e.needUpdateAndDestroy=!1,e}return p(e,t),e.prototype.onCreateLight=function(t){return new Re.AmbientLight(t)},e=g([C({className:"AmbientLightComponent"})],e)}(Mr),Lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",br,t)},e=g([C({className:"AmbientLightActor"})],e)}(Wn);function Ir(t){return t.isDirectionalLightComponent}var Rr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDirectionalLightComponent=!0,e.needUpdateAndDestroy=!1,e}return p(e,t),e.prototype.onCreateLight=function(t){return new Re.DirectionalLight(t)},Object.defineProperty(e.prototype,"direction",{get:function(){return this._light.direction},set:function(t){this._light.direction.copy(t)},enumerable:!1,configurable:!0}),e=g([C({className:"DirectionalLightComponent"})],e)}(Mr),Cr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",Rr,t)},e=g([C({className:"DirectionalLightActor"})],e)}(Wn);function xr(t){return t.isPointLightComponent}var wr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPointLightComponent=!0,e.needUpdateAndDestroy=!1,e}return p(e,t),e.prototype.onCreateLight=function(t){return new Re.PointLight(t)},Object.defineProperty(e.prototype,"range",{get:function(){return this._light.range},set:function(t){this._light.range=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constantAttenuation",{get:function(){return this._light.constantAttenuation},set:function(t){this._light.constantAttenuation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linearAttenuation",{get:function(){return this._light.linearAttenuation},set:function(t){this._light.linearAttenuation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quadraticAttenuation",{get:function(){return this._light.quadraticAttenuation},set:function(t){this._light.quadraticAttenuation=t},enumerable:!1,configurable:!0}),e=g([C({className:"PointLightComponent"})],e)}(Mr),Nr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",wr,t)},e=g([C({className:"PointLightActor"})],e)}(Wn);function Pr(t){return t.isSpotLightComponent}var Dr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLightComponent=!0,e.isSpotLightComponent=!0,e.needUpdateAndDestroy=!1,e}return p(e,t),e.prototype.onCreateLight=function(t){return new Re.SpotLight(t)},Object.defineProperty(e.prototype,"direction",{get:function(){return this._light.direction},set:function(t){this._light.direction.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this._light.range},set:function(t){this._light.range=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cutoff",{get:function(){return this._light.cutoff},set:function(t){this._light.cutoff=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outerCutoff",{get:function(){return this._light.outerCutoff},set:function(t){this._light.outerCutoff=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constantAttenuation",{get:function(){return this._light.constantAttenuation},set:function(t){this._light.constantAttenuation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linearAttenuation",{get:function(){return this._light.linearAttenuation},set:function(t){this._light.linearAttenuation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quadraticAttenuation",{get:function(){return this._light.quadraticAttenuation},set:function(t){this._light.quadraticAttenuation=t},enumerable:!1,configurable:!0}),e=g([C({className:"SpotLightComponent"})],e)}(Mr),Hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",Dr,t)},e=g([C({className:"SpotLightActor"})],e)}(Wn);function Fr(){}var Ur=function(t){function e(e){var n=t.call(this)||this;return n.isAnimation=!0,n.animator=null,n.speed=1,n.handleStart=Fr,n.handleEnd=Fr,n.handlePause=Fr,n.handleResume=Fr,n._initState=null,n._paused=!0,e.speed=e.speed||1,n.speed=e.speed,n._initState=e,n}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this.animator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actor",{get:function(){return this.animator.getOwner()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fsm",{get:function(){return this.animator.fsm},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){throw new Error("Not implemented !")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){throw new Error("Not implemented !")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),e.prototype.getGame=function(){return this.actor.getGame()},e.prototype.getWorld=function(){return this.actor.getWorld()},e.prototype.getLevel=function(){return this.actor.getLevel()},e.prototype.onInit=function(t){},e.prototype.onPlay=function(t){},e.prototype.onPause=function(){},e.prototype.onResume=function(){},e.prototype.onStop=function(){},e.prototype.onUpdate=function(t){},e.prototype.onError=function(t,e){},e.prototype.initialize=function(){try{this.onInit(this._initState)}catch(t){O(t,this)}},e.prototype.play=function(t){this._paused=!1;try{this.onPlay(t),this.handleStart(this,this.actor)}catch(t){O(t,this)}},e.prototype.pause=function(){this._paused=!0;try{this.onPause(),this.handlePause(this,this.actor)}catch(t){O(t,this)}},e.prototype.resume=function(){this._paused=!1;try{this.onResume(),this.handleResume(this,this.actor)}catch(t){O(t,this)}},e.prototype.stop=function(){this._paused=!0;try{this.onStop()}catch(t){O(t,this)}},e.prototype.update=function(t){try{this.onUpdate(t)}catch(t){O(t,this)}},e=g([C({className:"Animation",classType:"Animation"})],e)}(L),Br=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isModelAnimation=!0,e._startTime=0,e._endTime=0,e._duration=0,e._currentEndHandler=function(){},e}return p(e,t),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._anim.currentTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._anim.paused},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t){var e=this.actor.findComponentByName(t.componentName)||this.actor.root,n=e.hiloNode.anim;if(!n)throw new gn(this,"Model of "+e.name+"->"+this.actor.name+" has no animations !");var r=n.clips[t.clipName];if(!r)throw new gn(this,"Clip "+this.className+" is not existed in model of "+e.name+"->"+this.actor.name+" !");this._anim=n,this._clipName=t.clipName,this._anim.loop=0;var i=this._anim.getAnimStatesListTimeInfo(r.animStatesList);this._duration=i.endTime-i.startTime},e.prototype.onPlay=function(t){var e=this;this._currentEndHandler=function(){return e.handleEnd(e,e.actor)},this._anim.on("end",this._currentEndHandler,!0),this._anim.play(this._clipName)},e.prototype.onPause=function(){this._anim.off("end",this._currentEndHandler),this._anim.pause()},e.prototype.onResume=function(){this._anim.on("end",this._currentEndHandler,!0),this._anim.resume()},e.prototype.onStop=function(){this._anim.off("end",this._currentEndHandler),this._currentEndHandler=function(){},this._anim.stop()},e.prototype.onUpdate=function(t){this.paused||this._anim.tick(t)},e=g([C({className:"ModelAnimation"})],e)}(Ur),Gr=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.isFSMState=!0,i._fsm=r,i.onEnter=n.onEnter,i.onUpdate=n.onUpdate,i.onExit=n.onExit,i.actions={},i.next={},i}return p(e,t),Object.defineProperty(e.prototype,"fsm",{get:function(){return this._fsm},enumerable:!1,configurable:!0}),e.prototype.enter=function(){this.onEnter&&this.onEnter(this)},e.prototype.update=function(t){this.onUpdate&&this.onUpdate(t,this)},e.prototype.exit=function(){this.onExit&&this.onExit(this)},e=g([C({className:"FSMState",classType:"FSMState"})],e)}(L);function kr(t){return!!t.push}var jr=function(t){function e(e){var n=t.call(this,e,null)||this;return n.isFSMComponent=!0,n.onExit=new w,n._states={},n._current="enter",n._default=null,n.handleExit=function(){n.dispatch("reset"),n.onExit&&(n.onExit.parent=n,n.onExit.notify(n))},n.addState("enter"),n.addState("exit",{onEnter:n.handleExit}),n.addTransition("reset","exit","enter"),n}return p(e,t),Object.defineProperty(e.prototype,"defaultState",{get:function(){return this._default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentState",{get:function(){return this._states[this._current]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent||this._owner},enumerable:!1,configurable:!0}),e.prototype.getCurrentState=function(){return this._states[this._current]},e.prototype.getState=function(t){return this._states[t]},e.prototype.addState=function(t,e,n){if(void 0===e&&(e={}),void 0===n&&(n=!1),this._states[t])throw new Cn(this,"State",t,this);return this._states[t]=new Gr(t,e,this),n&&this.setDefault(t),this},e.prototype.setDefault=function(t){return this._default=t,this.addTransition("enter","enter",t),this},e.prototype.has=function(t){return!!this._states[t]},e.prototype.removeState=function(t){if(this._states[t])return delete this._states[t],this},e.prototype.reset=function(){return this._current="enter",this},e.prototype.addTransition=function(t,e,n){var r=this;return this._states[n]||O(new N(this,"State",n,this),this),kr(e)||(e=[e]),e.forEach((function(e){var i=r._states[e];i||O(new N(r,"State",e,r),r),i.next[n]&&O(new Cn(r,"State",e,r),r),i.next[n]=t,i.actions[t]=n})),this},e.prototype.removeTransition=function(t,e){var n=this;return kr(t)||kr(e)||this.removeOneTransition(t,e),kr(t)&&!kr(e)&&t.forEach((function(t){return n.removeOneTransition(t,e)})),kr(e)&&!kr(t)&&e.forEach((function(e){return n.removeOneTransition(t,e)})),this},e.prototype.removeOneTransition=function(t,e){var n=this._states[t];if(n&&n.next[e]){var r=n.next[e];return delete n.next[e],delete n.actions[r],this}},e.prototype.addTransitions=function(t){var e=this;return t.forEach((function(t){return e.addTransition(t.action,t.from,t.to)})),this},e.prototype.removeTransitions=function(t){var e=this;return t.forEach((function(t){return e.removeTransition(t.from,t.to)})),this},e.prototype.hasTransition=function(t,e){var n=this._states[t];return!!n&&!!n.actions[e]},e.prototype.enter=function(){this.dispatch("enter")},e.prototype.onUpdate=function(t){if(this._current){var e=this._states[this._current];e&&e.update(t)}},e.prototype.dispatch=function(t){this._current&&this._states[this._current]||O(new Error('State "'+this._current+'" does not in this fsm now: "'+this.name+'"!'),this);var e=this._states[this._current];e.exit();var n=e.actions[t];return n&&this._states[n]||O(new Error('FromState "'+this._current+'" does not have action "'+t+'"!'),this),this._current=n,this._states[n].enter(),this},e.prototype.onDestroy=function(){this.reset()},e=g([C({className:"FSMComponent"})],e)}(H),Vr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isAnimatorComponent=!0,e._fsm=new jr("fsm"),e._loop=0,e._animations={},e._transitions={},e._parameters={},e.handleElementEnd=function(t){var n=t.name.value;if(e._transitions[n]){for(var r=e._transitions[n],i=r.conditions,o=r.length,s=r.array,a=0;a<o;a+=1){var u=s[a];if(i[u](e._parameters))return void e._fsm.dispatch(u)}e._fsm.dispatch("exit")}else e._fsm.dispatch("exit")},e.handleEnd=function(){if(!e._loop||e._loop<=0)return e._event.trigger("End",{name:e.current,animation:e._currentAnimation,actor:e._owner}),void(e._currentAnimation=null);e._event.trigger("Loop",{animation:e._currentAnimation,name:e._current,actor:e._owner}),e._fsm.dispatch(e._current),e._loop-=1},e}return p(e,t),Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fsm",{get:function(){return this._fsm},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parameters",{get:function(){return this._parameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animationNames",{get:function(){return Object.keys(this._fsm.getState("enter").next)},enumerable:!1,configurable:!0}),e.prototype.onInit=function(){this._event.register("Start"),this._event.register("Pause"),this._event.register("Resume"),this._event.register("Loop"),this._event.register("End"),this._fsm._parent=this,this._fsm.onExit.add(this.handleEnd)},e.prototype.onAdd=function(t){this.initFromComponent(t.componentName),this._owner._animator=this},e.prototype.setParameter=function(t,e){return this._parameters[t]=e,this},e.prototype.getParameter=function(t){return this._parameters[t]},e.prototype.getAnimation=function(t){return this._animations[t]||S.warn("Animation "+t+" is not existed in "+(this._owner&&this._owner.name)),this._animations[t]},e.prototype.initFromComponent=function(t){var e=this;void 0===t&&(t="root");var n=this._owner.findComponentByName(t);if(n.hiloNode.anim){var r=this._owner.name.value+"@",i=n.hiloNode.anim.clips;Object.keys(i).forEach((function(n){e.register(n.replace(r,""),new Br({componentName:t,clipName:n}))}))}},e.prototype.onUpdate=function(t){this._fsm.update(t)},e.prototype.onUnLink=function(){this.stop()},e.prototype.onDestroy=function(){this._currentAnimation&&!this._currentAnimation.paused&&this._currentAnimation.pause(),this._owner.animator===this&&(this._owner._animator=null),this._fsm.reset(),this._animations={}},e.prototype.register=function(t,e,n){var r=this;return void 0===n&&(n=!1),!n&&this._default||(this._default=t),e.name=new f(t),e.animator=this,e.handleEnd=this.handleElementEnd,e.handlePause=function(){return r._event.trigger("Pause",{animation:e,name:r._current,actor:r._owner})},e.handleResume=function(){return r._event.trigger("Resume",{animation:e,name:r._current,actor:r._owner})},this._fsm.addState(t,{onEnter:function(){r._currentAnimation=e,e.play(r._loop)},onUpdate:function(t){return e.update(t)}}),this.addTransition("enter",t,(function(){return!0})),this._fsm.addTransition("exit",t,"exit"),this._animations[t]=e,e.initialize(),this},e.prototype.unregister=function(t){return this._fsm.removeState(t),this._fsm.removeTransition("enter",t),this._animations[t]&&(this._animations[t].destroy(),delete this._animations[t]),this},e.prototype.setDefault=function(t){this._default=t},e.prototype.addTransition=function(t,e,n){return this._fsm.addTransition(e,t,e),this._transitions[t]=this._transitions[t]||{conditions:{},array:[],length:0},this._transitions[t].conditions[e]=n||function(){return!0},this._transitions[t].array.push(e),this._transitions[t].length+=1,this},e.prototype.setTransitionCondition=function(t,e,n){return this._transitions[t].conditions[e]=n,this},e.prototype.removeTransition=function(t,e){if(this._fsm.removeTransition(t,e),!this._transitions[t].conditions[e])return this;delete this._transitions[t].conditions[e];var n=this._transitions[t].array.indexOf(e);return this._transitions[t].array.splice(n,1),this._transitions[t].length-=1,this},e.prototype.clear=function(){return this.stop(),this._fsm=new jr("fsm"),this},e.prototype.has=function(t){return this._fsm.hasTransition("enter",t)},e.prototype.play=function(t,e){return this._fsm.getCurrentState().name.equalsTo("enter")||this.stop(),(t=t||this._default)?(this._loop=e||0,this._current=t,this._fsm.dispatch(t),this._event.trigger("Start",{animation:this._currentAnimation,name:this._current,actor:this._owner}),this):this},e.prototype.pause=function(){return this._currentAnimation.pause(),this},e.prototype.resume=function(){return this._currentAnimation.resume(),this},e.prototype.stop=function(){return this._currentAnimation&&!this._currentAnimation.paused&&this._currentAnimation.stop(),this._loop=0,this._fsm.reset(),this.handleEnd(),this},e=g([C({className:"AnimatorComponent"})],e)}(H),Xr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.MorphGeometry);function Wr(t){return t.isBSPComponent}var zr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBSPComponent=!0,e.needUpdateAndDestroy=!1,e}return p(e,t),e.prototype.onInit=function(e){var n=this.convertState(e);t.prototype.onInit.call(this,n)},e.prototype.convertState=function(t){return t},e=g([C({className:"BSPComponent"})],e)}(Jn);function qr(t){return t.isBSPMorphComponent}var Yr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBSPMorphComponent=!0,e}return p(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._mesh.geometry},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targets",{get:function(){return this.geometry.targets},set:function(t){this.geometry.targets=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.geometry.weights},set:function(t){this.geometry.weights=t},enumerable:!1,configurable:!0}),e.prototype.convertState=function(t){var e=t.weights,n=t.targets,r=t.geometry,i=_(t,["weights","targets","geometry"]),o={};return Object.keys(r).forEach((function(t){r[t].isGeometryData&&(o[t]=r[t])})),i.geometry=new Xr(o),r.isMorphGeometry?(i.geometry.targets=n||r.targets,i.geometry.weights=e||r.weights.slice()):(i.geometry.weights=e||[],i.geometry.targets=n||{}),i},e=g([C({className:"BSPMorphComponent"})],e)}(zr),Jr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",Yr,t)},e=g([C({className:"BSPMorphActor"})],e)}(Wn),Qr=function(t){function e(e){var n=t.call(this,{side:on.FRONT_AND_BACK,alphaMode:"BLEND",attributes:{a_position:"POSITION",a_uv:"TEXCOORD_0"},uniforms:m({u_modelViewProjectionMatrix:"SPRITEMODELVIEWPROJECTION",u_modelViewMatrix:"MODELVIEW",u_fogInfo:"FOGINFO",u_fogColor:"FOGCOLOR"},e.uniforms),vs:"\nprecision HILO_MAX_VERTEX_PRECISION float;\nattribute vec3 a_position;\nattribute vec2 a_uv;\nuniform mat4 u_modelViewProjectionMatrix;\nuniform mat3 u_uvMatrix;\n"+ln.shaders["chunk/lightFog.vert"]+"\nvarying vec2 v_uv;\n\nvoid main() {\nvec4 pos = vec4(a_position, 1.0);\nv_uv = (u_uvMatrix * vec3(a_uv, 1.)).xy;\n"+ln.shaders["chunk/lightFog_main.vert"]+"\n\ngl_Position = u_modelViewProjectionMatrix * pos;\n}\n",fs:"\nprecision HILO_MAX_FRAGMENT_PRECISION float;\nuniform sampler2D u_texture;\nuniform float u_opacity;\n"+ln.shaders["chunk/fog.frag"]+"\nvarying vec2 v_uv;\n\nvoid main() {\nvec4 color = texture2D(u_texture, v_uv);\nfloat a = color.a;\n"+ln.shaders["chunk/fog_main.frag"]+"\ncolor.a = a * u_opacity;\n\ngl_FragColor = color;\n}\n"})||this;return n.isSpriteMaterial=!0,n}return p(e,t),e=g([x({className:"SpriteMaterial"})],e)}(hn);function Zr(t){return t.isSpriteComponent}var Kr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSpriteComponent=!0,e._isBillboard=!1,e}return p(e,t),Object.defineProperty(e.prototype,"isBillboard",{get:function(){return this._isBillboard},set:function(t){this._isBillboard=t,this.getMaterial().isBillboard=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._currentFrame},enumerable:!1,configurable:!0}),e.prototype.onInit=function(e){var n;t.prototype.onInit.call(this,e);var r=new Ve;e.atlas?(n=e.atlas.texture,this._atlas=e.atlas,r.copy(this._atlas.getUVMatrix(e.frameName))):this._texture=n=e.texture,n.width=n.origWidth,n.height=n.origHeight;var i=void 0===e.opacity?1:e.opacity,o=new Re.PlaneGeometry({width:e.width,height:e.height}),s=e.material||new Qr({uniforms:{u_texture:{value:n},u_uvMatrix:{value:r},u_opacity:{value:i}}});e.material&&(s.setUniform("u_texture",n),s.setUniform("u_uvMatrix",r),s.setUniform("u_opacity",i)),e.materialOptions&&Object.assign(s,e.materialOptions),s.game=this.getGame(),this._mesh=new pn({geometry:o,material:s}),this._mesh.__forceUseParentWorldMatrix=!0,void 0!==e.frustumTest&&(this._mesh.frustumTest=e.frustumTest),this.isBillboard=e.isBillboard||!1,this._node.addChild(this._mesh);var a=this.getRoot();a&&a.hiloNode.addChild(this._node)},Object.defineProperty(e.prototype,"width",{get:function(){return this._initState.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._initState.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this._mesh.material.setUniform("u_texture",t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"atlas",{get:function(){return this._atlas},set:function(t){this._atlas!==t&&(this._atlas=t,this._mesh.material.setUniform("u_texture",t.getWholeTexture()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frustumTest",{get:function(){return this._mesh.frustumTest},set:function(t){this._mesh.frustumTest=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._mesh.material},enumerable:!1,configurable:!0}),e.prototype.getMaterial=function(){return this._mesh.material},e.prototype.setFrame=function(t){return this._mesh.material.setUniform("u_uvMatrix",this._atlas.getUVMatrix(t)),this._currentFrame=t,this},e.prototype.preRender=function(){this.getGame().renderer.renderMesh(this._mesh)},e=g([C({className:"SpriteComponent"})],e)}(rn),$r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",Kr,t)},e=g([C({className:"SpriteActor"})],e)}(Wn);function ti(t,n,r,i,o,s,a){void 0===s&&(s=!1),void 0===a&&(a=null);var u=!1,c=null,h=null;n&&(Xn(n)?c=n.root.hiloNode:(c=n.hiloNode,u=!0)),h=c&&c.gltfExtensions&&c.gltfExtensions.SEIN_node?c.gltfExtensions.SEIN_node:{};for(var l=r.length,f=function(c){var l=r[c];l.gltfExtensions=l.gltfExtensions||{},l.childrenOffset=0;var f=void 0,d=!1;l.gltfExtensions.SEIN_node&&(d=(f=l.gltfExtensions.SEIN_node).skipThisNode),(s||a)&&(f=f||{selfType:e.ESeinNodeType.Actor,childrenType:e.ESeinNodeType.Component}),s&&(f.selfType=e.ESeinNodeType.Component),a&&(f.className=a),f&&f.selfType===e.ESeinNodeType.Actor?u=!1:u||h.childrenType!==e.ESeinNodeType.Component||f&&f.selfType===e.ESeinNodeType.Actor?f&&f.selfType===e.ESeinNodeType.Component&&(u=!0):u=!0;var p=n;if(!d){if(p=function(t,e,n,r,i,o){var s,a=t.children[0],u=null,c=null,h={__fromGlTF:!0,matrix:t.matrix};if(t.gltfExtensions.SEIN_node&&t.gltfExtensions.SEIN_node.className){var l=t.gltfExtensions.SEIN_node.className;(s=I[l])?Object.assign(h,t.gltfExtensions.SEIN_node.initOptions||{}):S.warn("No class named '"+l+"', no effect, you must use decorator 'SClass' to annotate your class before use it !")}if(a)if(a.isSkinedMesh){for(var f=t.children.length,d=[],p=0;p<f&&(y=t.children[p]).isSkinedMesh;p+=1)d.push(y),t.childrenOffset+=1;f=d.length;var m=a,_=m.geometry,g=m.material;Object.assign(h,{__doNotUseMultiPrimitiveYourself:d,geometry:_,material:g}),r?(c=u=e.addComponent(t.name,s||vr,h,n),e.skeletalMeshComponents.push([c,d])):(c=(u=o.addActor(t.name,s||yr,h,e,n)).root).getOwner().skeletalMeshComponents=[[c,d]]}else if(a.isMesh){var v=t.children.length;for(d=[],p=0;p<v;p+=1){var y;if(!(y=t.children[p]).isMesh)break;d.push(y),t.childrenOffset+=1}v=d.length;var E=a;_=E.geometry,g=E.material,Object.assign(h,{__doNotUseMultiPrimitiveYourself:d,geometry:_,material:g}),c=_.isMorphGeometry?r?u=e.addComponent(t.name,s||Yr,h,n):(u=o.addActor(t.name,s||Jr,h,e,n)).root:r?u=e.addComponent(t.name,s||Jn,h,n):(u=o.addActor(t.name,s||Er,h,e,n)).root}else if(a.isFakeHiloSprite){var T=a.sprite,A=T.width,M=T.height,O=T.isBillboard,b=T.frustumTest,L=T.atlas,R=(g=a.material,L.frameName),C=(p=L.index,i.atlases[p]);Object.assign(h,{width:A,height:M,isBillboard:O,frustumTest:b,frameName:R,atlas:C,material:g,materialOptions:{alphaMode:"BLEND"}}),c=r?u=e.addComponent(t.name,s||Kr,h,n):(u=o.addActor(t.name,s||$r,h,e,n)).root,t.childrenOffset+=1}else if(a.isOrthographicCamera){var x=a,w=x.far,N=x.near,P=x.left,D=x.right,H=x.top,F=x.bottom,U=x.backgroundMat;Object.assign(h,{far:w,near:N,left:P,right:D,top:H,bottom:F,backgroundMat:U}),c=r?u=e.addComponent(t.name,s||Mn,h,n):(u=o.addActor(t.name,s||Tr,h,e,n)).root,t.childrenOffset+=1}else if(a.isPerspectiveCamera){var B=a,G=(w=B.far,N=B.near,B.fov),k=B.aspect;U=B.backgroundMat,Object.assign(h,{far:w,near:N,fov:G,aspect:k,backgroundMat:U}),c=r?u=e.addComponent(t.name,s||An,h,n):(u=o.addActor(t.name,s||Ar,h,e,n)).root,t.childrenOffset+=1}else if(a.isAmbientLight){var j=a,V=j.amount,X=j.color,W=j.shadow;Object.assign(h,{amount:V,color:X,shadow:W}),c=r?u=e.addComponent(t.name,s||br,h,n):(u=o.addActor(t.name,s||Lr,h,e,n)).root,t.childrenOffset+=1}else if(a.isDirectionalLight){var z=a,q=(V=z.amount,X=z.color,W=z.shadow,z.direction);Object.assign(h,{amount:V,color:X,shadow:W,direction:q}),c=r?u=e.addComponent(t.name,s||Rr,h,n):(u=o.addActor(t.name,s||Cr,h,e,n)).root,t.childrenOffset+=1}else if(a.isPointLight){var Y=a,J=(V=Y.amount,X=Y.color,W=Y.shadow,Y.range),Q=Y.constantAttenuation,Z=Y.linearAttenuation,K=Y.quadraticAttenuation;Object.assign(h,{amount:V,color:X,shadow:W,range:J,constantAttenuation:Q,linearAttenuation:Z,quadraticAttenuation:K}),c=r?u=e.addComponent(t.name,s||wr,h,n):(u=o.addActor(t.name,s||Nr,h,e,n)).root,t.childrenOffset+=1}else if(a.isSpotLight){var $=a,tt=(V=$.amount,X=$.color,W=$.shadow,J=$.range,Q=$.constantAttenuation,Z=$.linearAttenuation,K=$.quadraticAttenuation,$.cutoff),et=$.outerCutoff;q=$.direction,Object.assign(h,{amount:V,color:X,shadow:W,range:J,constantAttenuation:Q,linearAttenuation:Z,quadraticAttenuation:K,cutoff:tt,outerCutoff:et,direction:q}),c=r?u=e.addComponent(t.name,s||Dr,h,n):(u=o.addActor(t.name,s||Hr,h,e,n)).root,t.childrenOffset+=1}else c=r?u=e.addComponent(t.name,s||rn,h,n):(u=o.addActor(t.name,s||Wn,h,e,n)).root;else c=r?u=e.addComponent(t.name,s||rn,h,n):(u=o.addActor(t.name,s||Wn,h,e,n)).root;c.cloneFromHiloNode(t),c.needReleaseGlRes=!1;var nt=c.hiloNode.animationId;return r&&i.anim&&i.anim.validAnimationIds[nt]&&(e.animNameMap[nt]=c.hiloNode,e.animCount+=1),u}(l,n&&!Xn(n)?n.getOwner():n,n&&Xn(n)?null:n,u,o,t.world),Xn(p)){var m=p;m.animNameMap={},m.animCount=0,m.skeletalMeshComponents=m.skeletalMeshComponents||[];var _=m.root.hiloNode.animationId;o.anim&&o.anim.validAnimationIds[_]&&(m.animNameMap[_]=m.root.hiloNode,m.animCount+=1),i.add(m)}Object.keys(l.gltfExtensions).forEach((function(e){var n=Re.GLTFParser.extensionHandlers[e];n&&n.instantiate&&n.instantiate(p,l.gltfExtensions[e],t,l,o)}))}var g=l.childrenOffset||0;if(!l.children||l.children.length===g)return"continue";ti(t,p,l.children.slice(g),i,o)},d=0;d<l;d+=1)f(d)}function ei(t,e,n,r){if(e&&e.extensions&&e.extensions.SEIN_customMaterial){var i=e.extensions,o=e.alphaMode,s=e.doubleSided,a=i.SEIN_customMaterial,u=a.className,c=a.uniforms,h=a.cloneForInst,l=a.renderOrder,f=R[u];if(!f){if(r.ignoreMaterialError)return void S.warn('ShaderMaterial "'+u+"\" is not existed, Please ensure your material is decorated with 'Sein.SMaterial' !");throw new Error('ShaderMaterial "'+u+"\" is not existed, Please ensure your material is decorated with 'Sein.SMaterial' !")}var d={uniforms:{},doubleSided:s,alphaMode:o,renderOrder:l};if(c)for(var p in c){var m=c[p],g=m.type,v=m.value,y=null;switch(g){case on.SAMPLER_2D:y=r.textures[v.index];break;case on.SAMPLER_CUBE:y=r.cubeTextures[v.index];break;case on.FLOAT_VEC2:case on.INT_VEC2:(y=new Ge).fromArray(v);break;case on.FLOAT_VEC3:case on.INT_VEC3:(y=new ke).fromArray(v);break;case on.FLOAT_VEC4:case on.INT_VEC4:(y=new ze).fromArray(v);break;case on.FLOAT_MAT3:(y=new Ve).fromArray(v);break;case on.FLOAT_MAT4:(y=new Xe).fromArray(v);break;default:y=c[p].value}d.uniforms[p]={value:y}}var E=new f(d);void 0!==h&&(E.cloneForInst=h),E.initCommonOptions(d,!0),i.SEIN_customMaterial,i.Sein_customMaterial;var T=_(i,["SEIN_customMaterial","Sein_customMaterial"]);return r.parseExtensions(T,E,{isMaterial:!0}),E}}var ni=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._cache={},e._cacheNames={},e.isGlTFLoader=!0,e}return p(e,t),e.REGISTER_EXTENSION=function(t){if(t.parse){var e=t.parse;t.parse=function(n,r,i,o){return er(t.name),e(n,r,i,o)}}else t.parse=er(t.name);Re.GLTFParser.registerExtensionHandler(t.name,t);var n=t.name.replace("SEIN_","Sein_");n!==t.name&&Re.GLTFParser.registerExtensionHandler(n,t)},e.UNREGISTER_EXTENSION=function(t){Re.GLTFParser.unregisterExtensionHandler(t.name)},e.GET_EXTENSION_HANDLER=function(t){return Re.GLTFParser.extensionHandlers[t]},e.prototype.load=function(t,e){var n=this;if(this._cache[t.url])return this._cacheNames[t.url].push(t.name),t.result=this._cache[t.url],void e.onLoaded(t);var r=new Re.GLTFLoader;r.game=this.game,r.on("progress",(function(n){var r=n.detail,i=r.loaded,o=r.total;o>0&&e.onLoading(t,i/o)})),r.load({src:t.url,isProgressive:t.isProgressive||!1,customMaterialCreator:ei,isLoadAllTextures:!0,ignoreTextureError:t.ignoreTextureError,game:this.game,ignoreMaterialError:t.ignoreMaterialError||!1,forceCreateNewBuffer:t.forceCreateNewBuffer||!1}).then((function(r){t.result=r,n._cacheNames[t.url]=n._cacheNames[t.url]||[],n._cacheNames[t.url][t.name]=!0,n._cache[t.url]=t.result,e.onLoaded(t)})).catch((function(n){return e.onError(t,n)}))},e.prototype.instantiate=function(t,e){return function(t,e,n){var r=e.result,i=r.node;if(n&&n.nodePath&&0!==n.nodePath.length&&!(i=r.node.getChildByNamePath(n.nodePath)))throw new Error('Resource "'+e.name+'" in type "GlTF" dose not has node "'+n.nodePath.toString()+'" !');var o=null,s=new U;if(i!==r.node)o=[i];else{o=i.children.slice();var a=r.ambientLight;if(a&&!t.world.__gltfAmbientLightCreated){var u=new Re.Node;u.name=a.name,u.addChild(a),o.push(u),t.world.__gltfAmbientLightCreated=!0}}return n&&n.name&&1===o.length&&(o[0].name=n.name),ti(t,n&&(n.parentActor||n.parentComponent),o,s,r,n&&n.asComponent,n&&(n.className||n.Class&&n.Class.CLASS_NAME.value)),s.forEach((function(t){for(var e=t,i=e.animCount,o=e.animNameMap,s=e.skeletalMeshComponents,a=s.length,u=0;u<a;u+=1)for(var c=s[u],h=c[0],l=c[1],f=l.length,d=0;d<f;d+=1)h.cloneSkinningFromHilo(l[d],d);if(delete t.animCount,delete t.animNameMap,delete t.skeletalMeshComponents,i>0){var p=t.root.hiloNode;if(p.anim=r.anim.clone(null),p.anim.nodeNameMap=o,p.gltfExtensions.SEIN_animator){var m=p.gltfExtensions.SEIN_animator,_=m.modelAnimations,g=m.prefix,v=m.prefixes;if(0!==(a=_.length)){var y=p.anim.clips,E=p.anim.clips={};for(d=0;d<a;d+=1){var T=_[d],A=v&&v[d]||g;E[T]=y[A?A+"@"+T:T]}}}if(t.addComponent("animator",Vr),p.gltfExtensions.SEIN_animator){var S=p.gltfExtensions.SEIN_animator.defaultAnimation;S&&t.animator.setDefault(S)}}n.preRender&&t.preRender(),t.instantiated()})),s}(this.game,t,e)},e.prototype.release=function(t){var e=this._cacheNames[t.url];e&&(e.length>1?e.splice(e.indexOf(t.name),1):(delete this._cacheNames[t.url],delete this._cache[t.url],t.result.node.destroy(this.game.renderer,!0)))},e.clearCache=function(){Re.GLTFLoader.clearCache()},e.FORMATS=[".gltf",".glb"],e=g([C({className:"GlTFLoader"})],e)}(Fn);ni.REGISTER_EXTENSION(cr),ni.REGISTER_EXTENSION(rr),ni.REGISTER_EXTENSION(ir),ni.REGISTER_EXTENSION(or),ni.REGISTER_EXTENSION(sr),ni.REGISTER_EXTENSION(ar),ni.REGISTER_EXTENSION(hr),ni.REGISTER_EXTENSION(lr),ni.REGISTER_EXTENSION(pr),ni.REGISTER_EXTENSION(fr),ni.REGISTER_EXTENSION(mr),ni.REGISTER_EXTENSION({name:"SEIN_textureImprove",parse:function(t,e,n){return n.isImageCanRelease=t.isImageCanRelease,n.anisotropic=t.anisotropic||n.anisotropic,n.type=t.textureType||n.type,n}});var ri=function(t){function e(e){var n=t.call(this)||this;return n.isResourceManager=!0,n._onError=new w(n),n._onLoading=new w(n),n._onLoaded=new w(n),n._loaders={},n._loadersFormat={},n._queue={},n._store={},n._state={totalCount:0,loadedCount:0,progress:0,totalWeight:0,loadDone:!0,current:null},n.handleLoadingOne=function(t,e){if(n._queue[t.name]){var r=t.weight,i=t.preProgress;t.preProgress=e,n._state.current=t,n._state.progress+=r*(e-i)/n._state.totalWeight,n.onLoading.notify(Object.assign({},n._state))}},n.handleLoadedOne=function(t,e){void 0===e&&(e=null);var r=t.weight,i=t.preProgress;t.preProgress=1,n._state.current=t,n._state.progress+=r*(1-i)/n._state.totalWeight,n._state.loadedCount+=1,delete n._queue[t.name],e?n.onError.notify({error:e,state:Object.assign({},n._state)}):n._store[t.name]=t,n.onLoading.notify(Object.assign(e?{error:e}:{},n._state)),n._state.loadedCount===n._state.totalCount&&n.handleLoadDone()},n._game=e,n}return p(e,t),Object.defineProperty(e.prototype,"loadDone",{get:function(){return this._state.loadDone},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._game},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLoading",{get:function(){return this._onLoading},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLoaded",{get:function(){return this._onLoaded},enumerable:!1,configurable:!0}),e.prototype.getLoader=function(t){return this._loaders[t]},e.prototype.getLoaderByFormat=function(t){return this.getLoader(this._loadersFormat[t])},e.prototype.register=function(t,e){var n=this;if(this._loaders[t])throw new Cn(this,"Loader",t,this,"You should unregister it at first !");var r=new e;return r.game=this._game,this._loaders[t]=r,(e.FORMATS||[]).forEach((function(e){n._loadersFormat[e]=t})),this},e.prototype.unregister=function(t){var e=this;if(this._loaders[t])return(this._loaders[t].constructor||[]).FORMATS.forEach((function(t){delete e._loadersFormat[t]})),delete this._loaders[t],this},e.prototype.add=function(t,e,n){if(!this._loaders[t])throw new N(this,"Loader",t,this,"Register it before adding resource !");if(!this._store[e])return this._store[e]={name:e,result:n,type:t,url:""},this},e.prototype.has=function(t){return!!this._store[t]},e.prototype.get=function(t){return this._store[t]?this._store[t].result:(S.warn("Resource "+t+" is not existed !"),null)},e.prototype.release=function(t){var e=this._store[t];if(!e)throw new N(this,"Entity",t,this);return this._loaders[e.type].release(e),delete this._store[t],this},e.prototype.clear=function(){for(var t in this._store)this.release(t);return this},e.prototype.cancel=function(t){if(this._queue[t]){var e=this._queue[t].entity;return delete this._queue[t],this._loaders[e.type].cancel(e),this._state.loadedCount+=1,this._state.loadedCount===this._state.totalCount&&this.handleLoadDone(),this}},e.prototype.cancelAll=function(){for(var t in this._queue)this.cancel(t);return this},e.prototype.load=function(t){return v(this,void 0,void 0,(function(){var e,n,r,i=this;return y(this,(function(o){var s;if("function"==typeof t.url&&(t.url=t.url(this._game)),e=t.type||this._loadersFormat[(s=t.url,"."+s.split(".").pop())],!this._loaders[e])throw new N(this,"Loader",e,this,"Register it before adding resource !");return this._store[t.name]?[2,this._store[t.name]]:this._queue[t.name]?[2,this._queue[t.name]]:(n=this._loaders[e],t.type=e,t.weight=t.weight||1,t.preProgress=0,t.canceled=!1,this._state.totalCount+=1,this._state.totalWeight+=t.weight,this._state.loadDone=!1,r=new Promise((function(e,r){n.load(t,{onLoading:i.handleLoadingOne,onLoaded:function(){i._queue[t.name]&&(i.handleLoadedOne(t),e(t.result))},onError:function(e,n){if(i._queue[t.name]){var o=n.stack;(n=new Hn(t.name,i,n.message)).stack=o,i.handleLoadedOne(t,n),r(n)}}})})),this._queue[t.name]={pending:r,entity:t},[2,this._queue[t.name].pending])}))}))},e.prototype.instantiate=function(t,e){var n=this._store[t];if(!n)throw new N(this,"Entity",t,this);return this._loaders[n.type].instantiate(n,e||{})},e.prototype.handleLoadDone=function(){ni.clearCache(),this._state.loadDone=!0,this._state.progress=1;var t=Object.assign({},this._state);this._state.totalCount=0,this._state.loadedCount=0,this._state.totalWeight=0,this._state.progress=0,this._state.current=null,this.onLoaded.notify(t)},e.prototype.onDestroy=function(){this._state.loadDone||this.cancelAll(),this.clear(),this._loaders={}},e=g([C({className:"ResourceManager"})],e)}(L),ii=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isImageLoader=!0,e}return p(e,t),e.prototype.load=function(t,e){return v(this,void 0,void 0,(function(){var n;return y(this,(function(r){return(n=document.createElement("img")).onload=function(){n.onerror=null,n.onabort=null,n.onload=null,t.canceled||(t.result=n,e.onLoaded(t))},n.onerror=function(){e.onError(t,new Error("Error when loading "+t.url))},n.crossOrigin=t.crossOrigin?"Anonymous":"",n.src=t.url,[2]}))}))},e=g([C({className:"ImageLoader"})],e)}(Fn),oi=new Re.TextureLoader,si=new Re.HDRLoader,ai=new Re.KTXLoader,ui=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTextureLoader=!0,e}return p(e,t),e.prototype.load=function(t,e){(t.hdr||/.hdr$/.test(t.url)?si:t.ktx||/.ktx$/.test(t.url)?ai:oi).load({src:t.url,crossOrigin:t.crossOrigin||!1,uv:t.uv||0,flipY:t.flipY,isImageCanRelease:t.isImageCanRelease}).then((function(n){t.result=n,e.onLoaded(t)})).catch((function(n){return e.onError(t,n)}))},e.prototype.release=function(t){t.result.destroy()},e.EXTENSIONS=[".png",".jpg",".bmp",".hdr",".ktx"],e=g([C({className:"TextureLoader"})],e)}(Fn),ci=B((function(t,e){var r;r=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=t,n.c=e,n.p="",n(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var r=n(2),i=n(3),o=n(5),s=n(6);function a(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var u=a(s);u.Axios=o,u.create=function(t){return a(r.merge(s,t))},u.Cancel=n(22),u.CancelToken=n(23),u.isCancel=n(19),u.all=function(t){return Promise.all(t)},u.spread=n(24),t.exports=u,t.exports.default=u},function(t,e,n){var r=n(3),i=n(4),o=Object.prototype.toString;function s(t){return"[object Array]"===o.call(t)}function a(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===o.call(t)}function c(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),s(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:s,isArrayBuffer:function(t){return"[object ArrayBuffer]"===o.call(t)},isBuffer:i,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:u,isStream:function(t){return a(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function t(){var e={};function n(n,r){"object"==typeof e[r]&&"object"==typeof n?e[r]=t(e[r],n):e[r]=n}for(var r=0,i=arguments.length;r<i;r++)c(arguments[r],n);return e},extend:function(t,e,n){return c(e,(function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e){t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e){
/*!
  	 * Determine if an object is a Buffer
  	 *
  	 * @author   Feross Aboukhadijeh <https://feross.org>
  	 * @license  MIT
  	 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,n){var r=n(6),i=n(2),o=n(16),s=n(17);function a(t){this.defaults=t,this.interceptors={request:new o,response:new o}}a.prototype.request=function(t){"string"==typeof t&&(t=i.merge({url:arguments[0]},arguments[1])),(t=i.merge(r,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[s,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},i.forEach(["delete","get","head","options"],(function(t){a.prototype[t]=function(e,n){return this.request(i.merge(n||{},{method:t,url:e}))}})),i.forEach(["post","put","patch"],(function(t){a.prototype[t]=function(e,n,r){return this.request(i.merge(r||{},{method:t,url:e,data:n}))}})),t.exports=a},function(t,e,r){var i=r(2),o=r(7),s={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!i.isUndefined(t)&&i.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==n)&&(u=r(8)),u),transformRequest:[function(t,e){return o(e,"Content-Type"),i.isFormData(t)||i.isArrayBuffer(t)||i.isBuffer(t)||i.isStream(t)||i.isFile(t)||i.isBlob(t)?t:i.isArrayBufferView(t)?t.buffer:i.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):i.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(t){c.headers[t]={}})),i.forEach(["post","put","patch"],(function(t){c.headers[t]=i.merge(s)})),t.exports=c},function(t,e,n){var r=n(2);t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},function(t,e,n){var r=n(2),i=n(9),o=n(12),s=n(13),a=n(14),u=n(10);t.exports=function(t){return new Promise((function(e,c){var h=t.data,l=t.headers;r.isFormData(h)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",p=t.auth.password||"";l.Authorization="Basic "+btoa(d+":"+p)}if(f.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),f.timeout=t.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?s(f.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:t,request:f};i(e,c,r),f=null}},f.onerror=function(){c(u("Network Error",t,null,f)),f=null},f.ontimeout=function(){c(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var m=n(15),_=(t.withCredentials||a(t.url))&&t.xsrfCookieName?m.read(t.xsrfCookieName):void 0;_&&(l[t.xsrfHeaderName]=_)}if("setRequestHeader"in f&&r.forEach(l,(function(t,e){void 0===h&&"content-type"===e.toLowerCase()?delete l[e]:f.setRequestHeader(e,t)})),t.withCredentials&&(f.withCredentials=!0),t.responseType)try{f.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&f.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){f&&(f.abort(),c(t),f=null)})),void 0===h&&(h=null),f.send(h)}))}},function(t,e,n){var r=n(10);t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){var r=n(11);t.exports=function(t,e,n,i,o){var s=new Error(t);return r(s,e,n,i,o)}},function(t,e){t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t}},function(t,e,n){var r=n(2);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var s=[];r.forEach(e,(function(t,e){null!=t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),s.push(i(e)+"="+i(t))})))})),o=s.join("&")}return o&&(t+=(-1===t.indexOf("?")?"?":"&")+o),t}},function(t,e,n){var r=n(2),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,s={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(s[e]&&i.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},function(t,e,n){var r=n(2);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){var r=n(2);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){var r=n(2);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},function(t,e,n){var r=n(2),i=n(18),o=n(19),s=n(6),a=n(20),u=n(21);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!a(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return c(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(c(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,n){var r=n(2);t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},function(t,e){t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e){t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e){t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e){function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,n){var r=n(22);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i((function(e){t=e})),cancel:t}},t.exports=i},function(t,e){t.exports=function(t){return function(e){return t.apply(null,e)}}}])},t.exports=r()})),hi=function(){function t(){}return t.get=ci.get,t.post=ci.post,t.delete=ci.delete,t.put=ci.put,t.patch=ci.patch,t.request=ci.request,t}(),li=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isAtlasLoader=!0,e}return p(e,t),e.prototype.load=function(t,e){return v(this,void 0,void 0,(function(){var n,r,i,o,s;return y(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,hi.get(t.url)];case 1:if(!(n=a.sent().data))throw new Error("Load resource error: "+t.name);return e.onLoading(t,.1),function(t){return"/"===t[0]||/^(http|https):\/\//.test(t)}(r=n.meta.image)||function(t){return/^data:(.+?);base64,/.test(t)}(r)||(i=t.url.split("/").pop(),r=""+t.url.replace(i,"")+n.meta.image),(o=document.createElement("img")).onload=function(){o.onerror=null,o.onabort=null,o.onload=null,t.canceled||(t.result=new $n({image:o,frames:n.frames,meta:n.meta},t.updatable||!1),e.onLoaded(t))},o.onerror=function(){e.onError(t,new Error("Error when loading "+t.name))},o.crossOrigin=t.crossOrigin?"Anonymous":"",o.src=r,[3,3];case 2:return s=a.sent(),e.onError(t,s),[3,3];case 3:return[2]}}))}))},e.prototype.instantiate=function(t,e){throw new Error("Not implemented !")},e.prototype.release=function(t){t.result.destroy()},e.EXTENSIONS=[".atlas"],e=g([C({className:"AtlasLoader"})],e)}(Fn),fi=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.isEventTrigger=!0,i.autoFlush=!0,i._type=null,i._eventManager=null,i._paused=!0,i._objHasGame=null,i.trigger=function(t){try{i.onTrigger(t)}catch(t){O(t,i)}return i},i._type=new f(e),i._eventManager=n,i._objHasGame=r,i}return p(e,t),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._eventManager},enumerable:!1,configurable:!0}),e.prototype.getGame=function(){return this._objHasGame.getGame()},e.prototype.onBegin=function(){},e.prototype.onPause=function(){},e.prototype.onTrigger=function(t){this._eventManager.trigger(this._type.value,t,this.autoFlush)},e.prototype.begin=function(){this._paused=!1;try{this.onBegin()}catch(t){O(t,this)}return this},e.prototype.pause=function(){this._paused=!0;try{this.onPause()}catch(t){O(t,this)}return this},e.prototype.destroy=function(){this.pause()},e=g([C({className:"EventTrigger",classType:"EventTrigger"})],e)}(L);function di(t,e){return function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.isKeyBoardEventTrigger=!0,t.autoFlush=!1,t}return p(r,n),r.prototype.onBegin=function(){window.addEventListener(e,this.trigger)},r.prototype.onTrigger=function(e){"KeyDownTrigger"!==t&&e.preventDefault(),e.stopPropagation(),n.prototype.onTrigger.call(this,e)},r.prototype.onPause=function(){window.removeEventListener(e,this.trigger)},r=g([C({className:t})],r)}(fi)}var pi=di("KeyDownTrigger","keydown"),mi=di("KeyPressTrigger","keypress"),_i=di("KeyUpTrigger","keyup");function gi(t,e){return function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.isTouchEventTrigger=!0,t.autoFlush=!1,t}var i;return p(r,n),i=r,r.prototype.onBegin=function(){this.getGame().canvas.addEventListener(e,this.trigger)},r.prototype.onTrigger=function(t){i.needPreventDefault&&t.preventDefault(),i.needStopPropagation&&t.stopPropagation(),n.prototype.onTrigger.call(this,t)},r.prototype.onPause=function(){this.getGame().canvas.removeEventListener(e,this.trigger)},r.needPreventDefault=!0,r.needStopPropagation=!0,r=i=g([C({className:t})],r)}(fi)}var vi=gi("TouchStartTrigger","touchstart"),yi=gi("TouchEndTrigger","touchend"),Ei=gi("TouchMoveTrigger","touchmove"),Ti=gi("TouchCancelTrigger","touchcancel");function Ai(t,e){return function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.isMouseEventTrigger=!0,t.autoFlush=!1,t}return p(r,n),r.prototype.onBegin=function(){this.getGame().canvas.addEventListener(e,this.trigger)},r.prototype.onTrigger=function(t){t.preventDefault(),t.stopPropagation(),n.prototype.onTrigger.call(this,t)},r.prototype.onPause=function(){this.getGame().canvas.removeEventListener(e,this.trigger)},r=g([C({className:t})],r)}(fi)}var Si=Ai("MouseClickTrigger","click"),Mi=Ai("MouseDownTrigger","mousedown"),Oi=Ai("MouseUpTrigger","mouseup"),bi=Ai("MouseEnterTrigger","mouseenter"),Li=Ai("MouseLeaveTrigger","mouseleave"),Ii=Ai("MouseMoveTrigger","mousemove"),Ri=Ai("MouseOutTrigger","mouseout"),Ci=Ai("MouseOverTrigger","mouseover"),xi=Ai("MouseWheelTrigger","mousewheel"),wi=Ai("WheelTrigger","wheel"),Ni=Ai("ContextMenuTrigger","contextmenu"),Pi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMouseEventTrigger=!0,e.autoFlush=!1,e}return p(e,t),e.prototype.onBegin=function(){window.addEventListener("resize",this.trigger)},e.prototype.onPause=function(){window.removeEventListener("resize",this.trigger)},e=g([C({className:"WindowResizeTrigger"})],e)}(fi),Di=function(t){function e(e,n){var r=t.call(this,e)||this;return r.isPlayer=!0,r._game=n,r}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._game},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){return this._controller},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._controller.state},enumerable:!1,configurable:!0}),e.prototype.onInit=function(){},e.prototype.onSwitchController=function(t){},e.prototype.onReleaseController=function(t){},e.prototype.onUpdate=function(t){},e.prototype.onError=function(t,e){},e.prototype.switchController=function(t){if(t.player)throw new gn(this,"Controller "+t.name+" already owned by player "+t.parent.name+" !");this._controller=t,t._player=this;try{this.onSwitchController(t)}catch(t){O(t,this)}return this},e.prototype.releaseController=function(){try{this.onReleaseController(this._controller)}catch(t){O(t,this)}return this._controller&&(this._controller._player=null),this._controller=null,this},e.prototype.getController=function(){return this._controller},e.prototype.getState=function(){return this._controller.getState()},e.prototype.getGame=function(){return this._game},e.prototype.getWorld=function(){return this._game.world},e.prototype.getLevel=function(){return this._game.level},e.prototype.getPhysicWorld=function(){return this._game.world.physicWorld},e.prototype.update=function(t){try{this.onUpdate(t)}catch(t){O(t,this)}},e.prototype.destroy=function(){this._controller&&(this._controller._player=null),this._controller=null,this._game=null,t.prototype.destroy.call(this)},e=g([C({className:"Player"})],e)}(L),Hi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInfoActor=!0,e.updatePriority=n.UPDATE_PRIORITY.Others,e}var n;return p(e,t),n=e,e.UPDATE_PRIORITY={System:1e3,GameMode:2e3,LevelScript:3e3,State:4e3,Others:-1},e=n=g([C({className:"InfoActor"})],e)}(Nn),Fi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStateActor=!0,e.updatePriority=Hi.UPDATE_PRIORITY.State,e}return p(e,t),e.prototype.copy=function(t){if(t)return this},e=g([C({className:"StateActor"})],e)}(Hi),Ui=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSystemActor=!0,e.updatePriority=Hi.UPDATE_PRIORITY.System,e}return p(e,t),e=g([C({className:"SystemActor"})],e)}(Hi),Bi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPhysicSystemActor=!0,e}return p(e,t),e.prototype.onUpdate=function(t){var e=this.getWorld();e&&e.physicWorld&&e.physicWorld.update(t)},e=g([C({className:"PhysicSystemActor"})],e)}(Ui),Gi=new Re.CubeTextureLoader,ki=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCubeTextureLoader=!0,e}return p(e,t),e.prototype.load=function(t,e){var n=t.url,r=t.images,i=n&&"/"!==n[n.length-1]?t.url+"/":t.url;Gi.load({left:i+r.left,right:i+r.right,front:i+r.front,back:i+r.back,top:i+r.top,bottom:i+r.bottom,crossOrigin:t.crossOrigin||!1,uv:t.uv||0,flipY:t.flipY,format:t.format||on.RGB,internalFormat:t.internalFormat||on.RGB,isImageCanRelease:t.isImageCanRelease}).then((function(n){t.result=n,e.onLoaded(t)})).catch((function(n){return e.onError(t,n)}))},e.prototype.release=function(t){t.result.destroy()},e=g([C({className:"CubeTextureLoader"})],e)}(Fn);function ji(t){return t.isGame}var Vi=function(t){function e(e,n,r,i){void 0===r&&(r=Fi),void 0===i&&(i=null);var o=t.call(this,e)||this;o.isGame=!0,o.deviceInfo={touchable:!(!window||!("ontouchstart"in window))},o._engine=null,o._resource=null,o._event=null,o._hid=null,o._worldsMeta={},o._defaultWorldName=null,o._world=null,o._actors=new U,o._actorsForUpdate=new U,o._actorsNeedUpdate=!1,o._actorsPriorities=[],o._actorsPriorityCount={},o._players=new xn,o._defaultPlayer=null,o._paused=!0,o._hiloStage=null,o._initState=i,o._hiloStage=new Re.Stage(n),o._hiloStage.needCallChildUpdate=!1,o._resource=new ri(o),o._event=new P(o),o._hid=new P(o),o._state=o.addActor("game-state",r),o._state.copy(o._initState),o.canvas.style.width="",o.canvas.style.height="",o.initEvents(),o.initLoaders(n),o.initSystems();try{o.onInit()}catch(t){O(t,o)}return o._event.trigger("GameDidInit",{game:o}),o}return p(e,t),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"event",{get:function(){return this._event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hid",{get:function(){return this._hid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fps",{get:function(){return this._engine.options.fps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._engine},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"game",{get:function(){return this},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"world",{get:function(){return this._world},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._world.level},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"players",{get:function(){return this._players},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actors",{get:function(){return this._actors},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resource",{get:function(){return this._resource},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ticker",{get:function(){return this._engine.ticker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._hiloStage.canvas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenWidth",{get:function(){return this.canvas.offsetWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenHeight",{get:function(){return this.canvas.offsetHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bound",{get:function(){return this.canvas.getBoundingClientRect()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenAspect",{get:function(){var t=this.canvas;return t.offsetWidth/t.offsetHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"env",{get:function(){return S.env},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"devMode",{get:function(){return S.devMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderer",{get:function(){return this._hiloStage.renderer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hiloStage",{get:function(){return this._hiloStage},enumerable:!1,configurable:!0}),e.prototype.getGame=function(){return this},e.prototype.getEvent=function(){return this._event},e.prototype.getHID=function(){return this._hid},e.prototype.getResource=function(){return this._resource},e.prototype.setOption=function(t,e){this._hiloStage.renderer[t]=e,this._initState[t]=e},e.prototype.getOption=function(t){return this._initState[t]},e.prototype.onInit=function(){},e.prototype.onAdd=function(){},e.prototype.onStart=function(){},e.prototype.onPause=function(){},e.prototype.onResume=function(){},e.prototype.onError=function(t,e){},e.prototype.onUpdate=function(t){},e.prototype.onDestroy=function(){},e.prototype.addWorld=function(t,e,n,r){return void 0===r&&(r=!1),this._worldsMeta[t]={GameMode:e,levels:{persistent:{Script:n}}},(r||Object.keys(this._worldsMeta).length<2)&&(this._defaultWorldName=t),this},e.prototype.removeWorld=function(t){if(this._world.name.equalsTo(t))throw new gn(this,"World "+t+" is running could not be removed !");return this._world.destroy(),delete this._worldsMeta[t],this},e.prototype.switchWorld=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!1),v(this,void 0,void 0,(function(){var r,i,o,s,a;return y(this,(function(u){switch(u.label){case 0:if(!this._worldsMeta[t])throw new N(this,"World",t,this);return(i=this._world)&&(r=i.destroy(!n)),o=this._worldsMeta[t],s=o.GameMode,a=o.levels,this._world=new bn(t,s,a,this),[4,this._world.init(e)];case 1:return u.sent(),r&&n?[4,this._world.switchLevel("persistent",null,r)]:[3,3];case 2:return u.sent(),[3,5];case 3:return[4,this.switchLevel("persistent")];case 4:u.sent(),u.label=5;case 5:return[2]}}))}))},e.prototype.addLevel=function(t,e,n){if(!this._worldsMeta[t])throw new N(this,"World",t,this);if(this._worldsMeta[t].levels[e])throw new Cn(this,"Level of world "+t,e,this);return this._worldsMeta[t].levels[e]={Script:n},this},e.prototype.removeLevel=function(t,e){if(this._worldsMeta[t]){if(this._world.name.equalsTo(t)&&this.level.name.equalsTo(e))throw new gn(this,"Level "+t+" in world "+this._world.name+" is running could not be removed !");return delete this._worldsMeta[t].levels[e],this}},e.prototype.switchLevel=function(t,e){return void 0===e&&(e=null),this._world.switchLevel(t,e)},e.prototype.addActor=function(t,e,n){var r=new e(t,this,n);if(this.devMode)try{r.verifyAdding(n)}catch(t){return void O(t,r)}r.initialized();var i=r.updatePriority,o=this._actorsPriorities,s=this._actorsPriorityCount,a=s[i];if(i===Hi.UPDATE_PRIORITY.Others)this._actors.add(r);else{for(var u=o.length,c=0,h=0;h<u;h+=1){var l=o[h];if(i<l)break;c+=s[l]}void 0===a&&(a=0,o.push(i),o.sort()),s[i]=a+1,this._actors.insert(c,r)}return r._parent=this,r.added(),this._actorsNeedUpdate=!0,r},e.prototype.removeActor=function(t){t.destroy(),t._parent=null,this._actors.remove(t);var e=t.updatePriority,n=this._actorsPriorities,r=this._actorsPriorityCount,i=r[e];return e!==Hi.UPDATE_PRIORITY.Others&&(i-=1),0===i&&(delete r[i],n.splice(n.indexOf(e),1)),this._actorsNeedUpdate=!0,this},e.prototype.createPlayer=function(t,e,n){return void 0===n&&(n=!1),e?this._players.set(t,new e(t,this)):this._players.set(t,new Di(t,this)),(n||this._players.empty)&&(this._defaultPlayer=t),this._players.get(t)},e.prototype.getPlayer=function(t){return!t&&this._defaultPlayer&&(t=this._defaultPlayer),this._players.get(t)},e.prototype.removePlayer=function(t){return this._players.remove(t).releaseController(),this},e.prototype.clearPlayers=function(){return this._players.forEach((function(t){t.releaseController()})),this._players.clear(),this},e.prototype.initLoaders=function(t){this._resource.register("GlTF",ni),this._resource.register("Image",ii),this._resource.register("Texture",ui),this._resource.register("CubeTexture",ki),this._resource.register("Atlas",li),t.amcMemPages&&(ni.GET_EXTENSION_HANDLER("ALI_amc_mesh_compression").memPages=t.amcMemPages)},e.prototype.initEvents=function(){var t=this;this._hid.register("MouseClick",Si),this._hid.register("MouseDown",Mi),this._hid.register("MouseEnter",bi),this._hid.register("MouseLeave",Li),this._hid.register("MouseMove",Ii),this._hid.register("MouseOut",Ri),this._hid.register("MouseOver",Ci),this._hid.register("MouseUp",Oi),this._hid.register("MouseWheel",xi),this._hid.register("Wheel",wi),this._hid.register("ContextMenu",Ni),this._hid.register("KeyDown",pi),this._hid.register("KeyUp",_i),this._hid.register("KeyPress",mi),this._hid.register("TouchStart",vi),this._hid.register("TouchEnd",yi),this._hid.register("TouchMove",Ei),this._hid.register("TouchCancel",Ti),this._event.register("Resize",Pi),this._event.register("GameDidInit"),this._event.register("GameDidStart"),this._event.register("GameWillPause"),this._event.register("GameDidResume"),this._event.register("GameWillDestroy"),this._event.register("WorldDidInit"),this._event.register("WorldDidCreatePlayers"),this._event.register("WorldWillDestroy"),this._event.register("LevelDidInit"),this._event.register("LevelWillPreload"),this._event.register("LevelIsPreloading"),this._event.register("LevelDidPreload"),this._event.register("LevelDidCreateActors"),this._event.register("LevelWillDestroy"),this._event.register("WebglContextLost"),this._event.register("WebglContextRestored"),this._event.register("MainRendererWillStart"),this._event.register("MainRendererIsCleared"),this._event.register("MainRendererIsFinished"),this._hiloStage.renderer.on("webglContextLost",(function(){return t._event.trigger("WebglContextLost")})),this._hiloStage.renderer.on("webglContextRestored",(function(){return t._event.trigger("WebglContextRestored")})),this._hiloStage.renderer.on("beforeRenderScene",(function(){return t._event.trigger("MainRendererIsCleared")})),this.event.add("Resize",(function(){return t.resize()}))},e.prototype.initSystems=function(){this.game.addActor("physicSystem",Bi)},e.prototype.resize=function(t){var e=this,n=(t=t||this.bound).width,r=t.height,i=this._hiloStage,o=i.pixelRatio,s=i.renderer;return this._hiloStage.width=n,this._hiloStage.height=r,s.resize(n*o,r*o,!0),this.world&&setTimeout((function(){return e.world.resizeMainCamera()}),0),this},e.prototype.start=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:if(!this._defaultWorldName)throw new En(this,"A default world must be specified !");return this.resize(),[4,this.switchWorld(this._defaultWorldName)];case 1:return t.sent(),this._engine?(this._engine.startGame(this),this._paused=!1,this._event.trigger("GameDidStart",{game:this}),[2,this]):[2,this]}}))}))},e.prototype.pause=function(){if(!this._paused)return this._event.trigger("GameWillPause",{game:this}),this._engine.pauseGame(this),this._paused=!0,this},e.prototype.resume=function(){if(this._paused)return this._engine.resumeGame(this),this._paused=!1,this._event.trigger("GameDidResume",{game:this}),this},e.prototype.destroy=function(){t.prototype.destroy.call(this),this._paused=!0,this._event.trigger("GameWillDestroy",{game:this}),this._engine.destroyGame(this),this._engine=null,this._hid.destroy(),this._event.destroy(),this._world.destroy(),this.removeActor(this._state),this._actors.forEach((function(t){return t.destroy()})),this._actors.clear(),this._hiloStage.destroy(),this._resource.destroy()},e.prototype.update=function(t){this._hid.flushAll(),this._event.flushAll();try{this.onUpdate(t)}catch(t){O(t,this)}this._actorsNeedUpdate&&(this._actorsForUpdate.copy(this._actors),this._actorsNeedUpdate=!1),this._actorsForUpdate.forEach((function(e){return e.update(t)})),this._players.forEach((function(e){return e.update(t)})),this.world&&this.world.update(t)},e=g([C({className:"Game",classType:"Game"})],e)}(L),Xi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isGameModeActor=!0,e.updatePriority=Hi.UPDATE_PRIORITY.GameMode,e}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._game},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this.getWorld().state},enumerable:!1,configurable:!0}),e.prototype.onLogin=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2]}))}))},e.prototype.onCreatePlayers=function(){this._game.createPlayer("player",null,!0)},e.prototype.onDestroyPlayers=function(){},e.WorldStateClass=Fi,e=g([C({className:"GameModeActor"})],e)}(Hi),Wi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLevelScriptActor=!0,e.updatePriority=Hi.UPDATE_PRIORITY.LevelScript,e}return p(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._game.world},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this.getLevel().state},enumerable:!1,configurable:!0}),e.prototype.onLogin=function(){return v(this,void 0,void 0,(function(){return y(this,(function(t){return[2]}))}))},e.prototype.onPreload=function(){},e.prototype.onLoading=function(t){},e.prototype.onCreate=function(){},e.LevelStateClass=Fi,e=g([C({className:"LevelScriptActor"})],e)}(Hi),zi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTimerActor=!0,e._state={times:0,timeStep:0,current:0},e._delta=0,e._paused=!1,e._stopped=!1,e}return p(e,t),Object.defineProperty(e.prototype,"event",{get:function(){return this._root.event},enumerable:!1,configurable:!0}),e.prototype.onInit=function(){this.event.register("Start"),this.event.register("Pause"),this.event.register("Resume"),this.event.register("Step"),this.event.register("End")},e.prototype.onUpdate=function(t){this._stopped?this._delta=0:this._delta<this._state.timeStep?this._delta+=t:(this._delta=0,this._state.current!==this._state.times?(this._state.current+=1,this.event.trigger("Step",this._state)):this.stop())},e.prototype.start=function(t,e){return this._state.times=t,this._state.timeStep=e,this._state.current=0,this.event.trigger("Start",this._state),this._paused=!1,this._stopped=!1,this},e.prototype.pause=function(){if(!this._paused&&!this._stopped)return this._paused=!0,this.event.trigger("Pause",this._state),this},e.prototype.resume=function(){if(!this._stopped&&this._paused)return this._delta=0,this.event.trigger("Resume",this._state),this._paused=!1,this},e.prototype.stop=function(){return this._stopped=!0,this.event.trigger("End",this._state),this},e=g([C({className:"Timer",classType:"Timer"})],e)}(Hi),qi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._table={},e}return p(e,t),e.prototype.add=function(t){if(!this._table[t.uuid])return this.addItem(t),this._table[t.uuid]=t,this},e.prototype.remove=function(t){if(this._table[t.uuid])return this.removeItem(t),delete this._table[t.uuid],this},e.prototype.clear=function(){return t.prototype.clear.call(this),this._table={},this},e.prototype.fromArray=function(t){this.clear();for(var e=t.length,n=0;n<e;n+=1)this.add(t[n]);return this},e}(F),Yi=function(t){function e(e,n,r,i){void 0===i&&(i="");var o=t.call(this,"TypeConflict",r,'Type of "'+e.name+'" is "'+e.classType+'", but type "'+n+'" is required. "'+parent.name+'". '+i)||this;return o.isTypeConflictException=!0,o}return p(e,t),e}(M),Ji=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isControllerActor=!0,e._follow=!1,e}return p(e,t),Object.defineProperty(e.prototype,"actor",{get:function(){return this._actor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.onPossesActor=function(t){},e.prototype.onDisPossesActor=function(t){},e.prototype.possessActor=function(t){if(this._actor)throw new gn(this,"Controller "+this.name+" already has actor "+this.actor.name+" !");if(t._controller)throw new gn(this,"Actor "+t.name+" already controlled by controller "+t.getController().name+" !");this._actor=t,this._actor._controller=this;try{this.onPossesActor(t)}catch(t){O(t,this)}return this},e.prototype.dispossessActor=function(t){try{this.onDisPossesActor(this._actor)}catch(t){O(t,this)}return this._actor&&(this._actor.controller=null),this._actor=null,t&&t.possessActor(this),this},e.prototype.getActor=function(){return this._actor},e.prototype.switchState=function(t){return t.controller&&(t.controller._state=null),this._state=t,t._controller=this,this},e.prototype.getState=function(){return this._state},e.prototype.followActor=function(){return this._follow=!0,this},e.prototype.unFollowActor=function(){return this._follow=!1,this},e.prototype.added=function(){t.prototype.added.call(this);var e=this._initOptions;e.state&&this.switchState(e.state),e.actor&&this.possessActor(e.actor),this._follow=!!e.followActor},e.prototype.update=function(e){t.prototype.update.call(this,e),this._follow&&this._actor&&this.transform.matrix.copy(this._actor.transform.matrix)},e=g([C({className:"ControllerActor",classType:"Controller"})],e)}(Wn),Qi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlayerControllerActor=!0,e.persistent=!0,e}return p(e,t),Object.defineProperty(e.prototype,"player",{get:function(){return this._player},enumerable:!1,configurable:!0}),e.prototype.setPlayer=function(t){return t.switchController(this),this},e.prototype.onDestroy=function(){this._player&&this._player.releaseController(),t.prototype.onDestroy.call(this)},e=g([C({className:"PlayerControllerActor"})],e)}(Ji),Zi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlayerStateActor=!0,e}return p(e,t),e.prototype.getController=function(){return this._controller},e=g([C({className:"PlayerStateActor"})],e)}(Fi),Ki=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isAIControllerActor=!0,e}return p(e,t),e=g([C({className:"AIControllerActor"})],e)}(Ji),$i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Fog),to=function(t){function e(e,n){return t.call(this,e.renderer,n)||this}return p(e,t),e}(Re.Framebuffer),eo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isRenderSystemActor=!0,e.handlePreRender=function(){return e.onPreRender(e._initOptions)},e.handlePostClear=function(){return e.onPostClear(e._initOptions)},e.handlePostRender=function(){return e.onPostRender(e._initOptions)},e}return p(e,t),e.prototype.onInit=function(t){this.bindEvents()},e.prototype.onUnLink=function(){this.unBindEvents()},e.prototype.onReLink=function(){this.bindEvents()},e.prototype.onPreRender=function(t){},e.prototype.onPostClear=function(t){},e.prototype.onPostRender=function(t){},e.prototype.onDestroy=function(){this.unBindEvents()},e.prototype.bindEvents=function(){var t=this.getGame();t.event.add("MainRendererWillStart",this.handlePreRender),t.event.add("MainRendererIsCleared",this.handlePostClear),t.event.add("MainRendererIsFinished",this.handlePostRender)},e.prototype.unBindEvents=function(){var t=this.getGame();t.event.remove("MainRendererWillStart",this.handlePreRender),t.event.remove("MainRendererIsCleared",this.handlePostClear),t.event.remove("MainRendererIsFinished",this.handlePostRender)},e=g([C({className:"RenderSystemActor"})],e)}(Ui),no=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.VertexArrayObject),ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Program),io=Re.capabilities,oo=Re.extensions,so=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Buffer);function ao(t){return t.isBSPBoxComponent}var uo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBSPBoxComponent=!0,e}return p(e,t),e.prototype.convertState=function(t){t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments;var e=_(t,["width","height","depth","widthSegments","heightSegments","depthSegments"]);return e.geometry=new mn(t),e},e=g([C({className:"BSPBoxComponent"})],e)}(zr),co=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.PlaneGeometry);function ho(t){return t.isBSPPlaneComponent}var lo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBSPPlaneComponent=!0,e}return p(e,t),e.prototype.convertState=function(t){t.width,t.height,t.widthSegments,t.heightSegments;var e=_(t,["width","height","widthSegments","heightSegments"]);return e.geometry=new co(t),e},e=g([C({className:"BSPPlaneComponent"})],e)}(zr);function fo(t){return t.isBSPSphereComponent}var po=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBSPSphereComponent=!0,e}return p(e,t),e.prototype.convertState=function(t){t.radius,t.widthSegments,t.heightSegments;var e=_(t,["radius","widthSegments","heightSegments"]);return e.geometry=new _n(t),e},e=g([C({className:"BSPSphereComponent"})],e)}(zr),mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Geometry),_o=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return p(e,t),e}(Re.GeometryData),go=function(t){function e(e){var n=t.call(this,e)||this;return n.isCylinderGeometry=!0,n.className="CylinderGeometry",n._options={radiusTop:1,radiusBottom:1,height:1,radialSegments:8,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:2*Math.PI},Object.assign(n._options,e),n.build(),n}return p(e,t),e.prototype.build=function(){var t=this._options,e=t.radiusTop,n=t.radiusBottom,r=t.height,i=t.radialSegments,o=t.heightSegments,s=t.openEnded,a=t.thetaStart,u=t.thetaLength,c=[],h=[],l=[],f=[],d=0,p=[],m=r/2;function _(t){var r,o,s,p=new Ge,_=new ke,g=!0===t?e:n,v=!0===t?1:-1;for(o=d,r=1;r<=i;r++)h.push(0,m*v,0),l.push(0,v,0),f.push(.5,.5),d++;for(s=d,r=0;r<=i;r++){var y=r/i*u+a,E=Math.cos(y),T=Math.sin(y);_.x=g*T,_.y=m*v,_.z=g*E,h.push(_.x,_.y,_.z),l.push(0,v,0),p.x=.5*E+.5,p.y=.5*T*v+.5,f.push(p.x,p.y),d++}for(r=0;r<i;r++){var A=o+r,S=s+r;!0===t?c.push(S,S+1,A):c.push(S+1,S,A)}}!function(){var t,s,_=new ke,g=new ke,v=(n-e)/r;for(s=0;s<=o;s++){var y=[],E=s/o,T=E*(n-e)+e;for(t=0;t<=i;t++){var A=t/i,S=A*u+a,M=Math.sin(S),O=Math.cos(S);g.x=T*M,g.y=-E*r+m,g.z=T*O,h.push(g.x,g.y,g.z),_.set(M,v,O).normalize(),l.push(_.x,_.y,_.z),f.push(A,1-E),y.push(d++)}p.push(y)}for(t=0;t<i;t++)for(s=0;s<o;s++){var b=p[s][t],L=p[s+1][t],I=p[s+1][t+1],R=p[s][t+1];c.push(b,L,R),c.push(L,I,R)}}(),!1===s&&(e>0&&_(!0),n>0&&_(!1)),this.vertices=new _o(new Float32Array(h),3,null),this.indices=new _o(new Uint16Array(c),1,null),this.uvs=new _o(new Float32Array(f),2,null),this.normals=new _o(new Float32Array(l),3,null)},e}(mo);function vo(t){return t.isBSPCylinderComponent}var yo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBSPCylinderComponent=!0,e}return p(e,t),e.prototype.convertState=function(t){t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength;var e=_(t,["radiusTop","radiusBottom","height","radialSegments","heightSegments","openEnded","thetaStart","thetaLength"]);return e.geometry=new go(t),e},e=g([C({className:"BSPCylinderComponent"})],e)}(zr),Eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",uo,t)},e=g([C({className:"BSPBoxActor"})],e)}(Wn),To=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",yo,t)},e=g([C({className:"BSPCylinderActor"})],e)}(Wn),Ao=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",lo,t)},e=g([C({className:"BSPPlaneActor"})],e)}(Wn),So=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onCreateRoot=function(t){return this.addComponent("root",po,t)},e=g([C({className:"BSPSphereActor"})],e)}(Wn),Mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.CubeTexture),Oo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.DataTexture),bo=function(t){function e(e){var n=t.call(this,e)||this;n.isDynamicTexture=!0,n.image=n._canvas=document.createElement("canvas"),n._canvas.width=e.width,n._canvas.height=e.height,n._context=n._canvas.getContext("2d");var r=n.onInit(n._context,e);return n.needUpdate=!1!==r,n}return p(e,t),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t,e){return!1},e.prototype.onDraw=function(t){return!1},e.prototype.draw=function(){var t=this.onDraw(this._context);this.needUpdate=!1!==t},e}(an),Lo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Material);Re.Material.prototype.getUniform=function(t){var e=this;return{get value(){return e[t]},set value(n){e.setUniform(t,n)}}},Re.Material.prototype.setUniform=function(t,e){return this[t]=e,this},Re.Material.prototype.changeUniform=function(t,e){return this[t]=e(this[t]),this};var Io=void 0,Ro=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.BasicMaterial);Ro.prototype.initCommonOptions=function(t){if(t.alphaMode)switch(t.alphaMode){case"BLEND":Io.transparent=!0,Io.blend=!0;break;case"MASK":Io.alphaCutoff="alphaCutoff"in t?t.alphaCutoff:.5;break;case"OPAQUE":default:Io.ignoreTranparent=!0}t.doubleSided&&(Io.side=on.FRONT_AND_BACK)},Ro.CLASS_NAME=new f("BasicMaterial"),R.BasicMaterial=function(t){var e=t.uniforms,n=(t.options,_(t,["uniforms","options"])),r=e.lightType.value;return new Ro(m({lightType:0===r?"NONE":1===r?"PHONE":2===r?"BLINN-PHONE":"LAMBERT",diffuse:(e.u_diffuseMap||e.u_diffuse||{}).value,ambient:(e.u_ambientMap||{}).value,specular:(e.u_specularMap||e.u_specular||{}).value,normalMap:(e.u_normalMap||{}).value,normalMapScale:(e.u_normalMapScale||{}).value,emission:(e.u_emissionMap||e.u_emission||{}).value,shininess:(e.u_shininess||{}).value,reflectivity:(e.u_reflectivity||{}).value,refractivity:(e.u_refractivity||{}).value,refractRatio:(e.u_refractRatio||{}).value},n))};var Co=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.GeometryMaterial),xo=function(){function t(t,e,n){void 0===n&&(n=!1),this.name=t,this.isMain=n,this.isShaderChuck=!0,this.vsEntryName="",this.fsEntryName="",this.hasVsOut=!1,this.hasFsOut=!1,this.requiredAttributes=[],this.requiredUniforms=[],this.attributes={},this.uniforms={},this.defines="",this.vs={header:"",main:""},this.fs={header:"",main:""},this.onInit(t,e)}return t.prototype.onInit=function(t,e){},t}(),wo=[Re.Shader.shaders["chunk/baseDefine.glsl"],"#define HILO_HAS_NORMAL 1","#define HILO_HAS_TEXCOORD0 1","#define HILO_HAS_TEXCOORD1 1"].join("\n"),No={a_position:"POSITION",a_normal:"NORMAL",a_tangent:"TANGENT",a_texcoord0:"TEXCOORD_0",a_texcoord1:"TEXCOORD_1",a_color:"COLOR_0",a_skinIndices:"SKININDICES",a_skinWeights:"SKINWEIGHTS"};["POSITION","NORMAL","TANGENT"].forEach((function(t){for(var e=t.slice(0,1)+t.slice(1).toLowerCase(),n=0;n<8;n+=1)No["a_morph"+e+n]="MORPH"+t+n}));var Po={u_normalMatrix:"MODELVIEWINVERSETRANSPOSE",u_modelViewMatrix:"MODELVIEW",u_modelViewProjectionMatrix:"MODELVIEWPROJECTION",u_logDepth:"LOGDEPTH",u_ambientLightsColor:"AMBIENTLIGHTSCOLOR",u_directionalLightsColor:"DIRECTIONALLIGHTSCOLOR",u_directionalLightsInfo:"DIRECTIONALLIGHTSINFO",u_directionalLightsShadowMap:"DIRECTIONALLIGHTSSHADOWMAP",u_directionalLightsShadowMapSize:"DIRECTIONALLIGHTSSHADOWMAPSIZE",u_directionalLightsShadowBias:"DIRECTIONALLIGHTSSHADOWBIAS",u_directionalLightSpaceMatrix:"DIRECTIONALLIGHTSPACEMATRIX",u_pointLightsPos:"POINTLIGHTSPOS",u_pointLightsColor:"POINTLIGHTSCOLOR",u_pointLightsInfo:"POINTLIGHTSINFO",u_pointLightsShadowBias:"POINTLIGHTSSHADOWBIAS",u_pointLightsShadowMap:"POINTLIGHTSSHADOWMAP",u_pointLightSpaceMatrix:"POINTLIGHTSPACEMATRIX",u_pointLightCamera:"POINTLIGHTCAMERA",u_spotLightsPos:"SPOTLIGHTSPOS",u_spotLightsDir:"SPOTLIGHTSDIR",u_spotLightsColor:"SPOTLIGHTSCOLOR",u_spotLightsCutoffs:"SPOTLIGHTSCUTOFFS",u_spotLightsInfo:"SPOTLIGHTSINFO",u_spotLightsShadowMap:"SPOTLIGHTSSHADOWMAP",u_spotLightsShadowMapSize:"SPOTLIGHTSSHADOWMAPSIZE",u_spotLightsShadowBias:"SPOTLIGHTSSHADOWBIAS",u_spotLightSpaceMatrix:"SPOTLIGHTSPACEMATRIX",u_areaLightsPos:"AREALIGHTSPOS",u_areaLightsColor:"AREALIGHTSCOLOR",u_areaLightsWidth:"AREALIGHTSWIDTH",u_areaLightsHeight:"AREALIGHTSHEIGHT",u_areaLightsLtcTexture1:"AREALIGHTSLTCTEXTURE1",u_areaLightsLtcTexture2:"AREALIGHTSLTCTEXTURE2",u_jointMat:"JOINTMATRIX",u_jointMatTexture:"JOINTMATRIXTEXTURE",u_jointMatTextureSize:"JOINTMATRIXTEXTURESIZE",u_positionDecodeMat:"POSITIONDECODEMAT",u_normalDecodeMat:"NORMALDECODEMAT",u_uvDecodeMat:"UVDECODEMAT",u_uv1DecodeMat:"UV1DECODEMAT",u_morphWeights:"MORPHWEIGHTS",u_normalMapScale:"NORMALMAPSCALE",u_emission:"EMISSION",u_transparency:"TRANSPARENCY",u_uvMatrix:"UVMATRIX_0",u_uvMatrix1:"UVMATRIX_1",u_fogColor:"FOGCOLOR",u_fogInfo:"FOGINFO",u_alphaCutoff:"ALPHACUTOFF",u_exposure:"EXPOSURE",u_gammaFactor:"GAMMAFACTOR"},Do={header:[Re.Shader.shaders["chunk/extensions.vert"],Re.Shader.shaders["chunk/precision.vert"],"attribute vec3 a_position;","uniform mat4 u_modelViewProjectionMatrix;",Re.Shader.shaders["chunk/unQuantize.vert"],Re.Shader.shaders["chunk/joint.vert"],Re.Shader.shaders["chunk/uv.vert"],Re.Shader.shaders["chunk/normal.vert"],Re.Shader.shaders["chunk/lightFog.vert"],Re.Shader.shaders["chunk/morph.vert"],Re.Shader.shaders["chunk/color.vert"],Re.Shader.shaders["chunk/logDepth.vert"]].join("\n"),main:""},Ho={header:[Re.Shader.shaders["chunk/extensions.frag"],Re.Shader.shaders["chunk/precision.frag"],Re.Shader.shaders["./chunk/color.frag"],Re.Shader.shaders["./chunk/uv.frag"],Re.Shader.shaders["./chunk/normal.frag"],Re.Shader.shaders["./chunk/lightFog.frag"],Re.Shader.shaders["./chunk/light.frag"],Re.Shader.shaders["./chunk/transparency.frag"],Re.Shader.shaders["./chunk/fog.frag"],Re.Shader.shaders["./chunk/logDepth.frag"]].join("\n"),main:""},Fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.onInit=function(){this.attributes=No,this.uniforms=Po,this.defines=wo,this.vs=Do,this.fs=Ho},e}(xo),Uo=function(t){function e(e){var n=t.call(this)||this;return n.isShaderMaterial=!0,e.chunks=e.chunks||[],e.chunks.splice(0,0,new Fo("basicDefinition")),n.init(e),n}return p(e,t),e=g([x({className:"ShaderMaterial"})],e)}(hn),Bo=["a_position","a_normal","a_texcoord0"],Go=["u_normalMatrix","u_viewVector"],ko={u_fresnelC:{value:1},u_fresnelP:{value:1},u_fresnelColor:{value:new ze(1,1,1,1)}},jo={header:"\nuniform vec3 u_viewVector;\nuniform float u_fresnelC;\nuniform float u_fresnelP;\n\nvarying vec2 v_fresnelUv;\nvarying float v_fresnelIntensity;\n",main:"\nvoid fresnelEffect() {\nvec3 v_normal = normalize(u_normalMatrix * a_normal);\nvec3 v_view = normalize(u_normalMatrix * u_viewVector);\n\nv_fresnelIntensity = pow(u_fresnelC - dot(v_normal, v_view), u_fresnelP);\nv_fresnelUv = a_texcoord0;\n}  \n"},Vo={header:"\nuniform vec4 u_fresnelColor;\n\nvarying float v_fresnelIntensity;\nvarying vec2 v_fresnelUv;\n",main:"\nvec4 fresnelEffect() {\nvec4 glow = u_fresnelColor * v_fresnelIntensity;\n\nreturn glow;\n}  \n"},Xo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vsEntryName="fresnelEffect",e.fsEntryName="fresnelEffect",e.hasVsOut=!1,e.hasFsOut=!0,e}return p(e,t),e.prototype.onInit=function(){this.requiredAttributes=Bo,this.requiredUniforms=Go,this.uniforms=ko,this.vs=jo,this.fs=Vo},e}(xo),Wo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasVsOut=!0,e.hasFsOut=!0,e}return p(e,t),e.prototype.onInit=function(t,e){var n=e.chunks,r=e.vsWeights,i=void 0===r?{}:r,o=e.fsWeights,s=void 0===o?{}:o,a=[],u=[];this.vsEntryName=this.fsEntryName=t||"mixChunks",this.vs.main=this.fs.main="vec4 "+this.vsEntryName+"() {\n";for(var c=e.chunks.length,h=0;h<c;h+=1){var l=n[h];if(l.vsEntryName)if(l.hasVsOut){var f=i[l.name]||0,d="u_"+l.vsEntryName+"VsWeight",p=l.vsEntryName+"Res";a.push(p),this.vs.main+="vec4 "+p+" = "+l.vsEntryName+"() * "+d+";\n",this.uniforms[d]={value:f},this.vs.header+="uniform float "+d+";\n"}else this.vs.main+=l.vsEntryName+"();\n";l.fsEntryName&&(l.hasFsOut?(f=s[l.name]||0,d="u_"+l.fsEntryName+"FsWeight",p=l.fsEntryName+"Res",u.push(p),this.fs.main+="vec4 "+p+" = "+l.fsEntryName+"() * "+d+";\n",this.uniforms[d]={value:f},this.fs.header+="uniform float "+d+";\n"):this.fs.main+=l.fsEntryName+"();\n")}this.vs.main+="return "+a.join(" + ")+";\n}",this.fs.main+="return "+u.join(" + ")+";\n}"},e}(xo),zo={BasicDefinitionChunk:Fo,FresnelEffectChuck:Xo,MixChunksChunk:Wo},qo=Re.semantic;qo.register=function(t,e){if(qo[t])throw new Error("Sematic "+t+" has already existed !");qo[t]=e},qo.get=function(t){return qo[t]},qo.unregister=function(t){qo[t]&&delete qo[t]};var Yo=qo,Jo={_mvp:new Xe,get:function(t,e){var n=e.game.world.mainCamera,r=Jo._mvp;return r.copy(t.worldMatrix),e.isBillboard&&r.fromRotationTranslationScale(n.quaternion,r.getTranslation(),r.getScaling()),r.premultiply(n.viewProjectionMatrix),r.elements}};Yo.register("SPRITEMODELVIEWPROJECTION",Jo);var Qo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e}(Re.Skeleton),Zo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSpriteAnimation=!0,e._paused=!0,e._delta=0,e.handleElementEnd=function(){e.handleEnd(e,e.actor)},e}return p(e,t),Object.defineProperty(e.prototype,"duration",{get:function(){return 1e3*this._length/(this._fps||this.parent.getGame().fps)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameCount",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return 1e3*this._current/(this._fps||this.parent.getGame().fps)},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t){var e=this._component=this.actor.findComponentByName(t.componentName||"root");if(!e.isSpriteComponent)throw new Yi(e,"SpriteComponent",this);this._fps=t.fps;var n=this._atlas=t.atlas||e.atlas;this._frames=t.frameNames,t.frameNames||(this._frames=Object.keys(n.frames)),this._length=this._frames.length},e.prototype.onPlay=function(t){this._current=0,this._delta=0,this._paused=!1,this._component.atlas=this._atlas},e.prototype.onPause=function(){this._paused=!0},e.prototype.onResume=function(){this._paused=!1,this._delta=0,this._component.atlas=this._atlas},e.prototype.onStop=function(){this._current=0,this._paused=!0},e.prototype.onUpdate=function(t){if(!this._paused){var e=this._fps||this.parent.getGame().fps;this._delta<1e3/e?this._delta+=t:(this._delta=0,this._component.setFrame(this._frames[this._current]),this._current+=1,this._current===this._length&&(this.stop(),this.handleElementEnd()))}},e=g([C({className:"SpriteAnimation"})],e)}(Ur),Ko=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTweenAnimation=!0,e.handleElementPause=function(){e.pause()},e.handleElementResume=function(){e.resume()},e.handleComplete=function(){e.handleEnd(e,e.actor)},e}return p(e,t),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._tween.time},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._tween.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._tween.paused},enumerable:!1,configurable:!0}),e.prototype.onInit=function(t){var e=t.create;this._tween=e(this.handleComplete),this._tween.stop(),this.getGame().event.add("GameWillPause",this.handleElementPause),this.getGame().event.add("GameDidResume",this.handleElementResume)},e.prototype.onPlay=function(t){this._tween.start()},e.prototype.onPause=function(){this._tween.pause()},e.prototype.onResume=function(){this._tween.resume()},e.prototype.onStop=function(){this._tween.stop()},e.prototype.onDestroy=function(){this.stop(),this.getGame().event.remove("GameWillPause",this.handleElementPause),this.getGame().event.remove("GameDidResume",this.handleElementResume)},e=g([C({className:"TweenAnimation"})],e)}(Ur),$o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCombineAnimation=!0,e._count=0,e._length=0,e.handleElementEnd=function(){e._count+=1,e._count===e._length&&e.handleEnd(e,e.actor)},e}return p(e,t),e.prototype.onInit=function(t){this._animations=t.animations,this._length=this._animations.length;for(var e=0;e<this._length;e+=1){var n=this._animations[e];n.handleEnd=this.handleElementEnd,n.animator=this.animator,n.initialize()}},e.prototype.onPlay=function(t){this._count=0;for(var e=0;e<this._length;e+=1)this._animations[e].play(t)},e.prototype.onPause=function(){for(var t=0;t<this._length;t+=1)this._animations[t].pause()},e.prototype.onResume=function(){for(var t=0;t<this._length;t+=1)this._animations[t].resume()},e.prototype.onStop=function(){for(var t=0;t<this._length;t+=1)this._animations[t].stop()},e.prototype.onUpdate=function(t){for(var e=0;e<this._length;e+=1)this._animations[e].onUpdate(t)},e.prototype.onDestroy=function(){for(var t=0;t<this._length;t+=1)this._animations[t].destroy()},e=g([C({className:"CombineAnimation"})],e)}(Ur);function ts(t,e){for(var n=t.findComponentsByClass(Rn),r=n.length,i=[],o=0;o<r;o+=1){var s=n[o].actor;if(e(s))return;Array.prototype.push.apply(i,s.findComponentsByClass(Rn)),o===r-1&&(r=(n=i).length,o=0,i=[])}}function es(t,e){wn(t)?ts(t,e):t.actors.forEach(e)}var ns=function(t){function n(e,n,r){void 0===n&&(n=new ke(0,-9.81,0)),void 0===r&&(r=10);var i=t.call(this,"SeinCannonPhysicWorld")||this;if(i.isPhysicWorld=!0,i.isCannonPhysicWorld=!0,i._fixedTimeStep=1/60,i._physicsMaterials=[],!e)throw new En(i,'The newest version Cannonjs is required ! Goto "https://github.com/dtysky/cannon.js/tree/master/build" get it !');return i.CANNON=e,i._world=new i.CANNON.World,i._world.broadphase=new i.CANNON.NaiveBroadphase,i._world.solver.iterations=r,i._world.gravity.set(n.x,n.y,n.z),i._ray=new i.CANNON.Ray,i._rayResult=new i.CANNON.RaycastResult,i}return p(n,t),Object.defineProperty(n.prototype,"timeStep",{get:function(){return this._fixedTimeStep},set:function(t){this._fixedTimeStep=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gravity",{get:function(){var t=this._world.gravity,e=t.x,n=t.y,r=t.z;return new ke(e,n,r)},set:function(t){this._world.gravity.set(t.x,t.y,t.z)},enumerable:!1,configurable:!0}),n.prototype.initContactEvents=function(){this._world.addEventListener("beginContact",(function(t){t.bodyA&&t.bodyB&&(t.bodyA.component.valid&&t.bodyA.component.handleBodyEnter(t.bodyA.component,t.bodyB.component),t.bodyB.component.valid&&t.bodyB.component.handleBodyEnter(t.bodyB.component,t.bodyA.component))})),this._world.addEventListener("endContact",(function(t){t.bodyA&&t.bodyB&&(t.bodyA.component.valid&&t.bodyA.component.handleBodyLeave(t.bodyA.component,t.bodyB.component),t.bodyB.component.valid&&t.bodyB.component.handleBodyLeave(t.bodyB.component,t.bodyA.component))})),this._world.addEventListener("beginShapeContact",(function(t){t.bodyA&&t.bodyB&&(t.bodyA.component.valid&&t.bodyA.component.handleColliderEnter(t.bodyA.component,t.bodyB.component,t.shapeA.component,t.shapeB.component),t.bodyB.component.valid&&t.bodyB.component.handleColliderEnter(t.bodyB.component,t.bodyA.component,t.shapeB.component,t.shapeA.component))})),this._world.addEventListener("endShapeContact",(function(t){t.bodyA&&t.bodyB&&(t.bodyA.component.valid&&t.bodyA.component.handleColliderLeave(t.bodyA.component,t.bodyB.component,t.shapeA.component,t.shapeB.component),t.bodyB.component.valid&&t.bodyB.component.handleColliderLeave(t.bodyB.component,t.bodyA.component,t.shapeB.component,t.shapeA.component))}))},n.prototype.setGravity=function(t){return this._world.gravity.x=t.x,this._world.gravity.y=t.y,this._world.gravity.z=t.z,this},n.prototype.update=function(t,e){void 0===t&&(t=0),this._world.step(this._fixedTimeStep,t,3)},n.prototype.applyImpulse=function(t,e,n){var r=new this.CANNON.Vec3(n.x,n.y,n.z),i=new this.CANNON.Vec3(e.x,e.y,e.z);t.rigidBody.applyImpulse(i,r)},n.prototype.applyForce=function(t,e,n){var r=new this.CANNON.Vec3(n.x,n.y,n.z),i=new this.CANNON.Vec3(e.x,e.y,e.z);t.rigidBody.applyForce(i,r)},n.prototype.pick=function(t,n,r,i){var o=this;void 0===i&&(i={});var s=m({},i);switch(this._ray.from.copy(t),this._ray.to.copy(n),this._ray.checkCollisionResponse=!0===s.checkCollisionResponse,s.mode){case e.EPickMode.All:s.mode=this.CANNON.Ray.ALL;break;case e.EPickMode.Any:s.mode=this.CANNON.Ray.ANY;break;case e.EPickMode.Closest:s.mode=this.CANNON.Ray.CLOSEST;default:s.mode=this.CANNON.Ray.CLOSEST}s.skipBackfaces=!1!==s.skipBackfaces,s.result=this._rayResult;var a=[];s.callback=function(){var t=o._rayResult,e=t.body,n=t.shape,r=t.distance,i=t.hitPointWorld;e.component.valid&&a.push({rigidBody:e.component,collider:n.component,actor:e.component.getOwner(),distance:r,point:new ke(i.x,i.y,i.z)})},s.bodies&&(s.bodies=s.bodies.map((function(t){return t.rigidBody})));var u=this._ray.intersectWorld(this._world,s);if(u&&s.mode===e.EPickMode.CLOSEST){var c=this._rayResult,h=c.body,l=c.shape,f=c.distance,d=c.hitPointWorld;a.push({rigidBody:h.component,collider:l.component,actor:h.component.getOwner(),distance:f,point:new ke(d.x,d.y,d.z)})}return r(a),u},n.prototype.createRigidBody=function(t,e){var n=this.addMaterial("mat-"+t.uuid,e.friction,e.restitution),r={mass:e.mass,material:n};for(var i in e.nativeOptions)r[i]=e.nativeOptions[i];var o=new this.CANNON.Body(r);o.component=t;var s=t.getCurrentTransform(),a=s[0],u=s[1],c=s[2];return this.setBodyTransform(o,a,u,c),o.updateMassProperties(),o.updateBoundingRadius(),S.devMode&&this.checkNest(t),this._world.addBody(o),o},n.prototype.disableRigidBody=function(t){this._world.remove(t.rigidBody)},n.prototype.enableRigidBody=function(t){this._world.add(t.rigidBody)},n.prototype.checkNest=function(t){for(var e=t.getOwner(),n=e.parent;n;){if(n.rigidBody){S.warn('You should never have a parent and child "none isTrigger and 0 mass" rigidBody together',e,n);break}n=n.parent}ts(e,(function(t){return!t.rigidBody||(S.warn('You should never have a parent and child "none isTrigger and 0 mass" rigidBody together',e,t),!1)}))},n.prototype.initEvents=function(t){this._world.addEventListener("preStep",t.handleBeforeStep),this._world.addEventListener("postStep",t.handleAfterStep),t.rigidBody.addEventListener("collide",t.handleCollision)},n.prototype.removeRigidBody=function(t){this._world.removeEventListener("preStep",t.handleBeforeStep),this._world.removeEventListener("postStep",t.handleAfterStep),t.rigidBody.removeEventListener("collision",t.handleCollision),this._world.remove(t.rigidBody)},n.prototype.clear=function(){this._world._listeners.preStep=[],this._world._listeners.postStep=[],this._world.bodies=[]},n.prototype.createJoint=function(t,n,r){var i,o=r.type,s=r.options,a=s.actor,u=_(s,["actor"]),c=t.rigidBody,h=a.rigidBody.rigidBody;switch(o){case e.EJointType.Hinge:i=new this.CANNON.HingeConstraint(c,h,u);break;case e.EJointType.Distance:i=new this.CANNON.DistanceConstraint(c,h,u.distance,u.maxForce);break;case e.EJointType.Spring:i=new this.CANNON.Spring(c,h,u);break;case e.EJointType.Lock:i=new this.CANNON.LockConstraint(c,h,u);break;case e.EJointType.PointToPoint:default:i=new this.CANNON.PointToPointConstraint(c,u.pivotA,h,u.pivotB,u.maxForce)}return i.collideConnected=!!u.collideConnected,i.wakeUpBodies=!!u.wakeUpBodies,i.component=i,o!==e.EJointType.Spring?this._world.addConstraint(i):t.event.add("AfterStep",n.applyForce),i},n.prototype.removeJoint=function(t,n){n.type!==e.EJointType.Spring?this._world.removeConstraint(n.joint):t.event.remove("AfterStep",n.applyForce)},n.prototype.enableJoint=function(t){t.joint.enable()},n.prototype.disableJoint=function(t){t.joint.disable()},n.prototype.addMaterial=function(t,e,n){var r,i;for(r=0;r<this._physicsMaterials.length;r+=1)if((i=this._physicsMaterials[r]).friction===e&&i.restitution===n)return i;var o=new this.CANNON.Material(t);return o.friction=e,o.restitution=n,this._physicsMaterials.push(o),o},n.prototype.createCollider=function(t,n,r){var i,o,s;switch(r.type){case e.EColliderType.Sphere:s=new this.CANNON.Sphere(r.options.radius);break;case e.EColliderType.Cylinder:s=new this.CANNON.Cylinder(r.options.radiusTop,r.options.radiusBottom,r.options.height,r.options.numSegments);break;case e.EColliderType.Box:s=new this.CANNON.Box(new this.CANNON.Vec3(r.options.size[0]/2,r.options.size[1]/2,r.options.size[2]/2));break;case e.EColliderType.Plane:S.warn("Attention, PlaneCollider might not behave as you expect. Consider using BoxCollider instead"),s=new this.CANNON.Plane}var a=r.options,u=a.offset,c=a.quaternion,h=a.isTrigger;return u=u||[0,0,0],c=c||[0,0,0,1],h=h||!1,t.rigidBody.addShape(s,new((i=this.CANNON.Vec3).bind.apply(i,E([void 0],u))),new((o=this.CANNON.Quaternion).bind.apply(o,E([void 0],c)))),s.collisionResponse=!h,s.component=n,s},n.prototype.removeCollider=function(t,e){var n=t.rigidBody,r=e.collider,i=n.shapes.indexOf(r);n.shapes.splice(i,1),n.shapeOffsets.splice(i,1),n.shapeOrientations.splice(i,1)},n.prototype.setRootTransform=function(t){var e=t.getOwner().transform,n=t.rigidBody,r=n.position,i=n.quaternion;e.setPosition(r.x,r.y,r.z),e.setQuaternion(i.x,i.y,i.z,i.w)},n.prototype.setRigidBodyTransform=function(t,e,n,r){this.setBodyTransform(t.rigidBody,e,n,r)},n.prototype.setBodyTransform=function(t,e,n,r){var i=this;e&&t.position.copy(e),n&&t.quaternion.copy(n),r&&t.shapes&&t.shapes.forEach((function(e,n){i.setColliderScale(e.component,t.component,r,n)}))},n.prototype.setColliderTransform=function(t,e,n,r){if(t){var i=t.collider,o=t.getOwner().rigidBody,s=o.rigidBody.shapes.indexOf(i);r&&this.setColliderScale(t,o,r,s),o.needUpdateCollider=!0}},n.prototype.setColliderScale=function(t,n,r,i){var o=t.collider,s=t.initState;switch(t.type){case e.EColliderType.Box:o.halfExtents.set(s.size[0]/2*r.x,s.size[1]/2*r.y,s.size[2]/2*r.z);break;case e.EColliderType.Sphere:o.radius=s.radius*r.x}t.type!==e.EColliderType.Sphere&&o.updateConvexPolyhedronRepresentation();var a=s.offset;if(0!==a[0]||0!==a[1]||0!==a[2]){var u=n.rigidBody.shapeOffsets[i];u.x=a[0]*r.x,u.y=a[1]*r.y,u.z=-a[2]*r.z}},n.prototype.updateBounding=function(t){t.rigidBody.updateMassProperties(),t.rigidBody.updateBoundingRadius()},n.prototype.setLinearVelocity=function(t,e){t.rigidBody.velocity.copy(e)},n.prototype.setAngularVelocity=function(t,e){t.rigidBody.angularVelocity.copy(e)},n.prototype.getLinearVelocity=function(t){var e=t.rigidBody.velocity;return e?new ke(e.x,e.y,e.z):null},n.prototype.getAngularVelocity=function(t){var e=t.rigidBody.angularVelocity;return e?new ke(e.x,e.y,e.z):null},n.prototype.setBodyMass=function(t,n){t.rigidBody.mass=n,!t.physicStatic&&n>0&&this.setBodyType(t,e.ERigidBodyType.Dynamic),t.rigidBody.updateMassProperties()},n.prototype.getBodyMass=function(t){return t.rigidBody.mass},n.prototype.setFilterGroup=function(t,e){t.rigidBody.collisionFilterGroup=e},n.prototype.getFilterGroup=function(t){return t.rigidBody.collisionFilterGroup},n.prototype.setFilterMask=function(t,e){t.rigidBody.collisionFilterMask=e},n.prototype.getFilterMask=function(t){return t.rigidBody.collisionFilterMask},n.prototype.getBodyFriction=function(t){return t.rigidBody.material.friction},n.prototype.setBodyFriction=function(t,e){t.rigidBody.material.friction=e},n.prototype.getBodyRestitution=function(t){return t.rigidBody.material.restitution},n.prototype.setBodyRestitution=function(t,e){t.rigidBody.material.restitution=e},n.prototype.sleepBody=function(t){t.rigidBody.sleep()},n.prototype.wakeUpBody=function(t){t.rigidBody.wakeUp()},n.prototype.setBodyType=function(t,e){t.rigidBody.type=e},n.prototype.setColliderIsTrigger=function(t,e){t.collider.collisionResponse=!e},n.prototype.getColliderIsTrigger=function(t){return!t.collider.collisionResponse},n=g([C({className:"CannonPhysicWorld",classType:"PhysicWorld"})],n)}(L),rs=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isCylinderColliderComponent=!0,n._type=e.EColliderType.Cylinder,n}return p(n,t),n.prototype.getDefaultOptions=function(){return null},n=g([C({className:"CylinderColliderComponent",classType:"Collider"})],n)}(kn),is=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isPlaneColliderComponent=!0,n._type=e.EColliderType.Plane,n}return p(n,t),n.prototype.getDefaultOptions=function(){return null},n=g([C({className:"PlaneColliderComponent",classType:"Collider"})],n)}(kn),os=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isJointComponent=!0,n._type=e.EJointType.PointToPoint,n}return p(n,t),Object.defineProperty(n.prototype,"joint",{get:function(){return this._joint},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"initState",{get:function(){return this._initState},enumerable:!1,configurable:!0}),n.prototype.verifyAdding=function(t){if(!this._owner.rigidBody||!t.actor.rigidBody)throw new gn(this,"RigidBodyComponent must be added to self or other actor before adding JointComponent !")},n.prototype.onAdd=function(t){var e=this._owner.rigidBody,n=this._initState=t;this._joint=this.getPhysicWorld().createJoint(e,this,{type:this._type,options:n})},n.prototype.disable=function(){this.getPhysicWorld().disableJoint(this)},n.prototype.enable=function(){this.getPhysicWorld().enableJoint(this)},n.prototype.onDestroy=function(){var t=this,e=this.getPhysicWorld();setTimeout((function(){t._owner&&t._owner.rigidBody&&e.removeJoint(t._owner.rigidBody,t)}),0)},n=g([C({className:"JointComponent"})],n)}(H),ss=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isPointToPointJointComponent=!0,n._type=e.EJointType.PointToPoint,n}return p(n,t),n=g([C({className:"PointToPointJointComponent",classType:"Collider"})],n)}(os),as=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isDistanceJointComponent=!0,n._type=e.EJointType.Distance,n}return p(n,t),n=g([C({className:"DistanceJointComponent",classType:"Collider"})],n)}(os),us=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isHingeJointComponent=!0,n._type=e.EJointType.Hinge,n}return p(n,t),n=g([C({className:"HingeJointComponent",classType:"Collider"})],n)}(os),cs=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isLockJointComponent=!0,n._type=e.EJointType.Lock,n}return p(n,t),n=g([C({className:"LockJointComponent",classType:"Collider"})],n)}(os),hs=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isSpringJointComponent=!0,n._type=e.EJointType.Spring,n.applyForce=function(){n._joint.applyForce},n}return p(n,t),n=g([C({className:"SpringJointComponent",classType:"Collider"})],n)}(os),ls=function(t){function e(e){var n=t.call(this)||this;return n.isPhysicPicker=!0,n._active=!1,n._tmpTo=new ke,n._tmpFrom=new ke,n.handleMouse=function(t){var e=n._game.bound,r=e.left,i=e.top;n._tmpX=t.clientX-r,n._tmpY=t.clientY-i,n.pick(n._tmpX,n._tmpY)},n.handleTouch=function(t){var e=t.changedTouches[0];if(e){var r=n._game.bound,i=r.left,o=r.top;n._tmpX=e.clientX-i,n._tmpY=e.clientY-o,n.pick(n._tmpX,n._tmpY)}},n.onPick=function(t){n._options.filter&&(t=n._options.filter(t)),t.forEach((function(t){t.rigidBody.handlePick(t)}))},n._game=e,n}return p(e,t),Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),e.prototype.enablePicking=function(t){if(!this._game.world.physicWorld)throw new En(this,"Physic world is required for enable physic picking !");this._active||(this._options=t||{},this._options.type=this._options.type||"down",this._active=!0,"up"===this._options.type?(this._game.hid.add("MouseUp",this.handleMouse),this._game.hid.add("TouchEnd",this.handleTouch)):"down"===this._options.type&&(this._game.hid.add("MouseDown",this.handleMouse),this._game.hid.add("TouchStart",this.handleTouch)))},e.prototype.disablePicking=function(){if(!this._game.world.physicWorld)throw new En(this,"Physic world is required for enable physic picking !");"up"===this._options.type?(this._game.hid.remove("MouseUp",this.handleMouse),this._game.hid.remove("TouchEnd",this.handleTouch)):"down"===this._options.type&&(this._game.hid.remove("MouseDown",this.handleMouse),this._game.hid.remove("TouchStart",this.handleTouch))},e.prototype.pick=function(t,e){var n=this._game,r=n.screenWidth,i=n.screenHeight,o=this._game.world.physicWorld,s=this._game.world.mainCamera;s?(s.generateRay(t,e,r,i,this._tmpFrom,this._tmpTo,this._options.rayLength),o.pick(this._tmpFrom,this._tmpTo,this.onPick,this._options)):S.warn("Can not pick, world has no camera now !")},e=g([C({className:"PhysicPicker"})],e)}(L);function fs(t,e){var n=null;return es(t,(function(t){return!!e(t)&&(n=t,!0)})),n}function ds(t,e,n){var r=[];return es(t,(function(t){if(e(t)&&r.push(t),n&&n(t,r))return!0})),r}var ps=new(function(){function t(){}return Object.defineProperty(t.prototype,"isWebGLSupport",{get:function(){return Re.WebGLSupport.get()},enumerable:!1,configurable:!0}),t}());console.log("Sein.js verison: 1.5.17"),"undefined"==typeof window||window.Sein||(window.Sein=t.exports),e.AIControllerActor=Ki,e.Actor=Nn,e.AliAMCExtension=nr,e.AmbientLightActor=Lr,e.AmbientLightComponent=br,e.Animation=Ur,e.AnimatorComponent=Vr,e.AtlasLoader=li,e.AtlasManager=$n,e.BSPBoxActor=Eo,e.BSPBoxComponent=uo,e.BSPComponent=zr,e.BSPCylinderActor=To,e.BSPCylinderComponent=yo,e.BSPMorphActor=Jr,e.BSPMorphComponent=Yr,e.BSPPlaneActor=Ao,e.BSPPlaneComponent=lo,e.BSPSphereActor=So,e.BSPSphereComponent=po,e.BaseException=M,e.BasicMaterial=Ro,e.BoxColliderComponent=jn,e.BoxGeometry=mn,e.BreakGuardException=gn,e.Buffer=so,e.CameraComponent=yn,e.CannonPhysicWorld=ns,e.ChildActorComponent=Rn,e.ColliderComponent=kn,e.Color=ze,e.CombineAnimation=$o,e.Component=H,e.Constants=on,e.ContextMenuTrigger=Ni,e.ContextSupports=ps,e.ControllerActor=Ji,e.CubeTexture=Mo,e.CubeTextureLoader=ki,e.CylinderColliderComponent=rs,e.CylinderGeometry=go,e.DEG2RAD=we,e.DataTexture=Oo,e.Debug=S,e.DirectionalLightActor=Cr,e.DirectionalLightComponent=Rr,e.DistanceJointComponent=as,e.DynamicTexture=bo,e.Engine=Dn,e.Euler=qe,e.EventManager=P,e.EventTrigger=fi,e.FSMComponent=jr,e.FSMState=Gr,e.Fog=$i,e.FrameBuffer=to,e.GLCapabilities=io,e.GLExtensions=oo,e.Game=Vi,e.GameModeActor=Xi,e.Geometry=mo,e.GeometryData=_o,e.GeometryMaterial=Co,e.GlTFLoader=ni,e.HTTP=hi,e.Hilo3d=Re,e.HingeJointComponent=us,e.ImageLoader=ii,e.InfoActor=Hi,e.JointComponent=os,e.KeyDownTrigger=pi,e.KeyPressTrigger=mi,e.KeyUpTrigger=_i,e.Layers=tn,e.LazyTexture=tr,e.Level=Ke,e.LevelScriptActor=Wi,e.LightComponent=Mr,e.LockJointComponent=cs,e.Material=Lo,e.Matrix3=Ve,e.Matrix4=Xe,e.MemberConflictException=Cn,e.Mesh=pn,e.MetaSClasses=I,e.MetaSMaterials=R,e.MissingMemberException=N,e.ModelAnimation=Br,e.MorphGeometry=Xr,e.MouseClickTrigger=Si,e.MouseDownTrigger=Mi,e.MouseEnterTrigger=bi,e.MouseLeaveTrigger=Li,e.MouseMoveTrigger=Ii,e.MouseOutTrigger=Ri,e.MouseOverTrigger=Ci,e.MouseUpTrigger=Oi,e.MouseWheelTrigger=xi,e.Observable=w,e.OrthographicCameraActor=Tr,e.OrthographicCameraComponent=Mn,e.PBRMaterial=Zn,e.PerspectiveCameraActor=Ar,e.PerspectiveCameraComponent=An,e.PhysicPicker=ls,e.PlaneColliderComponent=is,e.PlaneGeometry=co,e.Player=Di,e.PlayerControllerActor=Qi,e.PlayerStateActor=Zi,e.PointLightActor=Nr,e.PointLightComponent=wr,e.PointToPointJointComponent=ss,e.PrimitiveComponent=qn,e.Program=ro,e.Quaternion=We,e.RAD2DEG=Fe,e.RawShaderMaterial=hn,e.RenderSystemActor=eo,e.ResourceLoadException=Hn,e.ResourceLoader=Fn,e.ResourceManager=ri,e.RigidBodyComponent=Gn,e.SArray=U,e.SClass=C,e.SIterable=F,e.SMap=xn,e.SMaterial=x,e.SName=f,e.SObject=L,e.SSet=qi,e.SceneActor=Wn,e.SceneComponent=rn,e.Semantic=Yo,e.Shader=ln,e.ShaderChunk=xo,e.ShaderMaterial=Uo,e.SkeletalMesh=_r,e.SkeletalMeshActor=yr,e.SkeletalMeshComponent=vr,e.Skeleton=Qo,e.SkyboxMaterial=fn,e.SphereColliderComponent=Vn,e.SphereGeometry=_n,e.Spherical=Je,e.SphericalHarmonics3=Ye,e.SpotLightActor=Hr,e.SpotLightComponent=Dr,e.SpringJointComponent=hs,e.SpriteActor=$r,e.SpriteAnimation=Zo,e.SpriteComponent=Kr,e.StateActor=Fi,e.StaticMeshActor=Er,e.StaticMeshComponent=Jn,e.SystemActor=Ui,e.Texture=an,e.TextureLoader=ui,e.Ticker=Pn,e.TimerActor=zi,e.TouchCancelTrigger=Ti,e.TouchEndTrigger=yi,e.TouchMoveTrigger=Ei,e.TouchStartTrigger=vi,e.Tween=Qe,e.TweenAnimation=Ko,e.TypeConflictException=Yi,e.UnmetRequireException=En,e.Vector2=Ge,e.Vector3=ke,e.Vector4=je,e.VertexArrayObject=no,e.WheelTrigger=wi,e.WindowResizeTrigger=Pi,e.World=bn,e.author="Tianyu Dai <dtysky@outlook.com>",e.bfs=ts,e.clamp=xe,e.degToRad=Ne,e.deprecated=function(t,e){},e.findActorByClass=function(t,e){return fs(t,(function(t){return t.className.equalsTo(e.CLASS_NAME)}))},e.findActorByClassName=function(t,e){return fs(t,(function(t){return t.className.equalsTo(e)}))},e.findActorByFilter=fs,e.findActorByName=function(t,e){return fs(t,(function(t){return t.name.equalsTo(e)}))},e.findActorByNamePath=function(t,e){var n,r=e.length;if(!(n=ji(t)||On(t)?t.actors.findByName(e[0]):t))return null;if(1===r)return n;if(e.splice(0,1),0==(r-=1))return null;for(var i,o=n,s=0;s<r;s+=1)if(i=e[s],ts(o,(function(t){return t.name.equalsTo(i)?(o=t,!0):(o=null,!1)})),!o)return null;return o===n?null:o},e.findActorByTag=function(t,e){return fs(t,(function(t){return t.tag.equalsTo(e)}))},e.findActorByUUID=function(t,e){return fs(t,(function(t){return t.uuid===e}))},e.findActorsByClass=function(t,e,n){return ds(t,(function(t){return t.className.equalsTo(e.CLASS_NAME)}),n)},e.findActorsByClassName=function(t,e,n){return ds(t,(function(t){return t.className.equalsTo(e)}),n)},e.findActorsByFilter=ds,e.findActorsByName=function(t,e,n){return ds(t,(function(t){return t.name.equalsTo(e)}),n)},e.findActorsByTag=function(t,e,n){return ds(t,(function(t){return t.tag.equalsTo(e)}),n)},e.inspectable=function(t,e){return function(n,r,i){var o=n.constructor;if(o.CLASS_NAME){var s=o.INSPECTABLE_PROPERTIES=o.INSPECTABLE_PROPERTIES||{};s[r]={},t&&(s[r].type=t),e&&(s[r].options=e),i&&!i.writable&&(s[r].readonly=!0)}else S.warn("'inspectable' decorator must be applied to property in 'SObject' with 'SClass' decorator!")}},e.isAIControllerActor=function(t){return t.isAIControllerActor},e.isActor=wn,e.isAmbientLightActor=function(t){return $e(t)&&Or(t.root)},e.isAmbientLightComponent=Or,e.isAnimation=function(t){return t.isAnimation},e.isAnimatorComponent=function(t){return t.isAnimatorComponent},e.isAtlasLoader=function(t){return t.isAtlasLoader},e.isAtlasManager=function(t){return t.isAtlasManager},e.isBSPActor=function(t){return $e(t)&&Wr(t.root)},e.isBSPBoxActor=function(t){return $e(t)&&ao(t.root)},e.isBSPBoxComponent=ao,e.isBSPComponent=Wr,e.isBSPCylinderActor=function(t){return $e(t)&&vo(t.root)},e.isBSPCylinderComponent=vo,e.isBSPMorphActor=function(t){return $e(t)&&qr(t.root)},e.isBSPMorphComponent=qr,e.isBSPPlaneActor=function(t){return $e(t)&&ho(t.root)},e.isBSPPlaneComponent=ho,e.isBSPSphereActor=function(t){return $e(t)&&fo(t.root)},e.isBSPSphereComponent=fo,e.isBaseException=function(t){return t.isBaseException},e.isBasicMaterial=function(t){return t.isBasicMaterial},e.isBoxColliderComponent=function(t){return t.isBoxColliderComponent},e.isBoxGeometry=function(t){return t.isBoxGeometry},e.isBreakGuardException=function(t){return t.isBreakGuardException},e.isCameraActor=function(t){return $e(t)&&vn(t.root)},e.isColliderComponent=function(t){return t.isColliderComponent},e.isColor=function(t){return t.isColor},e.isCombineAnimation=function(t){return t.isCombineAnimation},e.isComponent=D,e.isControllerActor=function(t){return t.isControllerActor},e.isCubeTexture=function(t){return t.isCubeTexture},e.isCubeTextureLoader=function(t){return t.isCubeTextureLoader},e.isCylinderColliderComponent=function(t){return t.isCylinderColliderComponent},e.isCylinderGeometry=function(t){return t.isCylinderGeometry},e.isDataTexture=function(t){return t.isDataTexture},e.isDirectionalLightActor=function(t){return $e(t)&&Ir(t.root)},e.isDirectionalLightComponent=Ir,e.isDistanceJointComponent=function(t){return t.isDistanceJointComponent},e.isDynamicTexture=function(t){return t.isDynamicTexture},e.isEngine=function(t){return t.isEngine},e.isEuler=function(t){return t.isEuler},e.isEventManager=function(t){return t.isEventManager},e.isEventTrigger=function(t){return t.isEventTrigger},e.isFSMComponent=function(t){return t.isFSMComponent},e.isFSMState=function(t){return t.isFSMState},e.isFog=function(t){return t.isFog},e.isFrameBuffer=function(t){return t.isFramebuffer},e.isGame=ji,e.isGameModeActor=function(t){return t.isGameModeActor},e.isGeometry=function(t){return t.isGeometry},e.isGeometryData=function(t){return t.isGeometryData},e.isGeometryMaterial=function(t){return t.isGeometryMaterial},e.isGlTFLoader=function(t){return t.isGlTFLoader},e.isHingeJointComponent=function(t){return t.isHingeJointComponent},e.isImageLoader=function(t){return t.isImageLoader},e.isInfoActor=function(t){return t.isInfoActor},e.isJointComponent=function(t){return t.isJointComponent},e.isLayers=function(t){return t.isLayers},e.isLazyTexture=function(t){return t.isLazyTexture},e.isLevel=Ze,e.isLevelScriptActor=function(t){return t.isLevelScriptActor},e.isLightActor=function(t){return $e(t)&&Sr(t.root)},e.isLightComponent=Sr,e.isLockJointComponent=function(t){return t.isLockJointComponent},e.isMaterial=function(t){return t.isMaterial},e.isMatrix3=function(t){return t.isMatrix3},e.isMatrix4=function(t){return t.isMatrix4},e.isMemberConflictException=function(t){return t.isMemberConflictException},e.isMesh=dn,e.isMissingMemberException=function(t){return t.isMissingMemberException},e.isModelAnimation=function(t){return t.isModelAnimation},e.isMorphGeometry=function(t){return t.isMorphGeometry},e.isObservable=function(t){return t.isObservable},e.isOrthographicCameraActor=function(t){return $e(t)&&Sn(t.root)},e.isOrthographicCameraComponent=Sn,e.isPBRMaterial=Qn,e.isPerspectiveCameraActor=function(t){return $e(t)&&Tn(t.root)},e.isPerspectiveCameraComponent=Tn,e.isPhysicPicker=function(t){return t.isPhysicPicker},e.isPlaneColliderComponent=function(t){return t.isPlaneColliderComponent},e.isPlaneGeometry=function(t){return t.isPlaneGeometry},e.isPlayer=function(t){return t.isPlayer},e.isPlayerControllerActor=function(t){return t.isPlayerControllerActor},e.isPlayerStateActor=function(t){return t.isPlayerStateActor},e.isPointLightActor=function(t){return $e(t)&&xr(t.root)},e.isPointLightComponent=xr,e.isPointToPointJointComponent=function(t){return t.isPointToPointJointComponent},e.isPowerOfTwo=Pe,e.isPrimitiveActor=function(t){return Xn(t)&&zn(t.root)},e.isPrimitiveComponent=zn,e.isQuaternion=function(t){return t.isQuaternion},e.isRawShaderMaterial=cn,e.isRenderSystemActor=function(t){return t.isRenderSystemActor},e.isResourceLoadException=function(t){return t.isResourceLoadException},e.isResourceLoader=function(t){return t.isResourceLoader},e.isResourceManager=function(t){return t.isResourceManager},e.isRigidBodyComponent=function(t){return t.isRigidBodyComponent},e.isSName=l,e.isSObject=b,e.isSceneActor=Xn,e.isSceneComponent=nn,e.isShaderChunk=function(t){return t.isShaderChuck},e.isShaderMaterial=function(t){return t.isShaderMaterial},e.isSkeletalMesh=function(t){return t.isSkeletalMesh},e.isSkeletalMeshActor=function(t){return $e(t)&&gr(t.root)},e.isSkeletalMeshComponent=gr,e.isSkyboxMaterial=function(t){return t.isSkyboxMaterial},e.isSphereColliderComponent=function(t){return t.isSphereColliderComponent},e.isSphereGeometry=function(t){return t.isSphereGeometry},e.isSpherical=function(t){return t.isSpherical},e.isSphericalHarmonics3=function(t){return t.isSphericalHarmonics3},e.isSpotLightActor=function(t){return $e(t)&&Pr(t.root)},e.isSpotLightComponent=Pr,e.isSpringJointComponent=function(t){return t.isSpringJointComponent},e.isSpriteActor=function(t){return $e(t)&&Zr(t.root)},e.isSpriteAnimation=function(t){return t.isSpriteAnimation},e.isSpriteComponent=Zr,e.isStateActor=function(t){return t.isStateActor},e.isStaticMeshActor=function(t){return $e(t)&&Yn(t.root)},e.isStaticMeshComponent=Yn,e.isSystemActor=function(t){return t.isSystemActor},e.isTexture=sn,e.isTextureLoader=function(t){return t.isTextureLoader},e.isTicker=function(t){return t.isTicker},e.isTimerActor=function(t){return t.isTimerActor},e.isTweenAnimation=function(t){return t.isTweenAnimation},e.isTypeConflictException=function(t){return t.isTypeConflictException},e.isUnmetRequireException=function(t){return t.isUnmetRequireException},e.isVector2=function(t){return t.isVector2},e.isVector3=Be,e.isVector4=function(t){return t.isVector4},e.isWorld=On,e.iterateActors=es,e.iterateActorsByClass=function(t,e,n){es(t,(function(t){return!!t.className.equalsTo(e.CLASS_NAME)&&n(t)}))},e.iterateActorsByClassType=function(t,e,n){es(t,(function(t){return!!t.classType.equalsTo(e)&&n(t)}))},e.iterateActorsByName=function(t,e,n){es(t,(function(t){return!!t.name.equalsTo(e)&&n(t)}))},e.iterateActorsByTag=function(t,e,n){es(t,(function(t){return!!t.tag.equalsTo(e)&&n(t)}))},e.nearestPowerOfTwo=De,e.nextPowerOfTwo=He,e.radToDeg=Ue,e.serialize=function(t,e){},e.shaderChunks=zo,e.throwException=O,e.version="1.5.17",Object.defineProperty(e,"__esModule",{value:!0})})(e)}).call(this,n(11),n(12))}]]);